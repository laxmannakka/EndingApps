(function(){var c=c||{};c.WEBGL_RENDERER=0;c.CANVAS_RENDERER=1;c.VERSION="v2.0.0";c.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};c.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1};c._UID=0;"undefined"!=typeof Float32Array?(c.Float32Array=Float32Array,c.Uint16Array=Uint16Array):(c.Float32Array=Array,c.Uint16Array=Array);c.INTERACTION_FREQUENCY=30;c.AUTO_PREVENT_DEFAULT=
!0;c.PI_2=2*Math.PI;c.RAD_TO_DEG=180/Math.PI;c.DEG_TO_RAD=Math.PI/180;c.RETINA_PREFIX="@2x";c.dontSayHello=!1;c.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0};c.sayHello=function(f){c.dontSayHello||(-1<navigator.userAgent.toLowerCase().indexOf("chrome")?console.log.apply(console,["%c %c %c Pixi.js "+c.VERSION+" - "+f+"  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 ","background: #ff66a5","background: #ff66a5",
"color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"]):window.console&&console.log("Pixi.js "+c.VERSION+" - http://www.pixijs.com/"),c.dontSayHello=!0)};c.Polygon=function(f){if(f instanceof Array||(f=Array.prototype.slice.call(arguments)),f[0]instanceof c.Point){for(var b=[],d=0,e=f.length;e>d;d++)b.push(f[d].x,f[d].y);f=b}this.closed=!0;this.points=
f};c.Polygon.prototype.clone=function(){var f=this.points.slice();return new c.Polygon(f)};c.Polygon.prototype.contains=function(c,b){for(var d=!1,e=this.points.length/2,g=0,h=e-1;e>g;h=g++){var l=this.points[2*g],k=this.points[2*g+1],m=this.points[2*h],h=this.points[2*h+1];k>b!=h>b&&(m-l)*(b-k)/(h-k)+l>c&&(d=!d)}return d};c.Polygon.prototype.constructor=c.Polygon;c.Matrix=function(){this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0};c.Matrix.prototype.fromArray=function(c){this.a=c[0];this.b=c[1];
this.c=c[3];this.d=c[4];this.tx=c[2];this.ty=c[5]};c.Matrix.prototype.toArray=function(f){this.array||(this.array=new c.Float32Array(9));var b=this.array;return f?(b[0]=this.a,b[1]=this.b,b[2]=0,b[3]=this.c,b[4]=this.d,b[5]=0,b[6]=this.tx,b[7]=this.ty,b[8]=1):(b[0]=this.a,b[1]=this.c,b[2]=this.tx,b[3]=this.b,b[4]=this.d,b[5]=this.ty,b[6]=0,b[7]=0,b[8]=1),b};c.Matrix.prototype.apply=function(f,b){return b=b||new c.Point,b.x=this.a*f.x+this.b*f.y+this.tx,b.y=this.c*f.x+this.d*f.y+this.ty,b};c.Matrix.prototype.applyInverse=
function(f,b){b=b||new c.Point;var d=1/(this.a*this.d+this.c*-this.b);return b.x=this.d*d*f.x+-this.c*d*f.y+(this.ty*this.c-this.tx*this.d)*d,b.y=this.a*d*f.y+-this.b*d*f.x+(-this.ty*this.a+this.tx*this.b)*d,b};c.Matrix.prototype.translate=function(c,b){return this.tx+=c,this.ty+=b,this};c.Matrix.prototype.scale=function(c,b){return this.a*=c,this.d*=b,this.c*=c,this.b*=b,this.tx*=c,this.ty*=b,this};c.Matrix.prototype.rotate=function(c){var b=Math.cos(c);c=Math.sin(c);var d=this.a,e=this.c,g=this.tx;
return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=g*b-this.ty*c,this.ty=g*c+this.ty*b,this};c.Matrix.prototype.append=function(c){var b=this.a,d=this.b,e=this.c,g=this.d;return this.a=c.a*b+c.b*e,this.b=c.a*d+c.b*g,this.c=c.c*b+c.d*e,this.d=c.c*d+c.d*g,this.tx=c.tx*b+c.ty*e+this.tx,this.ty=c.tx*d+c.ty*g+this.ty,this};c.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this};c.identityMatrix=new c.Matrix;
c.DisplayObject=function(){this.position=new c.Point;this.scale=new c.Point(1,1);this.pivot=new c.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.renderable=this.buttonMode=!1;this.stage=this.parent=null;this.worldAlpha=1;this._interactive=!1;this.defaultCursor="pointer";this.worldTransform=new c.Matrix;this._sr=0;this._cr=1;this.filterArea=null;this._bounds=new c.Rectangle(0,0,1,1);this._mask=this._currentBounds=null;this._cacheIsDirty=this._cacheAsBitmap=!1};c.DisplayObject.prototype.constructor=
c.DisplayObject;Object.defineProperty(c.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(c){this._interactive=c;this.stage&&(this.stage.dirty=!0)}});Object.defineProperty(c.DisplayObject.prototype,"worldVisible",{get:function(){var c=this;do{if(!c.visible)return!1;c=c.parent}while(c);return!0}});Object.defineProperty(c.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(c){this._mask&&(this._mask.isMask=!1);(this._mask=c)&&(this._mask.isMask=
!0)}});Object.defineProperty(c.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(c){if(c){for(var b=[],d=0;d<c.length;d++)for(var e=c[d].passes,g=0;g<e.length;g++)b.push(e[g]);this._filterBlock={target:this,filterPasses:b}}this._filters=c}});Object.defineProperty(c.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(c){this._cacheAsBitmap!==c&&(c?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=
c)}});c.DisplayObject.prototype.updateTransform=function(){var f,b,d,e,g,h,l=this.parent.worldTransform,k=this.worldTransform;this.rotation%c.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),f=this._cr*this.scale.x,b=this._sr*this.scale.x,d=-this._sr*this.scale.y,e=this._cr*this.scale.y,g=this.position.x,h=this.position.y,(this.pivot.x||this.pivot.y)&&(g-=this.pivot.x*f+this.pivot.y*d,h-=this.pivot.x*b+this.pivot.y*
e),k.a=f*l.a+b*l.c,k.b=f*l.b+b*l.d,k.c=d*l.a+e*l.c,k.d=d*l.b+e*l.d,k.tx=g*l.a+h*l.c+l.tx,k.ty=g*l.b+h*l.d+l.ty):(f=this.scale.x,e=this.scale.y,g=this.position.x-this.pivot.x*f,h=this.position.y-this.pivot.y*e,k.a=l.a*f,k.b=l.b*e,k.c=l.c*f,k.d=l.d*e,k.tx=g*l.a+h*l.c+l.tx,k.ty=g*l.b+h*l.d+l.ty);this.worldAlpha=this.alpha*this.parent.worldAlpha};c.DisplayObject.prototype.getBounds=function(f){return c.EmptyRectangle};c.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(c.identityMatrix)};
c.DisplayObject.prototype.setStageReference=function(c){this.stage=c;this._interactive&&(this.stage.dirty=!0)};c.DisplayObject.prototype.generateTexture=function(f,b,d){var e=this.getLocalBounds();f=new c.RenderTexture(0|e.width,0|e.height,d,b,f);return c.DisplayObject._tempMatrix.tx=-e.x,c.DisplayObject._tempMatrix.ty=-e.y,f.render(this,c.DisplayObject._tempMatrix),f};c.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()};c.DisplayObject.prototype.toGlobal=function(c){return this.updateTransform(),
this.worldTransform.apply(c)};c.DisplayObject.prototype.toLocal=function(c,b){return b&&(c=b.toGlobal(c)),this.updateTransform(),this.worldTransform.applyInverse(c)};c.DisplayObject.prototype._renderCachedSprite=function(f){this._cachedSprite.worldAlpha=this.worldAlpha;f.gl?c.Sprite.prototype._renderWebGL.call(this._cachedSprite,f):c.Sprite.prototype._renderCanvas.call(this._cachedSprite,f)};c.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var f=this.getLocalBounds();
if(this._cachedSprite)this._cachedSprite.texture.resize(0|f.width,0|f.height);else{var b=new c.RenderTexture(0|f.width,0|f.height);this._cachedSprite=new c.Sprite(b);this._cachedSprite.worldTransform=this.worldTransform}b=this._filters;this._filters=null;this._cachedSprite.filters=b;c.DisplayObject._tempMatrix.tx=-f.x;c.DisplayObject._tempMatrix.ty=-f.y;this._cachedSprite.texture.render(this,c.DisplayObject._tempMatrix);this._cachedSprite.anchor.x=-(f.x/f.width);this._cachedSprite.anchor.y=-(f.y/
f.height);this._filters=b;this._cacheAsBitmap=!0};c.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)};c.DisplayObject.prototype._renderWebGL=function(c){};c.DisplayObject.prototype._renderCanvas=function(c){};c.DisplayObject._tempMatrix=new c.Matrix;Object.defineProperty(c.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(c){this.position.x=c}});Object.defineProperty(c.DisplayObject.prototype,
"y",{get:function(){return this.position.y},set:function(c){this.position.y=c}});c.DisplayObjectContainer=function(){c.DisplayObject.call(this);this.children=[]};c.DisplayObjectContainer.prototype=Object.create(c.DisplayObject.prototype);c.DisplayObjectContainer.prototype.constructor=c.DisplayObjectContainer;Object.defineProperty(c.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(c){var b=this.getLocalBounds().width;this.scale.x=
0!==b?c/(b/this.scale.x):1;this._width=c}});Object.defineProperty(c.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(c){var b=this.getLocalBounds().height;this.scale.y=0!==b?c/(b/this.scale.y):1;this._height=c}});c.DisplayObjectContainer.prototype.addChild=function(c){return this.addChildAt(c,this.children.length)};c.DisplayObjectContainer.prototype.addChildAt=function(c,b){if(0<=b&&b<=this.children.length)return c.parent&&c.parent.removeChild(c),
c.parent=this,this.children.splice(b,0,c),this.stage&&c.setStageReference(this.stage),c;throw Error(c+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length);};c.DisplayObjectContainer.prototype.swapChildren=function(c,b){if(c!==b){var d=this.getChildIndex(c),e=this.getChildIndex(b);if(0>d||0>e)throw Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[d]=b;this.children[e]=c}};c.DisplayObjectContainer.prototype.getChildIndex=
function(c){c=this.children.indexOf(c);if(-1===c)throw Error("The supplied DisplayObject must be a child of the caller");return c};c.DisplayObjectContainer.prototype.setChildIndex=function(c,b){if(0>b||b>=this.children.length)throw Error("The supplied index is out of bounds");var d=this.getChildIndex(c);this.children.splice(d,1);this.children.splice(b,0,c)};c.DisplayObjectContainer.prototype.getChildAt=function(c){if(0>c||c>=this.children.length)throw Error("getChildAt: Supplied index "+c+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");
return this.children[c]};c.DisplayObjectContainer.prototype.removeChild=function(c){c=this.children.indexOf(c);if(-1!==c)return this.removeChildAt(c)};c.DisplayObjectContainer.prototype.removeChildAt=function(c){var b=this.getChildAt(c);return this.stage&&b.removeStageReference(),b.parent=void 0,this.children.splice(c,1),b};c.DisplayObjectContainer.prototype.removeChildren=function(c,b){var d=c||0,e="number"==typeof b?b:this.children.length,g=e-d;if(0<g&&e>=g){d=this.children.splice(d,g);for(e=0;e<
d.length;e++)g=d[e],this.stage&&g.removeStageReference(),g.parent=void 0;return d}if(0===g&&0===this.children.length)return[];throw Error("removeChildren: Range Error, numeric values are outside the acceptable range");};c.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(c.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var f=0,b=this.children.length;b>f;f++)this.children[f].updateTransform()};c.DisplayObjectContainer.prototype.getBounds=function(){if(0===
this.children.length)return c.EmptyRectangle;for(var f,b,d,e=1/0,g=1/0,h=-1/0,l=-1/0,k=!1,m=0,n=this.children.length;n>m;m++)this.children[m].visible&&(k=!0,f=this.children[m].getBounds(),e=e<f.x?e:f.x,g=g<f.y?g:f.y,b=f.width+f.x,d=f.height+f.y,h=h>b?h:b,l=l>d?l:d);if(!k)return c.EmptyRectangle;f=this._bounds;return f.x=e,f.y=g,f.width=h-e,f.height=l-g,f};c.DisplayObjectContainer.prototype.getLocalBounds=function(){var f=this.worldTransform;this.worldTransform=c.identityMatrix;for(var b=0,d=this.children.length;d>
b;b++)this.children[b].updateTransform();b=this.getBounds();return this.worldTransform=f,b};c.DisplayObjectContainer.prototype.setStageReference=function(c){this.stage=c;this._interactive&&(this.stage.dirty=!0);for(var b=0,d=this.children.length;d>b;b++)this.children[b].setStageReference(c)};c.DisplayObjectContainer.prototype.removeStageReference=function(){for(var c=0,b=this.children.length;b>c;c++)this.children[c].removeStageReference();this._interactive&&(this.stage.dirty=!0);this.stage=null};
c.DisplayObjectContainer.prototype._renderWebGL=function(c){if(this.visible&&!(0>=this.alpha)){if(this._cacheAsBitmap)return void this._renderCachedSprite(c);var b,d;if(this._mask||this._filters){this._filters&&(c.spriteBatch.flush(),c.filterManager.pushFilter(this._filterBlock));this._mask&&(c.spriteBatch.stop(),c.maskManager.pushMask(this.mask,c),c.spriteBatch.start());b=0;for(d=this.children.length;d>b;b++)this.children[b]._renderWebGL(c);c.spriteBatch.stop();this._mask&&c.maskManager.popMask(this._mask,
c);this._filters&&c.filterManager.popFilter();c.spriteBatch.start()}else for(b=0,d=this.children.length;d>b;b++)this.children[b]._renderWebGL(c)}};c.DisplayObjectContainer.prototype._renderCanvas=function(c){if(!1!==this.visible&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(c);this._mask&&c.maskManager.pushMask(this._mask,c);for(var b=0,d=this.children.length;d>b;b++)this.children[b]._renderCanvas(c);this._mask&&c.maskManager.popMask(c)}};c.Sprite=function(f){c.DisplayObjectContainer.call(this);
this.anchor=new c.Point;this.texture=f;this._height=this._width=0;this.tint=16777215;this.blendMode=c.blendModes.NORMAL;this.shader=null;f.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.on("update",this.onTextureUpdateBind));this.renderable=!0};c.Sprite.prototype=Object.create(c.DisplayObjectContainer.prototype);c.Sprite.prototype.constructor=c.Sprite;Object.defineProperty(c.Sprite.prototype,"width",{get:function(){return this.scale.x*
this.texture.frame.width},set:function(c){this.scale.x=c/this.texture.frame.width;this._width=c}});Object.defineProperty(c.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(c){this.scale.y=c/this.texture.frame.height;this._height=c}});c.Sprite.prototype.setTexture=function(c){this.texture=c;this.cachedTint=16777215};c.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=
this._height/this.texture.frame.height)};c.Sprite.prototype.getBounds=function(c){var b=this.texture.frame.width,d=this.texture.frame.height,e=b*(1-this.anchor.x),g=b*-this.anchor.x,h=d*(1-this.anchor.y),l=d*-this.anchor.y;c=c||this.worldTransform;var k=c.a,m=c.c,n=c.b,p=c.d,q=c.tx,r=c.ty;c=k*g+n*l+q;var d=p*l+m*g+r,b=k*e+n*l+q,l=p*l+m*e+r,t=k*e+n*h+q,e=p*h+m*e+r,k=k*g+n*h+q,g=p*h+m*g+r,h=-1/0,m=-1/0,p=1/0,n=1/0,p=p>c?c:p,p=p>b?b:p,p=p>t?t:p,p=p>k?k:p,n=n>d?d:n,n=n>l?l:n,n=n>e?e:n,n=n>g?g:n,h=c>h?
c:h,h=b>h?b:h,h=t>h?t:h,m=d>m?d:m,m=l>m?l:m,m=e>m?e:m;c=this._bounds;return c.x=p,c.width=(k>h?k:h)-p,c.y=n,c.height=(g>m?g:m)-n,this._currentBounds=c,c};c.Sprite.prototype._renderWebGL=function(c){if(this.visible&&!(0>=this.alpha)){var b,d;if(this._mask||this._filters){var e=c.spriteBatch;this._filters&&(e.flush(),c.filterManager.pushFilter(this._filterBlock));this._mask&&(e.stop(),c.maskManager.pushMask(this.mask,c),e.start());e.render(this);b=0;for(d=this.children.length;d>b;b++)this.children[b]._renderWebGL(c);
e.stop();this._mask&&c.maskManager.popMask(this._mask,c);this._filters&&c.filterManager.popFilter();e.start()}else for(c.spriteBatch.render(this),b=0,d=this.children.length;d>b;b++)this.children[b]._renderWebGL(c)}};c.Sprite.prototype._renderCanvas=function(f){if(!(!1===this.visible||0===this.alpha||0>=this.texture.crop.width||0>=this.texture.crop.height)){if(this.blendMode!==f.currentBlendMode&&(f.currentBlendMode=this.blendMode,f.context.globalCompositeOperation=c.blendModesCanvas[f.currentBlendMode]),
this._mask&&f.maskManager.pushMask(this._mask,f),this.texture.valid){var b=this.texture.baseTexture.resolution/f.resolution;f.context.globalAlpha=this.worldAlpha;f.roundPixels?f.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*f.resolution|0,this.worldTransform.ty*f.resolution|0):f.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*f.resolution,
this.worldTransform.ty*f.resolution);f.smoothProperty&&f.scaleMode!==this.texture.baseTexture.scaleMode&&(f.scaleMode=this.texture.baseTexture.scaleMode,f.context[f.smoothProperty]=f.scaleMode===c.scaleModes.LINEAR);var d=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,e=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;16777215!==this.tint?(this.cachedTint!==this.tint&&
(this.cachedTint=this.tint,this.tintedTexture=c.CanvasTinter.getTintedTexture(this,this.tint)),f.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,d/b,e/b,this.texture.crop.width/b,this.texture.crop.height/b)):f.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,d/b,e/b,this.texture.crop.width/b,this.texture.crop.height/b)}b=0;for(d=this.children.length;d>b;b++)this.children[b]._renderCanvas(f);
this._mask&&f.maskManager.popMask(f)}};c.Sprite.fromFrame=function(f){var b=c.TextureCache[f];if(!b)throw Error('The frameId "'+f+'" does not exist in the texture cache'+this);return new c.Sprite(b)};c.Sprite.fromImage=function(f,b,d){f=c.Texture.fromImage(f,b,d);return new c.Sprite(f)};c.SpriteBatch=function(f){c.DisplayObjectContainer.call(this);this.textureThing=f;this.ready=!1};c.SpriteBatch.prototype=Object.create(c.DisplayObjectContainer.prototype);c.SpriteBatch.prototype.constructor=c.SpriteBatch;
c.SpriteBatch.prototype.initWebGL=function(f){this.fastSpriteBatch=new c.WebGLFastSpriteBatch(f);this.ready=!0};c.SpriteBatch.prototype.updateTransform=function(){c.DisplayObject.prototype.updateTransform.call(this)};c.SpriteBatch.prototype._renderWebGL=function(c){!this.visible||0>=this.alpha||!this.children.length||(this.ready||this.initWebGL(c.gl),c.spriteBatch.stop(),c.shaderManager.setShader(c.shaderManager.fastShader),this.fastSpriteBatch.begin(this,c),this.fastSpriteBatch.render(this),c.spriteBatch.start())};
c.SpriteBatch.prototype._renderCanvas=function(f){if(this.visible&&!(0>=this.alpha)&&this.children.length){var b=f.context;b.globalAlpha=this.worldAlpha;c.DisplayObject.prototype.updateTransform.call(this);for(var d=this.worldTransform,e=!0,g=0;g<this.children.length;g++){var h=this.children[g];if(h.visible){var l=h.texture,k=l.frame;if(b.globalAlpha=this.worldAlpha*h.alpha,0===h.rotation%(2*Math.PI))e&&(b.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),e=!1),b.drawImage(l.baseTexture.source,k.x,k.y,k.width,
k.height,h.anchor.x*-k.width*h.scale.x+h.position.x+.5|0,h.anchor.y*-k.height*h.scale.y+h.position.y+.5|0,k.width*h.scale.x,k.height*h.scale.y);else{e||(e=!0);c.DisplayObject.prototype.updateTransform.call(h);var m=h.worldTransform;f.roundPixels?b.setTransform(m.a,m.b,m.c,m.d,0|m.tx,0|m.ty):b.setTransform(m.a,m.b,m.c,m.d,m.tx,m.ty);b.drawImage(l.baseTexture.source,k.x,k.y,k.width,k.height,h.anchor.x*-k.width+.5|0,h.anchor.y*-k.height+.5|0,k.width,k.height)}}}}};c.FilterBlock=function(){this.renderable=
this.visible=!0};c.FilterBlock.prototype.constructor=c.FilterBlock;c.Text=function(f,b){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=1;c.Sprite.call(this,c.Texture.fromCanvas(this.canvas));this.setText(f);this.setStyle(b)};c.Text.prototype=Object.create(c.Sprite.prototype);c.Text.prototype.constructor=c.Text;Object.defineProperty(c.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},
set:function(c){this.scale.x=c/this.texture.frame.width;this._width=c}});Object.defineProperty(c.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(c){this.scale.y=c/this.texture.frame.height;this._height=c}});c.Text.prototype.setStyle=function(c){c=c||{};c.font=c.font||"bold 20pt Arial";c.fill=c.fill||"black";c.align=c.align||"left";c.stroke=c.stroke||"black";c.strokeThickness=c.strokeThickness||0;c.wordWrap=
c.wordWrap||!1;c.wordWrapWidth=c.wordWrapWidth||100;c.dropShadow=c.dropShadow||!1;c.dropShadowAngle=c.dropShadowAngle||Math.PI/6;c.dropShadowDistance=c.dropShadowDistance||4;c.dropShadowColor=c.dropShadowColor||"black";this.style=c;this.dirty=!0};c.Text.prototype.setText=function(c){this.text=c.toString()||" ";this.dirty=!0};c.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution;this.context.font=this.style.font;var c=this.text;this.style.wordWrap&&(c=this.wordWrap(this.text));
for(var c=c.split(/(?:\r\n|\r|\n)/),b=[],d=0,e=this.determineFontProperties(this.style.font),g=0;g<c.length;g++){var h=this.context.measureText(c[g]).width;b[g]=h;d=Math.max(d,h)}g=d+this.style.strokeThickness;this.style.dropShadow&&(g+=this.style.dropShadowDistance);this.canvas.width=(g+this.context.lineWidth)*this.resolution;h=e.fontSize+this.style.strokeThickness;g=h*c.length;this.style.dropShadow&&(g+=this.style.dropShadowDistance);this.canvas.height=g*this.resolution;this.context.scale(this.resolution,
this.resolution);navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.lineWidth=this.style.strokeThickness;this.context.textBaseline="alphabetic";this.context.lineJoin="round";var l,k;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;for(var m=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,n=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance,
g=0;g<c.length;g++)l=this.style.strokeThickness/2,k=this.style.strokeThickness/2+g*h+e.ascent,"right"===this.style.align?l+=d-b[g]:"center"===this.style.align&&(l+=(d-b[g])/2),this.style.fill&&this.context.fillText(c[g],l+m,k+n)}this.context.fillStyle=this.style.fill;for(g=0;g<c.length;g++)l=this.style.strokeThickness/2,k=this.style.strokeThickness/2+g*h+e.ascent,"right"===this.style.align?l+=d-b[g]:"center"===this.style.align&&(l+=(d-b[g])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(c[g],
l,k),this.style.fill&&this.context.fillText(c[g],l,k);this.updateTexture()};c.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.crop.width=this.texture.frame.width=this.canvas.width;this.texture.crop.height=this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;this.texture.baseTexture.dirty()};c.Text.prototype._renderWebGL=function(f){this.dirty&&
(this.resolution=f.resolution,this.updateText(),this.dirty=!1);c.Sprite.prototype._renderWebGL.call(this,f)};c.Text.prototype._renderCanvas=function(f){this.dirty&&(this.resolution=f.resolution,this.updateText(),this.dirty=!1);c.Sprite.prototype._renderCanvas.call(this,f)};c.Text.prototype.determineFontProperties=function(f){var b=c.Text.fontPropertiesCache[f];if(!b){var b={},d=c.Text.fontPropertiesCanvas,e=c.Text.fontPropertiesContext;e.font=f;var g=Math.ceil(e.measureText("|Mq").width),h=Math.ceil(e.measureText("M").width),
l=2*h,h=1.4*h|0;d.width=g;d.height=l;e.fillStyle="#f00";e.fillRect(0,0,g,l);e.font=f;e.textBaseline="alphabetic";e.fillStyle="#000";e.fillText("|Mq",0,h);for(var k,d=e.getImageData(0,0,g,l).data,e=d.length,m=4*g,n=0,p=!1,g=0;h>g;g++){for(k=0;m>k;k+=4)if(255!==d[n+k]){p=!0;break}if(p)break;n+=m}b.ascent=h-g;n=e-m;p=!1;for(g=l;g>h;g--){for(k=0;m>k;k+=4)if(255!==d[n+k]){p=!0;break}if(p)break;n-=m}b.descent=g-h;b.fontSize=b.ascent+b.descent;c.Text.fontPropertiesCache[f]=b}return b};c.Text.prototype.wordWrap=
function(c){var b="";c=c.split("\n");for(var d=0;d<c.length;d++){for(var e=this.style.wordWrapWidth,g=c[d].split(" "),h=0;h<g.length;h++){var l=this.context.measureText(g[h]).width,k=l+this.context.measureText(" ").width;0===h||k>e?(0<h&&(b+="\n"),b+=g[h],e=this.style.wordWrapWidth-l):(e-=k,b+=" "+g[h])}d<c.length-1&&(b+="\n")}return b};c.Text.prototype.destroy=function(c){this.canvas=this.context=null;this.texture.destroy(void 0===c?!0:c)};c.Text.fontPropertiesCache={};c.Text.fontPropertiesCanvas=
document.createElement("canvas");c.Text.fontPropertiesContext=c.Text.fontPropertiesCanvas.getContext("2d");c.BitmapText=function(f,b){c.DisplayObjectContainer.call(this);this.textHeight=this.textWidth=0;this._pool=[];this.setText(f);this.setStyle(b);this.updateText();this.dirty=!1};c.BitmapText.prototype=Object.create(c.DisplayObjectContainer.prototype);c.BitmapText.prototype.constructor=c.BitmapText;c.BitmapText.prototype.setText=function(c){this.text=c||" ";this.dirty=!0};c.BitmapText.prototype.setStyle=
function(f){f=f||{};f.align=f.align||"left";this.style=f;var b=f.font.split(" ");this.fontName=b[b.length-1];this.fontSize=2<=b.length?parseInt(b[b.length-2],10):c.BitmapText.fonts[this.fontName].size;this.dirty=!0;this.tint=f.tint};c.BitmapText.prototype.updateText=function(){for(var f=c.BitmapText.fonts[this.fontName],b=new c.Point,d=null,e=[],g=0,h=[],l=0,k=this.fontSize/f.size,m=0;m<this.text.length;m++){var n=this.text.charCodeAt(m);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(m)))h.push(b.x),g=
Math.max(g,b.x),l++,b.x=0,b.y+=f.lineHeight,d=null;else{var p=f.chars[n];p&&(d&&p.kerning[d]&&(b.x+=p.kerning[d]),e.push({texture:p.texture,line:l,charCode:n,position:new c.Point(b.x+p.xOffset,b.y+p.yOffset)}),b.x+=p.xAdvance,d=n)}}h.push(b.x);g=Math.max(g,b.x);d=[];for(m=0;l>=m;m++)n=0,"right"===this.style.align?n=g-h[m]:"center"===this.style.align&&(n=(g-h[m])/2),d.push(n);l=this.children.length;h=e.length;n=this.tint||16777215;for(m=0;h>m;m++)(p=l>m?this.children[m]:this._pool.pop())?p.setTexture(e[m].texture):
p=new c.Sprite(e[m].texture),p.position.x=(e[m].position.x+d[e[m].line])*k,p.position.y=e[m].position.y*k,p.scale.x=p.scale.y=k,p.tint=n,p.parent||this.addChild(p);for(;this.children.length>h;)e=this.getChildAt(this.children.length-1),this._pool.push(e),this.removeChild(e);this.textWidth=g*k;this.textHeight=(b.y+f.lineHeight)*k};c.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1);c.DisplayObjectContainer.prototype.updateTransform.call(this)};c.BitmapText.fonts=
{};c.Stage=function(f){c.DisplayObjectContainer.call(this);this.worldTransform=new c.Matrix;this.interactive=!0;this.interactionManager=new c.InteractionManager(this);this.dirty=!0;this.stage=this;this.stage.hitArea=new c.Rectangle(0,0,1E5,1E5);this.setBackgroundColor(f)};c.Stage.prototype=Object.create(c.DisplayObjectContainer.prototype);c.Stage.prototype.constructor=c.Stage;c.Stage.prototype.setInteractionDelegate=function(c){this.interactionManager.setTargetDomElement(c)};c.Stage.prototype.updateTransform=
function(){this.worldAlpha=1;for(var c=0,b=this.children.length;b>c;c++)this.children[c].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0);this.interactive&&this.interactionManager.update()};c.Stage.prototype.setBackgroundColor=function(f){this.backgroundColor=f||0;this.backgroundColorSplit=c.hex2rgb(this.backgroundColor);f=this.backgroundColor.toString(16);f="000000".substr(0,6-f.length)+f;this.backgroundColorString="#"+f};c.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};
(function(c){for(var b=0,d=["ms","moz","webkit","o"],e=0;e<d.length&&!c.requestAnimationFrame;++e)c.requestAnimationFrame=c[d[e]+"RequestAnimationFrame"],c.cancelAnimationFrame=c[d[e]+"CancelAnimationFrame"]||c[d[e]+"CancelRequestAnimationFrame"];c.requestAnimationFrame||(c.requestAnimationFrame=function(d){var e=(new Date).getTime(),l=Math.max(0,16-(e-b)),k=c.setTimeout(function(){d(e+l)},l);return b=e+l,k});c.cancelAnimationFrame||(c.cancelAnimationFrame=function(b){clearTimeout(b)});c.requestAnimFrame=
c.requestAnimationFrame})(this);c.hex2rgb=function(c){return[(c>>16&255)/255,(c>>8&255)/255,(255&c)/255]};c.rgb2hex=function(c){return(255*c[0]<<16)+(255*c[1]<<8)+255*c[2]};"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(c){function b(){for(var e=arguments.length,l=Array(e);e--;)l[e]=arguments[e];return l=g.concat(l),d.apply(this instanceof b?this:c,l)}var d=this,e=arguments.length-1,g=[];if(0<e)for(g.length=e;e--;)g[e]=arguments[e+1];if("function"!=
typeof d)throw new TypeError;return b.prototype=function l(b){return b&&(l.prototype=b),this instanceof l?void 0:new l}(d.prototype),b}}());c.AjaxRequest=function(){var c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var b=0;b<c.length;b++)try{return new window.ActiveXObject(c[b])}catch(d){}};c.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var c=document.createElement("canvas");
c.width=1;c.height=1;c=c.getContext("2d");return c.fillStyle="#000",c.fillRect(0,0,1,1),c.globalCompositeOperation="multiply",c.fillStyle="#fff",c.fillRect(0,0,1,1),0===c.getImageData(0,0,1,1).data[0]};c.getNextPowerOfTwo=function(c){if(0<c&&0===(c&c-1))return c;for(var b=1;c>b;)b<<=1;return b};c.EventTarget={call:function(f){f&&(f=f.prototype||f,c.EventTarget.mixin(f))},mixin:function(f){f.listeners=function(b){return this._listeners=this._listeners||{},this._listeners[b]?this._listeners[b].slice():
[]};f.emit=f.dispatchEvent=function(b,d){if(this._listeners=this._listeners||{},"object"==typeof b&&(d=b,b=b.type),d&&!0===d.__isEventObject||(d=new c.Event(this,b,d)),this._listeners&&this._listeners[b]){var e,g=this._listeners[b],h=g.length,f=g[0];for(e=0;h>e;f=g[++e])if(f.call(this,d),d.stoppedImmediate)return this;if(d.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,b,d),this};f.on=f.addEventListener=function(b,d){return this._listeners=this._listeners||
{},(this._listeners[b]=this._listeners[b]||[]).push(d),this};f.once=function(b,d){function c(){d.apply(g.off(b,c),arguments)}this._listeners=this._listeners||{};var g=this;return c._originalHandler=d,this.on(b,c)};f.off=f.removeEventListener=function(b,d){if(this._listeners=this._listeners||{},!this._listeners[b])return this;for(var c=this._listeners[b],g=d?c.length:0;0<g--;)c[g]!==d&&c[g]._originalHandler!==d||c.splice(g,1);return 0===c.length&&delete this._listeners[b],this};f.removeAllListeners=
function(b){return this._listeners=this._listeners||{},this._listeners[b]?(delete this._listeners[b],this):this}}};c.Event=function(c,b,d){this.__isEventObject=!0;this.stoppedImmediate=this.stopped=!1;this.target=c;this.type=b;this.content=this.data=d;this.timeStamp=Date.now()};c.Event.prototype.stopPropagation=function(){this.stopped=!0};c.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0};c.PolyK={};c.PolyK.Triangulate=function(f){var b=!0,d=f.length>>1;if(3>d)return[];
for(var e=[],g=[],h=0;d>h;h++)g.push(h);for(var h=0,l=d;3<l;){var k=g[(h+0)%l],m=g[(h+1)%l],n=g[(h+2)%l],p=f[2*k],q=f[2*k+1],r=f[2*m],t=f[2*m+1],w=f[2*n],v=f[2*n+1],u=!1;if(c.PolyK._convex(p,q,r,t,w,v,b))for(var u=!0,y=0;l>y;y++){var C=g[y];if(C!==k&&C!==m&&C!==n&&c.PolyK._PointInTriangle(f[2*C],f[2*C+1],p,q,r,t,w,v)){u=!1;break}}if(u)e.push(k,m,n),g.splice((h+1)%l,1),l--,h=0;else if(h++>3*l){if(!b)return window.console.log("PIXI Warning: shape too complex to fill"),[];e=[];g=[];for(h=0;d>h;h++)g.push(h);
h=0;l=d;b=!1}}return e.push(g[0],g[1],g[2]),e};c.PolyK._PointInTriangle=function(c,b,d,e,g,h,l,k){l-=d;k-=e;g-=d;h-=e;c-=d;d=b-e;b=l*l+k*k;e=l*g+k*h;l=l*c+k*d;k=g*g+h*h;g=g*c+h*d;h=1/(b*k-e*e);k=(k*l-e*g)*h;l=(b*g-e*l)*h;return 0<=k&&0<=l&&1>k+l};c.PolyK._convex=function(c,b,d,e,g,h,l){return 0<=(b-e)*(g-d)+(d-c)*(h-e)===l};c.initDefaultShaders=function(){};c.CompileVertexShader=function(f,b){return c._CompileShader(f,b,f.VERTEX_SHADER)};c.CompileFragmentShader=function(f,b){return c._CompileShader(f,
b,f.FRAGMENT_SHADER)};c._CompileShader=function(c,b,d){b=b.join("\n");d=c.createShader(d);return c.shaderSource(d,b),c.compileShader(d),c.getShaderParameter(d,c.COMPILE_STATUS)?d:(window.console.log(c.getShaderInfoLog(d)),null)};c.compileProgram=function(f,b,d){d=c.CompileFragmentShader(f,d);b=c.CompileVertexShader(f,b);var e=f.createProgram();return f.attachShader(e,b),f.attachShader(e,d),f.linkProgram(e),f.getProgramParameter(e,f.LINK_STATUS)||window.console.log("Could not initialise shaders"),
e};c.PixiShader=function(f){this._UID=c._UID++;this.gl=f;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.dirty=this.firstRun=!0;this.attributes=[];this.init()};c.PixiShader.prototype.constructor=c.PixiShader;c.PixiShader.prototype.init=function(){var f=this.gl,b=c.compileProgram(f,this.vertexSrc||
c.PixiShader.defaultVertexSrc,this.fragmentSrc);f.useProgram(b);this.uSampler=f.getUniformLocation(b,"uSampler");this.projectionVector=f.getUniformLocation(b,"projectionVector");this.offsetVector=f.getUniformLocation(b,"offsetVector");this.dimensions=f.getUniformLocation(b,"dimensions");this.aVertexPosition=f.getAttribLocation(b,"aVertexPosition");this.aTextureCoord=f.getAttribLocation(b,"aTextureCoord");this.colorAttribute=f.getAttribLocation(b,"aColor");-1===this.colorAttribute&&(this.colorAttribute=
2);this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var d in this.uniforms)this.uniforms[d].uniformLocation=f.getUniformLocation(b,d);this.initUniforms();this.program=b};c.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var c,b=this.gl,d;for(d in this.uniforms){c=this.uniforms[d];var e=c.type;"sampler2D"===e?(c._init=!1,null!==c.value&&this.initSampler2D(c)):"mat2"===e||"mat3"===e||"mat4"===e?(c.glMatrix=!0,c.glValueLength=1,"mat2"===e?c.glFunc=b.uniformMatrix2fv:
"mat3"===e?c.glFunc=b.uniformMatrix3fv:"mat4"===e&&(c.glFunc=b.uniformMatrix4fv)):(c.glFunc=b["uniform"+e],c.glValueLength="2f"===e||"2i"===e?2:"3f"===e||"3i"===e?3:"4f"===e||"4i"===e?4:1)}};c.PixiShader.prototype.initSampler2D=function(c){if(c.value&&c.value.baseTexture&&c.value.baseTexture.hasLoaded){var b=this.gl;if(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,c.value.baseTexture._glTextures[b.id]),c.textureData){var d=c.textureData,e=d.magFilter?d.magFilter:b.LINEAR,
g=d.minFilter?d.minFilter:b.LINEAR,h=d.wrapS?d.wrapS:b.CLAMP_TO_EDGE,l=d.wrapT?d.wrapT:b.CLAMP_TO_EDGE,k=d.luminance?b.LUMINANCE:b.RGBA;(d.repeat&&(h=b.REPEAT,l=b.REPEAT),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!!d.flipY),d.width)?b.texImage2D(b.TEXTURE_2D,0,k,d.width?d.width:512,d.height?d.height:2,d.border?d.border:0,k,b.UNSIGNED_BYTE,null):b.texImage2D(b.TEXTURE_2D,0,k,b.RGBA,b.UNSIGNED_BYTE,c.value.baseTexture.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,e);b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,g);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,h);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,l)}b.uniform1i(c.uniformLocation,this.textureCount);c._init=!0;this.textureCount++}};c.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var f,b=this.gl,d;for(d in this.uniforms)f=this.uniforms[d],1===f.glValueLength?!0===f.glMatrix?f.glFunc.call(b,f.uniformLocation,f.transpose,f.value):f.glFunc.call(b,f.uniformLocation,f.value):2===f.glValueLength?f.glFunc.call(b,
f.uniformLocation,f.value.x,f.value.y):3===f.glValueLength?f.glFunc.call(b,f.uniformLocation,f.value.x,f.value.y,f.value.z):4===f.glValueLength?f.glFunc.call(b,f.uniformLocation,f.value.x,f.value.y,f.value.z,f.value.w):"sampler2D"===f.type&&(f._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),f.value.baseTexture._dirty[b.id]?c.defaultRenderer.updateTexture(f.value.baseTexture):b.bindTexture(b.TEXTURE_2D,f.value.baseTexture._glTextures[b.id]),b.uniform1i(f.uniformLocation,this.textureCount),this.textureCount++):
this.initSampler2D(f))};c.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};c.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"];c.PixiFastShader=function(f){this._UID=c._UID++;this.gl=f;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;",
"attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);",
"   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};c.PixiFastShader.prototype.constructor=c.PixiFastShader;c.PixiFastShader.prototype.init=function(){var f=this.gl,b=c.compileProgram(f,this.vertexSrc,this.fragmentSrc);f.useProgram(b);this.uSampler=f.getUniformLocation(b,"uSampler");this.projectionVector=f.getUniformLocation(b,
"projectionVector");this.offsetVector=f.getUniformLocation(b,"offsetVector");this.dimensions=f.getUniformLocation(b,"dimensions");this.uMatrix=f.getUniformLocation(b,"uMatrix");this.aVertexPosition=f.getAttribLocation(b,"aVertexPosition");this.aPositionCoord=f.getAttribLocation(b,"aPositionCoord");this.aScale=f.getAttribLocation(b,"aScale");this.aRotation=f.getAttribLocation(b,"aRotation");this.aTextureCoord=f.getAttribLocation(b,"aTextureCoord");this.colorAttribute=f.getAttribLocation(b,"aColor");
-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute];this.program=b};c.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};c.StripShader=function(f){this._UID=c._UID++;this.gl=f;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;",
"void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","}"];this.init()};c.StripShader.prototype.constructor=c.StripShader;c.StripShader.prototype.init=function(){var f=this.gl,b=c.compileProgram(f,this.vertexSrc,this.fragmentSrc);f.useProgram(b);this.uSampler=f.getUniformLocation(b,"uSampler");this.projectionVector=f.getUniformLocation(b,"projectionVector");this.offsetVector=f.getUniformLocation(b,"offsetVector");this.colorAttribute=f.getAttribLocation(b,"aColor");this.aVertexPosition=f.getAttribLocation(b,"aVertexPosition");
this.aTextureCoord=f.getAttribLocation(b,"aTextureCoord");this.attributes=[this.aVertexPosition,this.aTextureCoord];this.translationMatrix=f.getUniformLocation(b,"translationMatrix");this.alpha=f.getUniformLocation(b,"alpha");this.program=b};c.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};c.PrimitiveShader=function(f){this._UID=c._UID++;this.gl=f;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;",
"void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);",
"   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};c.PrimitiveShader.prototype.constructor=c.PrimitiveShader;c.PrimitiveShader.prototype.init=function(){var f=this.gl,b=c.compileProgram(f,this.vertexSrc,this.fragmentSrc);f.useProgram(b);this.projectionVector=f.getUniformLocation(b,"projectionVector");this.offsetVector=f.getUniformLocation(b,"offsetVector");this.tintColor=f.getUniformLocation(b,"tint");this.aVertexPosition=f.getAttribLocation(b,"aVertexPosition");this.colorAttribute=
f.getAttribLocation(b,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=f.getUniformLocation(b,"translationMatrix");this.alpha=f.getUniformLocation(b,"alpha");this.program=b};c.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};c.ComplexPrimitiveShader=function(f){this._UID=c._UID++;this.gl=f;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {",
"   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);",
"}"];this.init()};c.ComplexPrimitiveShader.prototype.constructor=c.ComplexPrimitiveShader;c.ComplexPrimitiveShader.prototype.init=function(){var f=this.gl,b=c.compileProgram(f,this.vertexSrc,this.fragmentSrc);f.useProgram(b);this.projectionVector=f.getUniformLocation(b,"projectionVector");this.offsetVector=f.getUniformLocation(b,"offsetVector");this.tintColor=f.getUniformLocation(b,"tint");this.color=f.getUniformLocation(b,"color");this.aVertexPosition=f.getAttribLocation(b,"aVertexPosition");this.attributes=
[this.aVertexPosition,this.colorAttribute];this.translationMatrix=f.getUniformLocation(b,"translationMatrix");this.alpha=f.getUniformLocation(b,"alpha");this.program=b};c.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};c.WebGLGraphics=function(){};c.WebGLGraphics.renderGraphics=function(f,b){var d,e=b.gl,g=b.projection,h=b.offset,l=b.shaderManager.primitiveShader;f.dirty&&c.WebGLGraphics.updateGraphics(f,e);for(var k=
f._webGL[e.id],m=0;m<k.data.length;m++)1===k.data[m].mode?(d=k.data[m],b.stencilManager.pushStencil(f,d,b),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(d.indices.length-4)),b.stencilManager.popStencil(f,d,b)):(d=k.data[m],b.shaderManager.setShader(l),l=b.shaderManager.primitiveShader,e.uniformMatrix3fv(l.translationMatrix,!1,f.worldTransform.toArray(!0)),e.uniform2f(l.projectionVector,g.x,-g.y),e.uniform2f(l.offsetVector,-h.x,-h.y),e.uniform3fv(l.tintColor,c.hex2rgb(f.tint)),e.uniform1f(l.alpha,
f.worldAlpha),e.bindBuffer(e.ARRAY_BUFFER,d.buffer),e.vertexAttribPointer(l.aVertexPosition,2,e.FLOAT,!1,24,0),e.vertexAttribPointer(l.colorAttribute,4,e.FLOAT,!1,24,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,d.indexBuffer),e.drawElements(e.TRIANGLE_STRIP,d.indices.length,e.UNSIGNED_SHORT,0))};c.WebGLGraphics.updateGraphics=function(f,b){var d=f._webGL[b.id];d||(d=f._webGL[b.id]={lastIndex:0,data:[],gl:b});f.dirty=!1;var e;if(f.clearDirty){f.clearDirty=!1;for(e=0;e<d.data.length;e++){var g=d.data[e];
g.reset();c.WebGLGraphics.graphicsDataPool.push(g)}d.data=[];d.lastIndex=0}var h;for(e=d.lastIndex;e<f.graphicsData.length;e++)g=f.graphicsData[e],g.type===c.Graphics.POLY?(g.points=g.shape.points.slice(),g.shape.closed&&g.points[0]!==g.points[g.points.length-2]&&g.points[1]!==g.points[g.points.length-1]&&g.points.push(g.points[0],g.points[1]),g.fill&&6<=g.points.length&&(10<g.points.length?(h=c.WebGLGraphics.switchMode(d,1),c.WebGLGraphics.buildComplexPoly(g,h)):(h=c.WebGLGraphics.switchMode(d,0),
c.WebGLGraphics.buildPoly(g,h))),0<g.lineWidth&&(h=c.WebGLGraphics.switchMode(d,0),c.WebGLGraphics.buildLine(g,h))):(h=c.WebGLGraphics.switchMode(d,0),g.type===c.Graphics.RECT?c.WebGLGraphics.buildRectangle(g,h):g.type===c.Graphics.CIRC||g.type===c.Graphics.ELIP?c.WebGLGraphics.buildCircle(g,h):g.type===c.Graphics.RREC&&c.WebGLGraphics.buildRoundedRectangle(g,h)),d.lastIndex++;for(e=0;e<d.data.length;e++)h=d.data[e],h.dirty&&h.upload()};c.WebGLGraphics.switchMode=function(f,b){var d;return f.data.length?
(d=f.data[f.data.length-1],(d.mode!==b||1===b)&&(d=c.WebGLGraphics.graphicsDataPool.pop()||new c.WebGLGraphicsData(f.gl),d.mode=b,f.data.push(d))):(d=c.WebGLGraphics.graphicsDataPool.pop()||new c.WebGLGraphicsData(f.gl),d.mode=b,f.data.push(d)),d.dirty=!0,d};c.WebGLGraphics.buildRectangle=function(f,b){var d=f.shape,e=d.x,g=d.y,h=d.width,d=d.height;if(f.fill){var l=c.hex2rgb(f.fillColor),k=f.fillAlpha,m=l[0]*k,n=l[1]*k,l=l[2]*k,p=b.points,q=b.indices,r=p.length/6;p.push(e,g);p.push(m,n,l,k);p.push(e+
h,g);p.push(m,n,l,k);p.push(e,g+d);p.push(m,n,l,k);p.push(e+h,g+d);p.push(m,n,l,k);q.push(r,r,r+1,r+2,r+3,r+3)}f.lineWidth&&(k=f.points,f.points=[e,g,e+h,g,e+h,g+d,e,g+d,e,g],c.WebGLGraphics.buildLine(f,b),f.points=k)};c.WebGLGraphics.buildRoundedRectangle=function(f,b){var d=f.shape.points,e=d[0],g=d[1],h=d[2],l=d[3],k=d[4],d=[];if(d.push(e,g+k),d=d.concat(c.WebGLGraphics.quadraticBezierCurve(e,g+l-k,e,g+l,e+k,g+l)),d=d.concat(c.WebGLGraphics.quadraticBezierCurve(e+h-k,g+l,e+h,g+l,e+h,g+l-k)),d=
d.concat(c.WebGLGraphics.quadraticBezierCurve(e+h,g+k,e+h,g,e+h-k,g)),d=d.concat(c.WebGLGraphics.quadraticBezierCurve(e+k,g,e,g,e,g+k)),f.fill){for(var l=c.hex2rgb(f.fillColor),e=f.fillAlpha,g=l[0]*e,h=l[1]*e,l=l[2]*e,k=b.points,m=b.indices,n=k.length/6,p=c.PolyK.Triangulate(d),q=0,q=0;q<p.length;q+=3)m.push(p[q]+n),m.push(p[q]+n),m.push(p[q+1]+n),m.push(p[q+2]+n),m.push(p[q+2]+n);for(q=0;q<d.length;q++)k.push(d[q],d[++q],g,h,l,e)}f.lineWidth&&(e=f.points,f.points=d,c.WebGLGraphics.buildLine(f,b),
f.points=e)};c.WebGLGraphics.quadraticBezierCurve=function(c,b,d,e,g,h){for(var l,k,m,n,p=[],q=0,r=0;20>=r;r++)q=r/20,l=c+(d-c)*q,k=b+(e-b)*q,m=d+(g-d)*q,n=e+(h-e)*q,l+=(m-l)*q,k+=(n-k)*q,p.push(l,k);return p};c.WebGLGraphics.buildCircle=function(f,b){var d,e,g=f.shape,h=g.x,l=g.y;f.type===c.Graphics.CIRC?(d=g.radius,e=g.radius):(d=g.width,e=g.height);var g=2*Math.PI/40,k=0;if(f.fill){var k=c.hex2rgb(f.fillColor),m=f.fillAlpha,n=k[0]*m,p=k[1]*m,q=k[2]*m,r=b.points,t=b.indices,w=r.length/6;t.push(w);
for(k=0;41>k;k++)r.push(h,l,n,p,q,m),r.push(h+Math.sin(g*k)*d,l+Math.cos(g*k)*e,n,p,q,m),t.push(w++,w++);t.push(w-1)}if(f.lineWidth){m=f.points;f.points=[];for(k=0;41>k;k++)f.points.push(h+Math.sin(g*k)*d,l+Math.cos(g*k)*e);c.WebGLGraphics.buildLine(f,b);f.points=m}};c.WebGLGraphics.buildLine=function(f,b){var d=0,e=f.points;if(0!==e.length){if(f.lineWidth%2)for(d=0;d<e.length;d++)e[d]+=.5;var g=new c.Point(e[0],e[1]),h=new c.Point(e[e.length-2],e[e.length-1]);if(g.x===h.x&&g.y===h.y){e=e.slice();
e.pop();e.pop();var h=new c.Point(e[e.length-2],e[e.length-1]),l=h.x+.5*(g.x-h.x),g=h.y+.5*(g.y-h.y);e.unshift(l,g);e.push(l,g)}var k,m,n,p,q,r,t,w,v,u,y,C,x,B,E,z,G,J,K,l=b.points,g=b.indices,h=e.length/2,M=e.length,H=l.length/6,L=f.lineWidth/2,d=c.hex2rgb(f.lineColor),P=f.lineAlpha,D=d[0]*P,O=d[1]*P,N=d[2]*P;n=e[0];p=e[1];q=e[2];r=e[3];v=-(p-r);u=n-q;K=Math.sqrt(v*v+u*u);v=v/K*L;u=u/K*L;l.push(n-v,p-u,D,O,N,P);l.push(n+v,p+u,D,O,N,P);for(d=1;h-1>d;d++)n=e[2*(d-1)],p=e[2*(d-1)+1],q=e[2*d],r=e[2*
d+1],t=e[2*(d+1)],w=e[2*(d+1)+1],v=-(p-r),u=n-q,K=Math.sqrt(v*v+u*u),v/=K,u/=K,v*=L,u*=L,y=-(r-w),C=q-t,K=Math.sqrt(y*y+C*C),y/=K,C/=K,y*=L,C*=L,E=-u+p-(-u+r),z=-v+q-(-v+n),n=(-v+n)*(-u+r)-(-v+q)*(-u+p),p=-C+w-(-C+r),G=-y+q-(-y+t),t=(-y+t)*(-C+r)-(-y+q)*(-C+w),w=E*G-p*z,.1>Math.abs(w)?(l.push(q-v,r-u,D,O,N,P),l.push(q+v,r+u,D,O,N,P)):(k=(z*t-G*n)/w,m=(p*n-E*t)/w,J=(k-q)*(k-q)+(m-r)+(m-r),19600<J?(x=v-y,B=u-C,K=Math.sqrt(x*x+B*B),x/=K,B/=K,x*=L,B*=L,l.push(q-x,r-B),l.push(D,O,N,P),l.push(q+x,r+B),
l.push(D,O,N,P),l.push(q-x,r-B),l.push(D,O,N,P),M++):(l.push(k,m),l.push(D,O,N,P),l.push(q-(k-q),r-(m-r)),l.push(D,O,N,P)));n=e[2*(h-2)];p=e[2*(h-2)+1];q=e[2*(h-1)];r=e[2*(h-1)+1];v=-(p-r);u=n-q;K=Math.sqrt(v*v+u*u);v/=K;u/=K;v*=L;u*=L;l.push(q-v,r-u);l.push(D,O,N,P);l.push(q+v,r+u);l.push(D,O,N,P);g.push(H);for(d=0;M>d;d++)g.push(H++);g.push(H-1)}};c.WebGLGraphics.buildComplexPoly=function(f,b){var d=f.points.slice();if(!(6>d.length)){var e=b.indices;b.points=d;b.alpha=f.fillAlpha;b.color=c.hex2rgb(f.fillColor);
for(var g,h,l=1/0,k=-1/0,m=1/0,n=-1/0,p=0;p<d.length;p+=2)g=d[p],h=d[p+1],l=l>g?g:l,k=g>k?g:k,m=m>h?h:m,n=h>n?h:n;d.push(l,m,k,m,k,n,l,n);d=d.length/2;for(p=0;d>p;p++)e.push(p)}};c.WebGLGraphics.buildPoly=function(f,b){var d=f.points;if(!(6>d.length)){for(var e=b.points,g=b.indices,h=d.length/2,l=c.hex2rgb(f.fillColor),k=f.fillAlpha,m=l[0]*k,n=l[1]*k,l=l[2]*k,p=c.PolyK.Triangulate(d),q=e.length/6,r=0,r=0;r<p.length;r+=3)g.push(p[r]+q),g.push(p[r]+q),g.push(p[r+1]+q),g.push(p[r+2]+q),g.push(p[r+2]+
q);for(r=0;h>r;r++)e.push(d[2*r],d[2*r+1],m,n,l,k)}};c.WebGLGraphics.graphicsDataPool=[];c.WebGLGraphicsData=function(c){this.gl=c;this.color=[0,0,0];this.points=[];this.indices=[];this.lastIndex=0;this.buffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.alpha=this.mode=1;this.dirty=!0};c.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[];this.lastIndex=0};c.WebGLGraphicsData.prototype.upload=function(){var c=this.gl;this.glPoints=new Float32Array(this.points);
c.bindBuffer(c.ARRAY_BUFFER,this.buffer);c.bufferData(c.ARRAY_BUFFER,this.glPoints,c.STATIC_DRAW);this.glIndicies=new Uint16Array(this.indices);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.glIndicies,c.STATIC_DRAW);this.dirty=!1};c.glContexts=[];c.WebGLRenderer=function(f,b,d){if(d)for(var e in c.defaultRenderOptions)"undefined"==typeof d[e]&&(d[e]=c.defaultRenderOptions[e]);else d=c.defaultRenderOptions;c.defaultRenderer||(c.sayHello("webGL"),c.defaultRenderer=
this);this.type=c.WEBGL_RENDERER;this.resolution=d.resolution;this.transparent=d.transparent;this.preserveDrawingBuffer=d.preserveDrawingBuffer;this.clearBeforeRender=d.clearBeforeRender;this.width=f||800;this.height=b||600;this.view=d.view||document.createElement("canvas");this.contextLostBound=this.handleContextLost.bind(this);this.contextRestoredBound=this.handleContextRestored.bind(this);this.view.addEventListener("webglcontextlost",this.contextLostBound,!1);this.view.addEventListener("webglcontextrestored",
this.contextRestoredBound,!1);this._contextOptions={alpha:this.transparent,antialias:d.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:d.preserveDrawingBuffer};this.projection=new c.Point;this.offset=new c.Point(0,0);this.shaderManager=new c.WebGLShaderManager;this.spriteBatch=new c.WebGLSpriteBatch;this.maskManager=new c.WebGLMaskManager;this.filterManager=new c.WebGLFilterManager;this.stencilManager=new c.WebGLStencilManager;this.blendModeManager=
new c.WebGLBlendModeManager;this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;
this.initContext();this.mapBlendModes()};c.WebGLRenderer.prototype.constructor=c.WebGLRenderer;c.WebGLRenderer.prototype.initContext=function(){var f=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=f,!f)throw Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=f.id=c.WebGLRenderer.glContextId++;c.glContexts[this.glContextId]=f;f.disable(f.DEPTH_TEST);f.disable(f.CULL_FACE);f.enable(f.BLEND);
this.shaderManager.setContext(f);this.spriteBatch.setContext(f);this.maskManager.setContext(f);this.filterManager.setContext(f);this.blendModeManager.setContext(f);this.stencilManager.setContext(f);this.renderSession.gl=this.gl;this.resize(this.width,this.height)};c.WebGLRenderer.prototype.render=function(c){if(!this.contextLost){this.__stage!==c&&(c.interactive&&c.interactionManager.removeEvents(),this.__stage=c);c.updateTransform();var b=this.gl;c._interactive?c._interactiveEventsAdded||(c._interactiveEventsAdded=
!0,c.interactionManager.setTarget(this)):c._interactiveEventsAdded&&(c._interactiveEventsAdded=!1,c.interactionManager.setTarget(this));b.viewport(0,0,this.width,this.height);b.bindFramebuffer(b.FRAMEBUFFER,null);this.clearBeforeRender&&(this.transparent?b.clearColor(0,0,0,0):b.clearColor(c.backgroundColorSplit[0],c.backgroundColorSplit[1],c.backgroundColorSplit[2],1),b.clear(b.COLOR_BUFFER_BIT));this.renderDisplayObject(c,this.projection)}};c.WebGLRenderer.prototype.renderDisplayObject=function(f,
b,d){this.renderSession.blendModeManager.setBlendMode(c.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.projection=b;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,d);f._renderWebGL(this.renderSession);this.spriteBatch.end()};c.WebGLRenderer.prototype.resize=function(c,b){this.width=c*this.resolution;this.height=b*this.resolution;this.view.width=this.width;this.view.height=this.height;this.gl.viewport(0,
0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};c.WebGLRenderer.prototype.updateTexture=function(f){if(f.hasLoaded){var b=this.gl;return f._glTextures[b.id]||(f._glTextures[b.id]=b.createTexture()),b.bindTexture(b.TEXTURE_2D,f._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,f.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,
f.scaleMode===c.scaleModes.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,f.scaleMode===c.scaleModes.LINEAR?b.LINEAR:b.NEAREST),f._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),f._dirty[b.id]=!1,f._glTextures[b.id]}};c.WebGLRenderer.prototype.handleContextLost=function(c){c.preventDefault();
this.contextLost=!0};c.WebGLRenderer.prototype.handleContextRestored=function(){this.initContext();for(var f in c.TextureCache)c.TextureCache[f].baseTexture._glTextures=[];this.contextLost=!1};c.WebGLRenderer.prototype.destroy=function(){this.view.off("webglcontextlost",this.contextLostBound);this.view.off("webglcontextrestored",this.contextRestoredBound);this.offset=this.projection=c.glContexts[this.glContextId]=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();
this.filterManager.destroy();this.renderSession=this.gl=this.filterManager=this.maskManager=this.spriteBatch=this.shaderManager=null};c.WebGLRenderer.prototype.mapBlendModes=function(){var f=this.gl;c.blendModesWebGL||(c.blendModesWebGL=[],c.blendModesWebGL[c.blendModes.NORMAL]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.ADD]=[f.SRC_ALPHA,f.DST_ALPHA],c.blendModesWebGL[c.blendModes.MULTIPLY]=[f.DST_COLOR,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.SCREEN]=[f.SRC_ALPHA,f.ONE],
c.blendModesWebGL[c.blendModes.OVERLAY]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.DARKEN]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.LIGHTEN]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.COLOR_DODGE]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.COLOR_BURN]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.HARD_LIGHT]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.SOFT_LIGHT]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],
c.blendModesWebGL[c.blendModes.DIFFERENCE]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.EXCLUSION]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.HUE]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.SATURATION]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.COLOR]=[f.ONE,f.ONE_MINUS_SRC_ALPHA],c.blendModesWebGL[c.blendModes.LUMINOSITY]=[f.ONE,f.ONE_MINUS_SRC_ALPHA])};c.WebGLRenderer.glContextId=0;c.WebGLBlendModeManager=function(){this.currentBlendMode=
99999};c.WebGLBlendModeManager.prototype.constructor=c.WebGLBlendModeManager;c.WebGLBlendModeManager.prototype.setContext=function(c){this.gl=c};c.WebGLBlendModeManager.prototype.setBlendMode=function(f){if(this.currentBlendMode===f)return!1;this.currentBlendMode=f;f=c.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(f[0],f[1]),!0};c.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};c.WebGLMaskManager=function(){};c.WebGLMaskManager.prototype.constructor=c.WebGLMaskManager;
c.WebGLMaskManager.prototype.setContext=function(c){this.gl=c};c.WebGLMaskManager.prototype.pushMask=function(f,b){var d=b.gl;f.dirty&&c.WebGLGraphics.updateGraphics(f,d);f._webGL[d.id].data.length&&b.stencilManager.pushStencil(f,f._webGL[d.id].data[0],b)};c.WebGLMaskManager.prototype.popMask=function(c,b){b.stencilManager.popStencil(c,c._webGL[this.gl.id].data[0],b)};c.WebGLMaskManager.prototype.destroy=function(){this.gl=null};c.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=!0;
this.count=0};c.WebGLStencilManager.prototype.setContext=function(c){this.gl=c};c.WebGLStencilManager.prototype.pushStencil=function(c,b,d){var e=this.gl;this.bindGraphics(c,b,d);0===this.stencilStack.length&&(e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0);this.stencilStack.push(b);c=this.count;e.colorMask(!1,!1,!1,!1);e.stencilFunc(e.ALWAYS,0,255);e.stencilOp(e.KEEP,e.KEEP,e.INVERT);1===b.mode?(e.drawElements(e.TRIANGLE_FAN,b.indices.length-4,e.UNSIGNED_SHORT,
0),this.reverse?(e.stencilFunc(e.EQUAL,255-c,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,c,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(b.indices.length-4)),this.reverse?e.stencilFunc(e.EQUAL,255-(c+1),255):e.stencilFunc(e.EQUAL,c+1,255),this.reverse=!this.reverse):(this.reverse?(e.stencilFunc(e.EQUAL,c,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,255-c,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_STRIP,
b.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,c+1,255):e.stencilFunc(e.EQUAL,255-(c+1),255));e.colorMask(!0,!0,!0,!0);e.stencilOp(e.KEEP,e.KEEP,e.KEEP);this.count++};c.WebGLStencilManager.prototype.bindGraphics=function(f,b,d){this._currentGraphics=f;var e,g=this.gl,h=d.projection,l=d.offset;1===b.mode?(e=d.shaderManager.complexPrimitiveShader,d.shaderManager.setShader(e),g.uniformMatrix3fv(e.translationMatrix,!1,f.worldTransform.toArray(!0)),g.uniform2f(e.projectionVector,
h.x,-h.y),g.uniform2f(e.offsetVector,-l.x,-l.y),g.uniform3fv(e.tintColor,c.hex2rgb(f.tint)),g.uniform3fv(e.color,b.color),g.uniform1f(e.alpha,f.worldAlpha*b.alpha),g.bindBuffer(g.ARRAY_BUFFER,b.buffer),g.vertexAttribPointer(e.aVertexPosition,2,g.FLOAT,!1,8,0),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,b.indexBuffer)):(e=d.shaderManager.primitiveShader,d.shaderManager.setShader(e),g.uniformMatrix3fv(e.translationMatrix,!1,f.worldTransform.toArray(!0)),g.uniform2f(e.projectionVector,h.x,-h.y),g.uniform2f(e.offsetVector,
-l.x,-l.y),g.uniform3fv(e.tintColor,c.hex2rgb(f.tint)),g.uniform1f(e.alpha,f.worldAlpha),g.bindBuffer(g.ARRAY_BUFFER,b.buffer),g.vertexAttribPointer(e.aVertexPosition,2,g.FLOAT,!1,24,0),g.vertexAttribPointer(e.colorAttribute,4,g.FLOAT,!1,24,8),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,b.indexBuffer))};c.WebGLStencilManager.prototype.popStencil=function(c,b,d){var e=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)e.disable(e.STENCIL_TEST);else{var g=this.count;this.bindGraphics(c,
b,d);e.colorMask(!1,!1,!1,!1);1===b.mode?(this.reverse=!this.reverse,this.reverse?(e.stencilFunc(e.EQUAL,255-(g+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,g+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(b.indices.length-4)),e.stencilFunc(e.ALWAYS,0,255),e.stencilOp(e.KEEP,e.KEEP,e.INVERT),e.drawElements(e.TRIANGLE_FAN,b.indices.length-4,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,g,255):e.stencilFunc(e.EQUAL,255-g,255)):
(this.reverse?(e.stencilFunc(e.EQUAL,g+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,255-(g+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_STRIP,b.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,g,255):e.stencilFunc(e.EQUAL,255-g,255));e.colorMask(!0,!0,!0,!0);e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}};c.WebGLStencilManager.prototype.destroy=function(){this.gl=this.stencilStack=null};c.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=
[];this.tempAttribState=[];for(var c=0;c<this.maxAttibs;c++)this.attribState[c]=!1;this.stack=[]};c.WebGLShaderManager.prototype.constructor=c.WebGLShaderManager;c.WebGLShaderManager.prototype.setContext=function(f){this.gl=f;this.primitiveShader=new c.PrimitiveShader(f);this.complexPrimitiveShader=new c.ComplexPrimitiveShader(f);this.defaultShader=new c.PixiShader(f);this.fastShader=new c.PixiFastShader(f);this.stripShader=new c.StripShader(f);this.setShader(this.defaultShader)};c.WebGLShaderManager.prototype.setAttribs=
function(c){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(b=0;b<c.length;b++)this.tempAttribState[c[b]]=!0;c=this.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.tempAttribState[b]?c.enableVertexAttribArray(b):c.disableVertexAttribArray(b))};c.WebGLShaderManager.prototype.setShader=function(c){return this._currentId===c._UID?!1:(this._currentId=c._UID,this.currentShader=c,this.gl.useProgram(c.program),
this.setAttribs(c.attributes),!0)};c.WebGLShaderManager.prototype.destroy=function(){this.tempAttribState=this.attribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};c.WebGLSpriteBatch=function(){this.vertSize=6;this.size=2E3;var f=6*this.size;this.vertices=new Float32Array(4*this.size*this.vertSize);this.indices=new Uint16Array(f);for(var b=this.lastIndexCount=0,d=0;f>b;b+=
6,d+=4)this.indices[b+0]=d+0,this.indices[b+1]=d+1,this.indices[b+2]=d+2,this.indices[b+3]=d+0,this.indices[b+4]=d+2,this.indices[b+5]=d+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=!0;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new c.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;",
"}"])};c.WebGLSpriteBatch.prototype.setContext=function(f){this.gl=f;this.vertexBuffer=f.createBuffer();this.indexBuffer=f.createBuffer();f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.bufferData(f.ELEMENT_ARRAY_BUFFER,this.indices,f.STATIC_DRAW);f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.bufferData(f.ARRAY_BUFFER,this.vertices,f.DYNAMIC_DRAW);this.currentBlendMode=99999;var b=new c.PixiShader(f);b.fragmentSrc=this.defaultShader.fragmentSrc;b.uniforms={};b.init();this.defaultShader.shaders[f.id]=
b};c.WebGLSpriteBatch.prototype.begin=function(c){this.renderSession=c;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};c.WebGLSpriteBatch.prototype.end=function(){this.flush()};c.WebGLSpriteBatch.prototype.render=function(c){var b=c.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);var d=b._uvs;if(d){var e,g,h,l,k=c.worldAlpha,m=c.tint,n=this.vertices;g=c.anchor.x;l=c.anchor.y;b.trim?(h=b.trim,g=h.x-g*h.width,e=g+b.crop.width,l=
h.y-l*h.height,h=l+b.crop.height):(e=b.frame.width*(1-g),g=b.frame.width*-g,h=b.frame.height*(1-l),l=b.frame.height*-l);var p=4*this.currentBatchSize*this.vertSize,q=b.baseTexture.resolution,r=c.worldTransform,b=r.a/q,t=r.b/q,w=r.c/q,q=r.d/q,v=r.tx,r=r.ty;n[p++]=b*g+w*l+v;n[p++]=q*l+t*g+r;n[p++]=d.x0;n[p++]=d.y0;n[p++]=k;n[p++]=m;n[p++]=b*e+w*l+v;n[p++]=q*l+t*e+r;n[p++]=d.x1;n[p++]=d.y1;n[p++]=k;n[p++]=m;n[p++]=b*e+w*h+v;n[p++]=q*h+t*e+r;n[p++]=d.x2;n[p++]=d.y2;n[p++]=k;n[p++]=m;n[p++]=b*g+w*h+v;
n[p++]=q*h+t*g+r;n[p++]=d.x3;n[p++]=d.y3;n[p++]=k;n[p++]=m;this.sprites[this.currentBatchSize++]=c}};c.WebGLSpriteBatch.prototype.renderTilingSprite=function(f){var b=f.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);f._uvs||(f._uvs=new c.TextureUvs);var d=f._uvs;f.tilePosition.x%=b.baseTexture.width*f.tileScaleOffset.x;f.tilePosition.y%=b.baseTexture.height*f.tileScaleOffset.y;var e=f.tilePosition.x/(b.baseTexture.width*f.tileScaleOffset.x),g=
f.tilePosition.y/(b.baseTexture.height*f.tileScaleOffset.y),h=f.width/b.baseTexture.width/(f.tileScale.x*f.tileScaleOffset.x),l=f.height/b.baseTexture.height/(f.tileScale.y*f.tileScaleOffset.y);d.x0=0-e;d.y0=0-g;d.x1=1*h-e;d.y1=0-g;d.x2=1*h-e;d.y2=1*l-g;d.x3=0-e;d.y3=1*l-g;var e=f.worldAlpha,g=f.tint,h=this.vertices,k=f.width,m=f.height,n=f.anchor.x,p=f.anchor.y,l=k*(1-n),k=k*-n,n=m*(1-p),m=m*-p,p=4*this.currentBatchSize*this.vertSize,q=b.baseTexture.resolution,r=f.worldTransform,b=r.a/q,t=r.b/q,
w=r.c/q,q=r.d/q,v=r.tx,r=r.ty;h[p++]=b*k+w*m+v;h[p++]=q*m+t*k+r;h[p++]=d.x0;h[p++]=d.y0;h[p++]=e;h[p++]=g;h[p++]=b*l+w*m+v;h[p++]=q*m+t*l+r;h[p++]=d.x1;h[p++]=d.y1;h[p++]=e;h[p++]=g;h[p++]=b*l+w*n+v;h[p++]=q*n+t*l+r;h[p++]=d.x2;h[p++]=d.y2;h[p++]=e;h[p++]=g;h[p++]=b*k+w*n+v;h[p++]=q*n+t*k+r;h[p++]=d.x3;h[p++]=d.y3;h[p++]=e;h[p++]=g;this.sprites[this.currentBatchSize++]=f};c.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var f,b=this.gl;if(this.dirty){this.dirty=!1;b.activeTexture(b.TEXTURE0);
b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f=this.defaultShader.shaders[b.id];var d=4*this.vertSize;b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,d,0);b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,d,8);b.vertexAttribPointer(f.colorAttribute,2,b.FLOAT,!1,d,16)}this.currentBatchSize>.5*this.size?b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices):(f=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize),b.bufferSubData(b.ARRAY_BUFFER,
0,f));for(var e,g,h,l,k=d=0,m=null,n=this.renderSession.blendModeManager.currentBlendMode,p=null,q=!1,r=!1,t=0,w=this.currentBatchSize;w>t;t++){if(l=this.sprites[t],e=l.texture.baseTexture,g=l.blendMode,h=l.shader||this.defaultShader,q=n!==g,r=p!==h,(m!==e||q||r)&&(this.renderBatch(m,d,k),k=t,d=0,m=e,q&&(n=g,this.renderSession.blendModeManager.setBlendMode(n)),r)){p=h;(f=p.shaders[b.id])||(f=new c.PixiShader(b),f.fragmentSrc=p.fragmentSrc,f.uniforms=p.uniforms,f.init(),p.shaders[b.id]=f);this.renderSession.shaderManager.setShader(f);
f.dirty&&f.syncUniforms();var v=this.renderSession.projection;b.uniform2f(f.projectionVector,v.x,v.y);v=this.renderSession.offset;b.uniform2f(f.offsetVector,v.x,v.y)}d++}this.renderBatch(m,d,k);this.currentBatchSize=0}};c.WebGLSpriteBatch.prototype.renderBatch=function(c,b,d){if(0!==b){var e=this.gl;c._dirty[e.id]?this.renderSession.renderer.updateTexture(c):e.bindTexture(e.TEXTURE_2D,c._glTextures[e.id]);e.drawElements(e.TRIANGLES,6*b,e.UNSIGNED_SHORT,12*d);this.renderSession.drawCount++}};c.WebGLSpriteBatch.prototype.stop=
function(){this.flush();this.dirty=!0};c.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0};c.WebGLSpriteBatch.prototype.destroy=function(){this.indices=this.vertices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.gl=this.currentBaseTexture=null};c.WebGLFastSpriteBatch=function(c){this.vertSize=10;this.size=this.maxSize=6E3;var b=6*this.maxSize;this.vertices=new Float32Array(4*this.size*this.vertSize);this.indices=new Uint16Array(b);this.indexBuffer=
this.vertexBuffer=null;for(var d=this.lastIndexCount=0,e=0;b>d;d+=6,e+=4)this.indices[d+0]=e+0,this.indices[d+1]=e+1,this.indices[d+2]=e+2,this.indices[d+3]=e+0,this.indices[d+4]=e+2,this.indices[d+5]=e+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.matrix=this.shader=this.renderSession=null;this.setContext(c)};c.WebGLFastSpriteBatch.prototype.constructor=c.WebGLFastSpriteBatch;c.WebGLFastSpriteBatch.prototype.setContext=function(c){this.gl=c;this.vertexBuffer=
c.createBuffer();this.indexBuffer=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.indices,c.STATIC_DRAW);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.vertices,c.DYNAMIC_DRAW)};c.WebGLFastSpriteBatch.prototype.begin=function(c,b){this.renderSession=b;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=c.worldTransform.toArray(!0);this.start()};c.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};
c.WebGLFastSpriteBatch.prototype.render=function(c){c=c.children;var b=c[0];if(b.texture._uvs){this.currentBaseTexture=b.texture.baseTexture;b.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(b.blendMode));for(var b=0,d=c.length;d>b;b++)this.renderSprite(c[b]);this.flush()}};c.WebGLFastSpriteBatch.prototype.renderSprite=function(c){if(c.visible&&(c.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=
c.texture.baseTexture,c.texture._uvs))){var b,d,e,g,h,l,k=this.vertices;(b=c.texture._uvs,c.texture.trim)?(g=c.texture.trim,e=g.x-c.anchor.x*g.width,d=e+c.texture.crop.width,h=g.y-c.anchor.y*g.height,g=h+c.texture.crop.height):(d=c.texture.frame.width*(1-c.anchor.x),e=c.texture.frame.width*-c.anchor.x,g=c.texture.frame.height*(1-c.anchor.y),h=c.texture.frame.height*-c.anchor.y);l=4*this.currentBatchSize*this.vertSize;k[l++]=e;k[l++]=h;k[l++]=c.position.x;k[l++]=c.position.y;k[l++]=c.scale.x;k[l++]=
c.scale.y;k[l++]=c.rotation;k[l++]=b.x0;k[l++]=b.y1;k[l++]=c.alpha;k[l++]=d;k[l++]=h;k[l++]=c.position.x;k[l++]=c.position.y;k[l++]=c.scale.x;k[l++]=c.scale.y;k[l++]=c.rotation;k[l++]=b.x1;k[l++]=b.y1;k[l++]=c.alpha;k[l++]=d;k[l++]=g;k[l++]=c.position.x;k[l++]=c.position.y;k[l++]=c.scale.x;k[l++]=c.scale.y;k[l++]=c.rotation;k[l++]=b.x2;k[l++]=b.y2;k[l++]=c.alpha;k[l++]=e;k[l++]=g;k[l++]=c.position.x;k[l++]=c.position.y;k[l++]=c.scale.x;k[l++]=c.scale.y;k[l++]=c.rotation;k[l++]=b.x3;k[l++]=b.y3;k[l++]=
c.alpha;this.currentBatchSize++;this.currentBatchSize>=this.size&&this.flush()}};c.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var c=this.gl;if(this.currentBaseTexture._glTextures[c.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,c),c.bindTexture(c.TEXTURE_2D,this.currentBaseTexture._glTextures[c.id]),this.currentBatchSize>.5*this.size)c.bufferSubData(c.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*
this.vertSize);c.bufferSubData(c.ARRAY_BUFFER,0,b)}c.drawElements(c.TRIANGLES,6*this.currentBatchSize,c.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++}};c.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};c.WebGLFastSpriteBatch.prototype.start=function(){var c=this.gl;c.activeTexture(c.TEXTURE0);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;c.uniform2f(this.shader.projectionVector,
b.x,b.y);c.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);b=4*this.vertSize;c.vertexAttribPointer(this.shader.aVertexPosition,2,c.FLOAT,!1,b,0);c.vertexAttribPointer(this.shader.aPositionCoord,2,c.FLOAT,!1,b,8);c.vertexAttribPointer(this.shader.aScale,2,c.FLOAT,!1,b,16);c.vertexAttribPointer(this.shader.aRotation,1,c.FLOAT,!1,b,24);c.vertexAttribPointer(this.shader.aTextureCoord,2,c.FLOAT,!1,b,28);c.vertexAttribPointer(this.shader.colorAttribute,1,c.FLOAT,!1,b,36)};c.WebGLFilterManager=function(){this.filterStack=
[];this.offsetY=this.offsetX=0};c.WebGLFilterManager.prototype.constructor=c.WebGLFilterManager;c.WebGLFilterManager.prototype.setContext=function(c){this.gl=c;this.texturePool=[];this.initShaderBuffers()};c.WebGLFilterManager.prototype.begin=function(c,b){this.renderSession=c;this.defaultShader=c.shaderManager.defaultShader;var d=this.renderSession.projection;this.width=2*d.x;this.height=2*-d.y;this.buffer=b};c.WebGLFilterManager.prototype.pushFilter=function(f){var b=this.gl,d=this.renderSession.projection,
e=this.renderSession.offset;f._filterArea=f.target.filterArea||f.target.getBounds();this.filterStack.push(f);var g=f.filterPasses[0];this.offsetX+=f._filterArea.x;this.offsetY+=f._filterArea.y;var h=this.texturePool.pop();h?h.resize(this.width,this.height):h=new c.FilterTexture(this.gl,this.width,this.height);b.bindTexture(b.TEXTURE_2D,h.texture);var l=f._filterArea,g=g.padding;l.x-=g;l.y-=g;l.width+=2*g;l.height+=2*g;0>l.x&&(l.x=0);l.width>this.width&&(l.width=this.width);0>l.y&&(l.y=0);l.height>
this.height&&(l.height=this.height);b.bindFramebuffer(b.FRAMEBUFFER,h.frameBuffer);b.viewport(0,0,l.width,l.height);d.x=l.width/2;d.y=-l.height/2;e.x=-l.x;e.y=-l.y;b.colorMask(!0,!0,!0,!0);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);f._glFilterTexture=h};c.WebGLFilterManager.prototype.popFilter=function(){var f=this.gl,b=this.filterStack.pop(),d=b._filterArea,e=b._glFilterTexture,g=this.renderSession.projection,h=this.renderSession.offset;if(1<b.filterPasses.length){f.viewport(0,0,d.width,d.height);
f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=d.height;this.vertexArray[2]=d.width;this.vertexArray[3]=d.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=d.width;this.vertexArray[7]=0;f.bufferSubData(f.ARRAY_BUFFER,0,this.vertexArray);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=d.width/this.width;this.uvArray[5]=d.height/this.height;this.uvArray[6]=d.width/this.width;this.uvArray[7]=d.height/this.height;f.bufferSubData(f.ARRAY_BUFFER,
0,this.uvArray);var l=this.texturePool.pop();l||(l=new c.FilterTexture(this.gl,this.width,this.height));l.resize(this.width,this.height);f.bindFramebuffer(f.FRAMEBUFFER,l.frameBuffer);f.clear(f.COLOR_BUFFER_BIT);f.disable(f.BLEND);for(var k=0;k<b.filterPasses.length-1;k++){var m=b.filterPasses[k];f.bindFramebuffer(f.FRAMEBUFFER,l.frameBuffer);f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,e.texture);this.applyFilterPass(m,d,d.width,d.height);m=e;e=l;l=m}f.enable(f.BLEND);this.texturePool.push(l)}l=
b.filterPasses[b.filterPasses.length-1];this.offsetX-=d.x;this.offsetY-=d.y;var k=this.width,m=this.height,n=0,p=0,q=this.buffer;0===this.filterStack.length?f.colorMask(!0,!0,!0,!0):(q=this.filterStack[this.filterStack.length-1],d=q._filterArea,k=d.width,m=d.height,n=d.x,p=d.y,q=q._glFilterTexture.frameBuffer);g.x=k/2;g.y=-m/2;h.x=n;h.y=p;d=b._filterArea;g=d.x-n;h=d.y-p;f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=g;this.vertexArray[1]=h+d.height;this.vertexArray[2]=g+d.width;
this.vertexArray[3]=h+d.height;this.vertexArray[4]=g;this.vertexArray[5]=h;this.vertexArray[6]=g+d.width;this.vertexArray[7]=h;f.bufferSubData(f.ARRAY_BUFFER,0,this.vertexArray);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=d.width/this.width;this.uvArray[5]=d.height/this.height;this.uvArray[6]=d.width/this.width;this.uvArray[7]=d.height/this.height;f.bufferSubData(f.ARRAY_BUFFER,0,this.uvArray);f.viewport(0,0,k,m);f.bindFramebuffer(f.FRAMEBUFFER,q);f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,
e.texture);this.applyFilterPass(l,d,k,m);this.texturePool.push(e);b._glFilterTexture=null};c.WebGLFilterManager.prototype.applyFilterPass=function(f,b,d,e){b=this.gl;var g=f.shaders[b.id];g||(g=new c.PixiShader(b),g.fragmentSrc=f.fragmentSrc,g.uniforms=f.uniforms,g.init(),f.shaders[b.id]=g);this.renderSession.shaderManager.setShader(g);b.uniform2f(g.projectionVector,d/2,-e/2);b.uniform2f(g.offsetVector,0,0);f.uniforms.dimensions&&(f.uniforms.dimensions.value[0]=this.width,f.uniforms.dimensions.value[1]=
this.height,f.uniforms.dimensions.value[2]=this.vertexArray[0],f.uniforms.dimensions.value[3]=this.vertexArray[5]);g.syncUniforms();b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.vertexAttribPointer(g.aVertexPosition,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);b.vertexAttribPointer(g.aTextureCoord,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.colorBuffer);b.vertexAttribPointer(g.colorAttribute,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.drawElements(b.TRIANGLES,
6,b.UNSIGNED_SHORT,0);this.renderSession.drawCount++};c.WebGLFilterManager.prototype.initShaderBuffers=function(){var c=this.gl;this.vertexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.colorBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.vertexArray,c.STATIC_DRAW);this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]);c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);
c.bufferData(c.ARRAY_BUFFER,this.uvArray,c.STATIC_DRAW);this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);c.bindBuffer(c.ARRAY_BUFFER,this.colorBuffer);c.bufferData(c.ARRAY_BUFFER,this.colorArray,c.STATIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),c.STATIC_DRAW)};c.WebGLFilterManager.prototype.destroy=function(){var c=this.gl;this.filterStack=null;for(var b=this.offsetY=this.offsetX=0;b<
this.texturePool.length;b++)this.texturePool[b].destroy();this.texturePool=null;c.deleteBuffer(this.vertexBuffer);c.deleteBuffer(this.uvBuffer);c.deleteBuffer(this.colorBuffer);c.deleteBuffer(this.indexBuffer)};c.FilterTexture=function(f,b,d,e){this.gl=f;this.frameBuffer=f.createFramebuffer();this.texture=f.createTexture();e=e||c.scaleModes.DEFAULT;f.bindTexture(f.TEXTURE_2D,this.texture);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e===c.scaleModes.LINEAR?f.LINEAR:f.NEAREST);f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_MIN_FILTER,e===c.scaleModes.LINEAR?f.LINEAR:f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindFramebuffer(f.FRAMEBUFFER,this.frameBuffer);f.bindFramebuffer(f.FRAMEBUFFER,this.frameBuffer);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,this.texture,0);this.renderBuffer=f.createRenderbuffer();f.bindRenderbuffer(f.RENDERBUFFER,this.renderBuffer);f.framebufferRenderbuffer(f.FRAMEBUFFER,
f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,this.renderBuffer);this.resize(b,d)};c.FilterTexture.prototype.constructor=c.FilterTexture;c.FilterTexture.prototype.clear=function(){var c=this.gl;c.clearColor(0,0,0,0);c.clear(c.COLOR_BUFFER_BIT)};c.FilterTexture.prototype.resize=function(c,b){if(this.width!==c||this.height!==b){this.width=c;this.height=b;var d=this.gl;d.bindTexture(d.TEXTURE_2D,this.texture);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,c,b,0,d.RGBA,d.UNSIGNED_BYTE,null);d.bindRenderbuffer(d.RENDERBUFFER,
this.renderBuffer);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,c,b)}};c.FilterTexture.prototype.destroy=function(){var c=this.gl;c.deleteFramebuffer(this.frameBuffer);c.deleteTexture(this.texture);this.texture=this.frameBuffer=null};c.CanvasBuffer=function(c,b){this.width=c;this.height=b;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=c;this.canvas.height=b};c.CanvasBuffer.prototype.constructor=c.CanvasBuffer;c.CanvasBuffer.prototype.clear=
function(){this.context.clearRect(0,0,this.width,this.height)};c.CanvasBuffer.prototype.resize=function(c,b){this.width=this.canvas.width=c;this.height=this.canvas.height=b};c.CanvasMaskManager=function(){};c.CanvasMaskManager.prototype.constructor=c.CanvasMaskManager;c.CanvasMaskManager.prototype.pushMask=function(f,b){var d=b.context;d.save();var e=f.alpha,g=f.worldTransform,h=b.resolution;d.setTransform(g.a*h,g.b*h,g.c*h,g.d*h,g.tx*h,g.ty*h);c.CanvasGraphics.renderGraphicsMask(f,d);d.clip();f.worldAlpha=
e};c.CanvasMaskManager.prototype.popMask=function(c){c.context.restore()};c.CanvasTinter=function(){};c.CanvasTinter.getTintedTexture=function(f,b){var d=f.texture;b=c.CanvasTinter.roundColor(b);var e="#"+("00000"+(0|b).toString(16)).substr(-6);if(d.tintCache=d.tintCache||{},d.tintCache[e])return d.tintCache[e];var g=c.CanvasTinter.canvas||document.createElement("canvas");if(c.CanvasTinter.tintMethod(d,b,g),c.CanvasTinter.convertTintToImage){var h=new Image;h.src=g.toDataURL();d.tintCache[e]=h}else d.tintCache[e]=
g,c.CanvasTinter.canvas=null;return g};c.CanvasTinter.tintWithMultiply=function(c,b,d){var e=d.getContext("2d"),g=c.crop;d.width=g.width;d.height=g.height;e.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6);e.fillRect(0,0,g.width,g.height);e.globalCompositeOperation="multiply";e.drawImage(c.baseTexture.source,g.x,g.y,g.width,g.height,0,0,g.width,g.height);e.globalCompositeOperation="destination-atop";e.drawImage(c.baseTexture.source,g.x,g.y,g.width,g.height,0,0,g.width,g.height)};c.CanvasTinter.tintWithOverlay=
function(c,b,d){var e=d.getContext("2d"),g=c.crop;d.width=g.width;d.height=g.height;e.globalCompositeOperation="copy";e.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6);e.fillRect(0,0,g.width,g.height);e.globalCompositeOperation="destination-atop";e.drawImage(c.baseTexture.source,g.x,g.y,g.width,g.height,0,0,g.width,g.height)};c.CanvasTinter.tintWithPerPixel=function(f,b,d){var e=d.getContext("2d"),g=f.crop;d.width=g.width;d.height=g.height;e.globalCompositeOperation="copy";e.drawImage(f.baseTexture.source,
g.x,g.y,g.width,g.height,0,0,g.width,g.height);d=c.hex2rgb(b);f=d[0];b=d[1];d=d[2];for(var g=e.getImageData(0,0,g.width,g.height),h=g.data,l=0;l<h.length;l+=4)h[l+0]*=f,h[l+1]*=b,h[l+2]*=d;e.putImageData(g,0,0)};c.CanvasTinter.roundColor=function(f){var b=c.CanvasTinter.cacheStepsPerColorChannel;f=c.hex2rgb(f);return f[0]=Math.min(255,f[0]/b*b),f[1]=Math.min(255,f[1]/b*b),f[2]=Math.min(255,f[2]/b*b),c.rgb2hex(f)};c.CanvasTinter.cacheStepsPerColorChannel=8;c.CanvasTinter.convertTintToImage=!1;c.CanvasTinter.canUseMultiply=
c.canUseNewCanvasBlendModes();c.CanvasTinter.tintMethod=c.CanvasTinter.canUseMultiply?c.CanvasTinter.tintWithMultiply:c.CanvasTinter.tintWithPerPixel;c.CanvasRenderer=function(f,b,d){if(d)for(var e in c.defaultRenderOptions)"undefined"==typeof d[e]&&(d[e]=c.defaultRenderOptions[e]);else d=c.defaultRenderOptions;c.defaultRenderer||(c.sayHello("Canvas"),c.defaultRenderer=this);this.type=c.CANVAS_RENDERER;this.resolution=d.resolution;this.clearBeforeRender=d.clearBeforeRender;this.transparent=d.transparent;
this.width=f||800;this.height=b||600;this.width*=this.resolution;this.height*=this.resolution;this.view=d.view||document.createElement("canvas");this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=!0;this.view.width=this.width*this.resolution;this.view.height=this.height*this.resolution;this.count=0;this.maskManager=new c.CanvasMaskManager;this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1};this.mapBlendModes();
this.resize(f,b);"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty=
"msImageSmoothingEnabled")};c.CanvasRenderer.prototype.constructor=c.CanvasRenderer;c.CanvasRenderer.prototype.render=function(f){f.updateTransform();this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=c.blendModes.NORMAL;this.context.globalCompositeOperation=c.blendModesCanvas[c.blendModes.NORMAL];navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear());this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,
0,this.width,this.height):(this.context.fillStyle=f.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)));this.renderDisplayObject(f);f.interactive&&(f._interactiveEventsAdded||(f._interactiveEventsAdded=!0,f.interactionManager.setTarget(this)))};c.CanvasRenderer.prototype.destroy=function(c){"undefined"==typeof c&&(c=!0);c&&this.view.parent&&this.view.parent.removeChild(this.view);this.renderSession=this.maskManager=this.context=this.view=null};c.CanvasRenderer.prototype.resize=
function(c,b){this.width=c*this.resolution;this.height=b*this.resolution;this.view.width=this.width;this.view.height=this.height;this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"};c.CanvasRenderer.prototype.renderDisplayObject=function(c,b){this.renderSession.context=b||this.context;this.renderSession.resolution=this.resolution;c._renderCanvas(this.renderSession)};c.CanvasRenderer.prototype.mapBlendModes=function(){c.blendModesCanvas||(c.blendModesCanvas=
[],c.canUseNewCanvasBlendModes()?(c.blendModesCanvas[c.blendModes.NORMAL]="source-over",c.blendModesCanvas[c.blendModes.ADD]="lighter",c.blendModesCanvas[c.blendModes.MULTIPLY]="multiply",c.blendModesCanvas[c.blendModes.SCREEN]="screen",c.blendModesCanvas[c.blendModes.OVERLAY]="overlay",c.blendModesCanvas[c.blendModes.DARKEN]="darken",c.blendModesCanvas[c.blendModes.LIGHTEN]="lighten",c.blendModesCanvas[c.blendModes.COLOR_DODGE]="color-dodge",c.blendModesCanvas[c.blendModes.COLOR_BURN]="color-burn",
c.blendModesCanvas[c.blendModes.HARD_LIGHT]="hard-light",c.blendModesCanvas[c.blendModes.SOFT_LIGHT]="soft-light",c.blendModesCanvas[c.blendModes.DIFFERENCE]="difference",c.blendModesCanvas[c.blendModes.EXCLUSION]="exclusion",c.blendModesCanvas[c.blendModes.HUE]="hue",c.blendModesCanvas[c.blendModes.SATURATION]="saturation",c.blendModesCanvas[c.blendModes.COLOR]="color",c.blendModesCanvas[c.blendModes.LUMINOSITY]="luminosity"):(c.blendModesCanvas[c.blendModes.NORMAL]="source-over",c.blendModesCanvas[c.blendModes.ADD]=
"lighter",c.blendModesCanvas[c.blendModes.MULTIPLY]="source-over",c.blendModesCanvas[c.blendModes.SCREEN]="source-over",c.blendModesCanvas[c.blendModes.OVERLAY]="source-over",c.blendModesCanvas[c.blendModes.DARKEN]="source-over",c.blendModesCanvas[c.blendModes.LIGHTEN]="source-over",c.blendModesCanvas[c.blendModes.COLOR_DODGE]="source-over",c.blendModesCanvas[c.blendModes.COLOR_BURN]="source-over",c.blendModesCanvas[c.blendModes.HARD_LIGHT]="source-over",c.blendModesCanvas[c.blendModes.SOFT_LIGHT]=
"source-over",c.blendModesCanvas[c.blendModes.DIFFERENCE]="source-over",c.blendModesCanvas[c.blendModes.EXCLUSION]="source-over",c.blendModesCanvas[c.blendModes.HUE]="source-over",c.blendModesCanvas[c.blendModes.SATURATION]="source-over",c.blendModesCanvas[c.blendModes.COLOR]="source-over",c.blendModesCanvas[c.blendModes.LUMINOSITY]="source-over"))};c.CanvasGraphics=function(){};c.CanvasGraphics.renderGraphics=function(f,b){for(var d=f.worldAlpha,e=0;e<f.graphicsData.length;e++){var g=f.graphicsData[e],
h=g.shape;if(b.strokeStyle="#"+("00000"+(0|g.lineColor).toString(16)).substr(-6),b.lineWidth=g.lineWidth,g.type===c.Graphics.POLY){b.beginPath();var l=h.points;b.moveTo(l[0],l[1]);for(var k=1;k<l.length/2;k++)b.lineTo(l[2*k],l[2*k+1]);h.closed&&b.lineTo(l[0],l[1]);l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&b.closePath();g.fill&&(b.globalAlpha=g.fillAlpha*d,b.fillStyle="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill());g.lineWidth&&(b.globalAlpha=g.lineAlpha*d,b.stroke())}else if(g.type===
c.Graphics.RECT)(g.fillColor||0===g.fillColor)&&(b.globalAlpha=g.fillAlpha*d,b.fillStyle="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fillRect(h.x,h.y,h.width,h.height)),g.lineWidth&&(b.globalAlpha=g.lineAlpha*d,b.strokeRect(h.x,h.y,h.width,h.height));else if(g.type===c.Graphics.CIRC)b.beginPath(),b.arc(h.x,h.y,h.radius,0,2*Math.PI),b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*d,b.fillStyle="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=
g.lineAlpha*d,b.stroke());else if(g.type===c.Graphics.ELIP){var m=2*h.width,k=2*h.height,l=h.x-m/2,h=h.y-k/2;b.beginPath();var n=m/2*.5522848,p=k/2*.5522848,q=l+m,r=h+k,m=l+m/2,k=h+k/2;b.moveTo(l,k);b.bezierCurveTo(l,k-p,m-n,h,m,h);b.bezierCurveTo(m+n,h,q,k-p,q,k);b.bezierCurveTo(q,k+p,m+n,r,m,r);b.bezierCurveTo(m-n,r,l,k+p,l,k);b.closePath();g.fill&&(b.globalAlpha=g.fillAlpha*d,b.fillStyle="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill());g.lineWidth&&(b.globalAlpha=g.lineAlpha*d,b.stroke())}else g.type===
c.Graphics.RREC&&(p=h.points,l=p[0],k=p[1],h=p[2],n=p[3],p=p[4],q=Math.min(h,n)/2|0,p=p>q?q:p,b.beginPath(),b.moveTo(l,k+p),b.lineTo(l,k+n-p),b.quadraticCurveTo(l,k+n,l+p,k+n),b.lineTo(l+h-p,k+n),b.quadraticCurveTo(l+h,k+n,l+h,k+n-p),b.lineTo(l+h,k+p),b.quadraticCurveTo(l+h,k,l+h-p,k),b.lineTo(l+p,k),b.quadraticCurveTo(l,k,l,k+p),b.closePath(),(g.fillColor||0===g.fillColor)&&(b.globalAlpha=g.fillAlpha*d,b.fillStyle="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=
g.lineAlpha*d,b.stroke()))}};c.CanvasGraphics.renderGraphicsMask=function(f,b){var d=f.graphicsData.length;if(0!==d)for(1<d&&window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"),d=0;1>d;d++){var e=f.graphicsData[d],g=e.shape;if(e.type===c.Graphics.POLY){b.beginPath();e=g.points;b.moveTo(e[0],e[1]);for(var h=1;h<e.length/2;h++)b.lineTo(e[2*h],e[2*h+1]);e[0]===e[e.length-2]&&e[1]===e[e.length-1]&&b.closePath()}else if(e.type===c.Graphics.RECT)b.beginPath(),
b.rect(g.x,g.y,g.width,g.height),b.closePath();else if(e.type===c.Graphics.CIRC)b.beginPath(),b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath();else if(e.type===c.Graphics.ELIP){var l=2*g.width,h=2*g.height,e=g.x-l/2,g=g.y-h/2;b.beginPath();var k=l/2*.5522848,m=h/2*.5522848,n=e+l,p=g+h,l=e+l/2,h=g+h/2;b.moveTo(e,h);b.bezierCurveTo(e,h-m,l-k,g,l,g);b.bezierCurveTo(l+k,g,n,h-m,n,h);b.bezierCurveTo(n,h+m,l+k,p,l,p);b.bezierCurveTo(l-k,p,e,h+m,e,h);b.closePath()}else e.type===c.Graphics.RREC&&(m=g.points,
e=m[0],h=m[1],g=m[2],k=m[3],m=m[4],n=Math.min(g,k)/2|0,m=m>n?n:m,b.beginPath(),b.moveTo(e,h+m),b.lineTo(e,h+k-m),b.quadraticCurveTo(e,h+k,e+m,h+k),b.lineTo(e+g-m,h+k),b.quadraticCurveTo(e+g,h+k,e+g,h+k-m),b.lineTo(e+g,h+m),b.quadraticCurveTo(e+g,h,e+g-m,h),b.lineTo(e+m,h),b.quadraticCurveTo(e,h,e,h+m),b.closePath())}};c.Strip=function(f){c.DisplayObjectContainer.call(this);this.texture=f;this.uvs=new c.Float32Array([0,1,1,1,1,0,0,1]);this.verticies=new c.Float32Array([0,0,100,0,100,100,0,100]);this.colors=
new c.Float32Array([1,1,1,1]);this.indices=new c.Uint16Array([0,1,2,3]);this.dirty=!0;this.padding=0};c.Strip.prototype=Object.create(c.DisplayObjectContainer.prototype);c.Strip.prototype.constructor=c.Strip;c.Strip.prototype._renderWebGL=function(c){!this.visible||0>=this.alpha||(c.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(c),c.shaderManager.setShader(c.shaderManager.stripShader),this._renderStrip(c),c.spriteBatch.start())};c.Strip.prototype._initWebGL=function(c){c=c.gl;this._vertexBuffer=
c.createBuffer();this._indexBuffer=c.createBuffer();this._uvBuffer=c.createBuffer();this._colorBuffer=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,this._vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.verticies,c.DYNAMIC_DRAW);c.bindBuffer(c.ARRAY_BUFFER,this._uvBuffer);c.bufferData(c.ARRAY_BUFFER,this.uvs,c.STATIC_DRAW);c.bindBuffer(c.ARRAY_BUFFER,this._colorBuffer);c.bufferData(c.ARRAY_BUFFER,this.colors,c.STATIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this._indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,
this.indices,c.STATIC_DRAW)};c.Strip.prototype._renderStrip=function(c){var b=c.gl,d=c.projection,e=c.offset,g=c.shaderManager.stripShader;b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);b.uniformMatrix3fv(g.translationMatrix,!1,this.worldTransform.toArray(!0));b.uniform2f(g.projectionVector,d.x,-d.y);b.uniform2f(g.offsetVector,-e.x,-e.y);b.uniform1f(g.alpha,this.worldAlpha);this.dirty?(this.dirty=!1,b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.verticies,b.STATIC_DRAW),
b.vertexAttribPointer(g.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.vertexAttribPointer(g.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?c.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,
b.STATIC_DRAW)):(b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.verticies),b.vertexAttribPointer(g.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.vertexAttribPointer(g.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?c.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer));
b.drawElements(b.TRIANGLE_STRIP,this.indices.length,b.UNSIGNED_SHORT,0)};c.Strip.prototype._renderCanvas=function(c){var b=c.context,d=this.worldTransform;c.roundPixels?b.setTransform(d.a,d.b,d.c,d.d,0|d.tx,0|d.ty):b.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty);c=this.verticies;var d=this.uvs,e=c.length/2;this.count++;for(var g=0;e-2>g;g++){var h=2*g,l=c[h],k=c[h+2],m=c[h+4],n=c[h+1],p=c[h+3],q=c[h+5];if(0<this.padding)var r=(l+k+m)/3,t=(n+p+q)/3,w=l-r,v=n-t,u=Math.sqrt(w*w+v*v),l=r+w/u*(u+3),n=t+v/u*
(u+3),w=k-r,v=p-t,u=Math.sqrt(w*w+v*v),k=r+w/u*(u+3),p=t+v/u*(u+3),w=m-r,v=q-t,u=Math.sqrt(w*w+v*v),m=r+w/u*(u+3),q=t+v/u*(u+3);r=d[h]*this.texture.width;t=d[h+2]*this.texture.width;w=d[h+4]*this.texture.width;v=d[h+1]*this.texture.height;u=d[h+3]*this.texture.height;h=d[h+5]*this.texture.height;b.save();b.beginPath();b.moveTo(l,n);b.lineTo(k,p);b.lineTo(m,q);b.closePath();b.clip();var y=r*u+v*w+t*h-u*w-v*t-r*h;b.transform((l*u+v*m+k*h-u*m-v*k-l*h)/y,(n*u+v*q+p*h-u*q-v*p-n*h)/y,(r*k+l*w+t*m-k*w-l*
t-r*m)/y,(r*p+n*w+t*q-p*w-n*t-r*q)/y,(r*u*m+v*k*w+l*t*h-l*u*w-v*t*m-r*k*h)/y,(r*u*q+v*p*w+n*t*h-n*u*w-v*t*q-r*p*h)/y);b.drawImage(this.texture.baseTexture.source,0,0);b.restore()}};c.Strip.prototype.renderStripFlat=function(c){var b=this.context;c=c.verticies;var d=c.length/2;this.count++;b.beginPath();for(var e=1;d-2>e;e++){var g=2*e,h=c[g+2],l=c[g+4],k=c[g+3],m=c[g+5];b.moveTo(c[g],c[g+1]);b.lineTo(h,k);b.lineTo(l,m)}b.fillStyle="#FF0000";b.fill();b.closePath()};c.Strip.prototype.onTextureUpdate=
function(){this.updateFrame=!0};c.Rope=function(f,b){c.Strip.call(this,f);this.points=b;this.verticies=new c.Float32Array(4*b.length);this.uvs=new c.Float32Array(4*b.length);this.colors=new c.Float32Array(2*b.length);this.indices=new c.Uint16Array(2*b.length);this.refresh()};c.Rope.prototype=Object.create(c.Strip.prototype);c.Rope.prototype.constructor=c.Rope;c.Rope.prototype.refresh=function(){var c=this.points;if(!(1>c.length)){var b=this.uvs,d=this.indices,e=this.colors;this.count-=.2;b[0]=0;b[1]=
0;b[2]=0;b[3]=1;e[0]=1;e[1]=1;d[0]=0;d[1]=1;for(var g,h=c.length,l=1;h>l;l++)c=4*l,g=l/(h-1),b[c]=g,b[c+1]=0,b[c+2]=g,b[c+3]=1,c=2*l,e[c]=1,e[c+1]=1,c=2*l,d[c]=c,d[c+1]=c+1}};c.Rope.prototype.updateTransform=function(){var f=this.points;if(!(1>f.length)){var b,d=f[0],e=b=0;this.count-=.2;for(var g,h,l,k=this.verticies,m=f.length,n=0;m>n;n++)g=f[n],h=4*n,b=n<f.length-1?f[n+1]:g,e=-(b.x-d.x),b=b.y-d.y,d=Math.sqrt(b*b+e*e),l=this.texture.height/2,b/=d,e/=d,b*=l,e*=l,k[h]=g.x+b,k[h+1]=g.y+e,k[h+2]=g.x-
b,k[h+3]=g.y-e,d=g;c.DisplayObjectContainer.prototype.updateTransform.call(this)}};c.Rope.prototype.setTexture=function(c){this.texture=c};c.TilingSprite=function(f,b,d){c.Sprite.call(this,f);this._width=b||100;this._height=d||100;this.tileScale=new c.Point(1,1);this.tileScaleOffset=new c.Point(1,1);this.tilePosition=new c.Point(0,0);this.renderable=!0;this.tint=16777215;this.blendMode=c.blendModes.NORMAL};c.TilingSprite.prototype=Object.create(c.Sprite.prototype);c.TilingSprite.prototype.constructor=
c.TilingSprite;Object.defineProperty(c.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(c){this._width=c}});Object.defineProperty(c.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(c){this._height=c}});c.TilingSprite.prototype.setTexture=function(c){this.texture!==c&&(this.texture=c,this.refreshTexture=!0,this.cachedTint=16777215)};c.TilingSprite.prototype._renderWebGL=function(f){if(!1!==this.visible&&0!==this.alpha){var b,d;this._mask&&
(f.spriteBatch.stop(),f.maskManager.pushMask(this.mask,f),f.spriteBatch.start());this._filters&&(f.spriteBatch.flush(),f.filterManager.pushFilter(this._filterBlock));!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(c.updateWebGLTexture(this.tilingTexture.baseTexture,f.gl),this.tilingTexture.needsUpdate=!1)):f.spriteBatch.renderTilingSprite(this);b=0;for(d=this.children.length;d>b;b++)this.children[b]._renderWebGL(f);f.spriteBatch.stop();
this._filters&&f.filterManager.popFilter();this._mask&&f.maskManager.popMask(this._mask,f);f.spriteBatch.start()}};c.TilingSprite.prototype._renderCanvas=function(f){if(!1!==this.visible&&0!==this.alpha){var b=f.context;this._mask&&f.maskManager.pushMask(this._mask,b);b.globalAlpha=this.worldAlpha;var d;d=this.worldTransform;var e=f.resolution;if(b.setTransform(d.a*e,d.c*e,d.b*e,d.d*e,d.tx*e,d.ty*e),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;
this.__tilePattern=b.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==f.currentBlendMode&&(f.currentBlendMode=this.blendMode,b.globalCompositeOperation=c.blendModesCanvas[f.currentBlendMode]);d=this.tilePosition;e=this.tileScale;d.x%=this.tilingTexture.baseTexture.width;d.y%=this.tilingTexture.baseTexture.height;b.scale(e.x,e.y);b.translate(d.x+this.anchor.x*-this._width,d.y+this.anchor.y*-this._height);b.fillStyle=this.__tilePattern;b.fillRect(-d.x,-d.y,this._width/
e.x,this._height/e.y);b.scale(1/e.x,1/e.y);b.translate(-d.x+this.anchor.x*this._width,-d.y+this.anchor.y*this._height);this._mask&&f.maskManager.popMask(f.context);b=0;for(d=this.children.length;d>b;b++)this.children[b]._renderCanvas(f)}};c.TilingSprite.prototype.getBounds=function(){var c=this._width,b=this._height,d=c*(1-this.anchor.x),e=c*-this.anchor.x,g=b*(1-this.anchor.y),h=b*-this.anchor.y,b=this.worldTransform,l=b.a,k=b.c,m=b.b,n=b.d,p=b.tx,q=b.ty,b=l*e+m*h+p,c=n*h+k*e+q,r=l*d+m*h+p,h=n*h+
k*d+q,t=l*d+m*g+p,d=n*g+k*d+q,l=l*e+m*g+p,e=n*g+k*e+q,g=-1/0,k=-1/0,n=1/0,m=1/0,n=n>b?b:n,n=n>r?r:n,n=n>t?t:n,n=n>l?l:n,m=m>c?c:m,m=m>h?h:m,m=m>d?d:m,m=m>e?e:m,g=b>g?b:g,g=r>g?r:g,g=t>g?t:g,k=c>k?c:k,k=h>k?h:k,k=d>k?d:k,b=this._bounds;return b.x=n,b.width=(l>g?l:g)-n,b.y=m,b.height=(e>k?e:k)-m,this._currentBounds=b,b};c.TilingSprite.prototype.onTextureUpdate=function(){};c.TilingSprite.prototype.generateTilingTexture=function(f){if(this.texture.baseTexture.hasLoaded){var b,d,e=this.originalTexture||
this.texture,g=e.frame,h=g.width!==e.baseTexture.width||g.height!==e.baseTexture.height,l=!1;if(f?(b=c.getNextPowerOfTwo(g.width),d=c.getNextPowerOfTwo(g.height),(g.width!==b||g.height!==d)&&(l=!0)):h&&(b=g.width,d=g.height,l=!0),l){var k;this.tilingTexture&&this.tilingTexture.isTiling?(k=this.tilingTexture.canvasBuffer,k.resize(b,d),this.tilingTexture.baseTexture.width=b,this.tilingTexture.baseTexture.height=d,this.tilingTexture.needsUpdate=!0):(k=new c.CanvasBuffer(b,d),this.tilingTexture=c.Texture.fromCanvas(k.canvas),
this.tilingTexture.canvasBuffer=k,this.tilingTexture.isTiling=!0);k.context.drawImage(e.baseTexture.source,e.crop.x,e.crop.y,e.crop.width,e.crop.height,0,0,b,d);this.tileScaleOffset.x=g.width/b;this.tileScaleOffset.y=g.height/d}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=e;this.refreshTexture=!1;this.originalTexture=this.texture;this.texture=this.tilingTexture;this.tilingTexture.baseTexture._powerOf2=
!0}};c.BaseTextureCache={};c.BaseTextureCacheIdGenerator=0;c.BaseTexture=function(f,b){if(this.resolution=1,this.width=100,this.height=100,this.scaleMode=b||c.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=f,this._UID=c._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this._dirty=[!0,!0,!0,!0],f){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||
this.source.height,this.dirty();else{var d=this;this.source.onload=function(){d.hasLoaded=!0;d.width=d.source.naturalWidth||d.source.width;d.height=d.source.naturalHeight||d.source.height;d.dirty();d.dispatchEvent({type:"loaded",content:d})};this.source.onerror=function(){d.dispatchEvent({type:"error",content:d})}}this.imageUrl=null;this._powerOf2=!1}};c.BaseTexture.prototype.constructor=c.BaseTexture;c.EventTarget.mixin(c.BaseTexture.prototype);c.BaseTexture.prototype.destroy=function(){this.imageUrl?
(delete c.BaseTextureCache[this.imageUrl],delete c.TextureCache[this.imageUrl],this.imageUrl=null,this.source.src=""):this.source&&this.source._pixiId&&delete c.BaseTextureCache[this.source._pixiId];this.source=null;for(var f=this._glTextures.length-1;0<=f;f--){var b=this._glTextures[f],d=c.glContexts[f];d&&b&&d.deleteTexture(b)}this._glTextures.length=0};c.BaseTexture.prototype.updateSourceImage=function(c){this.hasLoaded=!1;this.source.src=null;this.source.src=c};c.BaseTexture.prototype.dirty=function(){for(var c=
0;c<this._glTextures.length;c++)this._dirty[c]=!0};c.BaseTexture.fromImage=function(f,b,d){var e=c.BaseTextureCache[f];(void 0===b&&-1===f.indexOf("data:")&&(b=!0),e)||(e=new Image,b&&(e.crossOrigin=""),e.src=f,e=new c.BaseTexture(e,d),e.imageUrl=f,c.BaseTextureCache[f]=e,-1!==f.indexOf(c.RETINA_PREFIX+".")&&(e.resolution=2));return e};c.BaseTexture.fromCanvas=function(f,b){f._pixiId||(f._pixiId="canvas_"+c.TextureCacheIdGenerator++);var d=c.BaseTextureCache[f._pixiId];return d||(d=new c.BaseTexture(f,
b),c.BaseTextureCache[f._pixiId]=d),d};c.TextureCache={};c.FrameCache={};c.TextureCacheIdGenerator=0;c.Texture=function(f,b,d,e){this.noFrame=!1;b||(this.noFrame=!0,b=new c.Rectangle(0,0,1,1));f instanceof c.Texture&&(f=f.baseTexture);this.baseTexture=f;this.frame=b;this.trim=e;this.requiresUpdate=this.valid=!1;this._uvs=null;this.height=this.width=0;this.crop=d||new c.Rectangle(0,0,1,1);f.hasLoaded?(this.noFrame&&(b=new c.Rectangle(0,0,f.width,f.height)),this.setFrame(b)):f.addEventListener("loaded",
this.onBaseTextureLoaded.bind(this))};c.Texture.prototype.constructor=c.Texture;c.EventTarget.mixin(c.Texture.prototype);c.Texture.prototype.onBaseTextureLoaded=function(){var f=this.baseTexture;f.removeEventListener("loaded",this.onLoaded);this.noFrame&&(this.frame=new c.Rectangle(0,0,f.width,f.height));this.setFrame(this.frame);this.dispatchEvent({type:"update",content:this})};c.Texture.prototype.destroy=function(c){c&&this.baseTexture.destroy();this.valid=!1};c.Texture.prototype.setFrame=function(c){if(this.noFrame=
!1,this.frame=c,this.width=c.width,this.height=c.height,this.crop.x=c.x,this.crop.y=c.y,this.crop.width=c.width,this.crop.height=c.height,!this.trim&&(c.x+c.width>this.baseTexture.width||c.y+c.height>this.baseTexture.height))throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=c&&c.width&&c.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,
this.frame.height=this.trim.height);this.valid&&this._updateUvs()};c.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new c.TextureUvs);var f=this.crop,b=this.baseTexture.width,d=this.baseTexture.height;this._uvs.x0=f.x/b;this._uvs.y0=f.y/d;this._uvs.x1=(f.x+f.width)/b;this._uvs.y1=f.y/d;this._uvs.x2=(f.x+f.width)/b;this._uvs.y2=(f.y+f.height)/d;this._uvs.x3=f.x/b;this._uvs.y3=(f.y+f.height)/d};c.Texture.fromImage=function(f,b,d){var e=c.TextureCache[f];return e||(e=new c.Texture(c.BaseTexture.fromImage(f,
b,d)),c.TextureCache[f]=e),e};c.Texture.fromFrame=function(f){var b=c.TextureCache[f];if(!b)throw Error('The frameId "'+f+'" does not exist in the texture cache ');return b};c.Texture.fromCanvas=function(f,b){var d=c.BaseTexture.fromCanvas(f,b);return new c.Texture(d)};c.Texture.addTextureToCache=function(f,b){c.TextureCache[b]=f};c.Texture.removeTextureFromCache=function(f){var b=c.TextureCache[f];return delete c.TextureCache[f],delete c.BaseTextureCache[f],b};c.TextureUvs=function(){this.y3=this.x3=
this.y2=this.x2=this.y1=this.x1=this.y0=this.x0=0};c.RenderTexture=function(f,b,d,e,g){(this.width=f||100,this.height=b||100,this.resolution=g||1,this.frame=new c.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new c.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new c.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=
this.resolution,this.baseTexture.scaleMode=e||c.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,c.Texture.call(this,this.baseTexture,new c.Rectangle(0,0,this.width,this.height)),this.renderer=d||c.defaultRenderer,this.renderer.type===c.WEBGL_RENDERER)?(f=this.renderer.gl,this.baseTexture._dirty[f.id]=!1,this.textureBuffer=new c.FilterTexture(f,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode),this.baseTexture._glTextures[f.id]=this.textureBuffer.texture,this.render=
this.renderWebGL,this.projection=new c.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new c.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas);this.valid=!0;this._updateUvs()};c.RenderTexture.prototype=Object.create(c.Texture.prototype);c.RenderTexture.prototype.constructor=c.RenderTexture;c.RenderTexture.prototype.resize=function(f,b,d){(f!==this.width||b!==this.height)&&(this.valid=0<f&&
0<b,this.width=this.frame.width=this.crop.width=f,this.height=this.frame.height=this.crop.height=b,d&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===c.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))};c.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===c.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,
this.textureBuffer.frameBuffer),this.textureBuffer.clear())};c.RenderTexture.prototype.renderWebGL=function(c,b,d){if(this.valid){var e=c.worldTransform;e.identity();e.translate(0,2*this.projection.y);b&&e.append(b);e.scale(1,-1);c.worldAlpha=1;b=c.children;for(var e=0,g=b.length;g>e;e++)b[e].updateTransform();b=this.renderer.gl;b.viewport(0,0,this.width*this.resolution,this.height*this.resolution);b.bindFramebuffer(b.FRAMEBUFFER,this.textureBuffer.frameBuffer);d&&this.textureBuffer.clear();this.renderer.spriteBatch.dirty=
!0;this.renderer.renderDisplayObject(c,this.projection,this.textureBuffer.frameBuffer);this.renderer.spriteBatch.dirty=!0}};c.RenderTexture.prototype.renderCanvas=function(c,b,d){if(this.valid){var e=c.worldTransform;e.identity();b&&e.append(b);b=c.children;for(var e=0,g=b.length;g>e;e++)b[e].updateTransform();d&&this.textureBuffer.clear();d=this.textureBuffer.context;b=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(c,d);this.renderer.resolution=
b}};c.RenderTexture.prototype.getImage=function(){var c=new Image;return c.src=this.getBase64(),c};c.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};c.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===c.WEBGL_RENDERER){var f=this.renderer.gl,b=this.textureBuffer.width,d=this.textureBuffer.height,e=new Uint8Array(4*b*d);f.bindFramebuffer(f.FRAMEBUFFER,this.textureBuffer.frameBuffer);f.readPixels(0,0,b,d,f.RGBA,f.UNSIGNED_BYTE,e);f.bindFramebuffer(f.FRAMEBUFFER,
null);for(var f=new c.CanvasBuffer(b,d),b=f.context.getImageData(0,0,b,d),d=b.data,g=0;g<e.length;g+=4){var h=e[g+3];d[g]=e[g]*h;d[g+1]=e[g+1]*h;d[g+2]=e[g+2]*h;d[g+3]=h}return f.context.putImageData(b,0,0),f.canvas}return this.textureBuffer.canvas};c.RenderTexture.tempMatrix=new c.Matrix;c.AbstractFilter=function(c,b){this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.uniforms=b||{};this.fragmentSrc=c||[]};c.AbstractFilter.prototype.constructor=c.AbstractFilter;c.AbstractFilter.prototype.syncUniforms=
function(){for(var c=0,b=this.shaders.length;b>c;c++)this.shaders[c].dirty=!0};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.PIXI=c):"undefined"!=typeof define&&define.amd?define("PIXI",this.PIXI=c):this.PIXI=c}).call(this);
(function(){var c=c||{VERSION:"2.1.3",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,
EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1}};if(PIXI.InteractionManager=PIXI.InteractionManager||function(){},PIXI.dontSayHello=!0,c.Utils={getProperty:function(b,d){for(var c=d.split("."),g=c.pop(),h=c.length,l=1,f=c[0];h>l&&(b=b[f]);)f=c[l],l++;return b?b[g]:null},setProperty:function(b,d,c){d=d.split(".");for(var g=d.pop(),h=d.length,l=1,f=d[0];h>l&&(b=b[f]);)f=d[l],l++;return b&&(b[g]=c),b},transposeArray:function(b){for(var d=Array(b[0].length),
c=0;c<b[0].length;c++){d[c]=Array(b.length-1);for(var g=b.length-1;-1<g;g--)d[c][g]=b[g][c]}return d},rotateArray:function(b,d){if("string"!=typeof d&&(d=(d%360+360)%360),90===d||-270===d||"rotateLeft"===d)b=c.Utils.transposeArray(b),b=b.reverse();else if(-90===d||270===d||"rotateRight"===d)b=b.reverse(),b=c.Utils.transposeArray(b);else if(180===Math.abs(d)||"rotate180"===d){for(var e=0;e<b.length;e++)b[e].reverse();b=b.reverse()}return b},parseDimension:function(b,d){var c=0,g=0;return"string"==
typeof b?"%"===b.substr(-1)?(c=parseInt(b,10)/100,g=0===d?window.innerWidth*c:window.innerHeight*c):g=parseInt(b,10):g=b,g},shuffle:function(b){for(var d=b.length-1;0<d;d--){var c=Math.floor(Math.random()*(d+1)),g=b[d];b[d]=b[c];b[c]=g}return b},pad:function(b,d,c,g){"undefined"==typeof d&&(d=0);"undefined"==typeof c&&(c=" ");"undefined"==typeof g&&(g=3);var h=0;if(d+1>=b.length)switch(g){case 1:b=Array(d+1-b.length).join(c)+b;break;case 3:d=Math.ceil((h=d-b.length)/2);b=Array(h-d+1).join(c)+b+Array(d+
1).join(c);break;default:b+=Array(d+1-b.length).join(c)}return b},isPlainObject:function(b){if("object"!=typeof b||b.nodeType||b===b.window)return!1;try{if(b.constructor&&!{}.hasOwnProperty.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}return!0},extend:function(){var b,d,e,g,h,l,f=arguments[0]||{},m=1,n=arguments.length,p=!1;"boolean"==typeof f&&(p=f,f=arguments[1]||{},m=2);for(n===m&&(f=this,--m);n>m;m++)if(null!=(b=arguments[m]))for(d in b)e=f[d],g=b[d],f!==g&&(p&&g&&
(c.Utils.isPlainObject(g)||(h=Array.isArray(g)))?(h?(h=!1,l=e&&Array.isArray(e)?e:[]):l=e&&c.Utils.isPlainObject(e)?e:{},f[d]=c.Utils.extend(p,l,g)):void 0!==g&&(f[d]=g));return f},mixin:function(b,d){if(!b||"object"!=typeof b)return d;for(var e in b){var g=b[e];if(!g.childNodes&&!g.cloneNode){var h=typeof b[e];d[e]=b[e]&&"object"===h?typeof d[e]===h?c.Utils.mixin(b[e],d[e]):c.Utils.mixin(b[e],new g.constructor):b[e]}}return d}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=
function(){var b=Array.prototype.slice;return function(d){function c(){var l=h.concat(b.call(arguments));g.apply(this instanceof c?this:d,l)}var g=this,h=b.call(arguments,1);if("function"!=typeof g)throw new TypeError;return c.prototype=function k(b){return b&&(k.prototype=b),this instanceof k?void 0:new k}(g.prototype),c}}()),Array.isArray||(Array.isArray=function(b){return"[object Array]"==Object.prototype.toString.call(b)}),Array.prototype.forEach||(Array.prototype.forEach=function(b){if(void 0===
this||null===this)throw new TypeError;var d=Object(this),c=d.length>>>0;if("function"!=typeof b)throw new TypeError;for(var g=2<=arguments.length?arguments[1]:void 0,h=0;c>h;h++)h in d&&b.call(g,d[h],h,d)}),"function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array){var f=function(b){window[b]=function(b){if("number"==typeof b){Array.call(this,b);this.length=b;for(var c=0;c<this.length;c++)this[c]=0}else for(Array.call(this,b.length),this.length=b.length,c=0;c<this.length;c++)this[c]=
b[c]};window[b].prototype=[];window[b].constructor=window[b]};f("Uint32Array");f("Int16Array")}window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){});c.Circle=function(b,d,c){c=c||0;this.x=b||0;this.y=d||0;this._diameter=c;this._radius=0<c?.5*c:0};c.Circle.prototype={type:null,circumference:function(){return 2*Math.PI*this._radius},getBounds:function(){return new c.Rectangle(this.x-this.radius,this.y-this.radius,
2*this.radius,2*this.radius)},setTo:function(b,d,c){return this.x=b,this.y=d,this._diameter=c,this._radius=.5*c,this},copyFrom:function(b){return this.setTo(b.x,b.y,b.diameter)},copyTo:function(b){return b.x=this.x,b.y=this.y,b.diameter=this._diameter,b},distance:function(b,d){return"undefined"==typeof d&&(d=!1),d?c.Math.distanceRounded(this.x,this.y,b.x,b.y):c.Math.distance(this.x,this.y,b.x,b.y)},clone:function(b){return"undefined"==typeof b||null===b?b=new c.Circle(this.x,this.y,this.diameter):
b.setTo(this.x,this.y,this.diameter),b},contains:function(b,d){return c.Circle.contains(this,b,d)},circumferencePoint:function(b,d,e){return c.Circle.circumferencePoint(this,b,d,e)},offset:function(b,d){return this.x+=b,this.y+=d,this},offsetPoint:function(b){return this.offset(b.x,b.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}};c.Circle.prototype.constructor=c.Circle;Object.defineProperty(c.Circle.prototype,"diameter",
{get:function(){return this._diameter},set:function(b){0<b&&(this._diameter=b,this._radius=.5*b)}});Object.defineProperty(c.Circle.prototype,"radius",{get:function(){return this._radius},set:function(b){0<b&&(this._radius=b,this._diameter=2*b)}});Object.defineProperty(c.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(b){b>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-b}});Object.defineProperty(c.Circle.prototype,"right",{get:function(){return this.x+
this._radius},set:function(b){b<this.x?(this._radius=0,this._diameter=0):this.radius=b-this.x}});Object.defineProperty(c.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(b){b>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-b}});Object.defineProperty(c.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(b){b<this.y?(this._radius=0,this._diameter=0):this.radius=b-this.y}});Object.defineProperty(c.Circle.prototype,"area",{get:function(){return 0<
this._radius?Math.PI*this._radius*this._radius:0}});Object.defineProperty(c.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(b){!0===b&&this.setTo(0,0,0)}});c.Circle.contains=function(b,d,c){return 0<b.radius&&d>=b.left&&d<=b.right&&c>=b.top&&c<=b.bottom?(b.x-d)*(b.x-d)+(b.y-c)*(b.y-c)<=b.radius*b.radius:!1};c.Circle.equals=function(b,d){return b.x==d.x&&b.y==d.y&&b.diameter==d.diameter};c.Circle.intersects=function(b,d){return c.Math.distance(b.x,b.y,d.x,d.y)<=b.radius+
d.radius};c.Circle.circumferencePoint=function(b,d,e,g){return"undefined"==typeof e&&(e=!1),"undefined"==typeof g&&(g=new c.Point),!0===e&&(d=c.Math.degToRad(d)),g.x=b.x+b.radius*Math.cos(d),g.y=b.y+b.radius*Math.sin(d),g};c.Circle.intersectsRectangle=function(b,d){var c=Math.abs(b.x-d.x-d.halfWidth);if(c>d.halfWidth+b.radius)return!1;var g=Math.abs(b.y-d.y-d.halfHeight);if(g>d.halfHeight+b.radius)return!1;if(c<=d.halfWidth||g<=d.halfHeight)return!0;c-=d.halfWidth;g-=d.halfHeight;return b.radius*
b.radius>=c*c+g*g};PIXI.Circle=c.Circle;c.Point=function(b,d){this.x=b||0;this.y=d||0};c.Point.prototype={copyFrom:function(b){return this.setTo(b.x,b.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(b,d){return this.x=b||0,this.y=d||(0!==d?this.x:0),this},set:function(b,d){return this.x=b||0,this.y=d||(0!==d?this.x:0),this},add:function(b,d){return this.x+=b,this.y+=d,this},subtract:function(b,d){return this.x-=b,this.y-=d,this},multiply:function(b,d){return this.x*=b,this.y*=
d,this},divide:function(b,d){return this.x/=b,this.y/=d,this},clampX:function(b,d){return this.x=c.Math.clamp(this.x,b,d),this},clampY:function(b,d){return this.y=c.Math.clamp(this.y,b,d),this},clamp:function(b,d){return this.x=c.Math.clamp(this.x,b,d),this.y=c.Math.clamp(this.y,b,d),this},clone:function(b){return"undefined"==typeof b||null===b?b=new c.Point(this.x,this.y):b.setTo(this.x,this.y),b},copyTo:function(b){return b.x=this.x,b.y=this.y,b},distance:function(b,d){return c.Point.distance(this,
b,d)},equals:function(b){return b.x===this.x&&b.y===this.y},angle:function(b,d){return"undefined"==typeof d&&(d=!1),d?c.Math.radToDeg(Math.atan2(b.y-this.y,b.x-this.x)):Math.atan2(b.y-this.y,b.x-this.x)},angleSq:function(b){return this.subtract(b).angle(b.subtract(this))},rotate:function(b,d,e,g,h){return c.Point.rotate(this,b,d,e,g,h)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(b){return this.normalize().multiply(b,
b)},normalize:function(){if(!this.isZero()){var b=this.getMagnitude();this.x/=b;this.y/=b}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(b){return this.x*b.x+this.y*b.y},cross:function(b){return this.x*b.y-this.y*b.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}};c.Point.prototype.constructor=
c.Point;c.Point.add=function(b,d,e){return"undefined"==typeof e&&(e=new c.Point),e.x=b.x+d.x,e.y=b.y+d.y,e};c.Point.subtract=function(b,d,e){return"undefined"==typeof e&&(e=new c.Point),e.x=b.x-d.x,e.y=b.y-d.y,e};c.Point.multiply=function(b,d,e){return"undefined"==typeof e&&(e=new c.Point),e.x=b.x*d.x,e.y=b.y*d.y,e};c.Point.divide=function(b,d,e){return"undefined"==typeof e&&(e=new c.Point),e.x=b.x/d.x,e.y=b.y/d.y,e};c.Point.equals=function(b,d){return b.x===d.x&&b.y===d.y};c.Point.angle=function(b,
d){return Math.atan2(b.y-d.y,b.x-d.x)};c.Point.angleSq=function(b,d){return b.subtract(d).angle(d.subtract(b))};c.Point.negative=function(b,d){return"undefined"==typeof d&&(d=new c.Point),d.setTo(-b.x,-b.y)};c.Point.multiplyAdd=function(b,d,e,g){return"undefined"==typeof g&&(g=new c.Point),g.setTo(b.x+d.x*e,b.y+d.y*e)};c.Point.interpolate=function(b,d,e,g){return"undefined"==typeof g&&(g=new c.Point),g.setTo(b.x+(d.x-b.x)*e,b.y+(d.y-b.y)*e)};c.Point.perp=function(b,d){return"undefined"==typeof d&&
(d=new c.Point),d.setTo(-b.y,b.x)};c.Point.rperp=function(b,d){return"undefined"==typeof d&&(d=new c.Point),d.setTo(b.y,-b.x)};c.Point.distance=function(b,d,e){return"undefined"==typeof e&&(e=!1),e?c.Math.distanceRounded(b.x,b.y,d.x,d.y):c.Math.distance(b.x,b.y,d.x,d.y)};c.Point.project=function(b,d,e){"undefined"==typeof e&&(e=new c.Point);b=b.dot(d)/d.getMagnitudeSq();return 0!==b&&e.setTo(b*d.x,b*d.y),e};c.Point.projectUnit=function(b,d,e){"undefined"==typeof e&&(e=new c.Point);b=b.dot(d);return 0!==
b&&e.setTo(b*d.x,b*d.y),e};c.Point.normalRightHand=function(b,d){return"undefined"==typeof d&&(d=new c.Point),d.setTo(-1*b.y,b.x)};c.Point.normalize=function(b,d){"undefined"==typeof d&&(d=new c.Point);var e=b.getMagnitude();return 0!==e&&d.setTo(b.x/e,b.y/e),d};c.Point.rotate=function(b,d,e,g,h,l){l=l||null;h&&(g=c.Math.degToRad(g));null===l&&(l=Math.sqrt((d-b.x)*(d-b.x)+(e-b.y)*(e-b.y)));g+=Math.atan2(b.y-e,b.x-d);return b.setTo(d+l*Math.cos(g),e+l*Math.sin(g))};c.Point.centroid=function(b,d){if("undefined"==
typeof d&&(d=new c.Point),"[object Array]"!==Object.prototype.toString.call(b))throw Error("Phaser.Point. Parameter 'points' must be an array");var e=b.length;if(1>e)throw Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===e)return d.copyFrom(b[0]),d;for(var g=0;e>g;g++)c.Point.add(d,b[g],d);return d.divide(e,e),d};c.Point.parse=function(b,d,e){d=d||"x";e=e||"y";var g=new c.Point;return b[d]&&(g.x=parseInt(b[d],10)),b[e]&&(g.y=parseInt(b[e],10)),g};PIXI.Point=c.Point;c.Rectangle=
function(b,d,c,g){this.x=b||0;this.y=d||0;this.width=c||0;this.height=g||0};c.Rectangle.prototype={offset:function(b,d){return this.x+=b,this.y+=d,this},offsetPoint:function(b){return this.offset(b.x,b.y)},setTo:function(b,d,c,g){return this.x=b,this.y=d,this.width=c,this.height=g,this},scale:function(b,d){return"undefined"==typeof d&&(d=b),this.width*=b,this.height*=d,this},centerOn:function(b,d){return this.centerX=b,this.centerY=d,this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y)},
floorAll:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.width=Math.floor(this.width);this.height=Math.floor(this.height)},copyFrom:function(b){return this.setTo(b.x,b.y,b.width,b.height)},copyTo:function(b){return b.x=this.x,b.y=this.y,b.width=this.width,b.height=this.height,b},inflate:function(b,d){return c.Rectangle.inflate(this,b,d)},size:function(b){return c.Rectangle.size(this,b)},clone:function(b){return c.Rectangle.clone(this,b)},contains:function(b,d){return c.Rectangle.contains(this,
b,d)},containsRect:function(b){return c.Rectangle.containsRect(b,this)},equals:function(b){return c.Rectangle.equals(this,b)},intersection:function(b,d){return c.Rectangle.intersection(this,b,d)},intersects:function(b,d){return c.Rectangle.intersects(this,b,d)},intersectsRaw:function(b,d,e,g,h){return c.Rectangle.intersectsRaw(this,b,d,e,g,h)},union:function(b,d){return c.Rectangle.union(this,b,d)},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+
" empty="+this.empty+")}]"}};Object.defineProperty(c.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}});Object.defineProperty(c.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}});Object.defineProperty(c.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(b){this.height=b<=this.y?0:b-this.y}});Object.defineProperty(c.Rectangle.prototype,"bottomRight",{get:function(){return new c.Point(this.right,this.bottom)},
set:function(b){this.right=b.x;this.bottom=b.y}});Object.defineProperty(c.Rectangle.prototype,"left",{get:function(){return this.x},set:function(b){this.width=b>=this.right?0:this.right-b;this.x=b}});Object.defineProperty(c.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(b){this.width=b<=this.x?0:b-this.x}});Object.defineProperty(c.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}});Object.defineProperty(c.Rectangle.prototype,"perimeter",
{get:function(){return 2*this.width+2*this.height}});Object.defineProperty(c.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(b){this.x=b-this.halfWidth}});Object.defineProperty(c.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(b){this.y=b-this.halfHeight}});Object.defineProperty(c.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}});Object.defineProperty(c.Rectangle.prototype,"randomY",
{get:function(){return this.y+Math.random()*this.height}});Object.defineProperty(c.Rectangle.prototype,"top",{get:function(){return this.y},set:function(b){b>=this.bottom?(this.height=0,this.y=b):this.height=this.bottom-b}});Object.defineProperty(c.Rectangle.prototype,"topLeft",{get:function(){return new c.Point(this.x,this.y)},set:function(b){this.x=b.x;this.y=b.y}});Object.defineProperty(c.Rectangle.prototype,"topRight",{get:function(){return new c.Point(this.x+this.width,this.y)},set:function(b){this.right=
b.x;this.y=b.y}});Object.defineProperty(c.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(b){!0===b&&this.setTo(0,0,0,0)}});c.Rectangle.prototype.constructor=c.Rectangle;c.Rectangle.inflate=function(b,d,c){return b.x-=d,b.width+=2*d,b.y-=c,b.height+=2*c,b};c.Rectangle.inflatePoint=function(b,d){return c.Rectangle.inflate(b,d.x,d.y)};c.Rectangle.size=function(b,d){return"undefined"==typeof d||null===d?d=new c.Point(b.width,b.height):d.setTo(b.width,b.height),
d};c.Rectangle.clone=function(b,d){return"undefined"==typeof d||null===d?d=new c.Rectangle(b.x,b.y,b.width,b.height):d.setTo(b.x,b.y,b.width,b.height),d};c.Rectangle.contains=function(b,d,c){return 0>=b.width||0>=b.height?!1:d>=b.x&&d<b.right&&c>=b.y&&c<b.bottom};c.Rectangle.containsRaw=function(b,d,c,g,h,l){return h>=b&&b+c>h&&l>=d&&d+g>l};c.Rectangle.containsPoint=function(b,d){return c.Rectangle.contains(b,d.x,d.y)};c.Rectangle.containsRect=function(b,d){return b.volume>d.volume?!1:b.x>=d.x&&b.y>=
d.y&&b.right<d.right&&b.bottom<d.bottom};c.Rectangle.equals=function(b,d){return b.x==d.x&&b.y==d.y&&b.width==d.width&&b.height==d.height};c.Rectangle.intersection=function(b,d,e){return"undefined"==typeof e&&(e=new c.Rectangle),c.Rectangle.intersects(b,d)&&(e.x=Math.max(b.x,d.x),e.y=Math.max(b.y,d.y),e.width=Math.min(b.right,d.right)-e.x,e.height=Math.min(b.bottom,d.bottom)-e.y),e};c.Rectangle.intersects=function(b,d){return 0>=b.width||0>=b.height||0>=d.width||0>=d.height?!1:!(b.right<d.x||b.bottom<
d.y||b.x>d.right||b.y>d.bottom)};c.Rectangle.intersectsRaw=function(b,d,c,g,h,l){return"undefined"==typeof l&&(l=0),!(d>b.right+l||c<b.left-l||g>b.bottom+l||h<b.top-l)};c.Rectangle.union=function(b,d,e){return"undefined"==typeof e&&(e=new c.Rectangle),e.setTo(Math.min(b.x,d.x),Math.min(b.y,d.y),Math.max(b.right,d.right)-Math.min(b.left,d.left),Math.max(b.bottom,d.bottom)-Math.min(b.top,d.top))};c.Rectangle.aabb=function(b,d){"undefined"==typeof d&&(d=new c.Rectangle);var e=Number.MIN_VALUE,g=Number.MAX_VALUE,
h=Number.MIN_VALUE,l=Number.MAX_VALUE;return b.forEach(function(b){b.x>e&&(e=b.x);b.x<g&&(g=b.x);b.y>h&&(h=b.y);b.y<l&&(l=b.y)}),d.setTo(g,l,e-g,h-l),d};PIXI.Rectangle=c.Rectangle;PIXI.EmptyRectangle=new c.Rectangle(0,0,0,0);c.Line=function(b,d,e,g){e=e||0;g=g||0;this.start=new c.Point(b||0,d||0);this.end=new c.Point(e,g)};c.Line.prototype={setTo:function(b,d,c,g){return this.start.setTo(b,d),this.end.setTo(c,g),this},fromSprite:function(b,d,c){return"undefined"==typeof c&&(c=!1),c?this.setTo(b.center.x,
b.center.y,d.center.x,d.center.y):this.setTo(b.x,b.y,d.x,d.y)},intersects:function(b,d,e){return c.Line.intersectsPoints(this.start,this.end,b.start,b.end,d,e)},pointOnLine:function(b,d){return(b-this.start.x)*(this.end.y-this.start.y)===(this.end.x-this.start.x)*(d-this.start.y)},pointOnSegment:function(b,d){var c=Math.min(this.start.x,this.end.x),g=Math.max(this.start.x,this.end.x),h=Math.min(this.start.y,this.end.y),l=Math.max(this.start.y,this.end.y);return this.pointOnLine(b,d)&&b>=c&&g>=b&&
d>=h&&l>=d},coordinatesOnLine:function(b,d){"undefined"==typeof b&&(b=1);"undefined"==typeof d&&(d=[]);var c=Math.round(this.start.x),g=Math.round(this.start.y),h=Math.round(this.end.x),l=Math.round(this.end.y),f=Math.abs(h-c),m=Math.abs(l-g),n=h>c?1:-1,p=l>g?1:-1,q=f-m;d.push([c,g]);for(var r=1;c!=h||g!=l;){var t=q<<1;t>-m&&(q-=m,c+=n);f>t&&(q+=f,g+=p);0===r%b&&d.push([c,g]);r++}return d},clone:function(b){return"undefined"==typeof b||null===b?b=new c.Line(this.start.x,this.start.y,this.end.x,this.end.y):
b.setTo(this.start.x,this.start.y,this.end.x,this.end.y),b}};Object.defineProperty(c.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}});Object.defineProperty(c.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}});Object.defineProperty(c.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}});
Object.defineProperty(c.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}});Object.defineProperty(c.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(c.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(c.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(c.Line.prototype,"right",{get:function(){return Math.max(this.start.x,
this.end.x)}});Object.defineProperty(c.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(c.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}});Object.defineProperty(c.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}});Object.defineProperty(c.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}});c.Line.intersectsPoints=function(b,d,e,g,h,l){"undefined"==
typeof h&&(h=!0);"undefined"==typeof l&&(l=new c.Point);var f=d.y-b.y,m=g.y-e.y,n=b.x-d.x,p=e.x-g.x,q=d.x*b.y-b.x*d.y,r=g.x*e.y-e.x*g.y,t=f*p-m*n;return 0===t?null:(l.x=(n*r-p*q)/t,l.y=(m*q-f*r)/t,h)?(h=(g.y-e.y)*(d.x-b.x)-(g.x-e.x)*(d.y-b.y),g=((g.x-e.x)*(b.y-e.y)-(g.y-e.y)*(b.x-e.x))/h,b=((d.x-b.x)*(b.y-e.y)-(d.y-b.y)*(b.x-e.x))/h,0<=g&&1>=g&&0<=b&&1>=b?l:null):l};c.Line.intersects=function(b,d,e,g){return c.Line.intersectsPoints(b.start,b.end,d.start,d.end,e,g)};c.Ellipse=function(b,d,e,g){this.type=
c.ELLIPSE;this.x=b||0;this.y=d||0;this.width=e||0;this.height=g||0};c.Ellipse.prototype={setTo:function(b,d,c,g){return this.x=b,this.y=d,this.width=c,this.height=g,this},getBounds:function(){return new c.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(b){return this.setTo(b.x,b.y,b.width,b.height)},copyTo:function(b){return b.x=this.x,b.y=this.y,b.width=this.width,b.height=this.height,b},clone:function(b){return"undefined"==typeof b||null===b?b=new c.Ellipse(this.x,
this.y,this.width,this.height):b.setTo(this.x,this.y,this.width,this.height),b},contains:function(b,d){return c.Ellipse.contains(this,b,d)},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}};c.Ellipse.prototype.constructor=c.Ellipse;Object.defineProperty(c.Ellipse.prototype,"left",{get:function(){return this.x},set:function(b){this.x=b}});Object.defineProperty(c.Ellipse.prototype,"right",{get:function(){return this.x+this.width},
set:function(b){this.width=b<this.x?0:this.x+b}});Object.defineProperty(c.Ellipse.prototype,"top",{get:function(){return this.y},set:function(b){this.y=b}});Object.defineProperty(c.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(b){this.height=b<this.y?0:this.y+b}});Object.defineProperty(c.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(b){!0===b&&this.setTo(0,0,0,0)}});c.Ellipse.contains=function(b,d,c){if(0>=b.width||
0>=b.height)return!1;d=(d-b.x)/b.width-.5;b=(c-b.y)/b.height-.5;return d*=d,b*=b,.25>d+b};c.Ellipse.prototype.getBounds=function(){return new c.Rectangle(this.x,this.y,this.width,this.height)};PIXI.Ellipse=c.Ellipse;c.Polygon=function(b){if(this.type=c.POLYGON,b instanceof Array||(b=Array.prototype.slice.call(arguments)),b[0]instanceof c.Point){for(var d=[],e=0,g=b.length;g>e;e++)d.push(b[e].x,b[e].y);b=d}this.points=b;this.closed=!0};c.Polygon.prototype={clone:function(b){var d=this.points.slice();
return"undefined"==typeof b||null===b?b=new c.Polygon(d):b.setTo(d),b},contains:function(b,d){for(var c=!1,g=this.points.length/2,h=0,l=g-1;g>h;l=h++){var f=this.points[2*h].x,m=this.points[2*h+1].y,n=this.points[2*l].x,l=this.points[2*l+1].y;m>d!=l>d&&(n-f)*(d-m)/(l-m)+f>b&&(c=!c)}return c},setTo:function(b){if(b instanceof Array||(b=Array.prototype.slice.call(arguments)),b[0]instanceof c.Point){for(var d=[],e=0,g=b.length;g>e;e++)d.push(b[e].x,b[e].y);b=d}return this.points=b,this}};c.Polygon.prototype.constructor=
c.Polygon;Object.defineProperty(c.Polygon.prototype,"points",{get:function(){return this._points},set:function(b){if(b instanceof Array||(b=Array.prototype.slice.call(arguments)),"number"==typeof b[0]){for(var d=[],e=0,g=b.length;g>e;e+=2)d.push(new c.Point(b[e],b[e+1]));b=d}this._points=b}});Object.defineProperty(c.Polygon.prototype,"area",{get:function(){var b,d,c,g,h=Number.MAX_VALUE,l=0;for(g=0;g<this.points.length;g++)this.points[g].y<h&&(h=this.points[g].y);for(g=0;g<this.points.length;g++)b=
this.points[g],d=g===this.points.length-1?this.points[0]:this.points[g+1],c=(b.y-h+(d.y-h))/2,b=b.x-d.x,l+=c*b;return l}});PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineColor=this.lineWidth=0;this.graphicsData=[];this.tint=16777215;this.blendMode=PIXI.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=!1;this.boundsPadding=0;this.dirty=!0;this.cachedSpriteDirty=this.webGLDirty=!1};PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
PIXI.Graphics.prototype.constructor=PIXI.Graphics;Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(b){(this._cacheAsBitmap=b)?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}});PIXI.Graphics.prototype.lineStyle=function(b,d,c){if(this.lineWidth=b||0,this.lineColor=d||0,this.lineAlpha=3>arguments.length?1:c,this.currentPath){if(this.currentPath.shape.points.length)return this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))),
this;this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha}return this};PIXI.Graphics.prototype.moveTo=function(b,d){return this.drawShape(new PIXI.Polygon([b,d])),this};PIXI.Graphics.prototype.lineTo=function(b,d){return this.currentPath.shape.points.push(b,d),this.dirty=!0,this};PIXI.Graphics.prototype.quadraticCurveTo=function(b,d,c,g){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=
[0,0]):this.moveTo(0,0);var h,l,f=this.currentPath.shape.points;0===f.length&&this.moveTo(0,0);for(var m=f[f.length-2],n=f[f.length-1],p=0,q=1;20>=q;q++)p=q/20,h=m+(b-m)*p,l=n+(d-n)*p,f.push(h+(b+(c-b)*p-h)*p,l+(d+(g-d)*p-l)*p);return this.dirty=!0,this};PIXI.Graphics.prototype.bezierCurveTo=function(b,d,c,g,h,l){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var f,m,n,p,q,r=this.currentPath.shape.points,t=r[r.length-2],w=r[r.length-
1],v=0,u=1;20>=u;u++)v=u/20,f=1-v,m=f*f,n=m*f,p=v*v,q=p*v,r.push(n*t+3*m*v*b+3*f*p*c+q*h,n*w+3*m*v*d+3*f*p*g+q*l);return this.dirty=!0,this};PIXI.Graphics.prototype.arcTo=function(b,d,c,g,h){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[b,d]):this.moveTo(b,d);0===this.currentPath.length&&this.moveTo(b,d);var l=this.currentPath,f=l[l.length-1]-d,m=l[l.length-2]-b;g-=d;c-=b;var n=Math.abs(f*c-m*g);if(1E-8>n||0===h)l.push(b,d);else{var p=f*f+m*m,q=g*g+c*c,
r=f*g+m*c,l=h*Math.sqrt(p)/n,n=h*Math.sqrt(q)/n,p=l*r/p,t=n*r/q,q=l*c+n*m,r=l*g+n*f,w=c*(l+t),l=g*(l+t),n=Math.atan2(f*(n+p)-r,m*(n+p)-q),l=Math.atan2(l-r,w-q);this.arc(q+b,r+d,h,n,l,m*g>c*f)}return this.dirty=!0,this};PIXI.Graphics.prototype.arc=function(b,d,c,g,h,l){var f=b+Math.cos(g)*c,m=d+Math.sin(g)*c,n=this.currentPath.shape.points;if((0!==n.length&&n[n.length-2]!==f||n[n.length-1]!==m)&&(this.moveTo(f,m),n=this.currentPath.shape.points),g===h)return this;!l&&g>=h?h+=2*Math.PI:l&&h>=g&&(g+=
2*Math.PI);h=l?-1*(g-h):h-g;var p=Math.abs(h)/(2*Math.PI)*40;if(0===h)return this;h/=2*p;l=2*h;for(var f=Math.cos(h),m=Math.sin(h),p=p-1,q=p%1/p,r=0;p>=r;r++){var t=h+g+l*(r+q*r),w=Math.cos(t),t=-Math.sin(t);n.push((f*w+m*t)*c+b,(f*-t+m*w)*c+d)}return this.dirty=!0,this};PIXI.Graphics.prototype.beginFill=function(b,d){return this.filling=!0,this.fillColor=b||0,this.fillAlpha=void 0===d?1:d,this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=
this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this};PIXI.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this};PIXI.Graphics.prototype.drawRect=function(b,d,c,g){return this.drawShape(new PIXI.Rectangle(b,d,c,g)),this};PIXI.Graphics.prototype.drawRoundedRect=function(b,d,c,g,h){return this.drawShape({points:[b,d,c,g,h],type:PIXI.Graphics.RREC}),this};PIXI.Graphics.prototype.drawCircle=function(b,d,c){return this.drawShape(new PIXI.Circle(b,
d,c)),this};PIXI.Graphics.prototype.drawEllipse=function(b,d,c,g){return this.drawShape(new PIXI.Ellipse(b,d,c,g)),this};PIXI.Graphics.prototype.drawPolygon=function(b){return b instanceof Array||(b=Array.prototype.slice.call(arguments)),this.drawShape(new PIXI.Polygon(b)),this};PIXI.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this};PIXI.Graphics.prototype.generateTexture=function(b,d){b=b||1;var c=this.getBounds(),
g=new PIXI.CanvasBuffer(c.width*b,c.height*b),h=PIXI.Texture.fromCanvas(g.canvas,d);return h.baseTexture.resolution=b,g.context.scale(b,b),g.context.translate(-c.x,-c.y),PIXI.CanvasGraphics.renderGraphics(this,g.context),h};PIXI.Graphics.prototype._renderWebGL=function(b){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=
this.alpha,void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,b);if(b.spriteBatch.stop(),b.blendModeManager.setBlendMode(this.blendMode),this._mask&&b.maskManager.pushMask(this._mask,b),this._filters&&b.filterManager.pushFilter(this._filterBlock),this.blendMode!==b.spriteBatch.currentBlendMode){b.spriteBatch.currentBlendMode=this.blendMode;var d=PIXI.blendModesWebGL[b.spriteBatch.currentBlendMode];b.spriteBatch.gl.blendFunc(d[0],d[1])}if(this.webGLDirty&&(this.dirty=!0,this.webGLDirty=
!1),PIXI.WebGLGraphics.renderGraphics(this,b),this.children.length){b.spriteBatch.start();for(var d=0,c=this.children.length;c>d;d++)this.children[d]._renderWebGL(b);b.spriteBatch.stop()}this._filters&&b.filterManager.popFilter();this._mask&&b.maskManager.popMask(this.mask,b);b.drawCount++;b.spriteBatch.start()}};PIXI.Graphics.prototype._renderCanvas=function(b){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),
this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,b);var d=b.context,c=this.worldTransform;this.blendMode!==b.currentBlendMode&&(b.currentBlendMode=this.blendMode,d.globalCompositeOperation=PIXI.blendModesCanvas[b.currentBlendMode]);this._mask&&b.maskManager.pushMask(this._mask,b);var g=b.resolution;d.setTransform(c.a*g,c.b*g,c.c*g,c.d*g,c.tx*g,c.ty*g);PIXI.CanvasGraphics.renderGraphics(this,
d);d=0;for(c=this.children.length;c>d;d++)this.children[d]._renderCanvas(b);this._mask&&b.maskManager.popMask(b)}};PIXI.Graphics.prototype.getBounds=function(b){this.dirty&&(this.updateBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var d=this._bounds,c=d.x,g=d.width+d.x,h=d.y,l=d.height+d.y;b=b||this.worldTransform;var f=b.a,m=b.c,n=b.b,p=b.d,q=b.tx,r=b.ty,t=f*g+n*l+q,w=p*l+m*g+r;b=f*c+n*l+q;var l=p*l+m*c+r,v=f*c+n*h+q,c=p*h+m*c+r,f=f*g+n*h+q,g=p*h+m*g+r,h=t,m=w;return t=t>b?
b:t,t=t>v?v:t,t=t>f?f:t,w=w>l?l:w,w=w>c?c:w,w=w>g?g:w,h=b>h?b:h,h=v>h?v:h,h=f>h?f:h,m=l>m?l:m,m=c>m?c:m,m=g>m?g:m,d.x=t,d.width=h-t,d.y=w,d.height=m-w,d};PIXI.Graphics.prototype.updateBounds=function(){var b=1/0,d=-1/0,c=1/0,g=-1/0;if(this.graphicsData.length)for(var h,l,f,m,n,p=0;p<this.graphicsData.length;p++)if(f=this.graphicsData[p],l=f.type,n=f.lineWidth,h=f.shape,l===PIXI.Graphics.RECT||l===PIXI.Graphics.RRECT)l=h.x-n/2,f=h.y-n/2,m=h.width+n,n=h.height+n,b=b>l?l:b,d=l+m>d?l+m:d,c=c>f?f:c,g=
f+n>g?f+n:g;else if(l===PIXI.Graphics.CIRC)l=h.x,f=h.y,m=h.radius+n/2,n=h.radius+n/2,b=b>l-m?l-m:b,d=l+m>d?l+m:d,c=c>f-n?f-n:c,g=f+n>g?f+n:g;else if(l===PIXI.Graphics.ELIP)l=h.x,f=h.y,m=h.width+n/2,n=h.height+n/2,b=b>l-m?l-m:b,d=l+m>d?l+m:d,c=c>f-n?f-n:c,g=f+n>g?f+n:g;else for(h=h.points,m=0;m<h.length;m+=2)l=h[m],f=h[m+1],b=b>l-n?l-n:b,d=l+n>d?l+n:d,c=c>f-n?f-n:c,g=f+n>g?f+n:g;else g=c=d=b=0;p=this.boundsPadding;n=this._bounds;n.x=b-p;n.width=d-b+2*p;n.y=c-p;n.height=g-c+2*p};PIXI.Graphics.prototype._generateCachedSprite=
function(){var b=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(b.width,b.height);else{var d=new PIXI.CanvasBuffer(b.width,b.height),c=PIXI.Texture.fromCanvas(d.canvas);this._cachedSprite=new PIXI.Sprite(c);this._cachedSprite.buffer=d;this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(b.x/b.width);this._cachedSprite.anchor.y=-(b.y/b.height);this._cachedSprite.buffer.context.translate(-b.x,-b.y);this.worldAlpha=1;PIXI.CanvasGraphics.renderGraphics(this,
this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var b=this._cachedSprite,d=b.texture,c=b.buffer.canvas;d.baseTexture.width=c.width;d.baseTexture.height=c.height;d.crop.width=d.frame.width=c.width;d.crop.height=d.frame.height=c.height;b._width=c.width;b._height=c.height;d.baseTexture.dirty()};PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0);this._cachedSprite=null};PIXI.Graphics.prototype.drawShape=
function(b){this.currentPath&&2>=this.currentPath.shape.points.length&&this.graphicsData.pop();this.currentPath=null;b=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,b);return this.graphicsData.push(b),b.type===PIXI.Graphics.POLY&&(b.shape.closed=this.filling,this.currentPath=b),this.dirty=!0,b};PIXI.GraphicsData=function(b,d,c,g,h,f,k){this.lineWidth=b;this.lineColor=d;this.lineAlpha=c;this.fillColor=g;this.fillAlpha=h;this.fill=f;this.shape=
k;this.type=k.type};PIXI.Graphics.POLY=0;PIXI.Graphics.RECT=1;PIXI.Graphics.CIRC=2;PIXI.Graphics.ELIP=3;PIXI.Graphics.RREC=4;PIXI.Polygon.prototype.type=PIXI.Graphics.POLY;PIXI.Rectangle.prototype.type=PIXI.Graphics.RECT;PIXI.Circle.prototype.type=PIXI.Graphics.CIRC;PIXI.Ellipse.prototype.type=PIXI.Graphics.ELIP;c.Camera=function(b,d,e,g,h,f){this.game=b;this.world=b.world;this.id=0;this.view=new c.Rectangle(e,g,h,f);this.screenView=new c.Rectangle(e,g,h,f);this.bounds=new c.Rectangle(e,g,h,f);this.deadzone=
null;this.roundPx=this.visible=!0;this.atLimit={x:!1,y:!1};this.target=null;this._edge=0;this._position=new c.Point;this.scale=this.displayObject=null;this._targetPosition=new c.Point};c.Camera.FOLLOW_LOCKON=0;c.Camera.FOLLOW_PLATFORMER=1;c.Camera.FOLLOW_TOPDOWN=2;c.Camera.FOLLOW_TOPDOWN_TIGHT=3;c.Camera.prototype={follow:function(b,d){"undefined"==typeof d&&(d=c.Camera.FOLLOW_LOCKON);this.target=b;var e;switch(d){case c.Camera.FOLLOW_PLATFORMER:e=this.width/8;var g=this.height/3;this.deadzone=new c.Rectangle((this.width-
e)/2,(this.height-g)/2-.25*g,e,g);break;case c.Camera.FOLLOW_TOPDOWN:e=Math.max(this.width,this.height)/4;this.deadzone=new c.Rectangle((this.width-e)/2,(this.height-e)/2,e,e);break;case c.Camera.FOLLOW_TOPDOWN_TIGHT:e=Math.max(this.width,this.height)/8;this.deadzone=new c.Rectangle((this.width-e)/2,(this.height-e)/2,e,e);break;case c.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(b){this.setPosition(Math.round(b.x-
this.view.halfWidth),Math.round(b.y-this.view.halfHeight))},focusOnXY:function(b,d){this.setPosition(Math.round(b-this.view.halfWidth),Math.round(d-this.view.halfHeight))},update:function(){this.target&&this.updateTarget();this.bounds&&this.checkBounds();this.roundPx&&this.view.floor();this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},updateTarget:function(){this._targetPosition.copyFrom(this.target).multiply(this.target.parent?this.target.parent.worldTransform.a:
1,this.target.parent?this.target.parent.worldTransform.d:1);this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this._targetPosition.x-this.deadzone.left:this._edge>this.deadzone.right&&(this.view.x=this._targetPosition.x-this.deadzone.right),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this._targetPosition.y-this.deadzone.top:this._edge>this.deadzone.bottom&&(this.view.y=this._targetPosition.y-this.deadzone.bottom)):
(this.view.x=this._targetPosition.x-this.view.halfWidth,this.view.y=this._targetPosition.y-this.view.halfHeight)},setBoundsToWorld:function(){this.bounds&&this.bounds.setTo(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},checkBounds:function(){this.atLimit.x=!1;this.atLimit.y=!1;this.view.x<=this.bounds.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x);this.view.right>=this.bounds.right&&(this.atLimit.x=!0,this.view.x=this.bounds.right-
this.width);this.view.y<=this.bounds.top&&(this.atLimit.y=!0,this.view.y=this.bounds.top);this.view.bottom>=this.bounds.bottom&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom-this.height)},setPosition:function(b,d){this.view.x=b;this.view.y=d;this.bounds&&this.checkBounds()},setSize:function(b,d){this.view.width=b;this.view.height=d},reset:function(){this.target=null;this.view.x=0;this.view.y=0}};c.Camera.prototype.constructor=c.Camera;Object.defineProperty(c.Camera.prototype,"x",{get:function(){return this.view.x},
set:function(b){this.view.x=b;this.bounds&&this.checkBounds()}});Object.defineProperty(c.Camera.prototype,"y",{get:function(){return this.view.y},set:function(b){this.view.y=b;this.bounds&&this.checkBounds()}});Object.defineProperty(c.Camera.prototype,"position",{get:function(){return this._position.set(this.view.centerX,this.view.centerY),this._position},set:function(b){"undefined"!=typeof b.x&&(this.view.x=b.x);"undefined"!=typeof b.y&&(this.view.y=b.y);this.bounds&&this.checkBounds()}});Object.defineProperty(c.Camera.prototype,
"width",{get:function(){return this.view.width},set:function(b){this.view.width=b}});Object.defineProperty(c.Camera.prototype,"height",{get:function(){return this.view.height},set:function(b){this.view.height=b}});c.State=function(){this.rnd=this.physics=this.particles=this.world=this.tweens=this.time=this.stage=this.scale=this.sound=this.math=this.load=this.input=this.cache=this.camera=this.make=this.add=this.game=null};c.State.prototype={preload:function(){},loadUpdate:function(){},loadRender:function(){},
create:function(){},update:function(){},render:function(){},resize:function(){},paused:function(){},pauseUpdate:function(){},shutdown:function(){}};c.State.prototype.constructor=c.State;c.StateManager=function(b,d){this.game=b;this.states={};this._pendingState=null;"undefined"!=typeof d&&null!==d&&(this._pendingState=d);this._created=this._clearCache=this._clearWorld=!1;this._args=[];this.current="";this.onShutDownCallback=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onLoadRenderCallback=
this.onLoadUpdateCallback=this.onPreRenderCallback=this.onResizeCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onPreloadCallback=this.onInitCallback=null};c.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this);this.game.onResume.add(this.resume,this);this.game.load.onLoadComplete.add(this.loadComplete,this);null!==this._pendingState&&"string"!=typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(b,d,e){"undefined"==
typeof e&&(e=!1);var g;return d instanceof c.State?g=d:"object"==typeof d?(g=d,g.game=this.game):"function"==typeof d&&(g=new d(this.game)),this.states[b]=g,e&&(this.game.isBooted?this.start(b):this._pendingState=b),g},remove:function(b){this.current===b&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=
null,this.onResizeCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null);delete this.states[b]},start:function(b,d,c){"undefined"==typeof d&&(d=!0);"undefined"==typeof c&&(c=!1);this.checkState(b)&&(this._pendingState=b,this._clearWorld=d,this._clearCache=c,3<arguments.length&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(b,d){"undefined"==typeof b&&(b=!0);"undefined"==typeof d&&(d=!1);this._pendingState=this.current;this._clearWorld=
b;this._clearCache=d;2<arguments.length&&(this._args=Array.prototype.splice.call(arguments,2))},dummy:function(){},preUpdate:function(){this._pendingState&&this.game.isBooted&&(this.clearCurrentState(),this.setCurrentState(this._pendingState),this.current===this._pendingState)&&(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():
this.game.load.start()):this.loadComplete())},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),!0===this._clearCache&&this.game.cache.destroy()))},checkState:function(b){if(this.states[b]){var d=
!1;return this.states[b].preload&&(d=!0),this.states[b].create&&(d=!0),this.states[b].update&&(d=!0),this.states[b].render&&(d=!0),!1===d?(console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"),!1):!0}return console.warn("Phaser.StateManager - No state found with the key: "+b),!1},link:function(b){this.states[b].game=this.game;this.states[b].add=this.game.add;this.states[b].make=this.game.make;this.states[b].camera=
this.game.camera;this.states[b].cache=this.game.cache;this.states[b].input=this.game.input;this.states[b].load=this.game.load;this.states[b].math=this.game.math;this.states[b].sound=this.game.sound;this.states[b].scale=this.game.scale;this.states[b].state=this;this.states[b].stage=this.game.stage;this.states[b].time=this.game.time;this.states[b].tweens=this.game.tweens;this.states[b].world=this.game.world;this.states[b].particles=this.game.particles;this.states[b].rnd=this.game.rnd;this.states[b].physics=
this.game.physics},unlink:function(b){this.states[b]&&(this.states[b].game=null,this.states[b].add=null,this.states[b].make=null,this.states[b].camera=null,this.states[b].cache=null,this.states[b].input=null,this.states[b].load=null,this.states[b].math=null,this.states[b].sound=null,this.states[b].scale=null,this.states[b].state=null,this.states[b].stage=null,this.states[b].time=null,this.states[b].tweens=null,this.states[b].world=null,this.states[b].particles=null,this.states[b].rnd=null,this.states[b].physics=
null)},setCurrentState:function(b){this.callbackContext=this.states[b];this.link(b);this.onInitCallback=this.states[b].init||this.dummy;this.onPreloadCallback=this.states[b].preload||null;this.onLoadRenderCallback=this.states[b].loadRender||null;this.onLoadUpdateCallback=this.states[b].loadUpdate||null;this.onCreateCallback=this.states[b].create||null;this.onUpdateCallback=this.states[b].update||null;this.onPreRenderCallback=this.states[b].preRender||null;this.onRenderCallback=this.states[b].render||
null;this.onResizeCallback=this.states[b].resize||null;this.onPausedCallback=this.states[b].paused||null;this.onResumedCallback=this.states[b].resumed||null;this.onPauseUpdateCallback=this.states[b].pauseUpdate||null;this.onShutDownCallback=this.states[b].shutdown||this.dummy;this.current=b;this._created=!1;this.onInitCallback.apply(this.callbackContext,this._args);b===this._pendingState&&(this._args=[])},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&
this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created&&this.onUpdateCallback?this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,
this.game)},pauseUpdate:function(){this._created&&this.onPauseUpdateCallback?this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(){this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game)},resize:function(b,d){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,b,d)},render:function(){this._created&&this.onRenderCallback?(this.game.renderType===
c.CANVAS&&(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0)),this.onRenderCallback.call(this.callbackContext,this.game),this.game.renderType===c.CANVAS&&this.game.context.restore()):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this.clearCurrentState();this.game=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=
this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null;this.states={};this._pendingState=null}};c.StateManager.prototype.constructor=c.StateManager;c.LinkedList=function(){this.last=this.first=this.prev=this.next=null;this.total=0};c.LinkedList.prototype={add:function(b){return 0===this.total&&null===this.first&&null===this.last?(this.first=b,this.last=b,this.next=b,b.prev=this,this.total++,b):(this.last.next=b,b.prev=this.last,this.last=
b,this.total++,b)},reset:function(){this.prev=this.next=this.last=this.first=null;this.total=0},remove:function(b){return 1===this.total?(this.reset(),void(b.next=b.prev=null)):(b===this.first?this.first=this.first.next:b===this.last&&(this.last=this.last.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),b.next=b.prev=null,null===this.first&&(this.last=null),void this.total--)},callAll:function(b){if(this.first&&this.last){var d=this.first;do d&&d[b]&&d[b].call(d),d=d.next;while(d!=
this.last.next)}}};c.LinkedList.prototype.constructor=c.LinkedList;c.ArrayList=function(){this.position=this.total=0;this.list=[]};c.ArrayList.prototype={add:function(b){return this.exists(b)||(this.list.push(b),this.total++),b},getIndex:function(b){return this.list.indexOf(b)},exists:function(b){return-1<this.list.indexOf(b)},reset:function(){this.total=this.list.length=0},remove:function(b){var d=this.list.indexOf(b);return-1<d?(this.list.splice(d,1),this.total--,b):void 0},setAll:function(b,d){for(var c=
this.list.length;c--;)this.list[c]&&this.list[c][b]&&(this.list[c][b]=d)},callAll:function(b){for(var d=Array.prototype.splice.call(arguments,1),c=this.list.length;c--;)this.list[c]&&this.list[c][b]&&this.list[c][b].apply(this.list[c],d)}};Object.defineProperty(c.ArrayList.prototype,"first",{get:function(){return this.position=0,0<this.total?this.list[0]:null}});Object.defineProperty(c.ArrayList.prototype,"next",{get:function(){return this.position<this.total?(this.position++,this.list[this.position]):
null}});c.ArrayList.prototype.constructor=c.ArrayList;c.Signal=function(){this._bindings=[];this._prevParams=null;var b=this;this.dispatch=function(){c.Signal.prototype.dispatch.apply(b,arguments)}};c.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(b,d){if("function"!=typeof b)throw Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",d));},_registerListener:function(b,d,e,g){var h,f=this._indexOfListener(b,e);
if(-1!==f){if(h=this._bindings[f],h.isOnce()!==d)throw Error("You cannot add"+(d?"":"Once")+"() then add"+(d?"Once":"")+"() the same listener without removing the relationship first.");}else h=new c.SignalBinding(this,b,d,e,g),this._addBinding(h);return this.memorize&&this._prevParams&&h.execute(this._prevParams),h},_addBinding:function(b){var d=this._bindings.length;do d--;while(this._bindings[d]&&b._priority<=this._bindings[d]._priority);this._bindings.splice(d+1,0,b)},_indexOfListener:function(b,
d){for(var c,g=this._bindings.length;g--;)if(c=this._bindings[g],c._listener===b&&c.context===d)return g;return-1},has:function(b,d){return-1!==this._indexOfListener(b,d)},add:function(b,d,c){return this.validateListener(b,"add"),this._registerListener(b,!1,d,c)},addOnce:function(b,d,c){return this.validateListener(b,"addOnce"),this._registerListener(b,!0,d,c)},remove:function(b,d){this.validateListener(b,"remove");var c=this._indexOfListener(b,d);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,
1)),b},removeAll:function(b){"undefined"==typeof b&&(b=null);for(var d=this._bindings.length;d--;)b?this._bindings[d].context===b&&(this._bindings[d]._destroy(),this._bindings.splice(d,1)):this._bindings[d]._destroy();b||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var b,d=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=d),c){b=this._bindings.slice();
this._shouldPropagate=!0;do c--;while(b[c]&&this._shouldPropagate&&!1!==b[c].execute(d))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};c.Signal.prototype.constructor=c.Signal;c.SignalBinding=function(b,d,c,g,h){this._listener=d;this._isOnce=c;this.context=g;this._signal=b;this._priority=h||0};c.SignalBinding.prototype=
{active:!0,params:null,execute:function(b){var d,c;return this.active&&this._listener&&(c=this.params?this.params.concat(b):b,d=this._listener.apply(this.context,c),this._isOnce&&this.detach()),d},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;
delete this._listener;delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};c.SignalBinding.prototype.constructor=c.SignalBinding;c.Filter=function(b,d,e){this.game=b;this.type=c.WEBGL_FILTER;this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.prevPoint=new c.Point;b=new Date;if(this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,
y:0}},date:{type:"4fv",value:[b.getFullYear(),b.getMonth(),b.getDate(),3600*b.getHours()+60*b.getMinutes()+b.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}},d)for(var g in d)this.uniforms[g]=d[g];this.fragmentSrc=e||[]};c.Filter.prototype={init:function(){},
setResolution:function(b,d){this.uniforms.resolution.value.x=b;this.uniforms.resolution.value.y=d},update:function(b){if("undefined"!=typeof b){var d=b.x/this.game.width;b=1-b.y/this.game.height;d===this.prevPoint.x&&b===this.prevPoint.y||(this.uniforms.mouse.value.x=d.toFixed(2),this.uniforms.mouse.value.y=b.toFixed(2),this.prevPoint.set(d,b))}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},destroy:function(){this.game=null}};c.Filter.prototype.constructor=c.Filter;Object.defineProperty(c.Filter.prototype,
"width",{get:function(){return this.uniforms.resolution.value.x},set:function(b){this.uniforms.resolution.value.x=b}});Object.defineProperty(c.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(b){this.uniforms.resolution.value.y=b}});c.Plugin=function(b,d){"undefined"==typeof d&&(d=null);this.game=b;this.parent=d;this.hasPostRender=this.hasRender=this.hasPostUpdate=this.hasUpdate=this.hasPreUpdate=this.visible=this.active=!1};c.Plugin.prototype={preUpdate:function(){},
update:function(){},render:function(){},postRender:function(){},destroy:function(){this.parent=this.game=null;this.visible=this.active=!1}};c.Plugin.prototype.constructor=c.Plugin;c.PluginManager=function(b){this.game=b;this.plugins=[];this._i=this._len=0};c.PluginManager.prototype={add:function(b){var d=Array.prototype.splice.call(arguments,1),c=!1;return"function"==typeof b?b=new b(this.game,this):(b.game=this.game,b.parent=this),"function"==typeof b.preUpdate&&(b.hasPreUpdate=!0,c=!0),"function"==
typeof b.update&&(b.hasUpdate=!0,c=!0),"function"==typeof b.postUpdate&&(b.hasPostUpdate=!0,c=!0),"function"==typeof b.render&&(b.hasRender=!0,c=!0),"function"==typeof b.postRender&&(b.hasPostRender=!0,c=!0),c?((b.hasPreUpdate||b.hasUpdate||b.hasPostUpdate)&&(b.active=!0),(b.hasRender||b.hasPostRender)&&(b.visible=!0),this._len=this.plugins.push(b),"function"==typeof b.init&&b.init.apply(b,d),b):null},remove:function(b){for(this._i=this._len;this._i--;)if(this.plugins[this._i]===b)return b.destroy(),
this.plugins.splice(this._i,1),void this._len--},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this._len=this.plugins.length=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=
this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll();this.game=null}};c.PluginManager.prototype.constructor=
c.PluginManager;c.Stage=function(b){this.game=b;PIXI.Stage.call(this,0);this.name="_stage_root";this.disableVisibilityChange=this.interactive=!1;this.exists=!0;this.currentRenderOrderID=0;this._hiddenVar="hidden";this._backgroundColor=0;b.config&&this.parseConfig(b.config)};c.Stage.prototype=Object.create(PIXI.Stage.prototype);c.Stage.prototype.constructor=c.Stage;c.Stage.prototype.parseConfig=function(b){b.disableVisibilityChange&&(this.disableVisibilityChange=b.disableVisibilityChange);b.backgroundColor&&
(this.backgroundColor=b.backgroundColor)};c.Stage.prototype.boot=function(){c.Canvas.getOffset(this.game.canvas,this.offset);var b=this;this._onChange=function(d){return b.visibilityChange(d)};c.Canvas.setUserSelect(this.game.canvas,"none");c.Canvas.setTouchAction(this.game.canvas,"none");this.checkVisibility()};c.Stage.prototype.preUpdate=function(){this.currentRenderOrderID=0;for(var b=this.children.length,d=0;b>d;d++)this.children[d].preUpdate()};c.Stage.prototype.update=function(){for(var b=this.children.length;b--;)this.children[b].update()};
c.Stage.prototype.postUpdate=function(){if(this.game.world.camera.target){this.game.world.camera.target.postUpdate();this.game.world.camera.update();for(var b=this.children.length;b--;)this.children[b]!==this.game.world.camera.target&&this.children[b].postUpdate()}else for(this.game.world.camera.update(),b=this.children.length;b--;)this.children[b].postUpdate()};c.Stage.prototype.checkVisibility=function(){(this._hiddenVar=void 0!==document.webkitHidden?"webkitvisibilitychange":void 0!==document.mozHidden?
"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.hidden?"visibilitychange":null)&&document.addEventListener(this._hiddenVar,this._onChange,!1);window.onpagehide=this._onChange;window.onpageshow=this._onChange;window.onblur=this._onChange;window.onfocus=this._onChange;var b=this;this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){c.Stage.prototype.visibilityChange.call(b,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){c.Stage.prototype.visibilityChange.call(b,
{type:"resume"})}))};c.Stage.prototype.visibilityChange=function(b){return"pagehide"===b.type||"blur"===b.type||"pageshow"===b.type||"focus"===b.type?void("pagehide"===b.type||"blur"===b.type?this.game.focusLoss(b):("pageshow"===b.type||"focus"===b.type)&&this.game.focusGain(b)):void(this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===b.type?this.game.gamePaused(b):this.game.gameResumed(b)))};c.Stage.prototype.setBackgroundColor=
function(b){if("string"==typeof b){var d=c.Color.hexToColor(b);this._backgroundColor=c.Color.getColor(d.r,d.g,d.b)}else d=c.Color.getRGB(b),this._backgroundColor=b;this.backgroundColorSplit=[d.r/255,d.g/255,d.b/255];this.backgroundColorString=c.Color.RGBtoString(d.r,d.g,d.b,255,"#")};c.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1);window.onpagehide=null;window.onpageshow=null;window.onblur=null;window.onfocus=null};Object.defineProperty(c.Stage.prototype,
"backgroundColor",{get:function(){return this._backgroundColor},set:function(b){this.game.transparent||this.setBackgroundColor(b)}});Object.defineProperty(c.Stage.prototype,"smoothed",{get:function(){return!PIXI.scaleModes.LINEAR},set:function(b){PIXI.scaleModes.LINEAR=b?0:1}});c.Group=function(b,d,e,g,h,f){"undefined"==typeof g&&(g=!1);"undefined"==typeof h&&(h=!1);"undefined"==typeof f&&(f=c.Physics.ARCADE);this.game=b;"undefined"==typeof d&&(d=b.world);this.name=e||"group";PIXI.DisplayObjectContainer.call(this);
g?this.game.stage.addChild(this):d&&d.addChild(this);this.z=0;this.type=c.GROUP;this.exists=this.alive=!0;this.ignoreDestroy=!1;this.classType=c.Sprite;this.scale=new c.Point(1,1);this.cursor=null;this.cameraOffset=new c.Point;this.enableBody=h;this.enableBodyDebug=!1;this.physicsBodyType=f;this.onDestroy=new c.Signal;this._sortProperty="z";this._cache=[0,0,0,0,1,0,1,0,0,0]};c.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);c.Group.prototype.constructor=c.Group;c.Group.RETURN_NONE=
0;c.Group.RETURN_TOTAL=1;c.Group.RETURN_CHILD=2;c.Group.SORT_ASCENDING=-1;c.Group.SORT_DESCENDING=1;c.Group.prototype.add=function(b,d){return"undefined"==typeof d&&(d=!1),b.parent!==this&&(this.enableBody&&this.game.physics.enable(b,this.physicsBodyType),this.addChild(b),b.z=this.children.length,!d&&b.events&&b.events.onAddedToGroup.dispatch(b,this),null===this.cursor&&(this.cursor=b)),b};c.Group.prototype.addMultiple=function(b,d){if(Array.isArray(b))for(var c=0;c<b.length;c++)this.add(b[c],d);
return b};c.Group.prototype.addAt=function(b,d,c){return"undefined"==typeof c&&(c=!1),b.parent!==this&&(this.enableBody&&this.game.physics.enable(b,this.physicsBodyType),this.addChildAt(b,d),this.updateZ(),!c&&b.events&&b.events.onAddedToGroup.dispatch(b,this),null===this.cursor&&(this.cursor=b)),b};c.Group.prototype.getAt=function(b){return 0>b||b>=this.children.length?-1:this.getChildAt(b)};c.Group.prototype.create=function(b,d,c,g,h){"undefined"==typeof h&&(h=!0);b=new this.classType(this.game,
b,d,c,g);return this.enableBody&&this.game.physics.enable(b,this.physicsBodyType,this.enableBodyDebug),b.exists=h,b.visible=h,b.alive=h,this.addChild(b),b.z=this.children.length,b.events&&b.events.onAddedToGroup.dispatch(b,this),null===this.cursor&&(this.cursor=b),b};c.Group.prototype.createMultiple=function(b,d,c,g){"undefined"==typeof g&&(g=!1);for(var h=0;b>h;h++)this.create(0,0,d,c,g)};c.Group.prototype.updateZ=function(){for(var b=this.children.length;b--;)this.children[b].z=b};c.Group.prototype.resetCursor=
function(b){return"undefined"==typeof b&&(b=0),b>this.children.length-1&&(b=0),this.cursor?(this._cache[8]=b,this.cursor=this.children[this._cache[8]],this.cursor):void 0};c.Group.prototype.next=function(){return this.cursor?(this._cache[8]>=this.children.length-1?this._cache[8]=0:this._cache[8]++,this.cursor=this.children[this._cache[8]],this.cursor):void 0};c.Group.prototype.previous=function(){return this.cursor?(0===this._cache[8]?this._cache[8]=this.children.length-1:this._cache[8]--,this.cursor=
this.children[this._cache[8]],this.cursor):void 0};c.Group.prototype.swap=function(b,d){this.swapChildren(b,d);this.updateZ()};c.Group.prototype.bringToTop=function(b){return b.parent===this&&this.getIndex(b)<this.children.length&&(this.remove(b,!1,!0),this.add(b,!0)),b};c.Group.prototype.sendToBack=function(b){return b.parent===this&&0<this.getIndex(b)&&(this.remove(b,!1,!0),this.addAt(b,0,!0)),b};c.Group.prototype.moveUp=function(b){if(b.parent===this&&this.getIndex(b)<this.children.length-1){var d=
this.getIndex(b);(d=this.getAt(d+1))&&this.swap(b,d)}return b};c.Group.prototype.moveDown=function(b){if(b.parent===this&&0<this.getIndex(b)){var d=this.getIndex(b);(d=this.getAt(d-1))&&this.swap(b,d)}return b};c.Group.prototype.xy=function(b,d,c){return 0>b||b>this.children.length?-1:(this.getChildAt(b).x=d,void(this.getChildAt(b).y=c))};c.Group.prototype.reverse=function(){this.children.reverse();this.updateZ()};c.Group.prototype.getIndex=function(b){return this.children.indexOf(b)};c.Group.prototype.replace=
function(b,d){var e=this.getIndex(b);if(-1!==e)return void 0!==d.parent&&(d.events.onRemovedFromGroup.dispatch(d,this),d.parent.removeChild(d),d.parent instanceof c.Group&&d.parent.updateZ()),this.remove(b),this.addAt(d,e),b};c.Group.prototype.hasProperty=function(b,d){var c=d.length;return 1===c&&d[0]in b?!0:2===c&&d[0]in b&&d[1]in b[d[0]]?!0:3===c&&d[0]in b&&d[1]in b[d[0]]&&d[2]in b[d[0]][d[1]]?!0:4===c&&d[0]in b&&d[1]in b[d[0]]&&d[2]in b[d[0]][d[1]]&&d[3]in b[d[0]][d[1]][d[2]]?!0:!1};c.Group.prototype.setProperty=
function(b,d,c,g,h){if("undefined"==typeof h&&(h=!1),g=g||0,!this.hasProperty(b,d)&&(!h||0<g))return!1;h=d.length;return 1===h?0===g?b[d[0]]=c:1==g?b[d[0]]+=c:2==g?b[d[0]]-=c:3==g?b[d[0]]*=c:4==g&&(b[d[0]]/=c):2===h?0===g?b[d[0]][d[1]]=c:1==g?b[d[0]][d[1]]+=c:2==g?b[d[0]][d[1]]-=c:3==g?b[d[0]][d[1]]*=c:4==g&&(b[d[0]][d[1]]/=c):3===h?0===g?b[d[0]][d[1]][d[2]]=c:1==g?b[d[0]][d[1]][d[2]]+=c:2==g?b[d[0]][d[1]][d[2]]-=c:3==g?b[d[0]][d[1]][d[2]]*=c:4==g&&(b[d[0]][d[1]][d[2]]/=c):4===h&&(0===g?b[d[0]][d[1]][d[2]][d[3]]=
c:1==g?b[d[0]][d[1]][d[2]][d[3]]+=c:2==g?b[d[0]][d[1]][d[2]][d[3]]-=c:3==g?b[d[0]][d[1]][d[2]][d[3]]*=c:4==g&&(b[d[0]][d[1]][d[2]][d[3]]/=c)),!0};c.Group.prototype.checkProperty=function(b,d,e,g){return"undefined"==typeof g&&(g=!1),!c.Utils.getProperty(b,d)&&g?!1:c.Utils.getProperty(b,d)!==e?!1:!0};c.Group.prototype.set=function(b,d,c,g,h,f,k){return"undefined"==typeof k&&(k=!1),d=d.split("."),"undefined"==typeof g&&(g=!1),"undefined"==typeof h&&(h=!1),(!1===g||g&&b.alive)&&(!1===h||h&&b.visible)?
this.setProperty(b,d,c,f,k):void 0};c.Group.prototype.setAll=function(b,d,c,g,h,f){"undefined"==typeof c&&(c=!1);"undefined"==typeof g&&(g=!1);"undefined"==typeof f&&(f=!1);b=b.split(".");h=h||0;for(var k=0,m=this.children.length;m>k;k++)(!c||c&&this.children[k].alive)&&(!g||g&&this.children[k].visible)&&this.setProperty(this.children[k],b,d,h,f)};c.Group.prototype.setAllChildren=function(b,d,e,g,h,f){"undefined"==typeof e&&(e=!1);"undefined"==typeof g&&(g=!1);"undefined"==typeof f&&(f=!1);h=h||0;
for(var k=0,m=this.children.length;m>k;k++)(!e||e&&this.children[k].alive)&&(!g||g&&this.children[k].visible)&&(this.children[k]instanceof c.Group?this.children[k].setAllChildren(b,d,e,g,h,f):this.setProperty(this.children[k],b.split("."),d,h,f))};c.Group.prototype.checkAll=function(b,d,c,g,h){"undefined"==typeof c&&(c=!1);"undefined"==typeof g&&(g=!1);"undefined"==typeof h&&(h=!1);for(var f=0,k=this.children.length;k>f;f++)if((!c||c&&this.children[f].alive)&&(!g||g&&this.children[f].visible)&&!this.checkProperty(this.children[f],
b,d,h))return!1;return!0};c.Group.prototype.addAll=function(b,d,c,g){this.setAll(b,d,c,g,1)};c.Group.prototype.subAll=function(b,d,c,g){this.setAll(b,d,c,g,2)};c.Group.prototype.multiplyAll=function(b,d,c,g){this.setAll(b,d,c,g,3)};c.Group.prototype.divideAll=function(b,d,c,g){this.setAll(b,d,c,g,4)};c.Group.prototype.callAllExists=function(b,d){for(var c=Array.prototype.splice.call(arguments,2),g=0,h=this.children.length;h>g;g++)this.children[g].exists===d&&this.children[g][b]&&this.children[g][b].apply(this.children[g],
c)};c.Group.prototype.callbackFromArray=function(b,d,c){if(1==c){if(b[d[0]])return b[d[0]]}else if(2==c){if(b[d[0]][d[1]])return b[d[0]][d[1]]}else if(3==c){if(b[d[0]][d[1]][d[2]])return b[d[0]][d[1]][d[2]]}else if(4==c){if(b[d[0]][d[1]][d[2]][d[3]])return b[d[0]][d[1]][d[2]][d[3]]}else if(b[d])return b[d];return!1};c.Group.prototype.callAll=function(b,d){if("undefined"!=typeof b){b=b.split(".");var c=b.length;if("undefined"==typeof d||null===d||""===d)d=null;else if("string"==typeof d){d=d.split(".");
var g=d.length}for(var h=Array.prototype.splice.call(arguments,2),f=null,k=null,m=0,n=this.children.length;n>m;m++)f=this.callbackFromArray(this.children[m],b,c),d&&f?(k=this.callbackFromArray(this.children[m],d,g),f&&f.apply(k,h)):f&&f.apply(this.children[m],h)}};c.Group.prototype.preUpdate=function(){if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var b=this.children.length;b--;)this.children[b].preUpdate();return!0};c.Group.prototype.update=function(){for(var b=this.children.length;b--;)this.children[b].update()};
c.Group.prototype.postUpdate=function(){1===this._cache[7]&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var b=this.children.length;b--;)this.children[b].postUpdate()};c.Group.prototype.filter=function(b,d){for(var e=-1,g=this.children.length,h=new c.ArrayList;++e<g;){var f=this.children[e];(!d||d&&f.exists)&&b(f,e,this.children)&&h.add(f)}return h};c.Group.prototype.forEach=function(b,d,c){"undefined"==typeof c&&(c=!1);var g=Array.prototype.splice.call(arguments,
3);g.unshift(null);for(var h=0,f=this.children.length;f>h;h++)(!c||c&&this.children[h].exists)&&(g[0]=this.children[h],b.apply(d,g))};c.Group.prototype.forEachExists=function(b,d){var e=Array.prototype.splice.call(arguments,2);e.unshift(null);this.iterate("exists",!0,c.Group.RETURN_TOTAL,b,d,e)};c.Group.prototype.forEachAlive=function(b,d){var e=Array.prototype.splice.call(arguments,2);e.unshift(null);this.iterate("alive",!0,c.Group.RETURN_TOTAL,b,d,e)};c.Group.prototype.forEachDead=function(b,d){var e=
Array.prototype.splice.call(arguments,2);e.unshift(null);this.iterate("alive",!1,c.Group.RETURN_TOTAL,b,d,e)};c.Group.prototype.sort=function(b,d){2>this.children.length||("undefined"==typeof b&&(b="z"),"undefined"==typeof d&&(d=c.Group.SORT_ASCENDING),this._sortProperty=b,this.children.sort(d===c.Group.SORT_ASCENDING?this.ascendingSortHandler.bind(this):this.descendingSortHandler.bind(this)),this.updateZ())};c.Group.prototype.customSort=function(b,d){2>this.children.length||(this.children.sort(b.bind(d)),
this.updateZ())};c.Group.prototype.ascendingSortHandler=function(b,d){return b[this._sortProperty]<d[this._sortProperty]?-1:b[this._sortProperty]>d[this._sortProperty]?1:b.z<d.z?-1:1};c.Group.prototype.descendingSortHandler=function(b,d){return b[this._sortProperty]<d[this._sortProperty]?1:b[this._sortProperty]>d[this._sortProperty]?-1:0};c.Group.prototype.iterate=function(b,d,e,g,h,f){if(e===c.Group.RETURN_TOTAL&&0===this.children.length)return 0;"undefined"==typeof g&&(g=!1);for(var k=0,m=0,n=this.children.length;n>
m;m++)if(this.children[m][b]===d&&(k++,g&&(f[0]=this.children[m],g.apply(h,f)),e===c.Group.RETURN_CHILD))return this.children[m];return e===c.Group.RETURN_TOTAL?k:e===c.Group.RETURN_CHILD?null:void 0};c.Group.prototype.getFirstExists=function(b){return"boolean"!=typeof b&&(b=!0),this.iterate("exists",b,c.Group.RETURN_CHILD)};c.Group.prototype.getFirstAlive=function(){return this.iterate("alive",!0,c.Group.RETURN_CHILD)};c.Group.prototype.getFirstDead=function(){return this.iterate("alive",!1,c.Group.RETURN_CHILD)};
c.Group.prototype.getTop=function(){return 0<this.children.length?this.children[this.children.length-1]:void 0};c.Group.prototype.getBottom=function(){return 0<this.children.length?this.children[0]:void 0};c.Group.prototype.countLiving=function(){return this.iterate("alive",!0,c.Group.RETURN_TOTAL)};c.Group.prototype.countDead=function(){return this.iterate("alive",!1,c.Group.RETURN_TOTAL)};c.Group.prototype.getRandom=function(b,d){return 0===this.children.length?null:(b=b||0,d=d||this.children.length,
this.game.math.getRandom(this.children,b,d))};c.Group.prototype.remove=function(b,d,c){if("undefined"==typeof d&&(d=!1),"undefined"==typeof c&&(c=!1),0===this.children.length||-1===this.children.indexOf(b))return!1;c||!b.events||b.destroyPhase||b.events.onRemovedFromGroup.dispatch(b,this);c=this.removeChild(b);return this.updateZ(),this.cursor===b&&this.next(),d&&c&&c.destroy(!0),!0};c.Group.prototype.removeAll=function(b,d){if("undefined"==typeof b&&(b=!1),"undefined"==typeof d&&(d=!1),0!==this.children.length){do{!d&&
this.children[0].events&&this.children[0].events.onRemovedFromGroup.dispatch(this.children[0],this);var c=this.removeChild(this.children[0]);b&&c&&c.destroy(!0)}while(0<this.children.length);this.cursor=null}};c.Group.prototype.removeBetween=function(b,d,c,g){if("undefined"==typeof d&&(d=this.children.length-1),"undefined"==typeof c&&(c=!1),"undefined"==typeof g&&(g=!1),0!==this.children.length){if(b>d||0>b||d>this.children.length)return!1;for(;d>=b;){!g&&this.children[d].events&&this.children[d].events.onRemovedFromGroup.dispatch(this.children[d],
this);var h=this.removeChild(this.children[d]);c&&h&&h.destroy(!0);this.cursor===this.children[d]&&(this.cursor=null);d--}this.updateZ()}};c.Group.prototype.destroy=function(b,d){null===this.game||this.ignoreDestroy||("undefined"==typeof b&&(b=!0),"undefined"==typeof d&&(d=!1),this.onDestroy.dispatch(this,b,d),this.removeAll(b),this.cursor=null,this.filters=null,d||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))};Object.defineProperty(c.Group.prototype,"total",{get:function(){return this.iterate("exists",
!0,c.Group.RETURN_TOTAL)}});Object.defineProperty(c.Group.prototype,"length",{get:function(){return this.children.length}});Object.defineProperty(c.Group.prototype,"angle",{get:function(){return c.Math.radToDeg(this.rotation)},set:function(b){this.rotation=c.Math.degToRad(b)}});Object.defineProperty(c.Group.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});c.World=function(b){c.Group.call(this,
b,null,"__world",!1);this.bounds=new c.Rectangle(0,0,b.width,b.height);this.camera=null;this._definedSize=!1;this._width=b.width;this._height=b.height};c.World.prototype=Object.create(c.Group.prototype);c.World.prototype.constructor=c.World;c.World.prototype.boot=function(){this.camera=new c.Camera(this.game,0,0,0,this.game.width,this.game.height);this.camera.displayObject=this;this.camera.scale=this.scale;this.game.camera=this.camera;this.game.stage.addChild(this)};c.World.prototype.setBounds=function(b,
d,c,g){this._definedSize=!0;this._width=c;this._height=g;this.bounds.setTo(b,d,c,g);this.camera.bounds&&this.camera.bounds.setTo(b,d,Math.max(c,this.game.width),Math.max(g,this.game.height));this.game.physics.setBoundsToWorld()};c.World.prototype.resize=function(b,d){this._definedSize&&(b<this._width&&(b=this._width),d<this._height&&(d=this._height));this.bounds.width=b;this.bounds.height=d;this.game.camera.setBoundsToWorld();this.game.physics.setBoundsToWorld()};c.World.prototype.shutdown=function(){this.destroy(!0,
!0)};c.World.prototype.wrap=function(b,d,c,g,h){"undefined"==typeof d&&(d=0);"undefined"==typeof c&&(c=!1);"undefined"==typeof g&&(g=!0);"undefined"==typeof h&&(h=!0);c?(b.getBounds(),g&&(b.x+b._currentBounds.width<this.bounds.x?b.x=this.bounds.right:b.x>this.bounds.right&&(b.x=this.bounds.left)),h&&(b.y+b._currentBounds.height<this.bounds.top?b.y=this.bounds.bottom:b.y>this.bounds.bottom&&(b.y=this.bounds.top))):(g&&b.x+d<this.bounds.x?b.x=this.bounds.right+d:g&&b.x-d>this.bounds.right&&(b.x=this.bounds.left-
d),h&&b.y+d<this.bounds.top?b.y=this.bounds.bottom+d:h&&b.y-d>this.bounds.bottom&&(b.y=this.bounds.top-d))};Object.defineProperty(c.World.prototype,"width",{get:function(){return this.bounds.width},set:function(b){b<this.game.width&&(b=this.game.width);this._width=this.bounds.width=b;this._definedSize=!0}});Object.defineProperty(c.World.prototype,"height",{get:function(){return this.bounds.height},set:function(b){b<this.game.height&&(b=this.game.height);this._height=this.bounds.height=b;this._definedSize=
!0}});Object.defineProperty(c.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth}});Object.defineProperty(c.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight}});Object.defineProperty(c.World.prototype,"randomX",{get:function(){return 0>this.bounds.x?this.game.rnd.integerInRange(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.integerInRange(this.bounds.x,this.bounds.width)}});Object.defineProperty(c.World.prototype,"randomY",{get:function(){return 0>
this.bounds.y?this.game.rnd.integerInRange(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.integerInRange(this.bounds.y,this.bounds.height)}});c.FlexGrid=function(b,d,e){this.game=b.game;this.manager=b;this.width=d;this.height=e;this.boundsCustom=new c.Rectangle(0,0,d,e);this.boundsFluid=new c.Rectangle(0,0,d,e);this.boundsFull=new c.Rectangle(0,0,d,e);this.boundsNone=new c.Rectangle(0,0,d,e);this.positionCustom=new c.Point(0,0);this.positionFluid=new c.Point(0,0);this.positionFull=
new c.Point(0,0);this.positionNone=new c.Point(0,0);this.scaleCustom=new c.Point(1,1);this.scaleFluid=new c.Point(1,1);this.scaleFluidInversed=new c.Point(1,1);this.scaleFull=new c.Point(1,1);this.scaleNone=new c.Point(1,1);this.customOffsetY=this.customOffsetX=this.customHeight=this.customWidth=0;this.ratioH=d/e;this.ratioV=e/d;this.multiplier=0;this.layers=[]};c.FlexGrid.prototype={setSize:function(b,d){this.width=b;this.height=d;this.ratioH=b/d;this.ratioV=d/b;this.scaleNone=new c.Point(1,1);this.boundsNone.width=
this.width;this.boundsNone.height=this.height;this.refresh()},createCustomLayer:function(b,d,e,g){"undefined"==typeof g&&(g=!0);this.customWidth=b;this.customHeight=d;this.boundsCustom.width=b;this.boundsCustom.height=d;b=new c.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);return g&&this.game.world.add(b),this.layers.push(b),"undefined"!=typeof e&&null!==typeof e&&b.addMultiple(e),b},createFluidLayer:function(b,d){"undefined"==typeof d&&(d=!0);var e=new c.FlexLayer(this,this.positionFluid,
this.boundsFluid,this.scaleFluid);return d&&this.game.world.add(e),this.layers.push(e),"undefined"!=typeof b&&null!==typeof b&&e.addMultiple(b),e},createFullLayer:function(b){var d=new c.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);return this.game.world.add(d),this.layers.push(d),"undefined"!=typeof b&&d.addMultiple(b),d},createFixedLayer:function(b){var d=new c.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);return this.game.world.add(d),this.layers.push(d),
"undefined"!=typeof b&&d.addMultiple(b),d},reset:function(){for(var b=this.layers.length;b--;)this.layers[b].persist||(this.layers[b].position=null,this.layers[b].scale=null,this.layers.slice(b,1))},onResize:function(b,d){this.refresh(b,d)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width);this.boundsFluid.width=Math.round(this.width*this.multiplier);this.boundsFluid.height=Math.round(this.height*this.multiplier);this.scaleFluid.set(this.boundsFluid.width/
this.width,this.boundsFluid.height/this.height);this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height);this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height);this.boundsFull.width=this.manager.width*this.scaleFluidInversed.x;this.boundsFull.height=this.manager.height*this.scaleFluidInversed.y;this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY);this.boundsNone.centerOn(this.manager.bounds.centerX,
this.manager.bounds.centerY);this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y);this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16);this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}};c.FlexGrid.prototype.constructor=c.FlexGrid;c.FlexLayer=function(b,d,e,g){c.Group.call(this,b.game,null,"__flexLayer"+b.game.rnd.uuid(),!1);this.manager=
b.manager;this.grid=b;this.persist=!1;this.position=d;this.bounds=e;this.scale=g;this.topLeft=e.topLeft;this.topMiddle=new c.Point(e.halfWidth,0);this.topRight=e.topRight;this.bottomLeft=e.bottomLeft;this.bottomMiddle=new c.Point(e.halfWidth,e.bottom);this.bottomRight=e.bottomRight};c.FlexLayer.prototype=Object.create(c.Group.prototype);c.FlexLayer.prototype.constructor=c.FlexLayer;c.FlexLayer.prototype.resize=function(){};c.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+
" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16);this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1);this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9");this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9");this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")};c.ScaleManager=function(b,d,e){this.game=b;this.grid=null;this.height=this.width=0;this.maxHeight=this.minHeight=this.maxWidth=this.minWidth=null;this.offset=new c.Point;this.pageAlignVertically=this.pageAlignHorizontally=
this.incorrectOrientation=this.forcePortrait=this.forceLandscape=!1;this.maxIterations=5;this.enterLandscape=new c.Signal;this.enterPortrait=new c.Signal;this.enterIncorrectOrientation=new c.Signal;this.leaveIncorrectOrientation=new c.Signal;this.fullScreenTarget=null;this.enterFullScreen=new c.Signal;this.leaveFullScreen=new c.Signal;this.orientation=0;window.orientation?this.orientation=window.orientation:window.outerWidth>window.outerHeight&&(this.orientation=90);this.scaleFactor=new c.Point(1,
1);this.scaleFactorInversed=new c.Point(1,1);this.margin=new c.Point(0,0);this.bounds=new c.Rectangle;this.sourceAspectRatio=this.aspectRatio=0;this.event=null;this.fullScreenScaleMode=c.ScaleManager.NO_SCALE;this.parentIsWindow=!1;this.parentNode=null;this.parentScaleFactor=new c.Point(1,1);this.trackParentInterval=2E3;this.onResizeContext=this.onResize=null;this._scaleMode=c.ScaleManager.NO_SCALE;this._height=this._width=0;this._check=null;this._nextParentCheck=0;this._parentBounds=null;b.config&&
this.parseConfig(b.config);this.setupScale(d,e)};c.ScaleManager.EXACT_FIT=0;c.ScaleManager.NO_SCALE=1;c.ScaleManager.SHOW_ALL=2;c.ScaleManager.RESIZE=3;c.ScaleManager.prototype={parseConfig:function(b){b.scaleMode&&(this.scaleMode=b.scaleMode);b.fullScreenScaleMode&&(this.fullScreenScaleMode=b.fullScreenScaleMode);b.fullScreenTarget&&(this.fullScreenTarget=b.fullScreenTarget)},setupScale:function(b,d){var e,g=new c.Rectangle;""!==this.game.parent&&("string"==typeof this.game.parent?e=document.getElementById(this.game.parent):
"object"==typeof this.game.parent&&1===this.game.parent.nodeType&&(e=this.game.parent));e?(this.parentNode=e,this.parentIsWindow=!1,this._parentBounds=this.parentNode.getBoundingClientRect(),g.width=this._parentBounds.width,g.height=this._parentBounds.height,this.offset.set(this._parentBounds.left,this._parentBounds.top)):(this.parentNode=null,this.parentIsWindow=!0,g.width=window.innerWidth,g.height=window.innerHeight);var h=e=0;"number"==typeof b?e=b:(this.parentScaleFactor.x=parseInt(b,10)/100,
e=g.width*this.parentScaleFactor.x);"number"==typeof d?h=d:(this.parentScaleFactor.y=parseInt(d,10)/100,h=g.height*this.parentScaleFactor.y);this.grid=new c.FlexGrid(this,e,h);this.updateDimensions(e,h,!1)},boot:function(){this.fullScreenTarget=this.game.canvas;var b=this;this._checkOrientation=function(d){return b.checkOrientation(d)};this._checkResize=function(d){return b.checkResize(d)};this._fullScreenChange=function(d){return b.fullScreenChange(d)};window.addEventListener("orientationchange",
this._checkOrientation,!1);window.addEventListener("resize",this._checkResize,!1);this.game.device.cocoonJS||(document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1));this.updateDimensions(this.width,this.height,!0);c.Canvas.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height)},
setResizeCallback:function(b,d){this.onResize=b;this.onResizeContext=d},setMinMax:function(b,d,c,g){this.minWidth=b;this.minHeight=d;"undefined"!=typeof c&&(this.maxWidth=c);"undefined"!=typeof g&&(this.maxHeight=g)},preUpdate:function(){this.game.time.now<this._nextParentCheck||(this.parentIsWindow||(c.Canvas.getOffset(this.game.canvas,this.offset),this._scaleMode===c.ScaleManager.RESIZE&&(this._parentBounds=this.parentNode.getBoundingClientRect(),(this._parentBounds.width!==this.width||this._parentBounds.height!==
this.height)&&this.updateDimensions(this._parentBounds.width,this._parentBounds.height,!0))),this._nextParentCheck=this.game.time.now+this.trackParentInterval)},updateDimensions:function(b,d,c){this.width=b*this.parentScaleFactor.x;this.height=d*this.parentScaleFactor.y;this.game.width=this.width;this.game.height=this.height;this.sourceAspectRatio=this.width/this.height;this.bounds.width=this.width;this.bounds.height=this.height;c&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,
this.height),this.game.world.resize(this.width,this.height));this.grid.onResize(b,d);this.onResize&&this.onResize.call(this.onResizeContext,this.width,this.height);this.game.state.resize(b,d)},forceOrientation:function(b,d){"undefined"==typeof d&&(d=!1);this.forceLandscape=b;this.forcePortrait=d},checkOrientationState:function(){this.incorrectOrientation?(this.forceLandscape&&window.innerWidth>window.innerHeight||this.forcePortrait&&window.innerHeight>window.innerWidth)&&(this.incorrectOrientation=
!1,this.leaveIncorrectOrientation.dispatch(),this.scaleMode!==c.ScaleManager.NO_SCALE&&this.refresh()):(this.forceLandscape&&window.innerWidth<window.innerHeight||this.forcePortrait&&window.innerHeight<window.innerWidth)&&(this.incorrectOrientation=!0,this.enterIncorrectOrientation.dispatch(),this.scaleMode!==c.ScaleManager.NO_SCALE&&this.refresh())},checkOrientation:function(b){this.event=b;this.orientation=window.orientation;this.isLandscape?this.enterLandscape.dispatch(this.orientation,!0,!1):
this.enterPortrait.dispatch(this.orientation,!1,!0);this.scaleMode!==c.ScaleManager.NO_SCALE&&this.refresh()},checkResize:function(b){this.event=b;b=this.isLandscape;this.orientation=window.outerWidth>window.outerHeight?90:0;b&&this.isPortrait?(this.enterPortrait.dispatch(this.orientation,!1,!0),this.forceLandscape?this.enterIncorrectOrientation.dispatch():this.forcePortrait&&this.leaveIncorrectOrientation.dispatch()):!b&&this.isLandscape&&(this.enterLandscape.dispatch(this.orientation,!0,!1),this.forceLandscape?
this.leaveIncorrectOrientation.dispatch():this.forcePortrait&&this.enterIncorrectOrientation.dispatch());this._scaleMode===c.ScaleManager.RESIZE&&this.parentIsWindow?this.updateDimensions(window.innerWidth,window.innerHeight,!0):(this._scaleMode===c.ScaleManager.EXACT_FIT||this._scaleMode===c.ScaleManager.SHOW_ALL)&&(this.refresh(),this.onResize&&this.onResize.call(this.onResizeContext,this.width,this.height));this.checkOrientationState()},refresh:function(){if(this.scaleMode!==c.ScaleManager.RESIZE&&
(this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?window.scrollTo(0,1):window.scrollTo(0,0)),null===this._check&&0<this.maxIterations)){this._iterations=this.maxIterations;var b=this;this._check=window.setInterval(function(){return b.setScreenSize()},10);this.setScreenSize()}},setScreenSize:function(b){this.scaleMode!==c.ScaleManager.RESIZE&&("undefined"==typeof b&&(b=!1),this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||
(this.game.device.android&&!this.game.device.chrome?window.scrollTo(0,1):window.scrollTo(0,0)),this._iterations--,(b||0>this._iterations)&&(document.documentElement.style.minHeight=window.innerHeight+"px",this.incorrectOrientation?this.setMaximum():this.isFullScreen?this.fullScreenScaleMode===c.ScaleManager.EXACT_FIT?this.setExactFit():this.fullScreenScaleMode===c.ScaleManager.SHOW_ALL&&this.setShowAll():this.scaleMode===c.ScaleManager.EXACT_FIT?this.setExactFit():this.scaleMode===c.ScaleManager.SHOW_ALL&&
this.setShowAll(),this.setSize(),clearInterval(this._check),this._check=null))},setSize:function(){this.incorrectOrientation||(this.maxWidth&&this.width>this.maxWidth&&(this.width=this.maxWidth),this.maxHeight&&this.height>this.maxHeight&&(this.height=this.maxHeight),this.minWidth&&this.width<this.minWidth&&(this.width=this.minWidth),this.minHeight&&this.height<this.minHeight&&(this.height=this.minHeight));this.game.canvas.style.width=this.width+"px";this.game.canvas.style.height=this.height+"px";
this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height);this.pageAlignHorizontally&&(this.width<window.innerWidth&&!this.incorrectOrientation?(this.margin.x=Math.round((window.innerWidth-this.width)/2),this.game.canvas.style.marginLeft=this.margin.x+"px"):(this.margin.x=0,this.game.canvas.style.marginLeft="0px"));this.pageAlignVertically&&(this.height<window.innerHeight&&!this.incorrectOrientation?(this.margin.y=Math.round((window.innerHeight-this.height)/2),this.game.canvas.style.marginTop=
this.margin.y+"px"):(this.margin.y=0,this.game.canvas.style.marginTop="0px"));c.Canvas.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.aspectRatio=this.width/this.height;this.scaleFactor.x=this.game.width/this.width;this.scaleFactor.y=this.game.height/this.height;this.scaleFactorInversed.x=this.width/this.game.width;this.scaleFactorInversed.y=this.height/this.game.height;this.checkOrientationState()},reset:function(b){b&&this.grid.reset()},
setMaximum:function(){this.width=window.innerWidth;this.height=window.innerHeight},setShowAll:function(){var b=Math.min(window.innerHeight/this.game.height,window.innerWidth/this.game.width);this.width=Math.round(this.game.width*b);this.height=Math.round(this.game.height*b)},setExactFit:function(){var b=window.innerWidth,d=window.innerHeight;this.width=this.maxWidth&&b>this.maxWidth?this.maxWidth:b;this.height=this.maxHeight&&d>this.maxHeight?this.maxHeight:d},startFullScreen:function(b){!this.isFullScreen&&
this.game.device.fullscreen&&("undefined"!=typeof b&&this.game.renderType===c.CANVAS&&(this.game.stage.smoothed=b),this._width=this.width,this._height=this.height,this.game.device.fullscreenKeyboard?this.fullScreenTarget[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):this.fullScreenTarget[this.game.device.requestFullscreen]())},stopFullScreen:function(){document[this.game.device.cancelFullscreen]()},fullScreenChange:function(b){this.event=b;this.isFullScreen?(this.fullScreenScaleMode===
c.ScaleManager.EXACT_FIT?(this.fullScreenTarget.style.width="100%",this.fullScreenTarget.style.height="100%",this.width=window.outerWidth,this.height=window.outerHeight,this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.checkResize()):this.fullScreenScaleMode===c.ScaleManager.SHOW_ALL&&(this.setShowAll(),this.refresh()),this.enterFullScreen.dispatch(this.width,
this.height)):(this.fullScreenTarget.style.width=this.game.width+"px",this.fullScreenTarget.style.height=this.game.height+"px",this.width=this._width,this.height=this._height,this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.leaveFullScreen.dispatch(this.width,this.height))},destroy:function(){window.removeEventListener("orientationchange",
this._checkOrientation,!1);window.removeEventListener("resize",this._checkResize,!1);this.game.device.cocoonJS||(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1))}};c.ScaleManager.prototype.constructor=c.ScaleManager;Object.defineProperty(c.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},
set:function(b){b!==this._scaleMode&&(this._scaleMode=b)}});Object.defineProperty(c.ScaleManager.prototype,"isFullScreen",{get:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement}});Object.defineProperty(c.ScaleManager.prototype,"isPortrait",{get:function(){return 0===this.orientation||180===this.orientation}});Object.defineProperty(c.ScaleManager.prototype,"isLandscape",{get:function(){return 90===this.orientation||-90===this.orientation}});
c.Game=function(b,d,e,g,h,f,k,m){this.id=c.GAMES.push(this)-1;this.config=null;this.physicsConfig=m;this.parent="";this.width=800;this.height=600;this.transparent=!1;this.antialias=!0;this.preserveDrawingBuffer=!1;this.renderer=null;this.renderType=c.AUTO;this.state=null;this.isRunning=this.isBooted=!1;this.particles=this.debug=this.context=this.canvas=this.camera=this.device=this.rnd=this.physics=this.world=this.tweens=this.time=this.stage=this.sound=this.scale=this.net=this.math=this.load=this.input=
this.cache=this.make=this.add=this.raf=null;this.pendingStep=this.stepping=!1;this.stepCount=0;this.onFocus=this.onBlur=this.onResume=this.onPause=null;this._codePaused=this._paused=!1;this._width=800;this._height=600;1===arguments.length&&"object"==typeof arguments[0]?this.parseConfig(arguments[0]):(this.config={enableDebug:!0},"undefined"!=typeof b&&(this._width=b),"undefined"!=typeof d&&(this._height=d),"undefined"!=typeof e&&(this.renderType=e),"undefined"!=typeof g&&(this.parent=g),"undefined"!=
typeof f&&(this.transparent=f),"undefined"!=typeof k&&(this.antialias=k),this.rnd=new c.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new c.StateManager(this,h));var n=this;return this._onBoot=function(){return n.boot()},"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(this._onBoot,0):"undefined"!=typeof window.cordova?document.addEventListener("deviceready",this._onBoot,!1):(document.addEventListener("DOMContentLoaded",this._onBoot,
!1),window.addEventListener("load",this._onBoot,!1)),this};c.Game.prototype={parseConfig:function(b){this.config=b;"undefined"==typeof b.enableDebug&&(this.config.enableDebug=!0);b.width&&(this._width=b.width);b.height&&(this._height=b.height);b.renderer&&(this.renderType=b.renderer);b.parent&&(this.parent=b.parent);b.transparent&&(this.transparent=b.transparent);b.antialias&&(this.antialias=b.antialias);b.preserveDrawingBuffer&&(this.preserveDrawingBuffer=b.preserveDrawingBuffer);b.physicsConfig&&
(this.physicsConfig=b.physicsConfig);var d=[(Date.now()*Math.random()).toString()];b.seed&&(d=b.seed);this.rnd=new c.RandomDataGenerator(d);d=null;b.state&&(d=b.state);this.state=new c.StateManager(this,d)},boot:function(){this.isBooted||(document.body?(document.removeEventListener("DOMContentLoaded",this._onBoot),window.removeEventListener("load",this._onBoot),this.onPause=new c.Signal,this.onResume=new c.Signal,this.onBlur=new c.Signal,this.onFocus=new c.Signal,this.isBooted=!0,this.device=new c.Device(this),
this.math=c.Math,this.scale=new c.ScaleManager(this,this._width,this._height),this.stage=new c.Stage(this),this.setUpRenderer(),this.device.checkFullScreenSupport(),this.world=new c.World(this),this.add=new c.GameObjectFactory(this),this.make=new c.GameObjectCreator(this),this.cache=new c.Cache(this),this.load=new c.Loader(this),this.time=new c.Time(this),this.tweens=new c.TweenManager(this),this.input=new c.Input(this),this.sound=new c.SndG(this),this.physics=new c.Physics(this,this.physicsConfig),
this.particles=new c.Particles(this),this.plugins=new c.PluginManager(this),this.net=new c.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug&&(this.debug=new c.Utils.Debug(this),this.debug.boot()),this.showDebugHeader(),this.isRunning=!0,this.raf=this.config&&this.config.forceSetTimeOut?new c.RequestAnimationFrame(this,this.config.forceSetTimeOut):new c.RequestAnimationFrame(this,!1),this.raf.start()):
window.setTimeout(this._onBoot,20))},showDebugHeader:function(){var b=c.VERSION,d="Canvas",e="HTML Audio",g=1;if(this.renderType===c.WEBGL?(d="WebGL",g++):this.renderType==c.HEADLESS&&(d="Headless"),this.device.webAudio&&(e="WebAudio",g++),this.device.chrome){b=["%c %c %c Phaser v"+b+" | Pixi.js "+PIXI.VERSION+" | "+d+" | "+e+"  %c %c  http://phaser.io  %c %c \u2665%c\u2665%c\u2665 ","background: #7a66a3","background: #625186","color: #ffffff; background: #43375b;","background: #625186","background: #ccb9f2",
"background: #625186"];for(d=0;3>d;d++)b.push(g>d?"color: #ff2424; background: #fff":"color: #959595; background: #fff");console.log.apply(console,b)}else window.console&&console.log("Phaser v"+b+" | Pixi.js "+PIXI.VERSION+" | "+d+" | "+e+" | http://phaser.io")},setUpRenderer:function(){if(this.canvas=this.config.canvasID?c.Canvas.create(this.width,this.height,this.config.canvasID):c.Canvas.create(this.width,this.height),this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]=
"width: 100%; height: 100%",this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===c.CANVAS?!0:!1),this.renderType===c.HEADLESS||this.renderType===c.CANVAS||this.renderType===c.AUTO&&!1===this.device.webGL){if(!this.device.canvas)throw Error("Phaser.Game - cannot create Canvas or WebGL context, aborting.");this.renderType===c.AUTO&&(this.renderType=c.CANVAS);this.renderer=new PIXI.CanvasRenderer(this.width,this.height,{view:this.canvas,transparent:this.transparent,resolution:1,clearBeforeRender:!0});
this.context=this.renderer.context}else this.renderType=c.WEBGL,this.renderer=new PIXI.WebGLRenderer(this.width,this.height,{view:this.canvas,transparent:this.transparent,resolution:1,antialias:this.antialias,preserveDrawingBuffer:this.preserveDrawingBuffer}),this.context=null;this.renderType!==c.HEADLESS&&(this.stage.smoothed=this.antialias,c.Canvas.addToDOM(this.canvas,this.parent,!1),c.Canvas.setTouchAction(this.canvas))},update:function(b){this.time.update(b);this._paused||this.pendingStep?(this.state.pauseUpdate(),
this.config.enableDebug&&this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.config.enableDebug&&this.debug.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(),this.plugins.preUpdate(),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate());this.renderType!=c.HEADLESS&&
(this.state.preRender(),this.renderer.render(this.stage),this.plugins.render(),this.state.render(),this.plugins.postRender(),this.device.cocoonJS&&this.renderType===c.CANVAS&&1===this.stage.currentRenderOrderID&&this.context.fillRect(0,0,0,0))},enableStep:function(){this.stepping=!0;this.pendingStep=!1;this.stepCount=0},disableStep:function(){this.pendingStep=this.stepping=!1},step:function(){this.pendingStep=!1;this.stepCount++},destroy:function(){this.raf.stop();this.state.destroy();this.sound.destroy();
this.scale.destroy();this.stage.destroy();this.input.destroy();this.physics.destroy();this.world=this.time=this.stage=this.sound=this.load=this.input=this.cache=this.state=null;this.isBooted=!1;c.Canvas.removeFromDOM(this.canvas)},gamePaused:function(b){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.setMute(),this.onPause.dispatch(b))},gameResumed:function(b){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.unsetMute(),this.onResume.dispatch(b))},
focusLoss:function(b){this.onBlur.dispatch(b);this.stage.disableVisibilityChange||this.gamePaused(b)},focusGain:function(b){this.onFocus.dispatch(b);this.stage.disableVisibilityChange||this.gameResumed(b)}};c.Game.prototype.constructor=c.Game;Object.defineProperty(c.Game.prototype,"paused",{get:function(){return this._paused},set:function(b){!0===b?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=
!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}});c.Input=function(b){this.game=b;this.hitContext=this.hitCanvas=null;this.moveCallbacks=[];this.moveCallback=null;this.moveCallbackContext=this;this.pollRate=0;this.disabled=!1;this.multiInputOverride=c.Input.MOUSE_TOUCH_COMBINE;this.scale=this.circle=this.speed=this.position=null;this.maxPointers=10;this.currentPointers=0;this.tapRate=200;this.doubleTapRate=300;this.holdRate=
2E3;this.justReleasedRate=this.justPressedRate=200;this.recordPointerHistory=!1;this.recordLimit=this.recordRate=100;this.gamepad=this.mspointer=this.touch=this.keyboard=this.mouse=this.mousePointer=this.activePointer=this.pointer10=this.pointer9=this.pointer8=this.pointer7=this.pointer6=this.pointer5=this.pointer4=this.pointer3=this.pointer2=this.pointer1=null;this.resetLocked=!1;this.onHold=this.onTap=this.onUp=this.onDown=null;this.minPriorityID=0;this.interactiveItems=new c.ArrayList;this._localPoint=
new c.Point;this._pollCounter=0;this._oldPosition=null;this._y=this._x=0};c.Input.MOUSE_OVERRIDES_TOUCH=0;c.Input.TOUCH_OVERRIDES_MOUSE=1;c.Input.MOUSE_TOUCH_COMBINE=2;c.Input.prototype={boot:function(){this.mousePointer=new c.Pointer(this.game,0);this.pointer1=new c.Pointer(this.game,1);this.pointer2=new c.Pointer(this.game,2);this.mouse=new c.Mouse(this.game);this.keyboard=new c.Keyboard(this.game);this.touch=new c.Touch(this.game);this.mspointer=new c.MSPointer(this.game);this.gamepad=new c.Gamepad(this.game);
this.onDown=new c.Signal;this.onUp=new c.Signal;this.onTap=new c.Signal;this.onHold=new c.Signal;this.scale=new c.Point(1,1);this.speed=new c.Point;this.position=new c.Point;this._oldPosition=new c.Point;this.circle=new c.Circle(0,0,44);this.activePointer=this.mousePointer;this.currentPointers=0;this.hitCanvas=document.createElement("canvas");this.hitCanvas.width=1;this.hitCanvas.height=1;this.hitContext=this.hitCanvas.getContext("2d");this.mouse.start();this.keyboard.start();this.touch.start();this.mspointer.start();
this.mousePointer.active=!0},destroy:function(){this.mouse.stop();this.keyboard.stop();this.touch.stop();this.mspointer.stop();this.gamepad.stop();this.moveCallbacks=[]},addMoveCallback:function(b,d){return this.moveCallbacks.push({callback:b,context:d})-1},deleteMoveCallback:function(b){this.moveCallbacks[b]&&this.moveCallbacks.splice(b,1)},addPointer:function(){for(var b=0,d=10;0<d;d--)null===this["pointer"+d]&&(b=d);return 0===b?(console.warn("You can only have 10 Pointer objects"),null):(this["pointer"+
b]=new c.Pointer(this.game,b),this["pointer"+b])},update:function(){return this.keyboard.update(),0<this.pollRate&&this._pollCounter<this.pollRate?void this._pollCounter++:(this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad.active&&this.gamepad.update(),this.pointer1.update(),this.pointer2.update(),this.pointer3&&this.pointer3.update(),this.pointer4&&this.pointer4.update(),
this.pointer5&&this.pointer5.update(),this.pointer6&&this.pointer6.update(),this.pointer7&&this.pointer7.update(),this.pointer8&&this.pointer8.update(),this.pointer9&&this.pointer9.update(),this.pointer10&&this.pointer10.update(),void(this._pollCounter=0))},reset:function(b){if(this.game.isBooted&&!this.resetLocked){"undefined"==typeof b&&(b=!1);this.keyboard.reset(b);this.mousePointer.reset();this.gamepad.reset();for(var d=1;10>=d;d++)this["pointer"+d]&&this["pointer"+d].reset();this.currentPointers=
0;"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit");b&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new c.Signal,this.onUp=new c.Signal,this.onTap=new c.Signal,this.onHold=new c.Signal,this.moveCallbacks=[]);this._pollCounter=0}},resetSpeed:function(b,d){this._oldPosition.setTo(b,d);this.speed.setTo(0,0)},startPointer:function(b){if(10>this.maxPointers&&this.totalActivePointers==this.maxPointers)return null;if(!1===
this.pointer1.active)return this.pointer1.start(b);if(!1===this.pointer2.active)return this.pointer2.start(b);for(var d=3;10>=d;d++)if(this["pointer"+d]&&!1===this["pointer"+d].active)return this["pointer"+d].start(b);return null},updatePointer:function(b){if(this.pointer1.active&&this.pointer1.identifier==b.identifier)return this.pointer1.move(b);if(this.pointer2.active&&this.pointer2.identifier==b.identifier)return this.pointer2.move(b);for(var d=3;10>=d;d++)if(this["pointer"+d]&&this["pointer"+
d].active&&this["pointer"+d].identifier==b.identifier)return this["pointer"+d].move(b);return null},stopPointer:function(b){if(this.pointer1.active&&this.pointer1.identifier==b.identifier)return this.pointer1.stop(b);if(this.pointer2.active&&this.pointer2.identifier==b.identifier)return this.pointer2.stop(b);for(var d=3;10>=d;d++)if(this["pointer"+d]&&this["pointer"+d].active&&this["pointer"+d].identifier==b.identifier)return this["pointer"+d].stop(b);return null},getPointer:function(b){if(b=b||!1,
this.pointer1.active==b)return this.pointer1;if(this.pointer2.active==b)return this.pointer2;for(var d=3;10>=d;d++)if(this["pointer"+d]&&this["pointer"+d].active==b)return this["pointer"+d];return null},getPointerFromIdentifier:function(b){if(this.pointer1.identifier===b)return this.pointer1;if(this.pointer2.identifier===b)return this.pointer2;for(var d=3;10>=d;d++)if(this["pointer"+d]&&this["pointer"+d].identifier===b)return this["pointer"+d];return null},getPointerFromId:function(b){if(this.pointer1.pointerId===
b)return this.pointer1;if(this.pointer2.pointerId===b)return this.pointer2;for(var d=3;10>=d;d++)if(this["pointer"+d]&&this["pointer"+d].pointerId===b)return this["pointer"+d];return null},getLocalPosition:function(b,d,e){"undefined"==typeof e&&(e=new c.Point);b=b.worldTransform;var g=1/(b.a*b.d+b.c*-b.b);return e.setTo(b.d*g*d.x+-b.c*g*d.y+(b.ty*b.c-b.tx*b.d)*g,b.a*g*d.y+-b.b*g*d.x+(-b.ty*b.a+b.tx*b.b)*g)},hitTest:function(b,d,e){if(!b.worldVisible)return!1;if(this.getLocalPosition(b,d,this._localPoint),
e.copyFrom(this._localPoint),b.hitArea&&b.hitArea.contains)return b.hitArea.contains(this._localPoint.x,this._localPoint.y);if(b instanceof PIXI.Sprite){var g=b.texture.frame.width,h=b.texture.frame.height,f=-g*b.anchor.x;if(this._localPoint.x>=f&&this._localPoint.x<f+g&&(g=-h*b.anchor.y,this._localPoint.y>=g&&this._localPoint.y<g+h))return!0}else if(b instanceof c.TileSprite){if(g=b.width,h=b.height,f=-g*b.anchor.x,this._localPoint.x>=f&&this._localPoint.x<f+g&&(g=-h*b.anchor.y,this._localPoint.y>=
g&&this._localPoint.y<g+h))return!0}else if(b instanceof c.Graphics)for(h=0;h<b.graphicsData.length;h++)if(g=b.graphicsData[h],g.fill&&g.shape&&g.shape.contains(this._localPoint.x,this._localPoint.y))return!0;h=0;for(g=b.children.length;g>h;h++)if(this.hitTest(b.children[h],d,e))return!0;return!1}};c.Input.prototype.constructor=c.Input;Object.defineProperty(c.Input.prototype,"x",{get:function(){return this._x},set:function(b){this._x=Math.floor(b)}});Object.defineProperty(c.Input.prototype,"y",{get:function(){return this._y},
set:function(b){this._y=Math.floor(b)}});Object.defineProperty(c.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}});Object.defineProperty(c.Input.prototype,"totalInactivePointers",{get:function(){return 10-this.currentPointers}});Object.defineProperty(c.Input.prototype,"totalActivePointers",{get:function(){this.currentPointers=0;for(var b=1;10>=b;b++)this["pointer"+b]&&this["pointer"+b].active&&this.currentPointers++;return this.currentPointers}});
Object.defineProperty(c.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}});Object.defineProperty(c.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}});c.Key=function(b,d){this.game=b;this.enabled=!0;this.event=null;this.isDown=!1;this.isUp=!0;this.shiftKey=this.ctrlKey=this.altKey=!1;this.duration=this.timeDown=0;this.timeUp=-2500;this.repeats=0;this.keyCode=d;this.onDown=new c.Signal;this.onHoldContext=this.onHoldCallback=null;this.onUp=
new c.Signal};c.Key.prototype={update:function(){this.enabled&&this.isDown&&(this.duration=this.game.time.now-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(b){this.enabled&&(this.event=b,this.isDown||(this.altKey=b.altKey,this.ctrlKey=b.ctrlKey,this.shiftKey=b.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.now,this.duration=0,this.repeats=0,this.onDown.dispatch(this)))},processKeyUp:function(b){this.enabled&&
(this.event=b,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.now,this.duration=this.game.time.now-this.timeDown,this.onUp.dispatch(this)))},reset:function(b){"undefined"==typeof b&&(b=!0);this.isDown=!1;this.isUp=!0;this.timeUp=this.game.time.now;this.duration=0;this.enabled=!0;b&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},justPressed:function(b){return"undefined"==typeof b&&(b=50),this.isDown&&this.duration<b},justReleased:function(b){return"undefined"==
typeof b&&(b=50),!this.isDown&&this.game.time.now-this.timeUp<b}};c.Key.prototype.constructor=c.Key;c.Keyboard=function(b){this.game=b;this.disabled=!1;this.pressEvent=this.event=null;this.callbackContext=this;this.onUpCallback=this.onPressCallback=this.onDownCallback=null;this._keys=[];this._capture=[];this._onKeyUp=this._onKeyPress=this._onKeyDown=null;this._k=this._i=0};c.Keyboard.prototype={addCallbacks:function(b,d,c,g){this.callbackContext=b;"undefined"!=typeof d&&(this.onDownCallback=d);"undefined"!=
typeof c&&(this.onUpCallback=c);"undefined"!=typeof g&&(this.onPressCallback=g)},addKey:function(b){return this._keys[b]||(this._keys[b]=new c.Key(this.game,b),this.addKeyCapture(b)),this._keys[b]},removeKey:function(b){this._keys[b]&&(this._keys[b]=null,this.removeKeyCapture(b))},createCursorKeys:function(){return{up:this.addKey(c.Keyboard.UP),down:this.addKey(c.Keyboard.DOWN),left:this.addKey(c.Keyboard.LEFT),right:this.addKey(c.Keyboard.RIGHT)}},start:function(){if(!this.game.device.cocoonJS&&
null===this._onKeyDown){var b=this;this._onKeyDown=function(d){return b.processKeyDown(d)};this._onKeyUp=function(d){return b.processKeyUp(d)};this._onKeyPress=function(d){return b.processKeyPress(d)};window.addEventListener("keydown",this._onKeyDown,!1);window.addEventListener("keyup",this._onKeyUp,!1);window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);window.removeEventListener("keypress",
this._onKeyPress);this._onKeyPress=this._onKeyUp=this._onKeyDown=null},destroy:function(){this.stop();this.clearCaptures();this._i=this._keys.length=0},addKeyCapture:function(b){if("object"==typeof b)for(var d in b)this._capture[b[d]]=!0;else this._capture[b]=!0},removeKeyCapture:function(b){delete this._capture[b]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(b){this.event=
b;this.game.input.disabled||this.disabled||(this._capture[b.keyCode]&&b.preventDefault(),this._keys[b.keyCode]||(this._keys[b.keyCode]=new c.Key(this.game,b.keyCode)),this._keys[b.keyCode].processKeyDown(b),this._k=b.keyCode,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,b))},processKeyPress:function(b){this.pressEvent=b;this.game.input.disabled||this.disabled||this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(b.charCode),b)},processKeyUp:function(b){this.event=
b;this.game.input.disabled||this.disabled||(this._capture[b.keyCode]&&b.preventDefault(),this._keys[b.keyCode]||(this._keys[b.keyCode]=new c.Key(this.game,b.keyCode)),this._keys[b.keyCode].processKeyUp(b),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,b))},reset:function(b){"undefined"==typeof b&&(b=!0);this.event=null;for(var d=this._keys.length;d--;)this._keys[d]&&this._keys[d].reset(b)},justPressed:function(b,d){return"undefined"==typeof d&&(d=50),this._keys[b]?this._keys[b].justPressed(d):
!1},justReleased:function(b,d){return"undefined"==typeof d&&(d=50),this._keys[b]?this._keys[b].justReleased(d):!1},isDown:function(b){return this._keys[b]?this._keys[b].isDown:!1}};Object.defineProperty(c.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}});Object.defineProperty(c.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}});c.Keyboard.prototype.constructor=c.Keyboard;c.Keyboard.A=65;c.Keyboard.B=
66;c.Keyboard.C=67;c.Keyboard.D=68;c.Keyboard.E=69;c.Keyboard.F=70;c.Keyboard.G=71;c.Keyboard.H=72;c.Keyboard.I=73;c.Keyboard.J=74;c.Keyboard.K=75;c.Keyboard.L=76;c.Keyboard.M=77;c.Keyboard.N=78;c.Keyboard.O=79;c.Keyboard.P=80;c.Keyboard.Q=81;c.Keyboard.R=82;c.Keyboard.S=83;c.Keyboard.T=84;c.Keyboard.U=85;c.Keyboard.V=86;c.Keyboard.W=87;c.Keyboard.X=88;c.Keyboard.Y=89;c.Keyboard.Z=90;c.Keyboard.ZERO=48;c.Keyboard.ONE=49;c.Keyboard.TWO=50;c.Keyboard.THREE=51;c.Keyboard.FOUR=52;c.Keyboard.FIVE=53;c.Keyboard.SIX=
54;c.Keyboard.SEVEN=55;c.Keyboard.EIGHT=56;c.Keyboard.NINE=57;c.Keyboard.NUMPAD_0=96;c.Keyboard.NUMPAD_1=97;c.Keyboard.NUMPAD_2=98;c.Keyboard.NUMPAD_3=99;c.Keyboard.NUMPAD_4=100;c.Keyboard.NUMPAD_5=101;c.Keyboard.NUMPAD_6=102;c.Keyboard.NUMPAD_7=103;c.Keyboard.NUMPAD_8=104;c.Keyboard.NUMPAD_9=105;c.Keyboard.NUMPAD_MULTIPLY=106;c.Keyboard.NUMPAD_ADD=107;c.Keyboard.NUMPAD_ENTER=108;c.Keyboard.NUMPAD_SUBTRACT=109;c.Keyboard.NUMPAD_DECIMAL=110;c.Keyboard.NUMPAD_DIVIDE=111;c.Keyboard.F1=112;c.Keyboard.F2=
113;c.Keyboard.F3=114;c.Keyboard.F4=115;c.Keyboard.F5=116;c.Keyboard.F6=117;c.Keyboard.F7=118;c.Keyboard.F8=119;c.Keyboard.F9=120;c.Keyboard.F10=121;c.Keyboard.F11=122;c.Keyboard.F12=123;c.Keyboard.F13=124;c.Keyboard.F14=125;c.Keyboard.F15=126;c.Keyboard.COLON=186;c.Keyboard.EQUALS=187;c.Keyboard.UNDERSCORE=189;c.Keyboard.QUESTION_MARK=191;c.Keyboard.TILDE=192;c.Keyboard.OPEN_BRACKET=219;c.Keyboard.BACKWARD_SLASH=220;c.Keyboard.CLOSED_BRACKET=221;c.Keyboard.QUOTES=222;c.Keyboard.BACKSPACE=8;c.Keyboard.TAB=
9;c.Keyboard.CLEAR=12;c.Keyboard.ENTER=13;c.Keyboard.SHIFT=16;c.Keyboard.CONTROL=17;c.Keyboard.ALT=18;c.Keyboard.CAPS_LOCK=20;c.Keyboard.ESC=27;c.Keyboard.SPACEBAR=32;c.Keyboard.PAGE_UP=33;c.Keyboard.PAGE_DOWN=34;c.Keyboard.END=35;c.Keyboard.HOME=36;c.Keyboard.LEFT=37;c.Keyboard.UP=38;c.Keyboard.RIGHT=39;c.Keyboard.DOWN=40;c.Keyboard.INSERT=45;c.Keyboard.DELETE=46;c.Keyboard.HELP=47;c.Keyboard.NUM_LOCK=144;c.Keyboard.PLUS=43;c.Keyboard.MINUS=45;c.Mouse=function(b){this.callbackContext=this.game=b;
this.mouseWheelCallback=this.mouseOverCallback=this.mouseOutCallback=this.mouseUpCallback=this.mouseMoveCallback=this.mouseDownCallback=null;this.capture=!1;this.button=-1;this.wheelDelta=0;this.stopOnGameOut=this.locked=this.disabled=!1;this.pointerLock=new c.Signal;this._onMouseWheel=this._onMouseOver=this._onMouseOut=this._onMouseUp=this._onMouseMove=this._onMouseDown=this.event=null};c.Mouse.NO_BUTTON=-1;c.Mouse.LEFT_BUTTON=0;c.Mouse.MIDDLE_BUTTON=1;c.Mouse.RIGHT_BUTTON=2;c.Mouse.WHEEL_UP=1;c.Mouse.WHEEL_DOWN=
-1;c.Mouse.prototype={start:function(){if((!this.game.device.android||!1!==this.game.device.chrome)&&null===this._onMouseDown){var b=this;this._onMouseDown=function(d){return b.onMouseDown(d)};this._onMouseMove=function(d){return b.onMouseMove(d)};this._onMouseUp=function(d){return b.onMouseUp(d)};this._onMouseUpGlobal=function(d){return b.onMouseUpGlobal(d)};this._onMouseOut=function(d){return b.onMouseOut(d)};this._onMouseOver=function(d){return b.onMouseOver(d)};this._onMouseWheel=function(d){return b.onMouseWheel(d)};
this.game.canvas.addEventListener("mousedown",this._onMouseDown,!0);this.game.canvas.addEventListener("mousemove",this._onMouseMove,!0);this.game.canvas.addEventListener("mouseup",this._onMouseUp,!0);this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),this.game.canvas.addEventListener("mouseover",this._onMouseOver,!0),this.game.canvas.addEventListener("mouseout",this._onMouseOut,!0),this.game.canvas.addEventListener("mousewheel",this._onMouseWheel,!0),this.game.canvas.addEventListener("DOMMouseScroll",
this._onMouseWheel,!0))}},onMouseDown:function(b){this.event=b;this.capture&&b.preventDefault();this.button=b.button;this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled||(b.identifier=0,this.game.input.mousePointer.start(b))},onMouseMove:function(b){this.event=b;this.capture&&b.preventDefault();this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled||(b.identifier=0,this.game.input.mousePointer.move(b))},
onMouseUp:function(b){this.event=b;this.capture&&b.preventDefault();this.button=c.Mouse.NO_BUTTON;this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled||(b.identifier=0,this.game.input.mousePointer.stop(b))},onMouseUpGlobal:function(b){this.game.input.mousePointer.withinGame||(this.button=c.Mouse.NO_BUTTON,this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,b),b.identifier=0,this.game.input.mousePointer.stop(b))},onMouseOut:function(b){this.event=
b;this.capture&&b.preventDefault();this.game.input.mousePointer.withinGame=!1;this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled||this.stopOnGameOut&&(b.identifier=0,this.game.input.mousePointer.stop(b))},onMouseWheel:function(b){this.event=b;this.capture&&b.preventDefault();this.wheelDelta=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,b)},onMouseOver:function(b){this.event=
b;this.capture&&b.preventDefault();this.game.input.mousePointer.withinGame=!0;this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled},requestPointerLock:function(){if(this.game.device.pointerLock){var b=this.game.canvas;b.requestPointerLock=b.requestPointerLock||b.mozRequestPointerLock||b.webkitRequestPointerLock;b.requestPointerLock();var d=this;this._pointerLockChange=function(b){return d.pointerLockChange(b)};document.addEventListener("pointerlockchange",
this._pointerLockChange,!0);document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(b){var d=this.game.canvas;document.pointerLockElement===d||document.mozPointerLockElement===d||document.webkitPointerLockElement===d?(this.locked=!0,this.pointerLock.dispatch(!0,b)):(this.locked=!1,this.pointerLock.dispatch(!1,b))},releasePointerLock:function(){document.exitPointerLock=
document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock();document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){this.game.canvas.removeEventListener("mousedown",this._onMouseDown,!0);this.game.canvas.removeEventListener("mousemove",this._onMouseMove,
!0);this.game.canvas.removeEventListener("mouseup",this._onMouseUp,!0);this.game.canvas.removeEventListener("mouseover",this._onMouseOver,!0);this.game.canvas.removeEventListener("mouseout",this._onMouseOut,!0);this.game.canvas.removeEventListener("mousewheel",this._onMouseWheel,!0);this.game.canvas.removeEventListener("DOMMouseScroll",this._onMouseWheel,!0);window.removeEventListener("mouseup",this._onMouseUpGlobal,!0);document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);
document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}};c.Mouse.prototype.constructor=c.Mouse;c.MSPointer=function(b){this.callbackContext=this.game=b;this.disabled=!1;this._onMSPointerUp=this._onMSPointerMove=this._onMSPointerDown=null};c.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var b=this;this.game.device.mspointer&&(this._onMSPointerDown=function(d){return b.onPointerDown(d)},
this._onMSPointerMove=function(d){return b.onPointerMove(d)},this._onMSPointerUp=function(d){return b.onPointerUp(d)},this.game.canvas.addEventListener("MSPointerDown",this._onMSPointerDown,!1),this.game.canvas.addEventListener("MSPointerMove",this._onMSPointerMove,!1),this.game.canvas.addEventListener("MSPointerUp",this._onMSPointerUp,!1),this.game.canvas.addEventListener("pointerDown",this._onMSPointerDown,!1),this.game.canvas.addEventListener("pointerMove",this._onMSPointerMove,!1),this.game.canvas.addEventListener("pointerUp",
this._onMSPointerUp,!1),this.game.canvas.style["-ms-content-zooming"]="none",this.game.canvas.style["-ms-touch-action"]="none")}},onPointerDown:function(b){this.game.input.disabled||this.disabled||(b.preventDefault(),b.identifier=b.pointerId,this.game.input.startPointer(b))},onPointerMove:function(b){this.game.input.disabled||this.disabled||(b.preventDefault(),b.identifier=b.pointerId,this.game.input.updatePointer(b))},onPointerUp:function(b){this.game.input.disabled||this.disabled||(b.preventDefault(),
b.identifier=b.pointerId,this.game.input.stopPointer(b))},stop:function(){this.game.canvas.removeEventListener("MSPointerDown",this._onMSPointerDown);this.game.canvas.removeEventListener("MSPointerMove",this._onMSPointerMove);this.game.canvas.removeEventListener("MSPointerUp",this._onMSPointerUp);this.game.canvas.removeEventListener("pointerDown",this._onMSPointerDown);this.game.canvas.removeEventListener("pointerMove",this._onMSPointerMove);this.game.canvas.removeEventListener("pointerUp",this._onMSPointerUp)}};
c.MSPointer.prototype.constructor=c.MSPointer;c.Pointer=function(b,d){this.game=b;this.id=d;this.type=c.POINTER;this.exists=!0;this.identifier=0;this.button=this.target=this.pointerId=null;this._holdSent=!1;this._history=[];this._nextDrop=0;this.withinGame=this._stateReset=!1;this.screenY=this.screenX=this.pageY=this.pageX=this.clientY=this.clientX=-1;this.movementY=this.movementX=this.rawMovementY=this.rawMovementX=0;this.y=this.x=-1;this.isDown=this.isMouse=!1;this.isUp=!0;this.totalTouches=this.previousTapTime=
this.timeUp=this.timeDown=0;this.msSinceLastClick=Number.MAX_VALUE;this.targetObject=null;this.dirty=this.active=!1;this.position=new c.Point;this.positionDown=new c.Point;this.positionUp=new c.Point;this.circle=new c.Circle(0,0,44);0===d&&(this.isMouse=!0)};c.Pointer.prototype={start:function(b){return b.pointerId&&(this.pointerId=b.pointerId),this.identifier=b.identifier,this.target=b.target,"undefined"!=typeof b.button&&(this.button=b.button),this._history=[],this.active=!0,this.withinGame=!0,
this.isDown=!0,this.isUp=!1,this.dirty=!1,this.msSinceLastClick=this.game.time.now-this.timeDown,this.timeDown=this.game.time.now,this._holdSent=!1,this.move(b,!0),this.positionDown.setTo(this.x,this.y),(this.game.input.multiInputOverride===c.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===c.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===c.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.x,
this.y),this.game.input.onDown.dispatch(this,b),this.game.input.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,this.isMouse||this.game.input.currentPointers++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){this.active&&(this.dirty&&(0<this.game.input.interactiveItems.total&&this.processInteractiveObjects(!0),this.dirty=!1),!1===this._holdSent&&this.duration>=this.game.input.holdRate&&((this.game.input.multiInputOverride==c.Input.MOUSE_OVERRIDES_TOUCH||
this.game.input.multiInputOverride==c.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==c.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&this.game.input.onHold.dispatch(this),this._holdSent=!0),this.game.input.recordPointerHistory&&this.game.time.now>=this._nextDrop&&(this._nextDrop=this.game.time.now+this.game.input.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>this.game.input.recordLimit&&this._history.shift()))},move:function(b,
d){if(!this.game.input.pollLocked){if("undefined"==typeof d&&(d=!1),"undefined"!=typeof b.button&&(this.button=b.button),this.clientX=b.clientX,this.clientY=b.clientY,this.pageX=b.pageX,this.pageY=b.pageY,this.screenX=b.screenX,this.screenY=b.screenY,this.isMouse&&this.game.input.mouse.locked&&!d&&(this.rawMovementX=b.movementX||b.mozMovementX||b.webkitMovementX||0,this.rawMovementY=b.movementY||b.mozMovementY||b.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),
this.x=(this.pageX-this.game.scale.offset.x)*this.game.input.scale.x,this.y=(this.pageY-this.game.scale.offset.y)*this.game.input.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(this.game.input.multiInputOverride===c.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===c.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===c.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.activePointer=this,this.game.input.x=
this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.game.input.x,this.game.input.y),this.game.input.circle.x=this.game.input.x,this.game.input.circle.y=this.game.input.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY),this.game.paused)return this;for(var e=this.game.input.moveCallbacks.length;e--;)this.game.input.moveCallbacks[e].callback.call(this.game.input.moveCallbacks[e].context,this,this.x,this.y,d);return null!==this.targetObject&&!0===this.targetObject.isDragged?
!1===this.targetObject.update(this)&&(this.targetObject=null):0<this.game.input.interactiveItems.total&&this.processInteractiveObjects(d),this}},processInteractiveObjects:function(b){this.game.input.interactiveItems.setAll("checked",!1);this._highestRenderOrderID=Number.MAX_SAFE_INTEGER;this._highestRenderObject=null;this._highestInputPriorityID=-1;var d=this.game.input.interactiveItems.first;do d&&d.validForInput(this._highestInputPriorityID,this._highestRenderOrderID,!1)&&(d.checked=!0,(b&&d.checkPointerDown(this,
!0)||!b&&d.checkPointerOver(this,!0))&&(this._highestRenderOrderID=d.sprite._cache[3],this._highestInputPriorityID=d.priorityID,this._highestRenderObject=d)),d=this.game.input.interactiveItems.next;while(null!==d);d=this.game.input.interactiveItems.first;do d&&!d.checked&&d.validForInput(this._highestInputPriorityID,this._highestRenderOrderID,!0)&&(b&&d.checkPointerDown(this,!1)||!b&&d.checkPointerOver(this,!1))&&(this._highestRenderOrderID=d.sprite._cache[3],this._highestInputPriorityID=d.priorityID,
this._highestRenderObject=d),d=this.game.input.interactiveItems.next;while(null!==d);return null===this._highestRenderObject?this.targetObject&&(this.targetObject._pointerOutHandler(this),this.targetObject=null):null===this.targetObject?(this.targetObject=this._highestRenderObject,this._highestRenderObject._pointerOverHandler(this)):this.targetObject===this._highestRenderObject?!1===this._highestRenderObject.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this),this.targetObject=
this._highestRenderObject,this.targetObject._pointerOverHandler(this)),null!==this.targetObject},leave:function(b){this.withinGame=!1;this.move(b,!1)},stop:function(b){return this._stateReset?void b.preventDefault():(this.timeUp=this.game.time.now,(this.game.input.multiInputOverride===c.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===c.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===c.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.onUp.dispatch(this,
b),0<=this.duration&&this.duration<=this.game.input.tapRate&&(this.timeUp-this.previousTapTime<this.game.input.doubleTapRate?this.game.input.onTap.dispatch(this,!0):this.game.input.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),0<this.id&&(this.active=!1),this.withinGame=!1,this.isDown=!1,this.isUp=!0,this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),!1===this.isMouse&&this.game.input.currentPointers--,this.game.input.interactiveItems.callAll("_releasedHandler",
this),this.targetObject=null,this)},justPressed:function(b){return b=b||this.game.input.justPressedRate,!0===this.isDown&&this.timeDown+b>this.game.time.now},justReleased:function(b){return b=b||this.game.input.justReleasedRate,!0===this.isUp&&this.timeUp+b>this.game.time.now},reset:function(){!1===this.isMouse&&(this.active=!1);this.identifier=this.pointerId=null;this.isDown=this.dirty=!1;this.isUp=!0;this.totalTouches=0;this._holdSent=!1;this._history.length=0;this._stateReset=!0;this.targetObject&&
this.targetObject._releasedHandler(this);this.targetObject=null},resetMovement:function(){this.movementY=this.movementX=0}};c.Pointer.prototype.constructor=c.Pointer;Object.defineProperty(c.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.now-this.timeDown}});Object.defineProperty(c.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}});Object.defineProperty(c.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}});
c.Touch=function(b){this.game=b;this.disabled=!1;this.callbackContext=this.game;this.touchCancelCallback=this.touchLeaveCallback=this.touchEnterCallback=this.touchEndCallback=this.touchMoveCallback=this.touchStartCallback=null;this.preventDefault=!0;this._onTouchMove=this._onTouchCancel=this._onTouchLeave=this._onTouchEnter=this._onTouchEnd=this._onTouchMove=this._onTouchStart=this.event=null};c.Touch.prototype={start:function(){if(null===this._onTouchStart){var b=this;this.game.device.touch&&(this._onTouchStart=
function(d){return b.onTouchStart(d)},this._onTouchMove=function(d){return b.onTouchMove(d)},this._onTouchEnd=function(d){return b.onTouchEnd(d)},this._onTouchEnter=function(d){return b.onTouchEnter(d)},this._onTouchLeave=function(d){return b.onTouchLeave(d)},this._onTouchCancel=function(d){return b.onTouchCancel(d)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",
this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(b){b.preventDefault()};document.addEventListener("touchmove",this._documentTouchMove,!1)},onTouchStart:function(b){if(this.event=b,this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,
b),!this.game.input.disabled&&!this.disabled){this.preventDefault&&b.preventDefault();for(var d=0;d<b.changedTouches.length;d++)this.game.input.startPointer(b.changedTouches[d])}},onTouchCancel:function(b){if(this.event=b,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,b),!this.game.input.disabled&&!this.disabled){this.preventDefault&&b.preventDefault();for(var d=0;d<b.changedTouches.length;d++)this.game.input.stopPointer(b.changedTouches[d])}},onTouchEnter:function(b){this.event=
b;this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,b);this.game.input.disabled||this.disabled||this.preventDefault&&b.preventDefault()},onTouchLeave:function(b){this.event=b;this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,b);this.preventDefault&&b.preventDefault()},onTouchMove:function(b){this.event=b;this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,b);this.preventDefault&&b.preventDefault();for(var d=0;d<b.changedTouches.length;d++)this.game.input.updatePointer(b.changedTouches[d])},
onTouchEnd:function(b){this.event=b;this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,b);this.preventDefault&&b.preventDefault();for(var d=0;d<b.changedTouches.length;d++)this.game.input.stopPointer(b.changedTouches[d])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",
this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}};c.Touch.prototype.constructor=c.Touch;c.Gamepad=function(b){this.game=b;this._gamepadIndexMap={};this._rawPads=[];this.disabled=this._active=!1;this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!=navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads;this._prevRawGamepadTypes=[];this._prevTimestamps=
[];this.callbackContext=this;this._gamepaddisconnected=this._ongamepadconnected=this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null;this._gamepads=[new c.SinglePad(b,this),new c.SinglePad(b,this),new c.SinglePad(b,this),new c.SinglePad(b,this)]};c.Gamepad.prototype={addCallbacks:function(b,d){"undefined"!=typeof d&&(this.onConnectCallback="function"==typeof d.onConnect?d.onConnect:this.onConnectCallback,this.onDisconnectCallback=
"function"==typeof d.onDisconnect?d.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof d.onDown?d.onDown:this.onDownCallback,this.onUpCallback="function"==typeof d.onUp?d.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof d.onAxis?d.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof d.onFloat?d.onFloat:this.onFloatCallback)},start:function(){if(!this._active){this._active=!0;var b=this;this._onGamepadConnected=function(d){return b.onGamepadConnected(d)};
this._onGamepadDisconnected=function(d){return b.onGamepadDisconnected(d)};window.addEventListener("gamepadconnected",this._onGamepadConnected,!1);window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1)}},onGamepadConnected:function(b){b=b.gamepad;this._rawPads.push(b);this._gamepads[b.index].connect(b)},onGamepadDisconnected:function(b){b=b.gamepad;for(var d in this._rawPads)this._rawPads[d].index===b.index&&this._rawPads.splice(d,1);this._gamepads[b.index].disconnect()},update:function(){this._pollGamepads();
this.pad1.pollStatus();this.pad2.pollStatus();this.pad3.pollStatus();this.pad4.pollStatus()},_pollGamepads:function(){if(navigator.getGamepads)var b=navigator.getGamepads();else navigator.webkitGetGamepads?b=navigator.webkitGetGamepads():navigator.webkitGamepads&&(b=navigator.webkitGamepads());if(b){this._rawPads=[];for(var d=!1,c=0;c<b.length&&(typeof b[c]!==this._prevRawGamepadTypes[c]&&(d=!0,this._prevRawGamepadTypes[c]=typeof b[c]),b[c]&&this._rawPads.push(b[c]),3!==c);c++);if(d){for(var g,b=
{},d={},c=0;c<this._gamepads.length;c++)if(g=this._gamepads[c],g.connected)for(var h=0;h<this._rawPads.length;h++)this._rawPads[h].index===g.index&&(b[g.index]=!0,d[c]=!0);for(c=0;c<this._gamepads.length;c++)if(g=this._gamepads[c],!d[c])for(1>this._rawPads.length&&g.disconnect(),h=0;h<this._rawPads.length&&!d[c];h++){var f=this._rawPads[h];f?b[f.index]?g.disconnect():(g.connect(f),b[f.index]=!0,d[c]=!0):g.disconnect()}}}},setDeadZones:function(b){for(var c=0;c<this._gamepads.length;c++)this._gamepads[c].deadZone=
b},stop:function(){this._active=!1;window.removeEventListener("gamepadconnected",this._onGamepadConnected);window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var b=0;b<this._gamepads.length;b++)this._gamepads[b].reset()},justPressed:function(b,c){for(var e=0;e<this._gamepads.length;e++)if(!0===this._gamepads[e].justPressed(b,c))return!0;return!1},justReleased:function(b,c){for(var e=0;e<this._gamepads.length;e++)if(!0===this._gamepads[e].justReleased(b,
c))return!0;return!1},isDown:function(b){for(var c=0;c<this._gamepads.length;c++)if(!0===this._gamepads[c].isDown(b))return!0;return!1},destroy:function(){this.stop();for(var b=0;b<this._gamepads.length;b++)this._gamepads[b].destroy()}};c.Gamepad.prototype.constructor=c.Gamepad;Object.defineProperty(c.Gamepad.prototype,"active",{get:function(){return this._active}});Object.defineProperty(c.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}});Object.defineProperty(c.Gamepad.prototype,
"padsConnected",{get:function(){return this._rawPads.length}});Object.defineProperty(c.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}});Object.defineProperty(c.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}});Object.defineProperty(c.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}});Object.defineProperty(c.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}});c.Gamepad.BUTTON_0=0;c.Gamepad.BUTTON_1=1;c.Gamepad.BUTTON_2=2;c.Gamepad.BUTTON_3=
3;c.Gamepad.BUTTON_4=4;c.Gamepad.BUTTON_5=5;c.Gamepad.BUTTON_6=6;c.Gamepad.BUTTON_7=7;c.Gamepad.BUTTON_8=8;c.Gamepad.BUTTON_9=9;c.Gamepad.BUTTON_10=10;c.Gamepad.BUTTON_11=11;c.Gamepad.BUTTON_12=12;c.Gamepad.BUTTON_13=13;c.Gamepad.BUTTON_14=14;c.Gamepad.BUTTON_15=15;c.Gamepad.AXIS_0=0;c.Gamepad.AXIS_1=1;c.Gamepad.AXIS_2=2;c.Gamepad.AXIS_3=3;c.Gamepad.AXIS_4=4;c.Gamepad.AXIS_5=5;c.Gamepad.AXIS_6=6;c.Gamepad.AXIS_7=7;c.Gamepad.AXIS_8=8;c.Gamepad.AXIS_9=9;c.Gamepad.XBOX360_A=0;c.Gamepad.XBOX360_B=1;c.Gamepad.XBOX360_X=
2;c.Gamepad.XBOX360_Y=3;c.Gamepad.XBOX360_LEFT_BUMPER=4;c.Gamepad.XBOX360_RIGHT_BUMPER=5;c.Gamepad.XBOX360_LEFT_TRIGGER=6;c.Gamepad.XBOX360_RIGHT_TRIGGER=7;c.Gamepad.XBOX360_BACK=8;c.Gamepad.XBOX360_START=9;c.Gamepad.XBOX360_STICK_LEFT_BUTTON=10;c.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11;c.Gamepad.XBOX360_DPAD_LEFT=14;c.Gamepad.XBOX360_DPAD_RIGHT=15;c.Gamepad.XBOX360_DPAD_UP=12;c.Gamepad.XBOX360_DPAD_DOWN=13;c.Gamepad.XBOX360_STICK_LEFT_X=0;c.Gamepad.XBOX360_STICK_LEFT_Y=1;c.Gamepad.XBOX360_STICK_RIGHT_X=
2;c.Gamepad.XBOX360_STICK_RIGHT_Y=3;c.Gamepad.PS3XC_X=0;c.Gamepad.PS3XC_CIRCLE=1;c.Gamepad.PS3XC_SQUARE=2;c.Gamepad.PS3XC_TRIANGLE=3;c.Gamepad.PS3XC_L1=4;c.Gamepad.PS3XC_R1=5;c.Gamepad.PS3XC_L2=6;c.Gamepad.PS3XC_R2=7;c.Gamepad.PS3XC_SELECT=8;c.Gamepad.PS3XC_START=9;c.Gamepad.PS3XC_STICK_LEFT_BUTTON=10;c.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11;c.Gamepad.PS3XC_DPAD_UP=12;c.Gamepad.PS3XC_DPAD_DOWN=13;c.Gamepad.PS3XC_DPAD_LEFT=14;c.Gamepad.PS3XC_DPAD_RIGHT=15;c.Gamepad.PS3XC_STICK_LEFT_X=0;c.Gamepad.PS3XC_STICK_LEFT_Y=
1;c.Gamepad.PS3XC_STICK_RIGHT_X=2;c.Gamepad.PS3XC_STICK_RIGHT_Y=3;c.SinglePad=function(b,c){this.game=b;this.index=null;this.connected=!1;this.callbackContext=this;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null;this.deadZone=.26;this._padParent=c;this._prevTimestamp=this._rawPad=null;this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0};c.SinglePad.prototype={addCallbacks:function(b,c){"undefined"!=
typeof c&&(this.onConnectCallback="function"==typeof c.onConnect?c.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof c.onDisconnect?c.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof c.onDown?c.onDown:this.onDownCallback,this.onUpCallback="function"==typeof c.onUp?c.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof c.onAxis?c.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof c.onFloat?c.onFloat:this.onFloatCallback)},
getButton:function(b){return this._buttons[b]?this._buttons[b]:null},pollStatus:function(){if(!(!this.connected||this.game.input.disabled||this.game.input.gamepad.disabled||this._rawPad.timestamp&&this._rawPad.timestamp===this._prevTimestamp)){for(var b=0;b<this._buttonsLen;b++){var c=isNaN(this._rawPad.buttons[b])?this._rawPad.buttons[b].value:this._rawPad.buttons[b];c!==this._buttons[b].value&&(1===c?this.processButtonDown(b,c):0===c?this.processButtonUp(b,c):this.processButtonFloat(b,c))}for(b=
0;b<this._axesLen;b++)c=this._rawPad.axes[b],0<c&&c>this.deadZone||0>c&&c<-this.deadZone?this.processAxisChange(b,c):this.processAxisChange(b,0);this._prevTimestamp=this._rawPad.timestamp}},connect:function(b){var d=!this.connected;this.connected=!0;this.index=b.index;this._rawPad=b;this._buttons=[];this._buttonsLen=b.buttons.length;this._axes=[];this._axesLen=b.axes.length;for(var e=0;e<this._axesLen;e++)this._axes[e]=b.axes[e];for(var g in b.buttons)g=parseInt(g,10),this._buttons[g]=new c.GamepadButton(this,
g);d&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index);d&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var b=this.connected,c=this.index;this.connected=!1;this.index=null;this._rawPad=void 0;for(var e=0;e<this._buttonsLen;e++)this._buttons[e].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;b&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,
c);b&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var b=0;b<this._buttonsLen;b++)this._buttons[b].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null},processAxisChange:function(b,c){this._axes[b]!==c&&(this._axes[b]=c,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,
this,b,c),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,b,c))},processButtonDown:function(b,c){this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,b,c,this.index);this.onDownCallback&&this.onDownCallback.call(this.callbackContext,b,c);this._buttons[b]&&this._buttons[b].processButtonDown(c)},processButtonUp:function(b,c){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,b,c,this.index);
this.onUpCallback&&this.onUpCallback.call(this.callbackContext,b,c);this._buttons[b]&&this._buttons[b].processButtonUp(c)},processButtonFloat:function(b,c){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,b,c,this.index);this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,b,c);this._buttons[b]&&this._buttons[b].processButtonFloat(c)},axis:function(b){return this._axes[b]?this._axes[b]:!1},isDown:function(b){return this._buttons[b]?
this._buttons[b].isDown:!1},isUp:function(b){return this._buttons[b]?this._buttons[b].isUp:!1},justReleased:function(b,c){return this._buttons[b]?this._buttons[b].justReleased(c):void 0},justPressed:function(b,c){return this._buttons[b]?this._buttons[b].justPressed(c):void 0},buttonValue:function(b){return this._buttons[b]?this._buttons[b].value:null},reset:function(){for(var b=0;b<this._axes.length;b++)this._axes[b]=0}};c.SinglePad.prototype.constructor=c.SinglePad;c.GamepadButton=function(b,d){this.pad=
b;this.game=b.game;this.isDown=!1;this.isUp=!0;this.value=this.repeats=this.timeUp=this.duration=this.timeDown=0;this.buttonCode=d;this.onDown=new c.Signal;this.onUp=new c.Signal;this.onFloat=new c.Signal};c.GamepadButton.prototype={processButtonDown:function(b){this.isDown=!0;this.isUp=!1;this.timeDown=this.game.time.now;this.repeats=this.duration=0;this.value=b;this.onDown.dispatch(this,b)},processButtonUp:function(b){this.isDown=!1;this.isUp=!0;this.timeUp=this.game.time.now;this.value=b;this.onUp.dispatch(this,
b)},processButtonFloat:function(b){this.value=b;this.onFloat.dispatch(this,b)},justPressed:function(b){return b=b||250,!0===this.isDown&&this.timeDown+b>this.game.time.now},justReleased:function(b){return b=b||250,!0===this.isUp&&this.timeUp+b>this.game.time.now},reset:function(){this.isDown=!1;this.isUp=!0;this.timeDown=this.game.time.now;this.repeats=this.duration=0},destroy:function(){this.onDown.dispose();this.onUp.dispose();this.onFloat.dispose();this.game=this.pad=null}};c.GamepadButton.prototype.constructor=
c.GamepadButton;c.InputHandler=function(b){this.sprite=b;this.game=b.game;this.checked=this.enabled=!1;this.priorityID=0;this.isDragged=this._setHandCursor=this.useHandCursor=!1;this.allowVerticalDrag=this.allowHorizontalDrag=!0;this.bringToTop=!1;this.snapOffset=null;this.snapOnRelease=this.snapOnDrag=!1;this.snapOffsetY=this.snapOffsetX=this.snapY=this.snapX=0;this.pixelPerfectClick=this.pixelPerfectOver=!1;this.pixelPerfectAlpha=255;this.draggable=!1;this.boundsSprite=this.boundsRect=null;this._wasEnabled=
this._dragPhase=this.scaleLayer=this.consumePointerEvent=!1;this._tempPoint=new c.Point;this._pointerData=[];this._pointerData.push({id:0,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})};c.InputHandler.prototype={start:function(b,d){if(b=b||0,"undefined"==typeof d&&(d=!1),!1===this.enabled){this.game.input.interactiveItems.add(this);this.useHandCursor=d;this.priorityID=b;for(var e=0;10>e;e++)this._pointerData[e]={id:e,x:0,y:0,isDown:!1,
isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new c.Point;this._wasEnabled=this.enabled=!0;this.sprite.events&&null===this.sprite.events.onInputOver&&(this.sprite.events.onInputOver=new c.Signal,this.sprite.events.onInputOut=new c.Signal,this.sprite.events.onInputDown=new c.Signal,this.sprite.events.onInputUp=new c.Signal,this.sprite.events.onDragStart=new c.Signal,this.sprite.events.onDragStop=new c.Signal)}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,
this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.flagged=!1,this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.flagged=this.enabled=!1;for(var b=0;10>b;b++)this._pointerData[b]={id:b,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,
isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(b,c,e){return"undefined"==typeof e&&(e=!0),0===this.sprite.scale.x||0===this.sprite.scale.y||
this.priorityID<this.game.input.minPriorityID?!1:(e||!this.pixelPerfectClick&&!this.pixelPerfectOver)&&(this.priorityID>b||this.priorityID===b&&this.sprite._cache[3]<c)?!0:!1},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(b){return b=b||0,this._pointerData[b].x},pointerY:function(b){return b=b||0,this._pointerData[b].y},pointerDown:function(b){return b=b||0,this._pointerData[b].isDown},pointerUp:function(b){return b=b||0,this._pointerData[b].isUp},
pointerTimeDown:function(b){return b=b||0,this._pointerData[b].timeDown},pointerTimeUp:function(b){return b=b||0,this._pointerData[b].timeUp},pointerOver:function(b){if(this.enabled){if("undefined"!=typeof b)return this._pointerData[b].isOver;for(b=0;10>b;b++)if(this._pointerData[b].isOver)return!0}return!1},pointerOut:function(b){if(this.enabled){if("undefined"!=typeof b)return this._pointerData[b].isOut;for(b=0;10>b;b++)if(this._pointerData[b].isOut)return!0}return!1},pointerTimeOver:function(b){return b=
b||0,this._pointerData[b].timeOver},pointerTimeOut:function(b){return b=b||0,this._pointerData[b].timeOut},pointerDragged:function(b){return b=b||0,this._pointerData[b].isDragged},checkPointerDown:function(b,c){return b.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&this.game.input.hitTest(this.sprite,b,this._tempPoint)?("undefined"==typeof c&&(c=!1),!c&&this.pixelPerfectClick?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1},checkPointerOver:function(b,
c){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&this.game.input.hitTest(this.sprite,b,this._tempPoint)?("undefined"==typeof c&&(c=!1),!c&&this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1},checkPixel:function(b,c,e){if(this.sprite.texture.baseTexture.source){null===b&&null===c&&(this.game.input.getLocalPosition(this.sprite,e,this._tempPoint),b=this._tempPoint.x,c=this._tempPoint.y);if(0!==this.sprite.anchor.x&&
(b-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(c-=-this.sprite.texture.frame.height*this.sprite.anchor.y),b+=this.sprite.texture.frame.x,c+=this.sprite.texture.frame.y,this.sprite.texture.trim&&(b-=this.sprite.texture.trim.x,c-=this.sprite.texture.trim.y,b<this.sprite.texture.crop.x||b>this.sprite.texture.crop.right||c<this.sprite.texture.crop.y||c>this.sprite.texture.crop.bottom))return this._dx=b,this._dy=c,!1;this._dx=b;this._dy=c;this.game.input.hitContext.clearRect(0,
0,1,1);this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,b,c,1,1,0,0,1,1);if(this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(b){return null!==this.sprite&&void 0!==this.sprite.parent?this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this.draggable&&this._draggedPointerID===b.id?this.updateDrag(b):this._pointerData[b.id].isOver?this.checkPointerOver(b)?(this._pointerData[b.id].x=b.x-this.sprite.x,
this._pointerData[b.id].y=b.y-this.sprite.y,!0):(this._pointerOutHandler(b),!1):void 0:(this._pointerOutHandler(b),!1):void 0},_pointerOverHandler:function(b){null!==this.sprite&&(!1===this._pointerData[b.id].isOver||b.dirty)&&(this._pointerData[b.id].isOver=!0,this._pointerData[b.id].isOut=!1,this._pointerData[b.id].timeOver=this.game.time.now,this._pointerData[b.id].x=b.x-this.sprite.x,this._pointerData[b.id].y=b.y-this.sprite.y,this.useHandCursor&&!1===this._pointerData[b.id].isDragged&&(this.game.canvas.style.cursor=
"pointer",this._setHandCursor=!0),this.sprite&&this.sprite.events&&this.sprite.events.onInputOver.dispatch(this.sprite,b))},_pointerOutHandler:function(b){null!==this.sprite&&(this._pointerData[b.id].isOver=!1,this._pointerData[b.id].isOut=!0,this._pointerData[b.id].timeOut=this.game.time.now,this.useHandCursor&&!1===this._pointerData[b.id].isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.sprite&&this.sprite.events&&this.sprite.events.onInputOut.dispatch(this.sprite,
b))},_touchedHandler:function(b){if(null!==this.sprite){if(!1===this._pointerData[b.id].isDown&&!0===this._pointerData[b.id].isOver){if(this.pixelPerfectClick&&!this.checkPixel(null,null,b))return;this._pointerData[b.id].isDown=!0;this._pointerData[b.id].isUp=!1;this._pointerData[b.id].timeDown=this.game.time.now;this.sprite&&this.sprite.events&&this.sprite.events.onInputDown.dispatch(this.sprite,b);b.dirty=!0;this.draggable&&!1===this.isDragged&&this.startDrag(b);this.bringToTop&&this.sprite.bringToTop()}return this.consumePointerEvent}},
_releasedHandler:function(b){null!==this.sprite&&this._pointerData[b.id].isDown&&b.isUp&&(this._pointerData[b.id].isDown=!1,this._pointerData[b.id].isUp=!0,this._pointerData[b.id].timeUp=this.game.time.now,this._pointerData[b.id].downDuration=this._pointerData[b.id].timeUp-this._pointerData[b.id].timeDown,this.checkPointerOver(b)?this.sprite&&this.sprite.events&&this.sprite.events.onInputUp.dispatch(this.sprite,b,!0):(this.sprite&&this.sprite.events&&this.sprite.events.onInputUp.dispatch(this.sprite,
b,!1),this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1)),b.dirty=!0,this.draggable&&this.isDragged&&this._draggedPointerID===b.id&&this.stopDrag(b))},updateDrag:function(b){if(b.isUp)return this.stopDrag(b),!1;var c=this.globalToLocalX(b.x)+this._dragPoint.x+this.dragOffset.x;b=this.globalToLocalY(b.y)+this._dragPoint.y+this.dragOffset.y;return this.sprite.fixedToCamera?(this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=c),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=
b),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)):(this.allowHorizontalDrag&&(this.sprite.x=c),this.allowVerticalDrag&&(this.sprite.y=b),this.boundsRect&&
this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),!0},justOver:function(b,c){return b=b||0,c=c||500,this._pointerData[b].isOver&&this.overDuration(b)<c},justOut:function(b,c){return b=b||0,c=c||500,this._pointerData[b].isOut&&
this.game.time.now-this._pointerData[b].timeOut<c},justPressed:function(b,c){return b=b||0,c=c||500,this._pointerData[b].isDown&&this.downDuration(b)<c},justReleased:function(b,c){return b=b||0,c=c||500,this._pointerData[b].isUp&&this.game.time.now-this._pointerData[b].timeUp<c},overDuration:function(b){return b=b||0,this._pointerData[b].isOver?this.game.time.now-this._pointerData[b].timeOver:-1},downDuration:function(b){return b=b||0,this._pointerData[b].isDown?this.game.time.now-this._pointerData[b].timeDown:
-1},enableDrag:function(b,d,e,g,h,f){"undefined"==typeof b&&(b=!1);"undefined"==typeof d&&(d=!1);"undefined"==typeof e&&(e=!1);"undefined"==typeof g&&(g=255);"undefined"==typeof h&&(h=null);"undefined"==typeof f&&(f=null);this._dragPoint=new c.Point;this.draggable=!0;this.bringToTop=d;this.dragOffset=new c.Point;this.dragFromCenter=b;this.pixelPerfectClick=e;this.pixelPerfectAlpha=g;h&&(this.boundsRect=h);f&&(this.boundsSprite=f)},disableDrag:function(){if(this._pointerData)for(var b=0;10>b;b++)this._pointerData[b].isDragged=
!1;this.isDragged=this.draggable=!1;this._draggedPointerID=-1},startDrag:function(b){if(this.isDragged=!0,this._draggedPointerID=b.id,this._pointerData[b.id].isDragged=!0,this.sprite.fixedToCamera)this.dragFromCenter?(this.sprite.centerOn(b.x,b.y),this._dragPoint.setTo(this.sprite.cameraOffset.x-b.x,this.sprite.cameraOffset.y-b.y)):this._dragPoint.setTo(this.sprite.cameraOffset.x-b.x,this.sprite.cameraOffset.y-b.y);else{if(this.dragFromCenter){var c=this.sprite.getBounds();this.sprite.x=this.globalToLocalX(b.x)+
(this.sprite.x-c.centerX);this.sprite.y=this.globalToLocalY(b.y)+(this.sprite.y-c.centerY)}this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(b.x),this.sprite.y-this.globalToLocalY(b.y))}this.updateDrag(b);this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop());this.sprite.events.onDragStart.dispatch(this.sprite,b)},globalToLocalX:function(b){return this.scaleLayer&&(b-=this.game.scale.grid.boundsFluid.x,b*=this.game.scale.grid.scaleFluidInversed.x),b},globalToLocalY:function(b){return this.scaleLayer&&
(b-=this.game.scale.grid.boundsFluid.y,b*=this.game.scale.grid.scaleFluidInversed.y),b},stopDrag:function(b){this.isDragged=!1;this._draggedPointerID=-1;this._dragPhase=this._pointerData[b.id].isDragged=!1;this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*
this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY));this.sprite.events.onDragStop.dispatch(this.sprite,b);!1===this.checkPointerOver(b)&&this._pointerOutHandler(b)},setDragLock:function(b,c){"undefined"==typeof b&&(b=!0);"undefined"==typeof c&&(c=!0);this.allowHorizontalDrag=
b;this.allowVerticalDrag=c},enableSnap:function(b,c,e,g,h,f){"undefined"==typeof e&&(e=!0);"undefined"==typeof g&&(g=!1);"undefined"==typeof h&&(h=0);"undefined"==typeof f&&(f=0);this.snapX=b;this.snapY=c;this.snapOffsetX=h;this.snapOffsetY=f;this.snapOnDrag=e;this.snapOnRelease=g},disableSnap:function(){this.snapOnRelease=this.snapOnDrag=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+
this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.x<this.boundsRect.left?this.sprite.x=this.boundsRect.x:this.sprite.x+this.sprite.width>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-
this.sprite.width),this.sprite.y<this.boundsRect.top?this.sprite.y=this.boundsRect.top:this.sprite.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-this.sprite.height))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.camerOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.camerOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.camerOffset.x+this.boundsSprite.width&&
(this.sprite.cameraOffset.x=this.boundsSprite.camerOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.camerOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.camerOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.camerOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.camerOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.x<this.boundsSprite.x?this.sprite.x=this.boundsSprite.x:this.sprite.x+
this.sprite.width>this.boundsSprite.x+this.boundsSprite.width&&(this.sprite.x=this.boundsSprite.x+this.boundsSprite.width-this.sprite.width),this.sprite.y<this.boundsSprite.y?this.sprite.y=this.boundsSprite.y:this.sprite.y+this.sprite.height>this.boundsSprite.y+this.boundsSprite.height&&(this.sprite.y=this.boundsSprite.y+this.boundsSprite.height-this.sprite.height))}};c.InputHandler.prototype.constructor=c.InputHandler;c.Events=function(b){this.parent=b;this.onAddedToGroup=new c.Signal;this.onRemovedFromGroup=
new c.Signal;this.onDestroy=new c.Signal;this.onKilled=new c.Signal;this.onRevived=new c.Signal;this.onOutOfBounds=new c.Signal;this.onEnterBounds=new c.Signal;this.onAnimationLoop=this.onAnimationComplete=this.onAnimationStart=this.onDragStop=this.onDragStart=this.onInputUp=this.onInputDown=this.onInputOut=this.onInputOver=null};c.Events.prototype={destroy:function(){this.parent=null;this.onDestroy.dispose();this.onAddedToGroup.dispose();this.onRemovedFromGroup.dispose();this.onKilled.dispose();
this.onRevived.dispose();this.onOutOfBounds.dispose();this.onInputOver&&(this.onInputOver.dispose(),this.onInputOut.dispose(),this.onInputDown.dispose(),this.onInputUp.dispose(),this.onDragStart.dispose(),this.onDragStop.dispose());this.onAnimationStart&&(this.onAnimationStart.dispose(),this.onAnimationComplete.dispose(),this.onAnimationLoop.dispose())}};c.Events.prototype.constructor=c.Events;c.GameObjectFactory=function(b){this.game=b;this.world=this.game.world};c.GameObjectFactory.prototype={existing:function(b){return this.world.add(b)},
image:function(b,d,e,g,h){return"undefined"==typeof h&&(h=this.world),h.add(new c.Image(this.game,b,d,e,g))},sprite:function(b,c,e,g,h){return"undefined"==typeof h&&(h=this.world),h.create(b,c,e,g)},tween:function(b){return this.game.tweens.create(b)},group:function(b,d,e,g,h){return new c.Group(this.game,b,d,e,g,h)},physicsGroup:function(b,d,e,g){return new c.Group(this.game,d,e,g,!0,b)},spriteBatch:function(b,d,e){return"undefined"==typeof b&&(b=null),"undefined"==typeof d&&(d="group"),"undefined"==
typeof e&&(e=!1),new c.SpriteBatch(this.game,b,d,e)},audio:function(b,c,e,g){return this.game.sound.add(b,c,e,g)},sound:function(b,c,e,g){return this.game.sound.add(b,c,e,g)},audioSprite:function(b){return this.game.sound.addSprite(b)},tileSprite:function(b,d,e,g,h,f,k){return"undefined"==typeof k&&(k=this.world),k.add(new c.TileSprite(this.game,b,d,e,g,h,f))},rope:function(b,d,e,g,h,f){return"undefined"==typeof f&&(f=this.world),f.add(new c.Rope(this.game,b,d,e,g,h))},text:function(b,d,e,g,h){return"undefined"==
typeof h&&(h=this.world),h.add(new c.Text(this.game,b,d,e,g))},button:function(b,d,e,g,h,f,k,m,n,p){return"undefined"==typeof p&&(p=this.world),p.add(new c.Button(this.game,b,d,e,g,h,f,k,m,n))},graphics:function(b,d,e){return"undefined"==typeof e&&(e=this.world),e.add(new c.Graphics(this.game,b,d))},emitter:function(b,d,e){return this.game.particles.add(new c.Particles.Arcade.Emitter(this.game,b,d,e))},retroFont:function(b,d,e,g,h,f,k,m,n){return new c.RetroFont(this.game,b,d,e,g,h,f,k,m,n)},bitmapText:function(b,
d,e,g,h,f){return"undefined"==typeof f&&(f=this.world),f.add(new c.BitmapText(this.game,b,d,e,g,h))},tilemap:function(b,d,e,g,h){return new c.Tilemap(this.game,b,d,e,g,h)},renderTexture:function(b,d,e,g){"undefined"!=typeof e&&""!==e||(e=this.game.rnd.uuid());"undefined"==typeof g&&(g=!1);b=new c.RenderTexture(this.game,b,d,e);return g&&this.game.cache.addRenderTexture(e,b),b},bitmapData:function(b,d,e,g){"undefined"==typeof g&&(g=!1);"undefined"!=typeof e&&""!==e||(e=this.game.rnd.uuid());b=new c.BitmapData(this.game,
e,b,d);return g&&this.game.cache.addBitmapData(e,b),b},filter:function(b){var d=Array.prototype.splice.call(arguments,1);b=new c.Filter[b](this.game);return b.init.apply(b,d),b},plugin:function(b){return this.game.plugins.add(b)}};c.GameObjectFactory.prototype.constructor=c.GameObjectFactory;c.GameObjectCreator=function(b){this.game=b;this.world=this.game.world};c.GameObjectCreator.prototype={image:function(b,d,e,g){return new c.Image(this.game,b,d,e,g)},sprite:function(b,d,e,g){return new c.Sprite(this.game,
b,d,e,g)},tween:function(b){return new c.Tween(b,this.game)},group:function(b,d,e,g,h){return new c.Group(this.game,null,d,e,g,h)},spriteBatch:function(b,d,e){return"undefined"==typeof d&&(d="group"),"undefined"==typeof e&&(e=!1),new c.SpriteBatch(this.game,b,d,e)},audio:function(b,c,e,g){return this.game.sound.add(b,c,e,g)},audioSprite:function(b){return this.game.sound.addSprite(b)},sound:function(b,c,e,g){return this.game.sound.add(b,c,e,g)},tileSprite:function(b,d,e,g,h,f){return new c.TileSprite(this.game,
b,d,e,g,h,f)},rope:function(b,d,e,g,h){return new c.Rope(this.game,b,d,e,g,h)},text:function(b,d,e,g){return new c.Text(this.game,b,d,e,g)},button:function(b,d,e,g,h,f,k,m,n){return new c.Button(this.game,b,d,e,g,h,f,k,m,n)},graphics:function(b,d){return new c.Graphics(this.game,b,d)},emitter:function(b,d,e){return new c.Particles.Arcade.Emitter(this.game,b,d,e)},retroFont:function(b,d,e,g,h,f,k,m,n){return new c.RetroFont(this.game,b,d,e,g,h,f,k,m,n)},bitmapText:function(b,d,e,g,h){return new c.BitmapText(this.game,
b,d,e,g,h)},tilemap:function(b,d,e,g,h){return new c.Tilemap(this.game,b,d,e,g,h)},renderTexture:function(b,d,e,g){"undefined"!=typeof e&&""!==e||(e=this.game.rnd.uuid());"undefined"==typeof g&&(g=!1);b=new c.RenderTexture(this.game,b,d,e);return g&&this.game.cache.addRenderTexture(e,b),b},bitmapData:function(b,d,e,g){"undefined"==typeof g&&(g=!1);"undefined"!=typeof e&&""!==e||(e=this.game.rnd.uuid());b=new c.BitmapData(this.game,e,b,d);return g&&this.game.cache.addBitmapData(e,b),b},filter:function(b){var d=
Array.prototype.splice.call(arguments,1);b=new c.Filter[b](this.game);return b.init.apply(b,d),b}};c.GameObjectCreator.prototype.constructor=c.GameObjectCreator;c.BitmapData=function(b,d,e,g){"undefined"==typeof e&&(e=256);"undefined"==typeof g&&(g=256);this.game=b;this.key=d;this.width=e;this.height=g;this.canvas=c.Canvas.create(e,g,"",!0);this.ctx=this.context=this.canvas.getContext("2d");this.imageData=this.context.getImageData(0,0,e,g);this.data=this.imageData.data;this.pixels=null;this.imageData.data.buffer?
(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data;this.baseTexture=new PIXI.BaseTexture(this.canvas);this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new c.Frame(0,0,0,e,g,"bitmapData",b.rnd.uuid());this.texture.frame=this.textureFrame;this.type=c.BITMAPDATA;this.dirty=this.disableTextureUpload=!1;this.cls=
this.clear;this._image=null;this._pos=new c.Point;this._size=new c.Point;this._scale=new c.Point;this._rotate=0;this._alpha={prev:1,current:1};this._anchor=new c.Point;this._tempB=this._tempG=this._tempR=0;this._circle=new c.Circle};c.BitmapData.prototype={add:function(b){if(Array.isArray(b))for(var c=0;c<b.length;c++)b[c].loadTexture&&b[c].loadTexture(this);else b.loadTexture(this);return this},load:function(b){return"string"==typeof b&&(b=this.game.cache.getImage(b)),b?(this.resize(b.width,b.height),
this.cls(),this.draw(b),this.update(),this):void 0},clear:function(){return this.context.clearRect(0,0,this.width,this.height),this.dirty=!0,this},fill:function(b,c,e,g){return"undefined"==typeof g&&(g=1),this.context.fillStyle="rgba("+b+","+c+","+e+","+g+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0,this},resize:function(b,c){return(b!==this.width||c!==this.height)&&(this.width=b,this.height=c,this.canvas.width=b,this.canvas.height=c,this.baseTexture.width=b,this.baseTexture.height=
c,this.textureFrame.width=b,this.textureFrame.height=c,this.texture.width=b,this.texture.height=c,this.texture.crop.width=b,this.texture.crop.height=c,this.update(),this.dirty=!0),this},update:function(b,c,e,g){return"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=0),"undefined"==typeof e&&(e=this.width),"undefined"==typeof g&&(g=this.height),this.imageData=this.context.getImageData(b,c,e,g),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=
new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this},processPixelRGB:function(b,d,e,g,h,f){"undefined"==typeof e&&(e=0);"undefined"==typeof g&&(g=0);"undefined"==typeof h&&(h=this.width);"undefined"==typeof f&&(f=this.height);h=e+h;f=g+f;for(var k=c.Color.createColor(),m={r:0,g:0,b:0,a:0},n=!1;f>g;g++)for(var p=e;h>p;p++)c.Color.unpackPixel(this.getPixel32(p,g),k),m=
b.call(d,k,p,g),!1!==m&&null!==m&&void 0!==m&&(this.setPixel32(p,g,m.r,m.g,m.b,m.a,!1),n=!0);return n&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},processPixel:function(b,c,e,g,h,f){"undefined"==typeof e&&(e=0);"undefined"==typeof g&&(g=0);"undefined"==typeof h&&(h=this.width);"undefined"==typeof f&&(f=this.height);h=e+h;f=g+f;for(var k=0,m=0,n=!1;f>g;g++)for(var p=e;h>p;p++)k=this.getPixel32(p,g),m=b.call(c,k,p,g),m!==k&&(this.pixels[g*this.width+p]=m,n=!0);return n&&(this.context.putImageData(this.imageData,
0,0),this.dirty=!0),this},replaceRGB:function(b,d,e,g,h,f,k,m,n){var p=0,q=0,r=this.width,t=this.height;b=c.Color.packPixel(b,d,e,g);void 0!==n&&n instanceof c.Rectangle&&(p=n.x,q=n.y,r=n.width,t=n.height);for(n=0;t>n;n++)for(d=0;r>d;d++)this.getPixel32(p+d,q+n)===b&&this.setPixel32(p+d,q+n,h,f,k,m,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this},setHSL:function(b,d,e,g){if(("undefined"==typeof b||null===b)&&(b=!1),("undefined"==typeof d||null===d)&&(d=!1),("undefined"==
typeof e||null===e)&&(e=!1),b||d||e){"undefined"==typeof g&&(g=new c.Rectangle(0,0,this.width,this.height));for(var h=c.Color.createColor(),f=g.y;f<g.bottom;f++)for(var k=g.x;k<g.right;k++)c.Color.unpackPixel(this.getPixel32(k,f),h,!0),b&&(h.h=b),d&&(h.s=d),e&&(h.l=e),c.Color.HSLtoRGB(h.h,h.s,h.l,h),this.setPixel32(k,f,h.r,h.g,h.b,h.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},shiftHSL:function(b,d,e,g){if(("undefined"==typeof b||null===b)&&(b=!1),("undefined"==
typeof d||null===d)&&(d=!1),("undefined"==typeof e||null===e)&&(e=!1),b||d||e){"undefined"==typeof g&&(g=new c.Rectangle(0,0,this.width,this.height));for(var h=c.Color.createColor(),f=g.y;f<g.bottom;f++)for(var k=g.x;k<g.right;k++)c.Color.unpackPixel(this.getPixel32(k,f),h,!0),b&&(h.h=this.game.math.wrap(h.h+b,0,1)),d&&(h.s=this.game.math.limitValue(h.s+d,0,1)),e&&(h.l=this.game.math.limitValue(h.l+e,0,1)),c.Color.HSLtoRGB(h.h,h.s,h.l,h),this.setPixel32(k,f,h.r,h.g,h.b,h.a,!1);return this.context.putImageData(this.imageData,
0,0),this.dirty=!0,this}},setPixel32:function(b,d,e,g,h,f,k){return"undefined"==typeof k&&(k=!0),0<=b&&b<=this.width&&0<=d&&d<=this.height&&(this.pixels[d*this.width+b]=c.Device.LITTLE_ENDIAN?f<<24|h<<16|g<<8|e:e<<24|g<<16|h<<8|f,k&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)),this},setPixel:function(b,c,e,g,h,f){return this.setPixel32(b,c,e,g,h,255,f)},getPixel:function(b,d,e){e||(e=c.Color.createColor());b=~~(b+d*this.width);return b*=4,e.r=this.data[b],e.g=this.data[++b],e.b=
this.data[++b],e.a=this.data[++b],e},getPixel32:function(b,c){return 0<=b&&b<=this.width&&0<=c&&c<=this.height?this.pixels[c*this.width+b]:void 0},getPixelRGB:function(b,d,e,g,h){return c.Color.unpackPixel(this.getPixel32(b,d),e,g,h)},getPixels:function(b){return this.context.getImageData(b.x,b.y,b.width,b.height)},getFirstPixel:function(b){"undefined"==typeof b&&(b=0);var d=c.Color.createColor(),e=0,g=0,h=1,f=!1;1===b?(h=-1,g=this.height):3===b&&(h=-1,e=this.width);do c.Color.unpackPixel(this.getPixel32(e,
g),d),0===b||1===b?(e++,e===this.width&&(e=0,g+=h,(g>=this.height||0>=g)&&(f=!0))):(2===b||3===b)&&(g++,g===this.height&&(g=0,e+=h,(e>=this.width||0>=e)&&(f=!0)));while(0===d.a&&!f);return d.x=e,d.y=g,d},getBounds:function(b){return"undefined"==typeof b&&(b=new c.Rectangle),b.x=this.getFirstPixel(2).x,b.x===this.width?b.setTo(0,0,0,0):(b.y=this.getFirstPixel(0).y,b.width=this.getFirstPixel(3).x-b.x+1,b.height=this.getFirstPixel(1).y-b.y+1,b)},addToWorld:function(b,c,e,g,h,f){h=h||1;f=f||1;b=this.game.add.image(b,
c,this);return b.anchor.set(e,g),b.scale.set(h,f),b},copy:function(b,d,e,g,h,f,k,m,n,p,q,r,t,w,v,u,y){if(("undefined"==typeof b||null===b)&&(b=this),this._image=b,b instanceof c.Sprite||b instanceof c.Image||b instanceof c.Text)this._pos.set(b.texture.crop.x,b.texture.crop.y),this._size.set(b.texture.crop.width,b.texture.crop.height),this._scale.set(b.scale.x,b.scale.y),this._anchor.set(b.anchor.x,b.anchor.y),this._rotate=b.rotation,this._alpha.current=b.alpha,this._image=b.texture.baseTexture.source,
b.texture.trim&&(f+=b.texture.trim.x-b.anchor.x*b.texture.trim.width,k+=b.texture.trim.y-b.anchor.y*b.texture.trim.height),16777215!==b.tint&&(b.cachedTint!==b.tint&&(b.cachedTint=b.tint,b.tintedTexture=PIXI.CanvasTinter.getTintedTexture(b,b.tint)),this._image=b.tintedTexture);else{if(this._pos.set(0),this._scale.set(1),this._anchor.set(0),this._rotate=0,this._alpha.current=1,b instanceof c.BitmapData)this._image=b.canvas;else if("string"==typeof b){if(b=this.game.cache.getImage(b),null===b)return;
this._image=b}this._size.set(this._image.width,this._image.height)}return("undefined"==typeof d||null===d)&&(d=0),("undefined"==typeof e||null===e)&&(e=0),g&&(this._size.x=g),h&&(this._size.y=h),("undefined"==typeof f||null===f)&&(f=d),("undefined"==typeof k||null===k)&&(k=e),("undefined"==typeof m||null===m)&&(m=this._size.x),("undefined"==typeof n||null===n)&&(n=this._size.y),"number"==typeof p&&(this._rotate=p),"number"==typeof q&&(this._anchor.x=q),"number"==typeof r&&(this._anchor.y=r),"number"==
typeof t&&(this._scale.x=t),"number"==typeof w&&(this._scale.y=w),"number"==typeof v&&(this._alpha.current=v),"undefined"==typeof u&&(u=null),"undefined"==typeof y&&(y=!1),0>=this._alpha.current||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y?void 0:(this._alpha.prev=this.context.globalAlpha,this.context.save(),this.context.globalAlpha=this._alpha.current,u&&(this.context.globalCompositeOperation=u),y&&(f|=0,k|=0),this.context.translate(f,k),this.context.scale(this._scale.x,
this._scale.y),this.context.rotate(this._rotate),this.context.drawImage(this._image,this._pos.x+d,this._pos.y+e,this._size.x,this._size.y,-m*this._anchor.x,-n*this._anchor.y,m,n),this.context.restore(),this.context.globalAlpha=this._alpha.prev,this.dirty=!0,this)},copyRect:function(b,c,e,g,h,f,k){return this.copy(b,c.x,c.y,c.width,c.height,e,g,c.width,c.height,0,0,0,1,1,h,f,k)},draw:function(b,c,e,g,h,f,k){return this.copy(b,null,null,null,null,c,e,g,h,null,null,null,null,null,null,f,k)},shadow:function(b,
c,e,g){"undefined"==typeof b||null===b?this.context.shadowColor="rgba(0,0,0,0)":(this.context.shadowColor=b,this.context.shadowBlur=c||5,this.context.shadowOffsetX=e||10,this.context.shadowOffsetY=g||10)},alphaMask:function(b,c,e,g){return"undefined"==typeof g||null===g?this.draw(c).blendSourceAtop():this.draw(c,g.x,g.y,g.width,g.height).blendSourceAtop(),"undefined"==typeof e||null===e?this.draw(b).blendReset():this.draw(b,e.x,e.y,e.width,e.height).blendReset(),this},extract:function(b,c,e,g,h,f,
k,m,n){return"undefined"==typeof h&&(h=255),"undefined"==typeof f&&(f=!1),"undefined"==typeof k&&(k=c),"undefined"==typeof m&&(m=e),"undefined"==typeof n&&(n=g),f&&b.resize(this.width,this.height),this.processPixelRGB(function(f,l,r){return f.r===c&&f.g===e&&f.b===g&&b.setPixel32(l,r,k,m,n,h,!1),!1},this),b.context.putImageData(b.imageData,0,0),b.dirty=!0,b},rect:function(b,c,e,g,h){return"undefined"!=typeof h&&(this.context.fillStyle=h),this.context.fillRect(b,c,e,g),this},circle:function(b,c,e,
g){return"undefined"!=typeof g&&(this.context.fillStyle=g),this.context.beginPath(),this.context.arc(b,c,e,0,2*Math.PI,!1),this.context.closePath(),this.context.fill(),this},textureLine:function(b,d,e){if("undefined"==typeof e&&(e="repeat-x"),"string"!=typeof d||(d=this.game.cache.getImage(d))){var g=b.length;return"no-repeat"===e&&g>d.width&&(g=d.width),this.context.fillStyle=this.context.createPattern(d,e),this._circle=new c.Circle(b.start.x,b.start.y,d.height),this._circle.circumferencePoint(b.angle-
1.5707963267948966,!1,this._pos),this.context.save(),this.context.translate(this._pos.x,this._pos.y),this.context.rotate(b.angle),this.context.fillRect(0,0,g,d.height),this.context.restore(),this.dirty=!0,this}},render:function(){return!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1),this},blendReset:function(){return this.context.globalCompositeOperation="source-over",this},blendSourceOver:function(){return this.context.globalCompositeOperation="source-over",this},
blendSourceIn:function(){return this.context.globalCompositeOperation="source-in",this},blendSourceOut:function(){return this.context.globalCompositeOperation="source-out",this},blendSourceAtop:function(){return this.context.globalCompositeOperation="source-atop",this},blendDestinationOver:function(){return this.context.globalCompositeOperation="destination-over",this},blendDestinationIn:function(){return this.context.globalCompositeOperation="destination-in",this},blendDestinationOut:function(){return this.context.globalCompositeOperation=
"destination-out",this},blendDestinationAtop:function(){return this.context.globalCompositeOperation="destination-atop",this},blendXor:function(){return this.context.globalCompositeOperation="xor",this},blendAdd:function(){return this.context.globalCompositeOperation="lighter",this},blendMultiply:function(){return this.context.globalCompositeOperation="multiply",this},blendScreen:function(){return this.context.globalCompositeOperation="screen",this},blendOverlay:function(){return this.context.globalCompositeOperation=
"overlay",this},blendDarken:function(){return this.context.globalCompositeOperation="darken",this},blendLighten:function(){return this.context.globalCompositeOperation="lighten",this},blendColorDodge:function(){return this.context.globalCompositeOperation="color-dodge",this},blendColorBurn:function(){return this.context.globalCompositeOperation="color-burn",this},blendHardLight:function(){return this.context.globalCompositeOperation="hard-light",this},blendSoftLight:function(){return this.context.globalCompositeOperation=
"soft-light",this},blendDifference:function(){return this.context.globalCompositeOperation="difference",this},blendExclusion:function(){return this.context.globalCompositeOperation="exclusion",this},blendHue:function(){return this.context.globalCompositeOperation="hue",this},blendSaturation:function(){return this.context.globalCompositeOperation="saturation",this},blendColor:function(){return this.context.globalCompositeOperation="color",this},blendLuminosity:function(){return this.context.globalCompositeOperation=
"luminosity",this}};Object.defineProperty(c.BitmapData.prototype,"smoothed",{get:function(){c.Canvas.getSmoothingEnabled(this.context)},set:function(b){c.Canvas.setSmoothingEnabled(this.context,b)}});c.BitmapData.getTransform=function(b,c,e,g,h,f){return"number"!=typeof b&&(b=0),"number"!=typeof c&&(c=0),"number"!=typeof e&&(e=1),"number"!=typeof g&&(g=1),"number"!=typeof h&&(h=0),"number"!=typeof f&&(f=0),{sx:e,sy:g,scaleX:e,scaleY:g,skewX:h,skewY:f,translateX:b,translateY:c,tx:b,ty:c}};c.BitmapData.prototype.constructor=
c.BitmapData;c.Sprite=function(b,d,e,g,h){d=d||0;e=e||0;g=g||null;h=h||null;this.game=b;this.name="";this.type=c.SPRITE;this.z=0;this.events=new c.Events(this);this.animations=new c.AnimationManager(this);this.key=g;PIXI.Sprite.call(this,PIXI.TextureCache.__default);this.position.set(d,e);this.world=new c.Point(d,e);this.autoCull=!1;this.body=this.input=null;this.alive=!0;this.health=1;this.lifespan=0;this.debug=this.outOfBoundsKill=this.checkWorldBounds=!1;this.cameraOffset=new c.Point;this.cropRect=
null;this._cache=[0,0,0,0,1,0,1,0];this._frame=this._crop=null;this._bounds=new c.Rectangle;this.loadTexture(g,h)};c.Sprite.prototype=Object.create(PIXI.Sprite.prototype);c.Sprite.prototype.constructor=c.Sprite;c.Sprite.prototype.preUpdate=function(){if(1===this._cache[4]&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this._cache[0]=this.world.x,this._cache[1]=
this.world.y,this._cache[2]=this.rotation,this.body&&this.body.preUpdate(),this._cache[4]=0,!1;if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;if(0<this.lifespan&&(this.lifespan-=this.game.time.elapsed,0>=this.lifespan))return this.kill(),!1;if((this.autoCull||this.checkWorldBounds)&&this._bounds.copyFrom(this.getBounds()),this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this._bounds)),
this.checkWorldBounds)if(1===this._cache[5]&&this.game.world.bounds.intersects(this._bounds))this._cache[5]=0,this.events.onEnterBounds.dispatch(this);else if(0===this._cache[5]&&!this.game.world.bounds.intersects(this._bounds)&&(this._cache[5]=1,this.events.onOutOfBounds.dispatch(this),this.outOfBoundsKill))return this.kill(),!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);
this.animations.update();this.body&&this.body.preUpdate();for(var b=0,c=this.children.length;c>b;b++)this.children[b].preUpdate();return!0};c.Sprite.prototype.update=function(){};c.Sprite.prototype.postUpdate=function(){this.key instanceof c.BitmapData&&this.key.render();this.exists&&this.body&&this.body.postUpdate();1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);
for(var b=0,d=this.children.length;d>b;b++)this.children[b].postUpdate()};c.Sprite.prototype.loadTexture=function(b,d,e){d=d||0;(e||"undefined"==typeof e)&&this.animations.stop();this.key=b;e=!0;var g=this.smoothed;b instanceof c.RenderTexture?(this.key=b.key,this.setTexture(b)):b instanceof c.BitmapData?(this.setTexture(b.texture),this.game.cache.getFrameData(b.key,c.Cache.BITMAPDATA)&&(e=!this.animations.loadFrameData(this.game.cache.getFrameData(b.key,c.Cache.BITMAPDATA),d))):b instanceof PIXI.Texture?
this.setTexture(b):null===b||"undefined"==typeof b?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key])):"string"!=typeof b||this.game.cache.checkImageKey(b)?(this.setTexture(new PIXI.Texture(PIXI.BaseTextureCache[b])),e=!this.animations.loadFrameData(this.game.cache.getFrameData(b),d)):(console.warn("Texture with key '"+b+"' not found."),this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]));this.texture.baseTexture.dirty();e&&(this._frame=c.Rectangle.clone(this.texture.frame));
g||(this.smoothed=!1)};c.Sprite.prototype.setFrame=function(b){this._frame=b;this.texture.frame.x=b.x;this.texture.frame.y=b.y;this.texture.frame.width=b.width;this.texture.frame.height=b.height;this.texture.crop.x=b.x;this.texture.crop.y=b.y;this.texture.crop.width=b.width;this.texture.crop.height=b.height;b.trimmed?(this.texture.trim?(this.texture.trim.x=b.spriteSourceSizeX,this.texture.trim.y=b.spriteSourceSizeY,this.texture.trim.width=b.sourceSizeW,this.texture.trim.height=b.sourceSizeH):this.texture.trim=
{x:b.spriteSourceSizeX,y:b.spriteSourceSizeY,width:b.sourceSizeW,height:b.sourceSizeH},this.texture.width=b.sourceSizeW,this.texture.height=b.sourceSizeH,this.texture.frame.width=b.sourceSizeW,this.texture.frame.height=b.sourceSizeH):!b.trimmed&&this.texture.trim&&(this.texture.trim=null);this.cropRect&&this.updateCrop();this.texture._updateUvs()};c.Sprite.prototype.resetFrame=function(){this._frame&&this.setFrame(this._frame)};c.Sprite.prototype.crop=function(b,d){"undefined"==typeof d&&(d=!1);b?
(d&&null!==this.cropRect?this.cropRect.setTo(b.x,b.y,b.width,b.height):this.cropRect=d&&null===this.cropRect?new c.Rectangle(b.x,b.y,b.width,b.height):b,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())};c.Sprite.prototype.updateCrop=function(){if(this.cropRect){this._crop=c.Rectangle.clone(this.cropRect,this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var b=Math.max(this._frame.x,this._crop.x),d=Math.max(this._frame.y,this._crop.y),e=Math.min(this._frame.right,
this._crop.right)-b,g=Math.min(this._frame.bottom,this._crop.bottom)-d;this.texture.crop.x=b;this.texture.crop.y=d;this.texture.crop.width=e;this.texture.crop.height=g;this.texture.frame.width=Math.min(e,this.cropRect.width);this.texture.frame.height=Math.min(g,this.cropRect.height);this.texture.width=this.texture.frame.width;this.texture.height=this.texture.frame.height;this.texture._updateUvs()}};c.Sprite.prototype.revive=function(b){return"undefined"==typeof b&&(b=1),this.alive=!0,this.exists=
!0,this.visible=!0,this.health=b,this.events&&this.events.onRevived.dispatch(this),this};c.Sprite.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled.dispatch(this),this};c.Sprite.prototype.destroy=function(b){if(null!==this.game&&1!==this._cache[8]){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.events&&this.events.onDestroy.dispatch(this);this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));
this.input&&this.input.destroy();this.animations&&this.animations.destroy();this.body&&this.body.destroy();this.events&&this.events.destroy();var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);else for(;d--;)this.removeChild(this.children[d]);this._crop&&(this._crop=null);this._frame&&(this._frame=null);this.visible=this.exists=this.alive=!1;this.game=this.mask=this.filters=null;this._cache[8]=0}};c.Sprite.prototype.damage=function(b){return this.alive&&(this.health-=b,0>=this.health&&
this.kill()),this};c.Sprite.prototype.reset=function(b,c,e){return"undefined"==typeof e&&(e=1),this.world.setTo(b,c),this.position.x=b,this.position.y=c,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.health=e,this.body&&this.body.reset(b,c,!1,!1),this._cache[4]=1,this};c.Sprite.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this};c.Sprite.prototype.play=function(b,c,e,g){return this.animations?this.animations.play(b,
c,e,g):void 0};c.Sprite.prototype.overlap=function(b){return c.Rectangle.intersects(this.getBounds(),b.getBounds())};Object.defineProperty(c.Sprite.prototype,"angle",{get:function(){return c.Math.wrapAngle(c.Math.radToDeg(this.rotation))},set:function(b){this.rotation=c.Math.degToRad(c.Math.wrapAngle(b))}});Object.defineProperty(c.Sprite.prototype,"deltaX",{get:function(){return this.world.x-this._cache[0]}});Object.defineProperty(c.Sprite.prototype,"deltaY",{get:function(){return this.world.y-this._cache[1]}});
Object.defineProperty(c.Sprite.prototype,"deltaZ",{get:function(){return this.rotation-this._cache[2]}});Object.defineProperty(c.Sprite.prototype,"inWorld",{get:function(){return this.game.world.bounds.intersects(this.getBounds())}});Object.defineProperty(c.Sprite.prototype,"inCamera",{get:function(){return this.game.world.camera.screenView.intersects(this.getBounds())}});Object.defineProperty(c.Sprite.prototype,"frame",{get:function(){return this.animations.frame},set:function(b){this.animations.frame=
b}});Object.defineProperty(c.Sprite.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(b){this.animations.frameName=b}});Object.defineProperty(c.Sprite.prototype,"renderOrderID",{get:function(){return this._cache[3]}});Object.defineProperty(c.Sprite.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():
this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.Sprite.prototype,"exists",{get:function(){return!!this._cache[6]},set:function(b){b?(this._cache[6]=1,this.body&&this.body.type===c.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._cache[6]=0,this.body&&this.body.type===c.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}});Object.defineProperty(c.Sprite.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(b){b?(this._cache[7]=
1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.Sprite.prototype,"smoothed",{get:function(){return!this.texture.baseTexture.scaleMode},set:function(b){b?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}});Object.defineProperty(c.Sprite.prototype,"x",{get:function(){return this.position.x},set:function(b){this.position.x=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=
1)}});Object.defineProperty(c.Sprite.prototype,"y",{get:function(){return this.position.y},set:function(b){this.position.y=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}});Object.defineProperty(c.Sprite.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.Image=function(b,d,e,g,h){d=d||0;e=e||0;g=g||null;h=h||null;this.game=b;this.exists=!0;this.name="";this.type=c.IMAGE;this.z=0;this.events=new c.Events(this);this.animations=new c.AnimationManager(this);
this.key=g;PIXI.Sprite.call(this,PIXI.TextureCache.__default);this.position.set(d,e);this.world=new c.Point(d,e);this.alive=!0;this.autoCull=!1;this.input=null;this.debug=!1;this.cameraOffset=new c.Point;this.cropRect=null;this._cache=[0,0,0,0,1,0,1,0,0];this._frame=this._crop=null;this._bounds=new c.Rectangle;this.loadTexture(g,h)};c.Image.prototype=Object.create(PIXI.Sprite.prototype);c.Image.prototype.constructor=c.Image;c.Image.prototype.preUpdate=function(){if(this._cache[0]=this.world.x,this._cache[1]=
this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;this.autoCull&&(this._bounds.copyFrom(this.getBounds()),this.renderable=this.game.world.camera.screenView.intersects(this._bounds));this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);for(var b=0,c=this.children.length;c>b;b++)this.children[b].preUpdate();return!0};c.Image.prototype.update=
function(){};c.Image.prototype.postUpdate=function(){this.key instanceof c.BitmapData&&this.key.render();1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);for(var b=0,d=this.children.length;d>b;b++)this.children[b].postUpdate()};c.Image.prototype.loadTexture=function(b,d){d=d||0;this.key=b;var e=!0,g=this.smoothed;b instanceof c.RenderTexture?(this.key=
b.key,this.setTexture(b)):b instanceof c.BitmapData?(this.setTexture(b.texture),this.game.cache.getFrameData(b.key,c.Cache.BITMAPDATA)&&(e=!this.animations.loadFrameData(this.game.cache.getFrameData(b.key,c.Cache.BITMAPDATA),d))):b instanceof PIXI.Texture?this.setTexture(b):null===b||"undefined"==typeof b?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key])):"string"!=typeof b||this.game.cache.checkImageKey(b)?(this.setTexture(new PIXI.Texture(PIXI.BaseTextureCache[b])),e=!this.animations.loadFrameData(this.game.cache.getFrameData(b),
d)):(console.warn("Texture with key '"+b+"' not found."),this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]));this.texture.baseTexture.dirty();e&&(this._frame=c.Rectangle.clone(this.texture.frame));g||(this.smoothed=!1)};c.Image.prototype.setFrame=function(b){this._frame=b;this.texture.frame.x=b.x;this.texture.frame.y=b.y;this.texture.frame.width=b.width;this.texture.frame.height=b.height;this.texture.crop.x=b.x;this.texture.crop.y=b.y;this.texture.crop.width=b.width;this.texture.crop.height=
b.height;b.trimmed?(this.texture.trim?(this.texture.trim.x=b.spriteSourceSizeX,this.texture.trim.y=b.spriteSourceSizeY,this.texture.trim.width=b.sourceSizeW,this.texture.trim.height=b.sourceSizeH):this.texture.trim={x:b.spriteSourceSizeX,y:b.spriteSourceSizeY,width:b.sourceSizeW,height:b.sourceSizeH},this.texture.width=b.sourceSizeW,this.texture.height=b.sourceSizeH,this.texture.frame.width=b.sourceSizeW,this.texture.frame.height=b.sourceSizeH):!b.trimmed&&this.texture.trim&&(this.texture.trim=null);
this.cropRect&&this.updateCrop();this.texture._updateUvs()};c.Image.prototype.resetFrame=function(){this._frame&&this.setFrame(this._frame)};c.Image.prototype.crop=function(b,d){"undefined"==typeof d&&(d=!1);b?(d&&null!==this.cropRect?this.cropRect.setTo(b.x,b.y,b.width,b.height):this.cropRect=d&&null===this.cropRect?new c.Rectangle(b.x,b.y,b.width,b.height):b,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())};c.Image.prototype.updateCrop=function(){if(this.cropRect){this._crop=
c.Rectangle.clone(this.cropRect,this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var b=Math.max(this._frame.x,this._crop.x),d=Math.max(this._frame.y,this._crop.y),e=Math.min(this._frame.right,this._crop.right)-b,g=Math.min(this._frame.bottom,this._crop.bottom)-d;this.texture.crop.x=b;this.texture.crop.y=d;this.texture.crop.width=e;this.texture.crop.height=g;this.texture.frame.width=Math.min(e,this.cropRect.width);this.texture.frame.height=Math.min(g,this.cropRect.height);this.texture.width=
this.texture.frame.width;this.texture.height=this.texture.frame.height;this.texture._updateUvs()}};c.Image.prototype.revive=function(){return this.alive=!0,this.exists=!0,this.visible=!0,this.events&&this.events.onRevived.dispatch(this),this};c.Image.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled.dispatch(this),this};c.Image.prototype.destroy=function(b){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=
1;this.events&&this.events.onDestroy.dispatch(this);this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));this.events&&this.events.destroy();this.input&&this.input.destroy();this.animations&&this.animations.destroy();var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);else for(;d--;)this.removeChild(this.children[d]);this.visible=this.exists=this.alive=!1;this.game=this.mask=this.filters=null;this._cache[8]=0}};c.Image.prototype.reset=
function(b,c){return this.world.setTo(b,c),this.position.x=b,this.position.y=c,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this};c.Image.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this};Object.defineProperty(c.Image.prototype,"angle",{get:function(){return c.Math.wrapAngle(c.Math.radToDeg(this.rotation))},set:function(b){this.rotation=c.Math.degToRad(c.Math.wrapAngle(b))}});Object.defineProperty(c.Image.prototype,"deltaX",{get:function(){return this.world.x-
this._cache[0]}});Object.defineProperty(c.Image.prototype,"deltaY",{get:function(){return this.world.y-this._cache[1]}});Object.defineProperty(c.Image.prototype,"deltaZ",{get:function(){return this.rotation-this._cache[2]}});Object.defineProperty(c.Image.prototype,"inWorld",{get:function(){return this.game.world.bounds.intersects(this.getBounds())}});Object.defineProperty(c.Image.prototype,"inCamera",{get:function(){return this.game.world.camera.screenView.intersects(this.getBounds())}});Object.defineProperty(c.Image.prototype,
"frame",{get:function(){return this._frame},set:function(b){if(b!==this.frame){var c=this.game.cache.getFrameData(this.key);c&&b<c.total&&c.getFrame(b)&&(this.setTexture(PIXI.TextureCache[c.getFrame(b).uuid]),this._frame=b)}}});Object.defineProperty(c.Image.prototype,"frameName",{get:function(){return this._frameName},set:function(b){if(b!==this.frameName){var c=this.game.cache.getFrameData(this.key);c&&c.getFrameByName(b)&&(this.setTexture(PIXI.TextureCache[c.getFrameByName(b).uuid]),this._frameName=
b)}}});Object.defineProperty(c.Image.prototype,"renderOrderID",{get:function(){return this._cache[3]}});Object.defineProperty(c.Image.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.Image.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},
set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.Image.prototype,"smoothed",{get:function(){return!this.texture.baseTexture.scaleMode},set:function(b){b?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}});Object.defineProperty(c.Image.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.TileSprite=function(b,d,e,g,h,f,k){d=d||0;e=e||0;g=g||256;h=h||256;f=f||
null;k=k||null;this.game=b;this.name="";this.type=c.TILESPRITE;this.z=0;this.events=new c.Events(this);this.animations=new c.AnimationManager(this);this.key=f;this._frame=0;this._frameName="";this._scroll=new c.Point;PIXI.TilingSprite.call(this,PIXI.TextureCache.__default,g,h);this.position.set(d,e);this.input=null;this.world=new c.Point(d,e);this.checkWorldBounds=this.autoCull=!1;this.cameraOffset=new c.Point;this.body=null;this.alive=!0;this._cache=[0,0,0,0,1,0,1,0,0];this.loadTexture(f,k)};c.TileSprite.prototype=
Object.create(PIXI.TilingSprite.prototype);c.TileSprite.prototype.constructor=c.TileSprite;c.TileSprite.prototype.preUpdate=function(){if(1===this._cache[4]&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.body&&this.body.preUpdate(),this._cache[4]=0,!1;if(this._cache[0]=
this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;(this.autoCull||this.checkWorldBounds)&&this._bounds.copyFrom(this.getBounds());this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this._bounds));this.checkWorldBounds&&(1===this._cache[5]&&this.game.world.bounds.intersects(this._bounds)?(this._cache[5]=0,this.events.onEnterBounds.dispatch(this)):0!==this._cache[5]||this.game.world.bounds.intersects(this._bounds)||
(this._cache[5]=1,this.events.onOutOfBounds.dispatch(this)));this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);this.animations.update();0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);this.body&&this.body.preUpdate();for(var b=0,c=this.children.length;c>
b;b++)this.children[b].preUpdate();return!0};c.TileSprite.prototype.update=function(){};c.TileSprite.prototype.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate();1===this._cache[7]&&(this.position.x=this.game.camera.view.x+this.cameraOffset.x,this.position.y=this.game.camera.view.y+this.cameraOffset.y);for(var b=0,c=this.children.length;c>b;b++)this.children[b].postUpdate()};c.TileSprite.prototype.autoScroll=function(b,c){this._scroll.set(b,c)};c.TileSprite.prototype.stopScroll=
function(){this._scroll.set(0,0)};c.TileSprite.prototype.loadTexture=function(b,d){d=d||0;this.key=b;b instanceof c.RenderTexture?(this.key=b.key,this.setTexture(b)):b instanceof c.BitmapData?this.setTexture(b.texture):b instanceof PIXI.Texture?this.setTexture(b):null===b||"undefined"==typeof b?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key])):"string"!=typeof b||this.game.cache.checkImageKey(b)?(this.setTexture(new PIXI.Texture(PIXI.BaseTextureCache[b])),this.animations.loadFrameData(this.game.cache.getFrameData(b),
d)):(console.warn("Texture with key '"+b+"' not found."),this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]));this.texture.baseTexture.dirty()};c.TileSprite.prototype.setFrame=function(b){this.texture.frame.x=b.x;this.texture.frame.y=b.y;this.texture.frame.width=b.width;this.texture.frame.height=b.height;this.texture.crop.x=b.x;this.texture.crop.y=b.y;this.texture.crop.width=b.width;this.texture.crop.height=b.height;b.trimmed?(this.texture.trim?(this.texture.trim.x=b.spriteSourceSizeX,
this.texture.trim.y=b.spriteSourceSizeY,this.texture.trim.width=b.sourceSizeW,this.texture.trim.height=b.sourceSizeH):this.texture.trim={x:b.spriteSourceSizeX,y:b.spriteSourceSizeY,width:b.sourceSizeW,height:b.sourceSizeH},this.texture.width=b.sourceSizeW,this.texture.height=b.sourceSizeH,this.texture.frame.width=b.sourceSizeW,this.texture.frame.height=b.sourceSizeH):!b.trimmed&&this.texture.trim&&(this.texture.trim=null);this.texture._updateUvs()};c.TileSprite.prototype.destroy=function(b){if(null!==
this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.events&&this.events.onDestroy.dispatch(this);this.filters&&(this.filters=null);this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));this.animations.destroy();this.events.destroy();var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);else for(;d--;)this.removeChild(this.children[d]);this.alive=this.visible=this.exists=!1;this.game=this.mask=this.filters=
null;this._cache[8]=0}};c.TileSprite.prototype.play=function(b,c,e,g){return this.animations.play(b,c,e,g)};c.TileSprite.prototype.reset=function(b,c){return this.world.setTo(b,c),this.position.x=b,this.position.y=c,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.tilePosition.x=0,this.tilePosition.y=0,this.body&&this.body.reset(b,c,!1,!1),this._cache[4]=1,this};Object.defineProperty(c.TileSprite.prototype,"angle",{get:function(){return c.Math.wrapAngle(c.Math.radToDeg(this.rotation))},
set:function(b){this.rotation=c.Math.degToRad(c.Math.wrapAngle(b))}});Object.defineProperty(c.TileSprite.prototype,"frame",{get:function(){return this.animations.frame},set:function(b){b!==this.animations.frame&&(this.animations.frame=b)}});Object.defineProperty(c.TileSprite.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(b){b!==this.animations.frameName&&(this.animations.frameName=b)}});Object.defineProperty(c.TileSprite.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},
set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.TileSprite.prototype,"exists",{get:function(){return!!this._cache[6]},set:function(b){b?(this._cache[6]=1,this.body&&this.body.type===c.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._cache[6]=0,this.body&&this.body.type===c.Physics.P2JS&&(this.body.safeRemove=!0),this.visible=!1)}});Object.defineProperty(c.TileSprite.prototype,"inputEnabled",{get:function(){return this.input&&
this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.TileSprite.prototype,"x",{get:function(){return this.position.x},set:function(b){this.position.x=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}});Object.defineProperty(c.TileSprite.prototype,"y",{get:function(){return this.position.y},
set:function(b){this.position.y=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}});Object.defineProperty(c.TileSprite.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.Rope=function(b,d,e,g,h,f){this.points=[];this.points=f;this._hasUpdateAnimation=!1;this._updateAnimationCallback=null;d=d||0;e=e||0;g=g||null;h=h||null;this.game=b;this.name="";this.type=c.ROPE;this.z=0;this.events=new c.Events(this);this.animations=new c.AnimationManager(this);
this.key=g;this._frame=0;this._frameName="";this._scroll=new c.Point;PIXI.Rope.call(this,g,this.points);this.position.set(d,e);this.input=null;this.world=new c.Point(d,e);this.checkWorldBounds=this.autoCull=!1;this.cameraOffset=new c.Point;this.body=null;this._cache=[0,0,0,0,1,0,1,0,0];this.loadTexture(g,h)};c.Rope.prototype=Object.create(PIXI.Rope.prototype);c.Rope.prototype.constructor=c.Rope;c.Rope.prototype.preUpdate=function(){if(1===this._cache[4]&&this.exists)return this.world.setTo(this.parent.position.x+
this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.body&&this.body.preUpdate(),this._cache[4]=0,!1;if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;(this.autoCull||this.checkWorldBounds)&&this._bounds.copyFrom(this.getBounds());this.autoCull&&
(this.renderable=this.game.world.camera.screenView.intersects(this._bounds));this.checkWorldBounds&&(1===this._cache[5]&&this.game.world.bounds.intersects(this._bounds)?(this._cache[5]=0,this.events.onEnterBounds.dispatch(this)):0!==this._cache[5]||this.game.world.bounds.intersects(this._bounds)||(this._cache[5]=1,this.events.onOutOfBounds.dispatch(this)));this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);
this.animations.update();0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);this.body&&this.body.preUpdate();for(var b=0,c=this.children.length;c>b;b++)this.children[b].preUpdate();return!0};c.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)};c.Rope.prototype.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate();1===this._cache[7]&&
(this.position.x=this.game.camera.view.x+this.cameraOffset.x,this.position.y=this.game.camera.view.y+this.cameraOffset.y);for(var b=0,c=this.children.length;c>b;b++)this.children[b].postUpdate()};c.Rope.prototype.loadTexture=function(b,d){d=d||0;this.key=b;b instanceof c.RenderTexture?(this.key=b.key,this.setTexture(b)):b instanceof c.BitmapData?this.setTexture(b.texture):b instanceof PIXI.Texture?this.setTexture(b):null===b||"undefined"==typeof b?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key])):
"string"!=typeof b||this.game.cache.checkImageKey(b)?(this.setTexture(new PIXI.Texture(PIXI.BaseTextureCache[b])),this.animations.loadFrameData(this.game.cache.getFrameData(b),d)):(console.warn("Texture with key '"+b+"' not found."),this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]))};c.Rope.prototype.setFrame=function(b){this.texture.frame.x=b.x;this.texture.frame.y=b.y;this.texture.frame.width=b.width;this.texture.frame.height=b.height;this.texture.crop.x=b.x;this.texture.crop.y=
b.y;this.texture.crop.width=b.width;this.texture.crop.height=b.height;b.trimmed?(this.texture.trim?(this.texture.trim.x=b.spriteSourceSizeX,this.texture.trim.y=b.spriteSourceSizeY,this.texture.trim.width=b.sourceSizeW,this.texture.trim.height=b.sourceSizeH):this.texture.trim={x:b.spriteSourceSizeX,y:b.spriteSourceSizeY,width:b.sourceSizeW,height:b.sourceSizeH},this.texture.width=b.sourceSizeW,this.texture.height=b.sourceSizeH,this.texture.frame.width=b.sourceSizeW,this.texture.frame.height=b.sourceSizeH):
!b.trimmed&&this.texture.trim&&(this.texture.trim=null);this.texture._updateUvs()};c.Rope.prototype.destroy=function(b){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.events&&this.events.onDestroy.dispatch(this);this.filters&&(this.filters=null);this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));this.animations.destroy();this.events.destroy();var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);
else for(;d--;)this.removeChild(this.children[d]);this.visible=this.exists=!1;this.game=this.mask=this.filters=null;this._cache[8]=0}};c.Rope.prototype.play=function(b,c,e,g){return this.animations.play(b,c,e,g)};c.Rope.prototype.reset=function(b,c){return this.world.setTo(b,c),this.position.x=b,this.position.y=c,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.tilePosition.x=0,this.tilePosition.y=0,this.body&&this.body.reset(b,c,!1,!1),this._cache[4]=
1,this};Object.defineProperty(c.Rope.prototype,"angle",{get:function(){return c.Math.wrapAngle(c.Math.radToDeg(this.rotation))},set:function(b){this.rotation=c.Math.degToRad(c.Math.wrapAngle(b))}});Object.defineProperty(c.Rope.prototype,"frame",{get:function(){return this.animations.frame},set:function(b){b!==this.animations.frame&&(this.animations.frame=b)}});Object.defineProperty(c.Rope.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(b){b!==this.animations.frameName&&
(this.animations.frameName=b)}});Object.defineProperty(c.Rope.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.Rope.prototype,"exists",{get:function(){return!!this._cache[6]},set:function(b){b?(this._cache[6]=1,this.body&&this.body.type===c.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._cache[6]=0,this.body&&this.body.type===c.Physics.P2JS&&(this.body.safeRemove=
!0),this.visible=!1)}});Object.defineProperty(c.Rope.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.Rope.prototype,"x",{get:function(){return this.position.x},set:function(b){this.position.x=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&
(this.body._reset=1)}});Object.defineProperty(c.Rope.prototype,"y",{get:function(){return this.position.y},set:function(b){this.position.y=b;this.body&&this.body.type===c.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}});Object.defineProperty(c.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(b){b&&"function"==typeof b?(this._hasUpdateAnimation=!0,this._updateAnimation=b):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}});Object.defineProperty(c.Rope.prototype,
"segments",{get:function(){for(var b,d,e,g,h=[],f=0;f<this.points.length;f++)b=4*f,d=this.verticies[b],e=this.verticies[b+1],g=this.verticies[b+4],b=this.verticies[b+3],g=c.Math.difference(d,g),b=c.Math.difference(e,b),d+=this.world.x,e+=this.world.y,d=new c.Rectangle(d,e,g,b),h.push(d);return h}});Object.defineProperty(c.Rope.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.Text=function(b,d,e,g,h){d=d||0;e=e||0;g=g||" ";h=h||{};g=0===g.length?" ":g.toString();this.game=b;this.exists=
!0;this.name="";this.type=c.TEXT;this.z=0;this.world=new c.Point(d,e);this._text=g;this._font="";this._fontSize=32;this._fontWeight="normal";this._charCount=this._lineSpacing=0;this.events=new c.Events(this);this.input=null;this.cameraOffset=new c.Point;this.colors=[];this.setStyle(h);PIXI.Text.call(this,g,this.style);this.position.set(d,e);this._cache=[0,0,0,0,1,0,1,0,0];" "!==g&&this.updateText()};c.Text.prototype=Object.create(PIXI.Text.prototype);c.Text.prototype.constructor=c.Text;c.Text.prototype.preUpdate=
function(){if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds()));this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);for(var b=0,c=this.children.length;c>b;b++)this.children[b].preUpdate();
return!0};c.Text.prototype.update=function(){};c.Text.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);for(var b=0,c=this.children.length;c>b;b++)this.children[b].postUpdate()};c.Text.prototype.destroy=function(b){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.events&&this.events.onDestroy.dispatch(this);
this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));this.texture.destroy(!0);this.canvas.parentNode?this.canvas.parentNode.removeChild(this.canvas):(this.canvas=null,this.context=null);var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);else for(;d--;)this.removeChild(this.children[d]);this.visible=this.exists=!1;this.game=this.mask=this.filters=null;this._cache[8]=0}};c.Text.prototype.setShadow=function(b,c,e,g){this.style.shadowOffsetX=
b||0;this.style.shadowOffsetY=c||0;this.style.shadowColor=e||"rgba(0,0,0,0)";this.style.shadowBlur=g||0;this.dirty=!0};c.Text.prototype.setStyle=function(b){b=b||{};b.font=b.font||"bold 20pt Arial";b.fill=b.fill||"black";b.align=b.align||"left";b.stroke=b.stroke||"black";b.strokeThickness=b.strokeThickness||0;b.wordWrap=b.wordWrap||!1;b.wordWrapWidth=b.wordWrapWidth||100;b.shadowOffsetX=b.shadowOffsetX||0;b.shadowOffsetY=b.shadowOffsetY||0;b.shadowColor=b.shadowColor||"rgba(0,0,0,0)";b.shadowBlur=
b.shadowBlur||0;this.style=b;this.dirty=!0};c.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution;this.context.font=this.style.font;var b=this.text;this.style.wordWrap&&(b=this.runWordWrap(this.text));for(var b=b.split(/(?:\r\n|\r|\n)/),c=[],e=0,g=this.determineFontProperties(this.style.font),h=0;h<b.length;h++){var f=this.context.measureText(b[h]).width;c[h]=f;e=Math.max(e,f)}this.canvas.width=(e+this.style.strokeThickness+this.context.lineWidth)*this.resolution;
f=g.fontSize+this.style.strokeThickness;this.canvas.height=f*b.length*this.resolution;this.context.scale(this.resolution,this.resolution);navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.textBaseline="alphabetic";this.context.shadowOffsetX=this.style.shadowOffsetX;this.context.shadowOffsetY=this.style.shadowOffsetY;this.context.shadowColor=
this.style.shadowColor;this.context.shadowBlur=this.style.shadowBlur;this.context.lineWidth=this.style.strokeThickness;this.context.lineCap="round";this.context.lineJoin="round";for(var k,m,h=this._charCount=0;h<b.length;h++)k=this.style.strokeThickness/2,m=this.style.strokeThickness/2+h*f+g.ascent,"right"===this.style.align?k+=e-c[h]:"center"===this.style.align&&(k+=(e-c[h])/2),m+=this._lineSpacing,0<this.colors.length?this.updateLine(b[h],k,m):(this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(b[h],
k,m),this.style.fill&&this.context.fillText(b[h],k,m));this.updateTexture()};c.Text.prototype.updateLine=function(b,c,e){for(var g=0;g<b.length;g++){var h=b[g];this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount],this.context.strokeStyle=this.colors[this._charCount]);this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(h,c,e);this.style.fill&&this.context.fillText(h,c,e);c+=this.context.measureText(h).width;this._charCount++}};c.Text.prototype.clearColors=
function(){this.colors=[];this.dirty=!0};c.Text.prototype.addColor=function(b,c){this.colors[c]=b;this.dirty=!0};c.Text.prototype.runWordWrap=function(b){var c="";b=b.split("\n");for(var e=0;e<b.length;e++){for(var g=this.style.wordWrapWidth,h=b[e].split(" "),f=0;f<h.length;f++){var k=this.context.measureText(h[f]).width,m=k+this.context.measureText(" ").width;m>g?(0<f&&(c+="\n"),c+=h[f]+" ",g=this.style.wordWrapWidth-k):(g-=m,c+=h[f]+" ")}e<b.length-1&&(c+="\n")}return c};Object.defineProperty(c.Text.prototype,
"angle",{get:function(){return c.Math.radToDeg(this.rotation)},set:function(b){this.rotation=c.Math.degToRad(b)}});Object.defineProperty(c.Text.prototype,"text",{get:function(){return this._text},set:function(b){b!==this._text&&(this._text=b.toString()||" ",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(c.Text.prototype,"font",{get:function(){return this._font},set:function(b){b!==this._font&&(this._font=b.trim(),this.style.font=this._fontWeight+" "+this._fontSize+"px '"+
this._font+"'",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(c.Text.prototype,"fontSize",{get:function(){return this._fontSize},set:function(b){b=parseInt(b,10);b!==this._fontSize&&(this._fontSize=b,this.style.font=this._fontWeight+" "+this._fontSize+"px '"+this._font+"'",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(c.Text.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(b){b!==this._fontWeight&&(this._fontWeight=
b,this.style.font=this._fontWeight+" "+this._fontSize+"px '"+this._font+"'",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(c.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(b){b!==this.style.fill&&(this.style.fill=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"align",{get:function(){return this.style.align},set:function(b){b!==this.style.align&&(this.style.align=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"stroke",
{get:function(){return this.style.stroke},set:function(b){b!==this.style.stroke&&(this.style.stroke=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(b){b!==this.style.strokeThickness&&(this.style.strokeThickness=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(b){b!==this.style.wordWrap&&(this.style.wordWrap=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,
"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(b){b!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(b){b!==this._lineSpacing&&(this._lineSpacing=parseFloat(b),this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(c.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(b){b!==
this.style.shadowOffsetX&&(this.style.shadowOffsetX=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(b){b!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(b){b!==this.style.shadowColor&&(this.style.shadowColor=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"shadowBlur",
{get:function(){return this.style.shadowBlur},set:function(b){b!==this.style.shadowBlur&&(this.style.shadowBlur=b,this.dirty=!0)}});Object.defineProperty(c.Text.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.Text.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},
set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.Text.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.BitmapText=function(b,d,e,g,h,f){d=d||0;e=e||0;g=g||"";h=h||"";f=f||32;this.game=b;this.exists=!0;this.name="";this.type=c.BITMAPTEXT;this.z=0;this.world=new c.Point(d,e);this._text=h;this._font=g;this._fontSize=f;this._align="left";this._tint=16777215;this.events=new c.Events(this);this.input=null;this.cameraOffset=
new c.Point;PIXI.BitmapText.call(this,h);this.position.set(d,e);this._cache=[0,0,0,0,1,0,1,0,0]};c.BitmapText.prototype=Object.create(PIXI.BitmapText.prototype);c.BitmapText.prototype.constructor=c.BitmapText;c.BitmapText.prototype.setStyle=function(){this.style={align:this._align};this.fontName=this._font;this.fontSize=this._fontSize;this.dirty=!0};c.BitmapText.prototype.preUpdate=function(){return this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.exists&&
this.parent.exists?(this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),!0):(this.renderOrderID=-1,!1)};c.BitmapText.prototype.update=function(){};c.BitmapText.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,
this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};c.BitmapText.prototype.destroy=function(b){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));var d=this.children.length;if(b)for(;d--;)this.children[d].destroy?this.children[d].destroy(b):this.removeChild(this.children[d]);else for(;d--;)this.removeChild(this.children[d]);
this.visible=this.exists=!1;this.game=this.mask=this.filters=null;this._cache[8]=0}};Object.defineProperty(c.BitmapText.prototype,"align",{get:function(){return this._align},set:function(b){b!==this._align&&(this._align=b,this.setStyle())}});Object.defineProperty(c.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(b){b!==this._tint&&(this._tint=b,this.dirty=!0)}});Object.defineProperty(c.BitmapText.prototype,"angle",{get:function(){return c.Math.radToDeg(this.rotation)},
set:function(b){this.rotation=c.Math.degToRad(b)}});Object.defineProperty(c.BitmapText.prototype,"font",{get:function(){return this._font},set:function(b){b!==this._font&&(this._font=b.trim(),this.style.font=this._fontSize+"px '"+this._font+"'",this.dirty=!0)}});Object.defineProperty(c.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(b){b=parseInt(b,10);b!==this._fontSize&&(this._fontSize=b,this.style.font=this._fontSize+"px '"+this._font+"'",this.dirty=!0)}});Object.defineProperty(c.BitmapText.prototype,
"text",{get:function(){return this._text},set:function(b){b!==this._text&&(this._text=b.toString()||" ",this.dirty=!0)}});Object.defineProperty(c.BitmapText.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(b){b?null===this.input?(this.input=new c.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}});Object.defineProperty(c.BitmapText.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},
set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.BitmapText.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.Button=function(b,d,e,g,h,f,k,m,n,p){h=h||null;f=f||this;c.Image.call(this,b,d||0,e||0,g||null,m);this.type=c.BUTTON;this._onUpFrameID=this._onDownFrameID=this._onOutFrameID=this._onOverFrameID=this._onUpFrameName=this._onDownFrameName=this._onOutFrameName=this._onOverFrameName=null;this.onOverMouseOnly=
!1;this.onUpSound=this.onDownSound=this.onOutSound=this.onOverSound=null;this.onUpSoundMarker=this.onDownSoundMarker=this.onOutSoundMarker=this.onOverSoundMarker="";this.onInputOver=new c.Signal;this.onInputOut=new c.Signal;this.onInputDown=new c.Signal;this.onInputUp=new c.Signal;this.forceOut=this.freezeFrames=!1;this.inputEnabled=!0;this.input.start(0,!0);this.setFrames(k,m,n,p);null!==h&&this.onInputUp.add(h,f);this.events.onInputOver.add(this.onInputOverHandler,this);this.events.onInputOut.add(this.onInputOutHandler,
this);this.events.onInputDown.add(this.onInputDownHandler,this);this.events.onInputUp.add(this.onInputUpHandler,this)};c.Button.prototype=Object.create(c.Image.prototype);c.Button.prototype.constructor=c.Button;c.Button.prototype.clearFrames=function(){this._onUpFrameID=this._onUpFrameName=this._onDownFrameID=this._onDownFrameName=this._onOutFrameID=this._onOutFrameName=this._onOverFrameID=this._onOverFrameName=null};c.Button.prototype.setFrames=function(b,c,e,g){this.clearFrames();null!==b&&("string"==
typeof b?(this._onOverFrameName=b,this.input.pointerOver()&&(this.frameName=b)):(this._onOverFrameID=b,this.input.pointerOver()&&(this.frame=b)));null!==c&&("string"==typeof c?(this._onOutFrameName=c,!1===this.input.pointerOver()&&(this.frameName=c)):(this._onOutFrameID=c,!1===this.input.pointerOver()&&(this.frame=c)));null!==e&&("string"==typeof e?(this._onDownFrameName=e,this.input.pointerDown()&&(this.frameName=e)):(this._onDownFrameID=e,this.input.pointerDown()&&(this.frame=e)));null!==g&&("string"==
typeof g?(this._onUpFrameName=g,this.input.pointerUp()&&(this.frameName=g)):(this._onUpFrameID=g,this.input.pointerUp()&&(this.frame=g)))};c.Button.prototype.setSounds=function(b,c,e,g,h,f,k,m){this.setOverSound(b,c);this.setOutSound(h,f);this.setDownSound(e,g);this.setUpSound(k,m)};c.Button.prototype.setOverSound=function(b,d){this.onOverSound=null;this.onOverSoundMarker="";(b instanceof c.Sound||b instanceof c.AudioSprite)&&(this.onOverSound=b);"string"==typeof d&&(this.onOverSoundMarker=d)};c.Button.prototype.setOutSound=
function(b,d){this.onOutSound=null;this.onOutSoundMarker="";(b instanceof c.Sound||b instanceof c.AudioSprite)&&(this.onOutSound=b);"string"==typeof d&&(this.onOutSoundMarker=d)};c.Button.prototype.setDownSound=function(b,d){this.onDownSound=null;this.onDownSoundMarker="";(b instanceof c.Sound||b instanceof c.AudioSprite)&&(this.onDownSound=b);"string"==typeof d&&(this.onDownSoundMarker=d)};c.Button.prototype.setUpSound=function(b,d){this.onUpSound=null;this.onUpSoundMarker="";(b instanceof c.Sound||
b instanceof c.AudioSprite)&&(this.onUpSound=b);"string"==typeof d&&(this.onUpSoundMarker=d)};c.Button.prototype.onInputOverHandler=function(b,c){c.justReleased()||(!1===this.freezeFrames&&this.setState(1),(!this.onOverMouseOnly||c.isMouse)&&(this.onOverSound&&this.onOverSound.play(this.onOverSoundMarker),this.onInputOver&&this.onInputOver.dispatch(this,c)))};c.Button.prototype.onInputOutHandler=function(b,c){!1===this.freezeFrames&&this.setState(2);this.onOutSound&&this.onOutSound.play(this.onOutSoundMarker);
this.onInputOut&&this.onInputOut.dispatch(this,c)};c.Button.prototype.onInputDownHandler=function(b,c){!1===this.freezeFrames&&this.setState(3);this.onDownSound&&this.onDownSound.play(this.onDownSoundMarker);this.onInputDown&&this.onInputDown.dispatch(this,c)};c.Button.prototype.onInputUpHandler=function(b,c,e){this.onUpSound&&this.onUpSound.play(this.onUpSoundMarker);this.onInputUp&&this.onInputUp.dispatch(this,c,e);this.freezeFrames||this.setState(this.forceOut?2:null!==this._onUpFrameName||null!==
this._onUpFrameID?4:e?1:2)};c.Button.prototype.setState=function(b){1===b?null!=this._onOverFrameName?this.frameName=this._onOverFrameName:null!=this._onOverFrameID&&(this.frame=this._onOverFrameID):2===b?null!=this._onOutFrameName?this.frameName=this._onOutFrameName:null!=this._onOutFrameID&&(this.frame=this._onOutFrameID):3===b?null!=this._onDownFrameName?this.frameName=this._onDownFrameName:null!=this._onDownFrameID&&(this.frame=this._onDownFrameID):4===b&&(null!=this._onUpFrameName?this.frameName=
this._onUpFrameName:null!=this._onUpFrameID&&(this.frame=this._onUpFrameID))};c.Graphics=function(b,d,e){d=d||0;e=e||0;this.game=b;this.exists=!0;this.name="";this.type=c.GRAPHICS;this.z=0;this.world=new c.Point(d,e);this.cameraOffset=new c.Point;PIXI.Graphics.call(this);this.position.set(d,e);this._cache=[0,0,0,0,1,0,1,0,0]};c.Graphics.prototype=Object.create(PIXI.Graphics.prototype);c.Graphics.prototype.constructor=c.Graphics;c.Graphics.prototype.preUpdate=function(){return this._cache[0]=this.world.x,
this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.exists&&this.parent.exists?(this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),!0):(this.renderOrderID=-1,!1)};c.Graphics.prototype.update=function(){};c.Graphics.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=
(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};c.Graphics.prototype.destroy=function(b){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof b&&(b=!0);this._cache[8]=1;this.clear();this.parent&&(this.parent instanceof c.Group?this.parent.remove(this):this.parent.removeChild(this));var d=this.children.length;if(b)for(;d--;)this.children[d].destroy(b);else for(;d--;)this.removeChild(this.children[d]);
this.visible=this.exists=!1;this.game=null;this._cache[8]=0}};c.Graphics.prototype.drawTriangle=function(b,d){"undefined"==typeof d&&(d=!1);var e=new c.Polygon(b);if(d){var g=new c.Point(this.game.camera.x-b[0].x,this.game.camera.y-b[0].y),h=new c.Point(b[1].x-b[0].x,b[1].y-b[0].y),h=(new c.Point(b[1].x-b[2].x,b[1].y-b[2].y)).cross(h);0<g.dot(h)&&this.drawPolygon(e)}else this.drawPolygon(e)};c.Graphics.prototype.drawTriangles=function(b,d,e){"undefined"==typeof e&&(e=!1);var g,h=new c.Point,f=new c.Point,
k=new c.Point,m=[];if(d)if(b[0]instanceof c.Point)for(g=0;g<d.length/3;g++)m.push(b[d[3*g]]),m.push(b[d[3*g+1]]),m.push(b[d[3*g+2]]),3===m.length&&(this.drawTriangle(m,e),m=[]);else for(g=0;g<d.length;g++)h.x=b[2*d[g]],h.y=b[2*d[g]+1],m.push(h.copyTo({})),3===m.length&&(this.drawTriangle(m,e),m=[]);else if(b[0]instanceof c.Point)for(g=0;g<b.length/3;g++)this.drawTriangle([b[3*g],b[3*g+1],b[3*g+2]],e);else for(g=0;g<b.length/6;g++)h.x=b[6*g+0],h.y=b[6*g+1],f.x=b[6*g+2],f.y=b[6*g+3],k.x=b[6*g+4],k.y=
b[6*g+5],this.drawTriangle([h,f,k],e)};Object.defineProperty(c.Graphics.prototype,"angle",{get:function(){return c.Math.radToDeg(this.rotation)},set:function(b){this.rotation=c.Math.degToRad(b)}});Object.defineProperty(c.Graphics.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(b){b?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}});Object.defineProperty(c.Graphics.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}});c.RenderTexture=
function(b,d,e,g,h,f){"undefined"==typeof g&&(g="");"undefined"==typeof h&&(h=c.scaleModes.DEFAULT);"undefined"==typeof f&&(f=1);this.game=b;this.key=g;this.type=c.RENDERTEXTURE;this.matrix=new PIXI.Matrix;PIXI.RenderTexture.call(this,d,e,this.game.renderer,h,f);this.render=c.RenderTexture.prototype.render};c.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype);c.RenderTexture.prototype.constructor=c.RenderTexture;c.RenderTexture.prototype.renderXY=function(b,c,e,g){this.matrix.tx=
c;this.matrix.ty=e;this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(b,this.matrix,g):this.renderCanvas(b,this.matrix,g)};c.RenderTexture.prototype.render=function(b,c,e){this.matrix.tx=c.x;this.matrix.ty=c.y;this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(b,this.matrix,e):this.renderCanvas(b,this.matrix,e)};c.SpriteBatch=function(b,d,e,g){"undefined"!=typeof d&&null!==d||(d=b.world);PIXI.SpriteBatch.call(this);c.Group.call(this,b,d,e,g);this.type=c.SPRITEBATCH};c.SpriteBatch.prototype=
c.Utils.extend(!0,c.SpriteBatch.prototype,c.Group.prototype,PIXI.SpriteBatch.prototype);c.SpriteBatch.prototype.constructor=c.SpriteBatch;c.RetroFont=function(b,d,e,g,h,f,k,m,n,p){if(!b.cache.checkImageKey(d))return!1;"undefined"!=typeof f&&null!==f||(f=b.cache.getImage(d).width/e);this.characterWidth=e;this.characterHeight=g;this.characterSpacingX=k||0;this.characterSpacingY=m||0;this.characterPerRow=f;this.offsetX=n||0;this.offsetY=p||0;this.align="left";this.multiLine=!1;this.autoUpperCase=!0;
this.fixedWidth=this.customSpacingY=this.customSpacingX=0;this.fontSet=b.cache.getImage(d);this._text="";this.grabData=[];this.frameData=new c.FrameData;e=this.offsetX;g=this.offsetY;for(k=f=0;k<h.length;k++)m=b.rnd.uuid(),n=this.frameData.addFrame(new c.Frame(k,e,g,this.characterWidth,this.characterHeight,"",m)),this.grabData[h.charCodeAt(k)]=n.index,PIXI.TextureCache[m]=new PIXI.Texture(PIXI.BaseTextureCache[d],{x:e,y:g,width:this.characterWidth,height:this.characterHeight}),f++,f==this.characterPerRow?
(f=0,e=this.offsetX,g+=this.characterHeight+this.characterSpacingY):e+=this.characterWidth+this.characterSpacingX;b.cache.updateFrameData(d,this.frameData);this.stamp=new c.Image(b,0,0,d,0);c.RenderTexture.call(this,b,100,100,"",c.scaleModes.NEAREST);this.type=c.RETROFONT};c.RetroFont.prototype=Object.create(c.RenderTexture.prototype);c.RetroFont.prototype.constructor=c.RetroFont;c.RetroFont.ALIGN_LEFT="left";c.RetroFont.ALIGN_RIGHT="right";c.RetroFont.ALIGN_CENTER="center";c.RetroFont.TEXT_SET1=
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";c.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ";c.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";c.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789";c.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789";c.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ";c.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39";
c.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ";c.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!";c.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ";c.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789";c.RetroFont.prototype.setFixedWidth=function(b,c){"undefined"==typeof c&&(c="left");this.fixedWidth=b;this.align=c};c.RetroFont.prototype.setText=function(b,c,e,g,h,f){this.multiLine=c||!1;this.customSpacingX=e||0;this.customSpacingY=g||0;
this.align=h||"left";this.autoUpperCase=f?!1:!0;0<b.length&&(this.text=b)};c.RetroFont.prototype.buildRetroFontText=function(){var b=0,d=0;if(this.clear(),this.multiLine){var e=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,e.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),e.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var g=0;g<e.length;g++){switch(this.align){case c.RetroFont.ALIGN_LEFT:b=
0;break;case c.RetroFont.ALIGN_RIGHT:b=this.width-e[g].length*(this.characterWidth+this.customSpacingX);break;case c.RetroFont.ALIGN_CENTER:b=this.width/2-e[g].length*(this.characterWidth+this.customSpacingX)/2,b+=this.customSpacingX/2}0>b&&(b=0);this.pasteLine(e[g],b,d,this.customSpacingX);d+=this.characterHeight+this.customSpacingY}}else{switch(0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,
!0),this.align){case c.RetroFont.ALIGN_LEFT:b=0;break;case c.RetroFont.ALIGN_RIGHT:b=this.width-this._text.length*(this.characterWidth+this.customSpacingX);break;case c.RetroFont.ALIGN_CENTER:b=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,b+=this.customSpacingX/2}this.textureBuffer.clear();this.pasteLine(this._text,b,0,this.customSpacingX)}};c.RetroFont.prototype.pasteLine=function(b,d,e,g){for(var h=new c.Point,f=0;f<b.length;f++)if(" "==b.charAt(f))d+=this.characterWidth+
g;else if(0<=this.grabData[b.charCodeAt(f)]&&(this.stamp.frame=this.grabData[b.charCodeAt(f)],h.set(d,e),this.render(this.stamp,h,!1),d+=this.characterWidth+g,d>this.width))break};c.RetroFont.prototype.getLongestLine=function(){var b=0;if(0<this._text.length)for(var c=this._text.split("\n"),e=0;e<c.length;e++)c[e].length>b&&(b=c[e].length);return b};c.RetroFont.prototype.removeUnsupportedCharacters=function(b){for(var c="",e=0;e<this._text.length;e++){var g=this._text[e],h=g.charCodeAt(0);(0<=this.grabData[h]||
!b&&"\n"===g)&&(c=c.concat(g))}return c};c.RetroFont.prototype.updateOffset=function(b,c){if(this.offsetX!==b||this.offsetY!==c){for(var e=b-this.offsetX,g=c-this.offsetY,h=this.game.cache.getFrameData(this.stamp.key).getFrames(),f=h.length;f--;)h[f].x+=e,h[f].y+=g,PIXI.TextureCache[h[f].uuid].frame.x=h[f].x,PIXI.TextureCache[h[f].uuid].frame.y=h[f].y;this.buildRetroFontText()}};Object.defineProperty(c.RetroFont.prototype,"text",{get:function(){return this._text},set:function(b){b=this.autoUpperCase?
b.toUpperCase():b;b!==this._text&&(this._text=b,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}});Object.defineProperty(c.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(b){this.stamp.smoothed=b;this.buildRetroFontText()}});c.Particle=function(b,d,e,g,h){c.Sprite.call(this,b,d,e,g,h);this.autoScale=!1;this.scaleData=null;this._s=0;this.autoAlpha=!1;this.alphaData=null;this._a=0};c.Particle.prototype=Object.create(c.Sprite.prototype);
c.Particle.prototype.constructor=c.Particle;c.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1);this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)};c.Particle.prototype.onEmit=function(){};c.Particle.prototype.setAlphaData=function(b){this.alphaData=b;this._a=b.length-1;this.alpha=this.alphaData[this._a].v;this.autoAlpha=!0};c.Particle.prototype.setScaleData=
function(b){this.scaleData=b;this._s=b.length-1;this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y);this.autoScale=!0};c.Particle.prototype.reset=function(b,c,e){return"undefined"==typeof e&&(e=1),this.world.setTo(b,c),this.position.x=b,this.position.y=c,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.health=e,this.body&&this.body.reset(b,c,!1,!1),this._cache[4]=1,this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this};
c.Canvas={create:function(b,c,e){b=b||256;c=c||256;var g=document.createElement("canvas");return"string"==typeof e&&""!==e&&(g.id=e),g.width=b,g.height=c,g.style.display="block",g},getOffset:function(b,d){d=d||new c.Point;var e=b.getBoundingClientRect(),g=b.clientTop||document.body.clientTop||0,h=b.clientLeft||document.body.clientLeft||0,f=0,k=0;return"CSS1Compat"===document.compatMode?(f=window.pageYOffset||document.documentElement.scrollTop||b.scrollTop||0,k=window.pageXOffset||document.documentElement.scrollLeft||
b.scrollLeft||0):(f=window.pageYOffset||document.body.scrollTop||b.scrollTop||0,k=window.pageXOffset||document.body.scrollLeft||b.scrollLeft||0),d.x=e.left+k-h,d.y=e.top+f-g,d},getAspectRatio:function(b){return b.width/b.height},setBackgroundColor:function(b,c){return c=c||"rgb(0,0,0)",b.style.backgroundColor=c,b},setTouchAction:function(b,c){return c=c||"none",b.style.msTouchAction=c,b.style["ms-touch-action"]=c,b.style["touch-action"]=c,b},setUserSelect:function(b,c){return c=c||"none",b.style["-webkit-touch-callout"]=
c,b.style["-webkit-user-select"]=c,b.style["-khtml-user-select"]=c,b.style["-moz-user-select"]=c,b.style["-ms-user-select"]=c,b.style["user-select"]=c,b.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",b},addToDOM:function(b,c,e){var g;return"undefined"==typeof e&&(e=!0),c&&("string"==typeof c?g=document.getElementById(c):"object"==typeof c&&1===c.nodeType&&(g=c)),g||(g=document.body),e&&g.style&&(g.style.overflow="hidden"),g.appendChild(b),b},removeFromDOM:function(b){b.parentNode&&b.parentNode.removeChild(b)},
setTransform:function(b,c,e,g,h,f,k){return b.setTransform(g,f,k,h,c,e),b},setSmoothingEnabled:function(b,c){return b.imageSmoothingEnabled=c,b.mozImageSmoothingEnabled=c,b.oImageSmoothingEnabled=c,b.webkitImageSmoothingEnabled=c,b.msImageSmoothingEnabled=c,b},getSmoothingEnabled:function(b){return b.imageSmoothingEnabled||b.mozImageSmoothingEnabled||b.oImageSmoothingEnabled||b.webkitImageSmoothingEnabled||b.msImageSmoothingEnabled},setImageRenderingCrisp:function(b){return b.style["image-rendering"]=
"optimizeSpeed",b.style["image-rendering"]="crisp-edges",b.style["image-rendering"]="-moz-crisp-edges",b.style["image-rendering"]="-webkit-optimize-contrast",b.style["image-rendering"]="optimize-contrast",b.style["image-rendering"]="pixelated",b.style.msInterpolationMode="nearest-neighbor",b},setImageRenderingBicubic:function(b){return b.style["image-rendering"]="auto",b.style.msInterpolationMode="bicubic",b}};c.Device=function(b){this.game=b;this.ie=this.firefox=this.epiphany=this.chrome=this.arora=
this.quirksMode=this.getUserMedia=this.vibration=this.typedArray=this.pointerLock=this.css3D=this.mspointer=this.touch=this.worker=this.webGL=this.localStorage=this.fileSystem=this.file=this.canvas=this.windowsPhone=this.windows=this.macOS=this.linux=this.chromeOS=this.android=this.crosswalk=this.ejecta=this.nodeWebkit=this.node=this.cordova=this.cocoonJSApp=this.cocoonJS=this.iOS=this.desktop=!1;this.ieVersion=0;this.trident=!1;this.tridentVersion=0;this.iPad=this.iPhone4=this.iPhone=this.webm=this.m4a=
this.wav=this.mp3=this.opus=this.ogg=this.webAudio=this.audioData=this.silk=this.webApp=this.safari=this.opera=this.midori=this.mobileSafari=!1;this.pixelRatio=0;this.fullscreen=this.support32bit=this.littleEndian=!1;this.cancelFullscreen=this.requestFullscreen="";this.fullscreenKeyboard=!1;this._checkOS();this._checkAudio();this._checkBrowser();this._checkCSS3D();this._checkDevice();this._checkFeatures()};c.Device.LITTLE_ENDIAN=!1;c.Device.prototype={_checkOS:function(){var b=navigator.userAgent;
/Playstation Vita/.test(b)?this.vita=!0:/Kindle/.test(b)||/\bKF[A-Z][A-Z]+/.test(b)||/Silk.*Mobile Safari/.test(b)?this.kindle=!0:/Android/.test(b)?this.android=!0:/CrOS/.test(b)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(b)?this.iOS=!0:/Linux/.test(b)?this.linux=!0:/Mac OS/.test(b)?this.macOS=!0:/Windows/.test(b)&&(this.windows=!0,/Windows Phone/i.test(b)&&(this.windowsPhone=!0));(this.windows||this.macOS||this.linux&&!1===this.silk||this.chromeOS)&&(this.desktop=!0);(this.windowsPhone||/Windows NT/i.test(b)&&
/Touch/i.test(b))&&(this.desktop=!1)},_checkFeatures:function(){this.canvas=!!window.CanvasRenderingContext2D||this.cocoonJS;try{this.localStorage=!!localStorage.getItem}catch(b){this.localStorage=!1}this.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob);this.fileSystem=!!window.requestFileSystem;var c;try{var e=document.createElement("canvas");c=(e.screencanvas=!1,!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl")))}catch(g){c=!1}this.webGL=
c;this.webGL=null===this.webGL||!1===this.webGL?!1:!0;this.worker=!!window.Worker;("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&1<window.navigator.maxTouchPoints)&&(this.touch=!0);(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(this.mspointer=!0);this.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;this.quirksMode="CSS1Compat"===document.compatMode?!1:!0;this.getUserMedia=!!(navigator.getUserMedia||
navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)},checkFullScreenSupport:function(){for(var b="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen msRequestFullscreen msRequestFullScreen mozRequestFullScreen mozRequestFullscreen".split(" "),c=0;c<b.length;c++)if(this.game.canvas[b[c]]){this.fullscreen=!0;this.requestFullscreen=b[c];break}b="cancelFullScreen exitFullscreen webkitCancelFullScreen webkitExitFullscreen msCancelFullScreen msExitFullscreen mozCancelFullScreen mozExitFullscreen".split(" ");
if(this.fullscreen)for(c=0;c<b.length;c++)if(document[b[c]]){this.cancelFullscreen=b[c];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.fullscreenKeyboard=!0)},_checkBrowser:function(){var b=navigator.userAgent;if(/Arora/.test(b)?this.arora=!0:/Chrome/.test(b)?this.chrome=!0:/Epiphany/.test(b)?this.epiphany=!0:/Firefox/.test(b)?this.firefox=!0:/AppleWebKit/.test(b)&&this.iOS?this.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(b)?(this.ie=!0,this.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(b)?
this.midori=!0:/Opera/.test(b)?this.opera=!0:/Safari/.test(b)?this.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(b)&&(this.ie=!0,this.trident=!0,this.tridentVersion=parseInt(RegExp.$1,10),this.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(b)&&(this.silk=!0),navigator.standalone&&(this.webApp=!0),"undefined"!=typeof window.cordova&&(this.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(this.node=!0),this.node)try{this.nodeWebkit="undefined"!=typeof require("nw.gui")}catch(c){this.nodeWebkit=
!1}if(navigator.isCocoonJS&&(this.cocoonJS=!0),this.cocoonJS)try{this.cocoonJSApp="undefined"!=typeof CocoonJS}catch(e){this.cocoonJSApp=!1}"undefined"!=typeof window.ejecta&&(this.ejecta=!0);/Crosswalk/.test(b)&&(this.crosswalk=!0)},_checkAudio:function(){this.audioData=!!window.Audio;this.webAudio=!(!window.webkitAudioContext&&!window.AudioContext);var b=document.createElement("audio");try{b.canPlayType&&(b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.ogg=!0),(b.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,
"")||b.canPlayType("audio/opus;").replace(/^no$/,""))&&(this.opus=!0),b.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.mp3=!0),b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.wav=!0),(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/aac;").replace(/^no$/,""))&&(this.m4a=!0),b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.webm=!0))}catch(c){}},_checkDevice:function(){this.pixelRatio=window.devicePixelRatio||1;this.iPhone=-1!=navigator.userAgent.toLowerCase().indexOf("iphone");
this.iPhone4=2==this.pixelRatio&&this.iPhone;this.iPad=-1!=navigator.userAgent.toLowerCase().indexOf("ipad");this.typedArray="undefined"!=typeof Int8Array?!0:!1;"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(this.littleEndian=this._checkIsLittleEndian(),c.Device.LITTLE_ENDIAN=this.littleEndian);this.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==this.littleEndian&&this._checkIsUint8ClampedImageData();
navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;navigator.vibrate&&(this.vibration=!0)},_checkIsLittleEndian:function(){var b=new ArrayBuffer(4),c=new Uint8Array(b),b=new Uint32Array(b);return c[0]=161,c[1]=178,c[2]=195,c[3]=212,3569595041==b[0]?!0:2712847316==b[0]?!1:null},_checkIsUint8ClampedImageData:function(){if("undefined"==typeof Uint8ClampedArray)return!1;var b=document.createElement("canvas").getContext("2d");return b?b.createImageData(1,
1).data instanceof Uint8ClampedArray:!1},_checkCSS3D:function(){var b,c=document.createElement("p"),e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(c,null);for(var g in e)void 0!==c.style[g]&&(c.style[g]="translate3d(1px,1px,1px)",b=window.getComputedStyle(c).getPropertyValue(e[g]));document.body.removeChild(c);this.css3D=void 0!==b&&0<b.length&&"none"!==b},canPlayAudio:function(b){return"mp3"==
b&&this.mp3?!0:"ogg"==b&&(this.ogg||this.opus)?!0:"m4a"==b&&this.m4a?!0:"opus"==b&&this.opus?!0:"wav"==b&&this.wav?!0:"webm"==b&&this.webm?!0:!1},isConsoleOpen:function(){return window.console&&window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?0<console.profiles.length:!1}};c.Device.prototype.constructor=c.Device;c.Device.isAndroidStockBrowser=function(){var b=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);
return b&&537>b[1]};c.RequestAnimationFrame=function(b,c){"undefined"==typeof c&&(c=!1);this.game=b;this.isRunning=!1;this.forceSetTimeOut=c;for(var e=["ms","moz","webkit","o"],g=0;g<e.length&&!window.requestAnimationFrame;g++)window.requestAnimationFrame=window[e[g]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[g]+"CancelAnimationFrame"];this._isSetTimeOut=!1;this._timeOutID=this._onLoop=null};c.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var b=this;!window.requestAnimationFrame||
this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return b.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(c){return b.updateRAF(c)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(){this.game.update(Date.now());this._timeOutID=window.requestAnimationFrame(this._onLoop)},updateSetTimeout:function(){this.game.update(Date.now());this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)},
stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID);this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}};c.RequestAnimationFrame.prototype.constructor=c.RequestAnimationFrame;c.Math={PI2:2*Math.PI,fuzzyEqual:function(b,c,e){return"undefined"==typeof e&&(e=1E-4),Math.abs(b-c)<e},fuzzyLessThan:function(b,c,e){return"undefined"==typeof e&&(e=1E-4),c+e>b},fuzzyGreaterThan:function(b,
c,e){return"undefined"==typeof e&&(e=1E-4),b>c-e},fuzzyCeil:function(b,c){return"undefined"==typeof c&&(c=1E-4),Math.ceil(b-c)},fuzzyFloor:function(b,c){return"undefined"==typeof c&&(c=1E-4),Math.floor(b+c)},average:function(){for(var b=[],c=0;c<arguments.length-0;c++)b[c]=arguments[c+0];for(var e=c=0;e<b.length;e++)c+=b[e];return c/b.length},truncate:function(b){return 0<b?Math.floor(b):Math.ceil(b)},shear:function(b){return b%1},snapTo:function(b,c,e){return"undefined"==typeof e&&(e=0),0===c?b:
(b-=e,b=c*Math.round(b/c),e+b)},snapToFloor:function(b,c,e){return"undefined"==typeof e&&(e=0),0===c?b:(b-=e,b=c*Math.floor(b/c),e+b)},snapToCeil:function(b,c,e){return"undefined"==typeof e&&(e=0),0===c?b:(b-=e,b=c*Math.ceil(b/c),e+b)},snapToInArray:function(b,c,e){if("undefined"==typeof e&&(e=!0),e&&c.sort(),b<c[0])return c[0];for(var g=1;c[g]<b;)g++;e=c[g-1];c=g<c.length?c[g]:Number.POSITIVE_INFINITY;return b-e>=c-b?c:e},roundTo:function(b,c,e){"undefined"==typeof c&&(c=0);"undefined"==typeof e&&
(e=10);c=Math.pow(e,-c);return Math.round(b*c)/c},floorTo:function(b,c,e){"undefined"==typeof c&&(c=0);"undefined"==typeof e&&(e=10);c=Math.pow(e,-c);return Math.floor(b*c)/c},ceilTo:function(b,c,e){"undefined"==typeof c&&(c=0);"undefined"==typeof e&&(e=10);c=Math.pow(e,-c);return Math.ceil(b*c)/c},interpolateFloat:function(b,c,e){return(c-b)*e+b},angleBetween:function(b,c,e,g){return Math.atan2(g-c,e-b)},angleBetweenY:function(b,c,e,g){return Math.atan2(e-b,g-c)},angleBetweenPoints:function(b,c){return Math.atan2(c.y-
b.y,c.x-b.x)},angleBetweenPointsY:function(b,c){return Math.atan2(c.x-b.x,c.y-b.y)},reverseAngle:function(b){return this.normalizeAngle(b+Math.PI,!0)},normalizeAngle:function(b){return b%=2*Math.PI,0<=b?b:b+2*Math.PI},normalizeLatitude:function(b){return Math.max(-90,Math.min(90,b))},normalizeLongitude:function(b){return 180==b%360?180:(b%=360,-180>b?b+360:180<b?b-360:b)},chanceRoll:function(b){return"undefined"==typeof b&&(b=50),0>=b?!1:100<=b?!0:100*Math.random()>=b?!1:!0},numberArray:function(b,
c){for(var e=[],g=b;c>=g;g++)e.push(g);return e},numberArrayStep:function(b,d,e){b=+b||0;var g=typeof d;"number"!==g&&"string"!==g||!e||e[d]!==b||(d=e=null);e=null==e?1:+e||0;null===d?(d=b,b=0):d=+d||0;g=-1;d=c.Math.max(c.Math.ceil((d-b)/(e||1)),0);for(var h=Array(d);++g<d;)h[g]=b,b+=e;return h},maxAdd:function(b,c,e){return b+=c,b>e&&(b=e),b},minSub:function(b,c,e){return b-=c,e>b&&(b=e),b},wrap:function(b,c,e){e-=c;if(0>=e)return 0;b=(b-c)%e;return 0>b&&(b+=e),b+c},wrapValue:function(b,c,e){return b=
Math.abs(b),c=Math.abs(c),e=Math.abs(e),(b+c)%e},limitValue:function(b,c,e){return c>b?c:b>e?e:b},randomSign:function(){return.5<Math.random()?1:-1},isOdd:function(b){return 1&b},isEven:function(b){return 1&b?!1:!0},min:function(){for(var b=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments,c=1,e=0,g=b.length;g>c;c++)b[c]<b[e]&&(e=c);return b[e]},max:function(){for(var b=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments,c=1,e=0,g=b.length;g>c;c++)b[c]>
b[e]&&(e=c);return b[e]},minProperty:function(b){for(var c=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1),e=1,g=0,h=c.length;h>e;e++)c[e][b]<c[g][b]&&(g=e);return c[g][b]},maxProperty:function(b){for(var c=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1),e=1,g=0,h=c.length;h>e;e++)c[e][b]>c[g][b]&&(g=e);return c[g][b]},wrapAngle:function(b,c){var e=c?Math.PI/180:1;return this.wrap(b,-180*e,180*e)},angleLimit:function(b,c,e){var g=
b;return b>e?g=e:c>b&&(g=c),g},linearInterpolation:function(b,c){var e=b.length-1,g=e*c,h=Math.floor(g);return 0>c?this.linear(b[0],b[1],g):1<c?this.linear(b[e],b[e-1],e-g):this.linear(b[h],b[h+1>e?e:h+1],g-h)},bezierInterpolation:function(b,c){for(var e=0,g=b.length-1,h=0;g>=h;h++)e+=Math.pow(1-c,g-h)*Math.pow(c,h)*b[h]*this.bernstein(g,h);return e},catmullRomInterpolation:function(b,c){var e=b.length-1,g=e*c,h=Math.floor(g);return b[0]===b[e]?(0>c&&(h=Math.floor(g=e*(1+c))),this.catmullRom(b[(h-
1+e)%e],b[h],b[(h+1)%e],b[(h+2)%e],g-h)):0>c?b[0]-(this.catmullRom(b[0],b[0],b[1],b[1],-g)-b[0]):1<c?b[e]-(this.catmullRom(b[e],b[e],b[e-1],b[e-1],g-e)-b[e]):this.catmullRom(b[h?h-1:0],b[h],b[h+1>e?e:h+1],b[h+2>e?e:h+2],g-h)},linear:function(b,c,e){return(c-b)*e+b},bernstein:function(b,c){return this.factorial(b)/this.factorial(c)/this.factorial(b-c)},factorial:function(b){if(0===b)return 1;for(var c=b;--b;)c*=b;return c},catmullRom:function(b,c,e,g,h){b=.5*(e-b);g=.5*(g-c);var f=h*h;return(2*c-2*
e+b+g)*h*f+(-3*c+3*e-2*b-g)*f+b*h+c},difference:function(b,c){return Math.abs(b-c)},getRandom:function(b,c,e){if("undefined"==typeof c&&(c=0),"undefined"==typeof e&&(e=0),null!=b)if((0===e||e>b.length-c)&&(e=b.length-c),0<e)return b[c+Math.floor(Math.random()*e)];return null},removeRandom:function(b,c,e){if("undefined"==typeof c&&(c=0),"undefined"==typeof e&&(e=0),null!=b)if((0===e||e>b.length-c)&&(e=b.length-c),0<e)return c+=Math.floor(Math.random()*e),b.splice(c,1)[0];return null},floor:function(b){var c=
0|b;return 0<b?c:c!=b?c-1:c},ceil:function(b){var c=0|b;return 0<b&&c!=b?c+1:c},sinCosGenerator:function(b,c,e,g){"undefined"==typeof c&&(c=1);"undefined"==typeof e&&(e=1);"undefined"==typeof g&&(g=1);g=g*Math.PI/b;for(var h=[],f=[],k=0;b>k;k++)e-=c*g,c+=e*g,h[k]=e,f[k]=c;return{sin:f,cos:h,length:b}},shift:function(b){var c=b.shift();return b.push(c),c},shuffleArray:function(b){for(var c=b.length-1;0<c;c--){var e=Math.floor(Math.random()*(c+1)),g=b[c];b[c]=b[e];b[e]=g}return b},distance:function(b,
c,e,g){b-=e;c-=g;return Math.sqrt(b*b+c*c)},distancePow:function(b,c,e,g,h){return"undefined"==typeof h&&(h=2),Math.sqrt(Math.pow(e-b,h)+Math.pow(g-c,h))},distanceRounded:function(b,d,e,g){return Math.round(c.Math.distance(b,d,e,g))},clamp:function(b,c,e){return c>b?c:b>e?e:b},clampBottom:function(b,c){return c>b?c:b},within:function(b,c,e){return Math.abs(b-c)<=e},mapLinear:function(b,c,e,g,h){return g+(b-c)*(h-g)/(e-c)},smoothstep:function(b,c,e){return b=Math.max(0,Math.min(1,(b-c)/(e-c))),b*b*
(3-2*b)},smootherstep:function(b,c,e){return b=Math.max(0,Math.min(1,(b-c)/(e-c))),b*b*b*(b*(6*b-15)+10)},sign:function(b){return 0>b?-1:0<b?1:0},percent:function(b,c,e){return"undefined"==typeof e&&(e=0),b>c||e>c?1:e>b||e>b?0:(b-e)/c},degToRad:function(){var b=Math.PI/180;return function(c){return c*b}}(),radToDeg:function(){var b=180/Math.PI;return function(c){return c*b}}()};c.RandomDataGenerator=function(b){"undefined"==typeof b&&(b=[]);this.c=1;this.s2=this.s1=this.s0=0;this.sow(b)};c.RandomDataGenerator.prototype=
{rnd:function(){var b=2091639*this.s0+2.3283064365386963E-10*this.c;return this.c=0|b,this.s0=this.s1,this.s1=this.s2,this.s2=b-this.c,this.s2},sow:function(b){"undefined"==typeof b&&(b=[]);this.s0=this.hash(" ");this.s1=this.hash(this.s0);this.s2=this.hash(this.s1);this.c=1;for(var c,e=0;c=b[e++];)this.s0-=this.hash(c),this.s0+=~~(0>this.s0),this.s1-=this.hash(c),this.s1+=~~(0>this.s1),this.s2-=this.hash(c),this.s2+=~~(0>this.s2)},hash:function(b){var c,e,g;g=4022871197;b=b.toString();for(e=0;e<
b.length;e++)g+=b.charCodeAt(e),c=.02519603282416938*g,g=c>>>0,c-=g,c*=g,g=c>>>0,c-=g,g+=4294967296*c;return 2.3283064365386963E-10*(g>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565E-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(b,c){return Math.floor(this.realInRange(0,c-b+1)+b)},between:function(b,c){return this.integerInRange(b,c)},realInRange:function(b,
c){return this.frac()*(c-b)+b},normal:function(){return 1-2*this.frac()},uuid:function(){for(var b="",c="",c=b="";36>b++;c+=~b%5|3*b&4?(15^b?8^this.frac()*(20^b?16:4):4).toString(16):"-");return c},pick:function(b){return b[this.integerInRange(0,b.length-1)]},weightedPick:function(b){return b[~~(Math.pow(this.frac(),2)*(b.length-1))]},timestamp:function(b,c){return this.realInRange(b||9466848E5,c||1577862E6)},angle:function(){return this.integerInRange(-180,180)}};c.RandomDataGenerator.prototype.constructor=
c.RandomDataGenerator;c.QuadTree=function(b,c,e,g,h,f,k){this.maxObjects=10;this.maxLevels=4;this.level=0;this.bounds={};this.objects=[];this.nodes=[];this._empty=[];this.reset(b,c,e,g,h,f,k)};c.QuadTree.prototype={reset:function(b,c,e,g,h,f,k){this.maxObjects=h||10;this.maxLevels=f||4;this.level=k||0;this.bounds={x:Math.round(b),y:Math.round(c),width:e,height:g,subWidth:Math.floor(e/2),subHeight:Math.floor(g/2),right:Math.round(b)+Math.floor(e/2),bottom:Math.round(c)+Math.floor(g/2)};this.objects.length=
0;this.nodes.length=0},populate:function(b){b.forEach(this.populateHandler,this,!0)},populateHandler:function(b){b.body&&b.exists&&this.insert(b.body)},split:function(){this.nodes[0]=new c.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[1]=new c.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[2]=new c.QuadTree(this.bounds.x,
this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[3]=new c.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(b){var c,e=0;if(null!=this.nodes[0]&&(c=this.getIndex(b),-1!==c))return void this.nodes[c].insert(b);if(this.objects.push(b),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();e<
this.objects.length;)c=this.getIndex(this.objects[e]),-1!==c?this.nodes[c].insert(this.objects.splice(e,1)[0]):e++},getIndex:function(b){var c=-1;return b.x<this.bounds.right&&b.right<this.bounds.right?b.y<this.bounds.bottom&&b.bottom<this.bounds.bottom?c=1:b.y>this.bounds.bottom&&(c=2):b.x>this.bounds.right&&(b.y<this.bounds.bottom&&b.bottom<this.bounds.bottom?c=0:b.y>this.bounds.bottom&&(c=3)),c},retrieve:function(b){if(b instanceof c.Rectangle)var d=this.objects,e=this.getIndex(b);else{if(!b.body)return this._empty;
d=this.objects;e=this.getIndex(b.body)}return this.nodes[0]&&(-1!==e?d=d.concat(this.nodes[e].retrieve(b)):(d=d.concat(this.nodes[0].retrieve(b)),d=d.concat(this.nodes[1].retrieve(b)),d=d.concat(this.nodes[2].retrieve(b)),d=d.concat(this.nodes[3].retrieve(b)))),d},clear:function(){this.objects.length=0;for(var b=this.nodes.length;b--;)this.nodes[b].clear(),this.nodes.splice(b,1);this.nodes.length=0}};c.QuadTree.prototype.constructor=c.QuadTree;c.Net=function(b){this.game=b};c.Net.prototype={getHostName:function(){return window.location&&
window.location.hostname?window.location.hostname:null},checkDomainName:function(b){return-1!==window.location.hostname.indexOf(b)},updateQueryString:function(b,c,e,g){"undefined"==typeof e&&(e=!1);"undefined"!=typeof g&&""!==g||(g=window.location.href);var h="",h=new RegExp("([?|&])"+b+"=.*?(&|#|$)(.*)","gi");if(h.test(g))h="undefined"!=typeof c&&null!==c?g.replace(h,"$1"+b+"="+c+"$2$3"):g.replace(h,"$1$3").replace(/(&|\?)$/,"");else{if("undefined"!=typeof c&&null!==c){var h=-1!==g.indexOf("?")?
"&":"?",f=g.split("#");g=f[0]+h+b+"="+c;f[1]&&(g+="#"+f[1])}h=g}return e?void(window.location.href=h):h},getQueryString:function(b){"undefined"==typeof b&&(b="");var c={},e=location.search.substring(1).split("&"),g;for(g in e){var h=e[g].split("=");if(1<h.length){if(b&&b==this.decodeURI(h[0]))return this.decodeURI(h[1]);c[this.decodeURI(h[0])]=this.decodeURI(h[1])}}return c},decodeURI:function(b){return decodeURIComponent(b.replace(/\+/g," "))}};c.Net.prototype.constructor=c.Net;c.TweenManager=function(b){this.game=
b;this._tweens=[];this._add=[];this.game.onPause.add(this._pauseAll,this);this.game.onResume.add(this._resumeAll,this)};c.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var b=0;b<this._tweens.length;b++)this._tweens[b].pendingDelete=!0;this._add=[]},add:function(b){b._manager=this;this._add.push(b)},create:function(b){return new c.Tween(b,this.game,this)},remove:function(b){var c=this._tweens.indexOf(b);-1!==c?this._tweens[c].pendingDelete=!0:(c=this._add.indexOf(b),
-1!==c&&(this._add[c].pendingDelete=!0))},update:function(){var b=this._add.length,c=this._tweens.length;if(0===c&&0===b)return!1;for(var e=0;c>e;)this._tweens[e].update(this.game.time.now)?e++:(this._tweens.splice(e,1),c--);return 0<b&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(b){return this._tweens.some(function(c){return c._object===b})},_pauseAll:function(){for(var b=this._tweens.length-1;0<=b;b--)this._tweens[b]._pause()},_resumeAll:function(){for(var b=
this._tweens.length-1;0<=b;b--)this._tweens[b]._resume()},pauseAll:function(){for(var b=this._tweens.length-1;0<=b;b--)this._tweens[b].pause()},resumeAll:function(){for(var b=this._tweens.length-1;0<=b;b--)this._tweens[b].resume(!0)}};c.TweenManager.prototype.constructor=c.TweenManager;c.Tween=function(b,d,e){this._object=b;this.game=d;this._manager=e;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._reversed=this._yoyo=!1;this._delayTime=0;
this._startTime=null;this._easingFunction=c.Easing.Default;this._interpolationFunction=c.Math.linearInterpolation;this._chainedTweens=[];this._onStartCallbackFired=!1;this._onUpdateCallbackContext=this._onUpdateCallback=null;this._paused=!1;this._pausedTime=0;this.pendingDelete=this._codePaused=!1;this.onStart=new c.Signal;this.onLoop=new c.Signal;this.onComplete=new c.Signal;this.isRunning=!1};c.Tween.prototype={to:function(b,c,e,g,h,f,k){c=c||1E3;e=e||null;g=g||!1;h=h||0;f=f||0;(k=k||!1)&&0===f&&
(f=1);var m;return this._parent?(m=this._manager.create(this._object),this._lastChild.chain(m),this._lastChild=m):(m=this,this._parent=this,this._lastChild=this),m._repeat=f,m._duration=c,m._valuesEnd=b,null!==e&&(m._easingFunction=e),0<h&&(m._delayTime=h),m._yoyo=k,g?this.start():this},from:function(b,c,e,g,h,f,k){var m={},n;for(n in b)m[n]=this._object[n],this._object[n]=b[n];return this.to(m,c,e,g,h,f,k)},start:function(){if(null!==this.game&&null!==this._object){this._manager.add(this);this.isRunning=
!0;this._onStartCallbackFired=!1;this._startTime=this.game.time.now+this._delayTime;for(var b in this._valuesEnd){if(Array.isArray(this._valuesEnd[b])){if(0===this._valuesEnd[b].length)continue;this._valuesEnd[b]=[this._object[b]].concat(this._valuesEnd[b])}this._valuesStart[b]=this._object[b];Array.isArray(this._valuesStart[b])||(this._valuesStart[b]*=1);this._valuesStartRepeat[b]=this._valuesStart[b]||0}return this}},generateData:function(b,c){if(null===this.game||null===this._object)return null;
this._startTime=0;for(var e in this._valuesEnd){if(Array.isArray(this._valuesEnd[e])){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}this._valuesStart[e]=this._object[e];Array.isArray(this._valuesStart[e])||(this._valuesStart[e]*=1);this._valuesStartRepeat[e]=this._valuesStart[e]||0}for(var g=0,h=Math.floor(this._duration/1E3*b),f=this._duration/h,k=[];h--;){var m=(g-this._startTime)/this._duration,m=1<m?1:m,m=this._easingFunction(m),n={};
for(e in this._valuesEnd){var p=this._valuesStart[e]||0,q=this._valuesEnd[e];q instanceof Array?n[e]=this._interpolationFunction(q,m):"string"==typeof q?parseFloat(q,10):"number"==typeof q&&(n[e]=p+(q-p)*m)}k.push(n);g+=f}n={};for(e in this._valuesEnd)n[e]=this._valuesEnd[e];if(k.push(n),this._yoyo)e=k.slice(),e.reverse(),k=k.concat(e);return"undefined"!=typeof c?c.concat(k):k},stop:function(){return this.isRunning=!1,this._onUpdateCallback=null,this._manager.remove(this),this},delay:function(b){return this._delayTime=
b,this},repeat:function(b){return this._repeat=b,this},yoyo:function(b){return this._yoyo=b,b&&0===this._repeat&&(this._repeat=1),this},easing:function(b){return this._easingFunction=b,this},interpolation:function(b){return this._interpolationFunction=b,this},chain:function(){return this._chainedTweens=arguments,this},loop:function(){return this._lastChild.chain(this),this},onUpdateCallback:function(b,c){return this._onUpdateCallback=b,this._onUpdateCallbackContext=c,this},pause:function(){this._paused=
this._codePaused=!0;this._pausedTime=this.game.time.now},_pause:function(){this._codePaused||(this._paused=!0,this._pausedTime=this.game.time.now)},resume:function(){this._paused&&(this._paused=!1,this._codePaused=!1,this._startTime+=this.game.time.now-this._pausedTime)},_resume:function(){this._codePaused||(this._startTime+=this.game.time.pauseDuration,this._paused=!1)},update:function(b){if(this.pendingDelete)return!1;if(this._paused||b<this._startTime)return!0;var c;if(b<this._startTime)return!0;
!1===this._onStartCallbackFired&&(this.onStart.dispatch(this._object),this._onStartCallbackFired=!0);var e=(b-this._startTime)/this._duration,e=1<e?1:e,g=this._easingFunction(e);for(c in this._valuesEnd){var h=this._valuesStart[c]||0,f=this._valuesEnd[c];f instanceof Array?this._object[c]=this._interpolationFunction(f,g):("string"==typeof f&&(f=h+parseFloat(f,10)),"number"==typeof f&&(this._object[c]=h+(f-h)*g))}if(null!==this._onUpdateCallback&&(this._onUpdateCallback.call(this._onUpdateCallbackContext,
this,g),!this.isRunning))return!1;if(1==e){if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(c in this._valuesStartRepeat){if("string"==typeof this._valuesEnd[c]&&(this._valuesStartRepeat[c]+=parseFloat(this._valuesEnd[c],10)),this._yoyo)e=this._valuesStartRepeat[c],this._valuesStartRepeat[c]=this._valuesEnd[c],this._valuesEnd[c]=e;this._valuesStart[c]=this._valuesStartRepeat[c]}return this._yoyo&&(this._reversed=!this._reversed),this._startTime=b+this._delayTime,this.onLoop.dispatch(this._object),
!0}this.isRunning=!1;this.onComplete.dispatch(this._object);c=0;for(e=this._chainedTweens.length;e>c;c++)this._chainedTweens[c].start(b);return!1}return!0}};c.Tween.prototype.constructor=c.Tween;c.Easing={Linear:{None:function(b){return b}},Quadratic:{In:function(b){return b*b},Out:function(b){return b*(2-b)},InOut:function(b){return 1>(b*=2)?.5*b*b:-.5*(--b*(b-2)-1)}},Cubic:{In:function(b){return b*b*b},Out:function(b){return--b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b:.5*((b-=2)*b*b+2)}},
Quartic:{In:function(b){return b*b*b*b},Out:function(b){return 1- --b*b*b*b},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b:-.5*((b-=2)*b*b*b-2)}},Quintic:{In:function(b){return b*b*b*b*b},Out:function(b){return--b*b*b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b*b:.5*((b-=2)*b*b*b*b+2)}},Sinusoidal:{In:function(b){return 1-Math.cos(b*Math.PI/2)},Out:function(b){return Math.sin(b*Math.PI/2)},InOut:function(b){return.5*(1-Math.cos(Math.PI*b))}},Exponential:{In:function(b){return 0===b?0:Math.pow(1024,
b-1)},Out:function(b){return 1===b?1:1-Math.pow(2,-10*b)},InOut:function(b){return 0===b?0:1===b?1:1>(b*=2)?.5*Math.pow(1024,b-1):.5*(-Math.pow(2,-10*(b-1))+2)}},Circular:{In:function(b){return 1-Math.sqrt(1-b*b)},Out:function(b){return Math.sqrt(1- --b*b)},InOut:function(b){return 1>(b*=2)?-.5*(Math.sqrt(1-b*b)-1):.5*(Math.sqrt(1-(b-=2)*b)+1)}},Elastic:{In:function(b){var c,e=.1;return 0===b?0:1===b?1:(!e||1>e?(e=1,c=.1):c=.4*Math.asin(1/e)/(2*Math.PI),-(e*Math.pow(2,10*--b)*Math.sin(2*(b-c)*Math.PI/
.4)))},Out:function(b){var c,e=.1;return 0===b?0:1===b?1:(!e||1>e?(e=1,c=.1):c=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*b)*Math.sin(2*(b-c)*Math.PI/.4)+1)},InOut:function(b){var c,e=.1;return 0===b?0:1===b?1:(!e||1>e?(e=1,c=.1):c=.4*Math.asin(1/e)/(2*Math.PI),1>(b*=2)?-.5*e*Math.pow(2,10*--b)*Math.sin(2*(b-c)*Math.PI/.4):e*Math.pow(2,-10*--b)*Math.sin(2*(b-c)*Math.PI/.4)*.5+1)}},Back:{In:function(b){return b*b*(2.70158*b-1.70158)},Out:function(b){return--b*b*(2.70158*b+1.70158)+1},InOut:function(b){return 1>
(b*=2)?.5*b*b*(3.5949095*b-2.5949095):.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)}},Bounce:{In:function(b){return 1-c.Easing.Bounce.Out(1-b)},Out:function(b){return 1/2.75>b?7.5625*b*b:2/2.75>b?7.5625*(b-=1.5/2.75)*b+.75:2.5/2.75>b?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375},InOut:function(b){return.5>b?.5*c.Easing.Bounce.In(2*b):.5*c.Easing.Bounce.Out(2*b-1)+.5}}};c.Easing.Default=c.Easing.Linear.None;c.Time=function(b){this.game=b;this.pausedTime=this.elapsed=this.now=this.prevTime=
this.time=0;this.advancedTiming=!1;this.fps=0;this.fpsMin=1E3;this.fpsMax=0;this.msMin=1E3;this.deltaCap=this.physicsElapsed=this.msMax=0;this.timeCap=1/60*1E3;this.lastTime=this.timeToCall=this.pauseDuration=this.frames=0;this.events=new c.Timer(this.game,!1);this._pauseStarted=this._timeLastSecond=this._started=0;this._justResumed=!1;this._timers=[];this._i=this._len=0};c.Time.prototype={boot:function(){this._started=Date.now();this.events.start()},add:function(b){return this._timers.push(b),b},
create:function(b){"undefined"==typeof b&&(b=!0);b=new c.Timer(this.game,b);return this._timers.push(b),b},removeAll:function(){for(var b=0;b<this._timers.length;b++)this._timers[b].destroy();this._timers=[];this.events.removeAll()},update:function(b){if(this.prevTime=this.now,this.now=b,this.timeToCall=this.game.math.max(0,16-(b-this.lastTime)),this.elapsed=this.now-this.time,this.elapsed>this.timeCap&&(this.elapsed=this.timeCap),this.physicsElapsed=this.elapsed/1E3||1/60,0<this.deltaCap&&this.physicsElapsed>
this.deltaCap&&(this.physicsElapsed=this.deltaCap),this.advancedTiming&&(this.msMin=this.game.math.min(this.msMin,this.elapsed),this.msMax=this.game.math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1E3&&(this.fps=Math.round(1E3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=this.game.math.min(this.fpsMin,this.fps),this.fpsMax=this.game.math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)),this.time=this.now,this.lastTime=b+this.timeToCall,
!this.game.paused)for(this.events.update(this.now),this._i=0,this._len=this._timers.length;this._i<this._len;)this._timers[this._i].update(this.now)?this._i++:(this._timers.splice(this._i,1),this._len--)},gamePaused:function(){this._pauseStarted=this.now;this.events.pause();for(var b=this._timers.length;b--;)this._timers[b]._pause()},gameResumed:function(){this.time=this.now=Date.now();this.pauseDuration=this.time-this._pauseStarted;this.events.resume();for(var b=this._timers.length;b--;)this._timers[b]._resume()},
totalElapsedSeconds:function(){return.001*(this.now-this._started)},elapsedSince:function(b){return this.now-b},elapsedSecondsSince:function(b){return.001*(this.now-b)},reset:function(){this._started=this.now;this.removeAll()}};c.Time.prototype.constructor=c.Time;c.Timer=function(b,d){"undefined"==typeof d&&(d=!0);this.game=b;this.running=!1;this.autoDestroy=d;this.expired=!1;this.elapsed=0;this.events=[];this.onComplete=new c.Signal;this.nextTick=0;this.timeCap=1E3;this._codePaused=this.paused=!1;
this._pauseTotal=this._pauseStarted=this._started=0;this._now=Date.now();this._newTick=this._diff=this._i=this._marked=this._len=0};c.Timer.MINUTE=6E4;c.Timer.SECOND=1E3;c.Timer.HALF=500;c.Timer.QUARTER=250;c.Timer.prototype={create:function(b,d,e,g,h,f){b=Math.round(b);var k;k=b+(0===this._now?this.game.time.now:this._now);b=new c.TimerEvent(this,b,k,e,d,g,h,f);return this.events.push(b),this.order(),this.expired=!1,b},add:function(b,c,e){return this.create(b,!1,0,c,e,Array.prototype.splice.call(arguments,
3))},repeat:function(b,c,e,g){return this.create(b,!1,c,e,g,Array.prototype.splice.call(arguments,4))},loop:function(b,c,e){return this.create(b,!0,0,c,e,Array.prototype.splice.call(arguments,3))},start:function(b){if(!this.running)for(this._started=this.game.time.now+(b||0),this.running=!0,b=0;b<this.events.length;b++)this.events[b].tick=this.events[b].delay+this._started},stop:function(b){this.running=!1;"undefined"==typeof b&&(b=!0);b&&(this.events.length=0)},remove:function(b){for(var c=0;c<this.events.length;c++)if(this.events[c]===
b)return this.events[c].pendingDelete=!0,!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(b,c){return b.tick<c.tick?-1:b.tick>c.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length;this._i=0},update:function(b){if(this.paused)return!0;if(this.elapsed=b-this._now,this._now=b,this.elapsed>
this.timeCap&&this.adjustEvents(b-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),0>this._newTick&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?(this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,
this.events[this._i].args)):0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):(this._marked++,this.events[this._i].pendingDelete=!0,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&
this.autoDestroy?!1:!0},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.now,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.now,this.paused=!0)},adjustEvents:function(b){for(var c=0;c<this.events.length;c++)if(!this.events[c].pendingDelete){var e=this.events[c].tick-b;0>e&&(e=0);this.events[c].tick=this._now+e}b=this.nextTick-b;this.nextTick=0>b?this._now:this._now+b},resume:function(){if(this.paused){var b=
this.game.time.now;this._pauseTotal+=b-this._now;this._now=b;this.adjustEvents(this._pauseStarted);this._codePaused=this.paused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll();this._i=this._len=this.events.length=0},destroy:function(){this.onComplete.removeAll();this.running=!1;this.events=[];this._i=this._len=0}};Object.defineProperty(c.Timer.prototype,"next",{get:function(){return this.nextTick}});Object.defineProperty(c.Timer.prototype,
"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}});Object.defineProperty(c.Timer.prototype,"length",{get:function(){return this.events.length}});Object.defineProperty(c.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}});Object.defineProperty(c.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}});c.Timer.prototype.constructor=c.Timer;c.TimerEvent=function(b,c,e,g,h,f,k,m){this.timer=
b;this.delay=c;this.tick=e;this.repeatCount=g-1;this.loop=h;this.callback=f;this.callbackContext=k;this.args=m;this.pendingDelete=!1};c.TimerEvent.prototype.constructor=c.TimerEvent;c.AnimationManager=function(b){this.sprite=b;this.game=b.game;this.currentAnim=this.currentFrame=null;this.updateIfVisible=!0;this.isLoaded=!1;this._frameData=null;this._anims={};this._outputFrames=[]};c.AnimationManager.prototype={loadFrameData:function(b,c){if("undefined"==typeof b)return!1;if(this.isLoaded)for(var e in this._anims)this._anims[e].updateFrameData(b);
return this._frameData=b,"undefined"==typeof c||null===c?this.frame=0:"string"==typeof c?this.frameName=c:this.frame=c,this.isLoaded=!0,!0},copyFrameData:function(b,c){if(this._frameData=b.clone(),this.isLoaded)for(var e in this._anims)this._anims[e].updateFrameData(this._frameData);return"undefined"==typeof c||null===c?this.frame=0:"string"==typeof c?this.frameName=c:this.frame=c,this.isLoaded=!0,!0},add:function(b,d,e,g,h){return d=d||[],e=e||60,"undefined"==typeof g&&(g=!1),"undefined"==typeof h&&
(h=d&&"number"==typeof d[0]?!0:!1),null===this.sprite.events.onAnimationStart&&(this.sprite.events.onAnimationStart=new c.Signal,this.sprite.events.onAnimationComplete=new c.Signal,this.sprite.events.onAnimationLoop=new c.Signal),this._outputFrames.length=0,this._frameData.getFrameIndexes(d,h,this._outputFrames),this._anims[b]=new c.Animation(this.game,this.sprite,b,this._frameData,this._outputFrames,e,g),this.currentAnim=this._anims[b],this.currentFrame=this.currentAnim.currentFrame,this.sprite.__tilePattern&&
(this.sprite.__tilePattern=!1,this.tilingTexture=!1),this._anims[b]},validateFrames:function(b,c){"undefined"==typeof c&&(c=!0);for(var e=0;e<b.length;e++)if(!0===c){if(b[e]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(b[e]))return!1;return!0},play:function(b,c,e,g){return this._anims[b]?this.currentAnim===this._anims[b]?!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(c,e,g)):this.currentAnim:(this.currentAnim&&this.currentAnim.isPlaying&&
this.currentAnim.stop(),this.currentAnim=this._anims[b],this.currentAnim.paused=!1,this.currentFrame=this.currentAnim.currentFrame,this.currentAnim.play(c,e,g)):void 0},stop:function(b,c){"undefined"==typeof c&&(c=!1);"string"==typeof b?this._anims[b]&&(this.currentAnim=this._anims[b],this.currentAnim.stop(c)):this.currentAnim&&this.currentAnim.stop(c)},update:function(){return this.updateIfVisible&&!this.sprite.visible?!1:this.currentAnim&&!0===this.currentAnim.update()?(this.currentFrame=this.currentAnim.currentFrame,
!0):!1},next:function(b){this.currentAnim&&(this.currentAnim.next(b),this.currentFrame=this.currentAnim.currentFrame)},previous:function(b){this.currentAnim&&(this.currentAnim.previous(b),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(b){return"string"==typeof b&&this._anims[b]?this._anims[b]:null},refreshFrame:function(){this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid]);this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1)},destroy:function(){var b=
null;for(b in this._anims)this._anims.hasOwnProperty(b)&&this._anims[b].destroy();this._anims={};this._frameData=null;this._frameIndex=0;this.currentFrame=this.currentAnim=null}};c.AnimationManager.prototype.constructor=c.AnimationManager;Object.defineProperty(c.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}});Object.defineProperty(c.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}});Object.defineProperty(c.AnimationManager.prototype,
"paused",{get:function(){return this.currentAnim.isPaused},set:function(b){this.currentAnim.paused=b}});Object.defineProperty(c.AnimationManager.prototype,"name",{get:function(){return this.currentAnim?this.currentAnim.name:void 0}});Object.defineProperty(c.AnimationManager.prototype,"frame",{get:function(){return this.currentFrame?this._frameIndex:void 0},set:function(b){"number"==typeof b&&null!==this._frameData.getFrame(b)&&(this.currentFrame=this._frameData.getFrame(b),this.currentFrame&&(this._frameIndex=
b,this.sprite.setFrame(this.currentFrame),this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1)))}});Object.defineProperty(c.AnimationManager.prototype,"frameName",{get:function(){return this.currentFrame?this.currentFrame.name:void 0},set:function(b){"string"==typeof b&&null!==this._frameData.getFrameByName(b)?(this.currentFrame=this._frameData.getFrameByName(b),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame),this.sprite.__tilePattern&&
(this.__tilePattern=!1,this.tilingTexture=!1))):console.warn("Cannot set frameName: "+b)}});c.Animation=function(b,d,e,g,h,f,k){"undefined"==typeof k&&(k=!1);this.game=b;this._parent=d;this._frameData=g;this.name=e;this._frames=[];this._frames=this._frames.concat(h);this.delay=1E3/f;this.loop=k;this.loopCount=0;this.isPaused=this.isPlaying=this.isFinished=this.killOnComplete=!1;this._frameDiff=this._frameIndex=this._pauseStartTime=0;this._frameSkip=1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);
this.onStart=new c.Signal;this.onUpdate=null;this.onComplete=new c.Signal;this.onLoop=new c.Signal;this.game.onPause.add(this.onPause,this);this.game.onResume.add(this.onResume,this)};c.Animation.prototype={play:function(b,c,e){return"number"==typeof b&&(this.delay=1E3/b),"boolean"==typeof c&&(this.loop=c),"undefined"!=typeof e&&(this.killOnComplete=e),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.now,this._timeNextFrame=this.game.time.now+
this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setFrame(this.currentFrame),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1),this._parent.events.onAnimationStart.dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),this},restart:function(){this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.now;this._timeNextFrame=this.game.time.now+
this.delay;this._frameIndex=0;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this._parent.setFrame(this.currentFrame);this.onStart.dispatch(this._parent,this)},setFrame:function(b,c){var e;if("undefined"==typeof c&&(c=!1),"string"==typeof b)for(var g=0;g<this._frames.length;g++)this._frameData.getFrame(this._frames[g]).name===b&&(e=g);else if("number"==typeof b)if(c)e=b;else for(g=0;g<this._frames.length;g++)this.frames[g]===e&&(e=g);e&&(this._frameIndex=e-1,this._timeNextFrame=
this.game.time.now,this.update())},stop:function(b,c){"undefined"==typeof b&&(b=!1);"undefined"==typeof c&&(c=!1);this.isPlaying=!1;this.isFinished=!0;this.paused=!1;b&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame));c&&(this._parent.events.onAnimationComplete.dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.now)},onResume:function(){this.isPlaying&&
(this._timeNextFrame=this.game.time.now+this._frameDiff)},update:function(){return this.isPaused?!1:this.isPlaying&&this.game.time.now>=this._timeNextFrame?(this._frameSkip=1,this._frameDiff=this.game.time.now-this._timeNextFrame,this._timeLastFrame=this.game.time.now,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.now+(this.delay-this._frameDiff),this._frameIndex+=this._frameSkip,this._frameIndex>=
this._frames.length&&(this.loop?(this._frameIndex%=this._frames.length,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.loopCount++,this._parent.events.onAnimationLoop.dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this)):this.complete()),this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(this._parent.setFrame(this.currentFrame),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=
!1),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame)),!0):!1},next:function(b){"undefined"==typeof b&&(b=1);b=this._frameIndex+b;b>=this._frames.length&&(this.loop?b%=this._frames.length:b=this._frames.length-1);b!==this._frameIndex&&(this._frameIndex=b,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(this._parent.setFrame(this.currentFrame),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1)),this.onUpdate&&
this.onUpdate.dispatch(this,this.currentFrame))},previous:function(b){"undefined"==typeof b&&(b=1);b=this._frameIndex-b;0>b&&(this.loop?b=this._frames.length+b:b++);b!==this._frameIndex&&(this._frameIndex=b,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(this._parent.setFrame(this.currentFrame),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1)),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))},updateFrameData:function(b){this.currentFrame=
(this._frameData=b)?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this.game.onPause.remove(this.onPause,this);this.game.onResume.remove(this.onResume,this);this.currentFrame=this._frameData=this._frames=this._parent=this.game=null;this.isPlaying=!1;this.onStart.dispose();this.onLoop.dispose();this.onComplete.dispose();this.onUpdate&&this.onUpdate.dispose()},complete:function(){this.isPlaying=!1;this.isFinished=!0;this.paused=!1;this._parent.events.onAnimationComplete.dispatch(this._parent,
this);this.onComplete.dispatch(this._parent,this);this.killOnComplete&&this._parent.kill()}};c.Animation.prototype.constructor=c.Animation;Object.defineProperty(c.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(b){(this.isPaused=b)?this._pauseStartTime=this.game.time.now:this.isPlaying&&(this._timeNextFrame=this.game.time.now+this.delay)}});Object.defineProperty(c.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}});Object.defineProperty(c.Animation.prototype,
"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(b){this.currentFrame=this._frameData.getFrame(this._frames[b]);null!==this.currentFrame&&(this._frameIndex=b,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}});Object.defineProperty(c.Animation.prototype,"speed",{get:function(){return Math.round(1E3/this.delay)},set:function(b){1<=b&&(this.delay=1E3/b)}});Object.defineProperty(c.Animation.prototype,
"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(b){b&&null===this.onUpdate?this.onUpdate=new c.Signal:b||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}});c.Animation.generateFrameNames=function(b,d,e,g,h){"undefined"==typeof g&&(g="");var f=[],k="";if(e>d)for(;e>=d;d++)k="number"==typeof h?c.Utils.pad(d.toString(),h,"0",1):d.toString(),k=b+k+g,f.push(k);else for(;d>=e;d--)k="number"==typeof h?c.Utils.pad(d.toString(),h,"0",1):d.toString(),k=b+k+g,f.push(k);
return f};c.Frame=function(b,d,e,g,h,f,k){this.index=b;this.x=d;this.y=e;this.width=g;this.height=h;this.name=f;this.uuid=k;this.centerX=Math.floor(g/2);this.centerY=Math.floor(h/2);this.distance=c.Math.distance(0,0,g,h);this.rotated=!1;this.rotationDirection="cw";this.trimmed=!1;this.sourceSizeW=g;this.sourceSizeH=h;this.spriteSourceSizeH=this.spriteSourceSizeW=this.spriteSourceSizeY=this.spriteSourceSizeX=0;this.right=this.x+this.width;this.bottom=this.y+this.height};c.Frame.prototype={setTrim:function(b,
c,e,g,h,f,k){(this.trimmed=b)&&(this.sourceSizeW=c,this.sourceSizeH=e,this.centerX=Math.floor(c/2),this.centerY=Math.floor(e/2),this.spriteSourceSizeX=g,this.spriteSourceSizeY=h,this.spriteSourceSizeW=f,this.spriteSourceSizeH=k)},clone:function(){var b=new c.Frame(this.index,this.x,this.y,this.width,this.height,this.name,this.uuid),d;for(d in this)this.hasOwnProperty(d)&&(b[d]=this[d]);return b},getRect:function(b){return"undefined"==typeof b?b=new c.Rectangle(this.x,this.y,this.width,this.height):
b.setTo(this.x,this.y,this.width,this.height),b}};c.Frame.prototype.constructor=c.Frame;c.FrameData=function(){this._frames=[];this._frameNames=[]};c.FrameData.prototype={addFrame:function(b){return b.index=this._frames.length,this._frames.push(b),""!==b.name&&(this._frameNames[b.name]=b.index),b},getFrame:function(b){return b>this._frames.length&&(b=0),this._frames[b]},getFrameByName:function(b){return"number"==typeof this._frameNames[b]?this._frames[this._frameNames[b]]:null},checkFrameName:function(b){return null==
this._frameNames[b]?!1:!0},clone:function(){for(var b=new c.FrameData,d=0;d<this._frames.length;d++)b._frames.push(this._frames[d].clone());for(d=0;d<this._frameNames.length;d++)b._frameNames.push(this._frameNames[d]);return b},getFrameRange:function(b,c,e){for("undefined"==typeof e&&(e=[]);c>=b;b++)e.push(this._frames[b]);return e},getFrames:function(b,c,e){if("undefined"==typeof c&&(c=!0),"undefined"==typeof e&&(e=[]),"undefined"==typeof b||0===b.length)for(var g=0;g<this._frames.length;g++)e.push(this._frames[g]);
else for(var g=0,h=b.length;h>g;g++)e.push(c?this.getFrame(b[g]):this.getFrameByName(b[g]));return e},getFrameIndexes:function(b,c,e){if("undefined"==typeof c&&(c=!0),"undefined"==typeof e&&(e=[]),"undefined"==typeof b||0===b.length)for(var g=0,h=this._frames.length;h>g;g++)e.push(this._frames[g].index);else for(g=0,h=b.length;h>g;g++)c?e.push(b[g]):this.getFrameByName(b[g])&&e.push(this.getFrameByName(b[g]).index);return e}};c.FrameData.prototype.constructor=c.FrameData;Object.defineProperty(c.FrameData.prototype,
"total",{get:function(){return this._frames.length}});c.AnimationParser={spriteSheet:function(b,d,e,g,h,f,k){var m=b.cache.getImage(d);if(null==m)return null;var n=m.width,p=m.height;0>=e&&(e=Math.floor(-n/Math.min(-1,e)));0>=g&&(g=Math.floor(-p/Math.min(-1,g)));m=Math.floor((n-f)/(e+k))*Math.floor((p-f)/(g+k));if(-1!==h&&(m=h),0===n||0===p||e>n||g>p||0===m)return console.warn("Phaser.AnimationParser.spriteSheet: '"+d+"'s width/height zero or width/height < given frameWidth/frameHeight"),null;h=new c.FrameData;
for(var q=p=f,r=0;m>r;r++){var t=b.rnd.uuid();h.addFrame(new c.Frame(r,p,q,e,g,"",t));PIXI.TextureCache[t]=new PIXI.Texture(PIXI.BaseTextureCache[d],{x:p,y:q,width:e,height:g});p+=e+k;p+e>n&&(p=f,q+=g+k)}return h},JSONData:function(b,d,e){if(!d.frames)return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"),void console.log(d);for(var g=new c.FrameData,h=d.frames,f=0;f<h.length;f++){var k=b.rnd.uuid();d=g.addFrame(new c.Frame(f,h[f].frame.x,
h[f].frame.y,h[f].frame.w,h[f].frame.h,h[f].filename,k));PIXI.TextureCache[k]=new PIXI.Texture(PIXI.BaseTextureCache[e],{x:h[f].frame.x,y:h[f].frame.y,width:h[f].frame.w,height:h[f].frame.h});h[f].trimmed&&d.setTrim(h[f].trimmed,h[f].sourceSize.w,h[f].sourceSize.h,h[f].spriteSourceSize.x,h[f].spriteSourceSize.y,h[f].spriteSourceSize.w,h[f].spriteSourceSize.h)}return g},JSONDataHash:function(b,d,e){if(!d.frames)return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"),
void console.log(d);var g=new c.FrameData,h=d.frames,f=0,k;for(k in h){var m=b.rnd.uuid();d=g.addFrame(new c.Frame(f,h[k].frame.x,h[k].frame.y,h[k].frame.w,h[k].frame.h,k,m));PIXI.TextureCache[m]=new PIXI.Texture(PIXI.BaseTextureCache[e],{x:h[k].frame.x,y:h[k].frame.y,width:h[k].frame.w,height:h[k].frame.h});h[k].trimmed&&d.setTrim(h[k].trimmed,h[k].sourceSize.w,h[k].sourceSize.h,h[k].spriteSourceSize.x,h[k].spriteSourceSize.y,h[k].spriteSourceSize.w,h[k].spriteSourceSize.h);f++}return g},XMLData:function(b,
d,e){if(!d.getElementsByTagName("TextureAtlas"))return void console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag");for(var g,h,f,k,m,n,p,q,r,t,w=new c.FrameData,v=d.getElementsByTagName("SubTexture"),u=0;u<v.length;u++)d=b.rnd.uuid(),h=v[u].attributes,g=h.name.value,f=parseInt(h.x.value,10),k=parseInt(h.y.value,10),m=parseInt(h.width.value,10),n=parseInt(h.height.value,10),q=p=null,h.frameX&&(p=Math.abs(parseInt(h.frameX.value,10)),q=Math.abs(parseInt(h.frameY.value,
10)),r=parseInt(h.frameWidth.value,10),t=parseInt(h.frameHeight.value,10)),g=w.addFrame(new c.Frame(u,f,k,m,n,g,d)),PIXI.TextureCache[d]=new PIXI.Texture(PIXI.BaseTextureCache[e],{x:f,y:k,width:m,height:n}),null===p&&null===q||g.setTrim(!0,m,n,p,q,r,t);return w}};c.Cache=function(b){this.game=b;this._canvases={};this._images={};this._textures={};this._sounds={};this._text={};this._json={};this._xml={};this._physics={};this._tilemaps={};this._binary={};this._bitmapDatas={};this._bitmapFont={};this._urlMap=
{};this._urlResolver=new Image;this._urlTemp=null;this.addDefaultImage();this.addMissingImage();this.onSoundUnlock=new c.Signal;this._cacheMap=[];this._cacheMap[c.Cache.CANVAS]=this._canvases;this._cacheMap[c.Cache.IMAGE]=this._images;this._cacheMap[c.Cache.TEXTURE]=this._textures;this._cacheMap[c.Cache.SOUND]=this._sounds;this._cacheMap[c.Cache.TEXT]=this._text;this._cacheMap[c.Cache.PHYSICS]=this._physics;this._cacheMap[c.Cache.TILEMAP]=this._tilemaps;this._cacheMap[c.Cache.BINARY]=this._binary;
this._cacheMap[c.Cache.BITMAPDATA]=this._bitmapDatas;this._cacheMap[c.Cache.BITMAPFONT]=this._bitmapFont;this._cacheMap[c.Cache.JSON]=this._json;this._cacheMap[c.Cache.XML]=this._xml};c.Cache.CANVAS=1;c.Cache.IMAGE=2;c.Cache.TEXTURE=3;c.Cache.SOUND=4;c.Cache.TEXT=5;c.Cache.PHYSICS=6;c.Cache.TILEMAP=7;c.Cache.BINARY=8;c.Cache.BITMAPDATA=9;c.Cache.BITMAPFONT=10;c.Cache.JSON=11;c.Cache.XML=12;c.Cache.prototype={addCanvas:function(b,c,e){this._canvases[b]={canvas:c,context:e}},addBinary:function(b,c){this._binary[b]=
c},addBitmapData:function(b,c,e){return c.key=b,this._bitmapDatas[b]={data:c,frameData:e},c},addRenderTexture:function(b,d){var e=new c.Frame(0,0,0,d.width,d.height,"","");this._textures[b]={texture:d,frame:e}},addSpriteSheet:function(b,d,e,g,h,f,k,m){this._images[b]={url:d,data:e,frameWidth:g,frameHeight:h,margin:k,spacing:m};PIXI.BaseTextureCache[b]=new PIXI.BaseTexture(e);PIXI.TextureCache[b]=new PIXI.Texture(PIXI.BaseTextureCache[b]);this._images[b].frameData=c.AnimationParser.spriteSheet(this.game,
b,g,h,f,k,m);this._urlMap[this._resolveUrl(d)]=this._images[b]},addTilemap:function(b,c,e,g){this._tilemaps[b]={url:c,data:e,format:g};this._urlMap[this._resolveUrl(c)]=this._tilemaps[b]},addTextureAtlas:function(b,d,e,g,h){this._images[b]={url:d,data:e};PIXI.BaseTextureCache[b]=new PIXI.BaseTexture(e);PIXI.TextureCache[b]=new PIXI.Texture(PIXI.BaseTextureCache[b]);h==c.Loader.TEXTURE_ATLAS_JSON_ARRAY?this._images[b].frameData=c.AnimationParser.JSONData(this.game,g,b):h==c.Loader.TEXTURE_ATLAS_JSON_HASH?
this._images[b].frameData=c.AnimationParser.JSONDataHash(this.game,g,b):h==c.Loader.TEXTURE_ATLAS_XML_STARLING&&(this._images[b].frameData=c.AnimationParser.XMLData(this.game,g,b));this._urlMap[this._resolveUrl(d)]=this._images[b]},addBitmapFont:function(b,d,e,g,h,f){this._images[b]={url:d,data:e};PIXI.BaseTextureCache[b]=new PIXI.BaseTexture(e);PIXI.TextureCache[b]=new PIXI.Texture(PIXI.BaseTextureCache[b]);c.LoaderParser.bitmapFont(this.game,g,b,h,f);this._bitmapFont[b]=PIXI.BitmapText.fonts[b];
this._urlMap[this._resolveUrl(d)]=this._bitmapFont[b]},addPhysicsData:function(b,c,e,g){this._physics[b]={url:c,data:e,format:g};this._urlMap[this._resolveUrl(c)]=this._physics[b]},addDefaultImage:function(){var b=new Image;b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";this._images.__default={url:null,data:b};this._images.__default.frame=new c.Frame(0,0,0,32,32,"","");this._images.__default.frameData=
new c.FrameData;this._images.__default.frameData.addFrame(new c.Frame(0,0,0,32,32,null,this.game.rnd.uuid()));PIXI.BaseTextureCache.__default=new PIXI.BaseTexture(b);PIXI.TextureCache.__default=new PIXI.Texture(PIXI.BaseTextureCache.__default)},addMissingImage:function(){var b=new Image;b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";
this._images.__missing={url:null,data:b};this._images.__missing.frame=new c.Frame(0,0,0,32,32,"","");this._images.__missing.frameData=new c.FrameData;this._images.__missing.frameData.addFrame(new c.Frame(0,0,0,32,32,null,this.game.rnd.uuid()));PIXI.BaseTextureCache.__missing=new PIXI.BaseTexture(b);PIXI.TextureCache.__missing=new PIXI.Texture(PIXI.BaseTextureCache.__missing)},addText:function(b,c,e){this._text[b]={url:c,data:e};this._urlMap[this._resolveUrl(c)]=this._text[b]},addJSON:function(b,c,
e){this._json[b]={url:c,data:e};this._urlMap[this._resolveUrl(c)]=this._json[b]},addXML:function(b,c,e){this._xml[b]={url:c,data:e}},addImage:function(b,d,e){this._images[b]={url:d,data:e};this._images[b].frame=new c.Frame(0,0,0,e.width,e.height,b,this.game.rnd.uuid());this._images[b].frameData=new c.FrameData;this._images[b].frameData.addFrame(new c.Frame(0,0,0,e.width,e.height,d,this.game.rnd.uuid()));PIXI.BaseTextureCache[b]=new PIXI.BaseTexture(e);PIXI.TextureCache[b]=new PIXI.Texture(PIXI.BaseTextureCache[b]);
this._urlMap[this._resolveUrl(d)]=this._images[b]},addSound:function(b,c,e,g,h){h=h||!1;var f=!1;h&&(f=!0);this._sounds[b]={url:c,data:e,isDecoding:!1,decoded:f,webAudio:g||!0,audioTag:h,locked:this.game.sound.touchLocked};this._urlMap[this._resolveUrl(c)]=this._sounds[b]},reloadSound:function(b){var c=this;this._sounds[b]&&(this._sounds[b].data.src=this._sounds[b].url,this._sounds[b].data.addEventListener("canplaythrough",function(){return c.reloadSoundComplete(b)},!1),this._sounds[b].data.load())},
reloadSoundComplete:function(b){this._sounds[b]&&(this._sounds[b].locked=!1,this.onSoundUnlock.dispatch(b))},updateSound:function(b,c,e){this._sounds[b]&&(this._sounds[b][c]=e)},decodedSound:function(b,c){this._sounds[b].data=c;this._sounds[b].decoded=!0;this._sounds[b].isDecoding=!1},getCanvas:function(b){return this._canvases[b]?this._canvases[b].canvas:void console.warn('Phaser.Cache.getCanvas: Invalid key: "'+b+'"')},getBitmapData:function(b){return this._bitmapDatas[b]?this._bitmapDatas[b].data:
void console.warn('Phaser.Cache.getBitmapData: Invalid key: "'+b+'"')},getBitmapFont:function(b){return this._bitmapFont[b]?this._bitmapFont[b]:void console.warn('Phaser.Cache.getBitmapFont: Invalid key: "'+b+'"')},getPhysicsData:function(b,c,e){if("undefined"==typeof c||null===c){if(this._physics[b])return this._physics[b].data;console.warn('Phaser.Cache.getPhysicsData: Invalid key: "'+b+'"')}else if(this._physics[b]&&this._physics[b].data[c]){c=this._physics[b].data[c];if(!c||!e)return c;for(var g in c)if(g=
c[g],g.fixtureKey===e)return g;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+e+" in "+b+'"')}else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+b+" / "+c+'"');return null},checkKey:function(b,c){return this._cacheMap[b][c]?!0:!1},checkCanvasKey:function(b){return this.checkKey(c.Cache.CANVAS,b)},checkImageKey:function(b){return this.checkKey(c.Cache.IMAGE,b)},checkTextureKey:function(b){return this.checkKey(c.Cache.TEXTURE,b)},checkSoundKey:function(b){return this.checkKey(c.Cache.SOUND,
b)},checkTextKey:function(b){return this.checkKey(c.Cache.TEXT,b)},checkPhysicsKey:function(b){return this.checkKey(c.Cache.PHYSICS,b)},checkTilemapKey:function(b){return this.checkKey(c.Cache.TILEMAP,b)},checkBinaryKey:function(b){return this.checkKey(c.Cache.BINARY,b)},checkBitmapDataKey:function(b){return this.checkKey(c.Cache.BITMAPDATA,b)},checkBitmapFontKey:function(b){return this.checkKey(c.Cache.BITMAPFONT,b)},checkJSONKey:function(b){return this.checkKey(c.Cache.JSON,b)},checkXMLKey:function(b){return this.checkKey(c.Cache.XML,
b)},checkUrl:function(b){return this._urlMap[this._resolveUrl(b)]?!0:!1},getImage:function(b){return this._images[b]?this._images[b].data:(console.warn('Phaser.Cache.getImage: Invalid key: "'+b+'"'),null)},getTilemapData:function(b){return this._tilemaps[b]?this._tilemaps[b]:void console.warn('Phaser.Cache.getTilemapData: Invalid key: "'+b+'"')},getFrameData:function(b,d){return"undefined"==typeof d&&(d=c.Cache.IMAGE),this._cacheMap[d][b]?this._cacheMap[d][b].frameData:null},updateFrameData:function(b,
c){this._images[b]&&(this._images[b].frameData=c)},getFrameByIndex:function(b,c){return this._images[b]?this._images[b].frameData.getFrame(c):null},getFrameByName:function(b,c){return this._images[b]?this._images[b].frameData.getFrameByName(c):null},getFrame:function(b){return this._images[b]?this._images[b].frame:null},getTextureFrame:function(b){return this._textures[b]?this._textures[b].frame:null},getTexture:function(b){return this._textures[b]?this._textures[b]:void console.warn('Phaser.Cache.getTexture: Invalid key: "'+
b+'"')},getSound:function(b){return this._sounds[b]?this._sounds[b]:void console.warn('Phaser.Cache.getSound: Invalid key: "'+b+'"')},getSoundData:function(b){return this._sounds[b]?this._sounds[b].data:void console.warn('Phaser.Cache.getSoundData: Invalid key: "'+b+'"')},isSoundDecoded:function(b){return this._sounds[b]?this._sounds[b].decoded:void 0},isSoundReady:function(b){return this._sounds[b]&&this._sounds[b].decoded&&!1===this.game.sound.touchLocked},getFrameCount:function(b){return this._images[b]?
this._images[b].frameData.total:0},getText:function(b){return this._text[b]?this._text[b].data:void console.warn('Phaser.Cache.getText: Invalid key: "'+b+'"')},getJSON:function(b){return this._json[b]?this._json[b].data:void console.warn('Phaser.Cache.getJSON: Invalid key: "'+b+'"')},getXML:function(b){return this._xml[b]?this._xml[b].data:void console.warn('Phaser.Cache.getXML: Invalid key: "'+b+'"')},getBinary:function(b){return this._binary[b]?this._binary[b]:void console.warn('Phaser.Cache.getBinary: Invalid key: "'+
b+'"')},getUrl:function(b){return this._urlMap[this._resolveUrl(b)]?this._urlMap[this._resolveUrl(b)]:void console.warn('Phaser.Cache.getUrl: Invalid url: "'+b+'"')},getKeys:function(b){var d=null;switch(b){case c.Cache.CANVAS:d=this._canvases;break;case c.Cache.IMAGE:d=this._images;break;case c.Cache.TEXTURE:d=this._textures;break;case c.Cache.SOUND:d=this._sounds;break;case c.Cache.TEXT:d=this._text;break;case c.Cache.PHYSICS:d=this._physics;break;case c.Cache.TILEMAP:d=this._tilemaps;break;case c.Cache.BINARY:d=
this._binary;break;case c.Cache.BITMAPDATA:d=this._bitmapDatas;break;case c.Cache.BITMAPFONT:d=this._bitmapFont;break;case c.Cache.JSON:d=this._json;break;case c.Cache.XML:d=this._xml}if(d){b=[];for(var e in d)"__default"!==e&&"__missing"!==e&&b.push(e);return b}},removeCanvas:function(b){delete this._canvases[b]},removeImage:function(b,c){"undefined"==typeof c&&(c=!0);delete this._images[b];c&&PIXI.BaseTextureCache[b].destroy()},removeSound:function(b){delete this._sounds[b]},removeText:function(b){delete this._text[b]},
removeJSON:function(b){delete this._json[b]},removeXML:function(b){delete this._xml[b]},removePhysics:function(b){delete this._physics[b]},removeTilemap:function(b){delete this._tilemaps[b]},removeBinary:function(b){delete this._binary[b]},removeBitmapData:function(b){delete this._bitmapDatas[b]},removeBitmapFont:function(b){delete this._bitmapFont[b]},_resolveUrl:function(b){return this._urlResolver.src=this.game.load.baseURL+b,this._urlTemp=this._urlResolver.src,this._urlResolver.src="",this._urlTemp},
destroy:function(){for(var b in this._canvases)delete this._canvases[b];for(b in this._images)"__default"!==b&&"__missing"!==b&&delete this._images[b];for(b in this._sounds)delete this._sounds[b];for(b in this._text)delete this._text[b];for(b in this._json)delete this._json[b];for(b in this._xml)delete this._xml[b];for(b in this._textures)delete this._textures[b];for(b in this._physics)delete this._physics[b];for(b in this._tilemaps)delete this._tilemaps[b];for(b in this._binary)delete this._binary[b];
for(b in this._bitmapDatas)delete this._bitmapDatas[b];for(b in this._bitmapFont)delete this._bitmapFont[b];this._urlTemp=this._urlResolver=this._urlMap=null}};c.Cache.prototype.constructor=c.Cache;c.Loader=function(b){this.game=b;this.hasLoaded=this.isLoading=!1;this.progressFloat=this.progress=0;this.preloadSprite=null;this.crossOrigin=!1;this.baseURL="";this.onLoadStart=new c.Signal;this.onFileStart=new c.Signal;this.onFileComplete=new c.Signal;this.onFileError=new c.Signal;this.onLoadComplete=
new c.Signal;this.onPackComplete=new c.Signal;this.useXDomainRequest=9===this.game.device.ieVersion;this._packList=[];this._packIndex=0;this._fileList=[];this._progressChunk=this._fileIndex=0;this._xhr=new XMLHttpRequest;this._ajax=null};c.Loader.TEXTURE_ATLAS_JSON_ARRAY=0;c.Loader.TEXTURE_ATLAS_JSON_HASH=1;c.Loader.TEXTURE_ATLAS_XML_STARLING=2;c.Loader.PHYSICS_LIME_CORONA_JSON=3;c.Loader.PHYSICS_PHASER_JSON=4;c.Loader.prototype={setPreloadSprite:function(b,d){d=d||0;this.preloadSprite={sprite:b,
direction:d,width:b.width,height:b.height,rect:null};this.preloadSprite.rect=0===d?new c.Rectangle(0,0,1,b.height):new c.Rectangle(0,0,b.width,1);b.crop(this.preloadSprite.rect);b.visible=!0},checkKeyExists:function(b,c){if(0<this._fileList.length)for(var e=0;e<this._fileList.length;e++)if(this._fileList[e].type===b&&this._fileList[e].key===c)return!0;return!1},getAssetIndex:function(b,c){if(0<this._fileList.length)for(var e=0;e<this._fileList.length;e++)if(this._fileList[e].type===b&&this._fileList[e].key===
c)return e;return-1},getAsset:function(b,c){if(0<this._fileList.length)for(var e=0;e<this._fileList.length;e++)if(this._fileList[e].type===b&&this._fileList[e].key===c)return{index:e,file:this._fileList[e]};return!1},reset:function(){this.preloadSprite=null;this.isLoading=!1;this._packIndex=this._packList.length=0;this._fileIndex=this._fileList.length=0},addToFileList:function(b,c,e,g){e={type:b,key:c,url:e,data:null,error:!1,loaded:!1};if("undefined"!=typeof g)for(var h in g)e[h]=g[h];!1===this.checkKeyExists(b,
c)&&this._fileList.push(e)},replaceInFileList:function(b,c,e,g){e={type:b,key:c,url:e,data:null,error:!1,loaded:!1};if("undefined"!=typeof g)for(var h in g)e[h]=g[h];b=this.getAssetIndex(b,c);-1===b?this._fileList.push(e):this._fileList[b]=e},pack:function(b,c,e,g){return"undefined"==typeof c&&(c=null),"undefined"==typeof e&&(e=null),"undefined"==typeof g&&(g=this),null===c&&null===e?(console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."),this):(e&&"string"==typeof e&&(e=
JSON.parse(e)),this._packList.push({key:b,url:c,data:e,loaded:!1,error:!1,callbackContext:g}),this)},image:function(b,c,e){return"undefined"==typeof e&&(e=!1),e?this.replaceInFileList("image",b,c):this.addToFileList("image",b,c),this},text:function(b,c,e){return"undefined"==typeof e&&(e=!1),e?this.replaceInFileList("text",b,c):this.addToFileList("text",b,c),this},json:function(b,c,e){return"undefined"==typeof e&&(e=!1),e?this.replaceInFileList("json",b,c):this.addToFileList("json",b,c),this},xml:function(b,
c,e){return"undefined"==typeof e&&(e=!1),e?this.replaceInFileList("xml",b,c):this.addToFileList("xml",b,c),this},script:function(b,c,e,g){return"undefined"==typeof e&&(e=!1),!1!==e&&"undefined"==typeof g&&(g=e),this.addToFileList("script",b,c,{callback:e,callbackContext:g}),this},binary:function(b,c,e,g){return"undefined"==typeof e&&(e=!1),!1!==e&&"undefined"==typeof g&&(g=e),this.addToFileList("binary",b,c,{callback:e,callbackContext:g}),this},spritesheet:function(b,c,e,g,h,f,k){return"undefined"==
typeof h&&(h=-1),"undefined"==typeof f&&(f=0),"undefined"==typeof k&&(k=0),this.addToFileList("spritesheet",b,c,{frameWidth:e,frameHeight:g,frameMax:h,margin:f,spacing:k}),this},audio:function(b,c,e){return"undefined"==typeof e&&(e=!0),this.addToFileList("audio",b,c,{buffer:null,autoDecode:e}),this},audiosprite:function(b,c,e){return this.audio(b,c),this.json(b+"-audioatlas",e),this},tilemap:function(b,d,e,g){if("undefined"==typeof d&&(d=null),"undefined"==typeof e&&(e=null),"undefined"==typeof g&&
(g=c.Tilemap.CSV),null==d&&null==e)return console.warn("Phaser.Loader.tilemap - Both url and data are null. One must be set."),this;if(e){switch(g){case c.Tilemap.TILED_JSON:"string"==typeof e&&(e=JSON.parse(e))}this.game.cache.addTilemap(b,null,e,g)}else this.addToFileList("tilemap",b,d,{format:g});return this},physics:function(b,d,e,g){return"undefined"==typeof d&&(d=null),"undefined"==typeof e&&(e=null),"undefined"==typeof g&&(g=c.Physics.LIME_CORONA_JSON),null==d&&null==e?(console.warn("Phaser.Loader.physics - Both url and data are null. One must be set."),
this):(e?("string"==typeof e&&(e=JSON.parse(e)),this.game.cache.addPhysicsData(b,null,e,g)):this.addToFileList("physics",b,d,{format:g}),this)},bitmapFont:function(b,c,e,g,h,f){if("undefined"==typeof e&&(e=null),"undefined"==typeof g&&(g=null),"undefined"==typeof h&&(h=0),"undefined"==typeof f&&(f=0),e)this.addToFileList("bitmapfont",b,c,{xmlURL:e,xSpacing:h,ySpacing:f});else if("string"==typeof g){var k;try{window.DOMParser?k=(new DOMParser).parseFromString(g,"text/xml"):(k=new ActiveXObject("Microsoft.XMLDOM"),
k.async="false",k.loadXML(g))}catch(m){k=void 0}if(!k||!k.documentElement||k.getElementsByTagName("parsererror").length)throw Error("Phaser.Loader. Invalid Bitmap Font XML given");this.addToFileList("bitmapfont",b,c,{xmlURL:null,xmlData:k,xSpacing:h,ySpacing:f})}return this},atlasJSONArray:function(b,d,e,g){return this.atlas(b,d,e,g,c.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(b,d,e,g){return this.atlas(b,d,e,g,c.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(b,d,e,g){return this.atlas(b,
d,e,g,c.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(b,d,e,g,h){if("undefined"==typeof e&&(e=null),"undefined"==typeof g&&(g=null),"undefined"==typeof h&&(h=c.Loader.TEXTURE_ATLAS_JSON_ARRAY),e)this.addToFileList("textureatlas",b,d,{atlasURL:e,format:h});else{switch(h){case c.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof g&&(g=JSON.parse(g));break;case c.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof g){var f;try{window.DOMParser?f=(new DOMParser).parseFromString(g,"text/xml"):(f=
new ActiveXObject("Microsoft.XMLDOM"),f.async="false",f.loadXML(g))}catch(k){f=void 0}if(!f||!f.documentElement||f.getElementsByTagName("parsererror").length)throw Error("Phaser.Loader. Invalid Texture Atlas XML given");g=f}}this.addToFileList("textureatlas",b,d,{atlasURL:null,atlasData:g,format:h})}return this},removeFile:function(b,c){var e=this.getAsset(b,c);!1!==e&&this._fileList.splice(e.index,1)},removeAll:function(){this._fileList.length=0},start:function(){this.isLoading||(0<this._packList.length?
(this._packIndex=0,this.loadPack()):this.beginLoad())},beginLoad:function(){this.progressFloat=this.progress=0;this.hasLoaded=!1;this.isLoading=!0;this.onLoadStart.dispatch(this._fileList.length);0<this._fileList.length?(this._fileIndex=0,this._progressChunk=100/this._fileList.length,this.loadFile()):(this.progress=100,this.progressFloat=100,this.hasLoaded=!0,this.isLoading=!1,this.onLoadComplete.dispatch())},loadPack:function(){if(!this._packList[this._packIndex])return void console.warn("Phaser.Loader loadPackList invalid index "+
this._packIndex);var b=this._packList[this._packIndex];null!==b.data?this.packLoadComplete(this._packIndex,!1):this.xhrLoad(this._packIndex,this.baseURL+b.url,"text","packLoadComplete","packLoadError")},packLoadComplete:function(b,d){if("undefined"==typeof d&&(d=!0),!this._packList[b])return void console.warn("Phaser.Loader packLoadComplete invalid index "+b);var e=this._packList[b],g=(e.loaded=!0,d)?JSON.parse(this._xhr.responseText):this._packList[b].data;if(g[e.key])for(var h,f=0;f<g[e.key].length;f++)switch(h=
g[e.key][f],h.type){case "image":this.image(h.key,h.url,h.overwrite);break;case "text":this.text(h.key,h.url,h.overwrite);break;case "json":this.json(h.key,h.url,h.overwrite);break;case "xml":this.xml(h.key,h.url,h.overwrite);break;case "script":this.script(h.key,h.url,h.callback,e.callbackContext);break;case "binary":this.binary(h.key,h.url,h.callback,e.callbackContext);break;case "spritesheet":this.spritesheet(h.key,h.url,h.frameWidth,h.frameHeight,h.frameMax,h.margin,h.spacing);break;case "audio":this.audio(h.key,
h.urls,h.autoDecode);break;case "tilemap":this.tilemap(h.key,h.url,h.data,c.Tilemap[h.format]);break;case "physics":this.physics(h.key,h.url,h.data,c.Loader[h.format]);break;case "bitmapFont":this.bitmapFont(h.key,h.textureURL,h.xmlURL,h.xmlData,h.xSpacing,h.ySpacing);break;case "atlasJSONArray":this.atlasJSONArray(h.key,h.textureURL,h.atlasURL,h.atlasData);break;case "atlasJSONHash":this.atlasJSONHash(h.key,h.textureURL,h.atlasURL,h.atlasData);break;case "atlasXML":this.atlasXML(h.key,h.textureURL,
h.atlasURL,h.atlasData);break;case "atlas":this.atlas(h.key,h.textureURL,h.atlasURL,h.atlasData,c.Loader[h.format])}this.nextPack(b,!0)},packError:function(b){this._packList[b].loaded=!0;this._packList[b].error=!0;this.onFileError.dispatch(this._packList[b].key,this._packList[b]);console.warn("Phaser.Loader error loading pack file: "+this._packList[b].key+" from URL "+this._packList[b].url);this.nextPack(b,!1)},nextPack:function(b,c){this.onPackComplete.dispatch(this._packList[b].key,c,this.totalLoadedPacks(),
this._packList.length);this._packIndex++;this._packIndex<this._packList.length?this.loadPack():this.beginLoad()},loadFile:function(){if(!this._fileList[this._fileIndex])return void console.warn("Phaser.Loader loadFile invalid index "+this._fileIndex);var b=this._fileList[this._fileIndex],d=this;switch(this.onFileStart.dispatch(this.progress,b.key,b.url),b.type){case "image":case "spritesheet":case "textureatlas":case "bitmapfont":b.data=new Image;b.data.name=b.key;b.data.onload=function(){return d.fileComplete(d._fileIndex)};
b.data.onerror=function(){return d.fileError(d._fileIndex)};this.crossOrigin&&(b.data.crossOrigin=this.crossOrigin);b.data.src=this.baseURL+b.url;break;case "audio":b.url=this.getAudioURL(b.url);null!==b.url?this.game.sound.usingWebAudio?this.xhrLoad(this._fileIndex,this.baseURL+b.url,"arraybuffer","fileComplete","fileError"):this.game.sound.usingAudioTag&&(this.game.sound.touchLocked?(b.data=new Audio,b.data.name=b.key,b.data.preload="auto",b.data.src=this.baseURL+b.url,this.fileComplete(this._fileIndex)):
(b.data=new Audio,b.data.name=b.key,b.data.onerror=function(){return d.fileError(d._fileIndex)},b.data.preload="auto",b.data.src=this.baseURL+b.url,b.data.addEventListener("canplaythrough",function(){c.GAMES[d.game.id].load.fileComplete(d._fileIndex)},!1),b.data.load())):this.fileError(this._fileIndex);break;case "json":this.useXDomainRequest&&window.XDomainRequest?(this._ajax=new window.XDomainRequest,this._ajax.timeout=3E3,this._ajax.onerror=function(){return d.dataLoadError(d._fileIndex)},this._ajax.ontimeout=
function(){return d.dataLoadError(d._fileIndex)},this._ajax.onprogress=function(){},this._ajax.onload=function(){return d.jsonLoadComplete(d._fileIndex)},this._ajax.open("GET",this.baseURL+b.url,!0),setTimeout(function(){this._ajax.send()},0)):this.xhrLoad(this._fileIndex,this.baseURL+b.url,"text","jsonLoadComplete","dataLoadError");break;case "xml":this.xhrLoad(this._fileIndex,this.baseURL+b.url,"text","xmlLoadComplete","dataLoadError");break;case "tilemap":if(b.format===c.Tilemap.TILED_JSON)this.xhrLoad(this._fileIndex,
this.baseURL+b.url,"text","jsonLoadComplete","dataLoadError");else{if(b.format!==c.Tilemap.CSV)throw Error("Phaser.Loader. Invalid Tilemap format: "+b.format);this.xhrLoad(this._fileIndex,this.baseURL+b.url,"text","csvLoadComplete","dataLoadError")}break;case "text":case "script":case "physics":this.xhrLoad(this._fileIndex,this.baseURL+b.url,"text","fileComplete","fileError");break;case "binary":this.xhrLoad(this._fileIndex,this.baseURL+b.url,"arraybuffer","fileComplete","fileError")}},xhrLoad:function(b,
c,e,g,h){this._xhr.open("GET",c,!0);this._xhr.responseType=e;var f=this;this._xhr.onload=function(){return f[g](b)};this._xhr.onerror=function(){return f[h](b)};this._xhr.send()},getAudioURL:function(b){var c;"string"==typeof b&&(b=[b]);for(var e=0;e<b.length;e++)if(c=b[e].toLowerCase(),c=c.substr((Math.max(0,c.lastIndexOf("."))||1/0)+1),0<=c.indexOf("?")&&(c=c.substr(0,c.indexOf("?"))),this.game.device.canPlayAudio(c))return b[e];return null},fileError:function(b){this._fileList[b].loaded=!0;this._fileList[b].error=
!0;this.onFileError.dispatch(this._fileList[b].key,this._fileList[b]);console.warn("Phaser.Loader error loading file: "+this._fileList[b].key+" from URL "+this._fileList[b].url);this.nextFile(b,!1)},fileComplete:function(b){if(!this._fileList[b])return void console.warn("Phaser.Loader fileComplete invalid index "+b);var d=this._fileList[b],e=d.loaded=!0;switch(d.type){case "image":this.game.cache.addImage(d.key,d.url,d.data);break;case "spritesheet":this.game.cache.addSpriteSheet(d.key,d.url,d.data,
d.frameWidth,d.frameHeight,d.frameMax,d.margin,d.spacing);break;case "textureatlas":if(null==d.atlasURL)this.game.cache.addTextureAtlas(d.key,d.url,d.data,d.atlasData,d.format);else if(e=!1,d.format==c.Loader.TEXTURE_ATLAS_JSON_ARRAY||d.format==c.Loader.TEXTURE_ATLAS_JSON_HASH)this.xhrLoad(this._fileIndex,this.baseURL+d.atlasURL,"text","jsonLoadComplete","dataLoadError");else{if(d.format!=c.Loader.TEXTURE_ATLAS_XML_STARLING)throw Error("Phaser.Loader. Invalid Texture Atlas format: "+d.format);this.xhrLoad(this._fileIndex,
this.baseURL+d.atlasURL,"text","xmlLoadComplete","dataLoadError")}break;case "bitmapfont":null==d.xmlURL?this.game.cache.addBitmapFont(d.key,d.url,d.data,d.xmlData,d.xSpacing,d.ySpacing):(e=!1,this.xhrLoad(this._fileIndex,this.baseURL+d.xmlURL,"text","xmlLoadComplete","dataLoadError"));break;case "audio":if(this.game.sound.usingWebAudio){if(d.data=this._xhr.response,this.game.cache.addSound(d.key,d.url,d.data,!0,!1),d.autoDecode){var g=this,h=d.key;this.game.cache.updateSound(h,"isDecoding",!0);this.game.sound.context.decodeAudioData(d.data,
function(b){b&&(g.game.cache.decodedSound(h,b),g.game.sound.onSoundDecode.dispatch(h,g.game.cache.getSound(h)))})}}else d.data.removeEventListener("canplaythrough",c.GAMES[this.game.id].load.fileComplete),this.game.cache.addSound(d.key,d.url,d.data,!1,!0);break;case "text":d.data=this._xhr.responseText;this.game.cache.addText(d.key,d.url,d.data);break;case "physics":var f=JSON.parse(this._xhr.responseText);this.game.cache.addPhysicsData(d.key,d.url,f,d.format);break;case "script":d.data=document.createElement("script");
d.data.language="javascript";d.data.type="text/javascript";d.data.defer=!1;d.data.text=this._xhr.responseText;document.head.appendChild(d.data);d.callback&&(d.data=d.callback.call(d.callbackContext,d.key,this._xhr.responseText));break;case "binary":d.data=d.callback?d.callback.call(d.callbackContext,d.key,this._xhr.response):this._xhr.response,this.game.cache.addBinary(d.key,d.data)}e&&this.nextFile(b,!0)},jsonLoadComplete:function(b){if(!this._fileList[b])return void console.warn("Phaser.Loader jsonLoadComplete invalid index "+
b);var c=this._fileList[b],e=this._ajax&&this._ajax.responseText?JSON.parse(this._ajax.responseText):JSON.parse(this._xhr.responseText);c.loaded=!0;"tilemap"===c.type?this.game.cache.addTilemap(c.key,c.url,e,c.format):"json"===c.type?this.game.cache.addJSON(c.key,c.url,e):this.game.cache.addTextureAtlas(c.key,c.url,c.data,e,c.format);this.nextFile(b,!0)},csvLoadComplete:function(b){if(!this._fileList[b])return void console.warn("Phaser.Loader csvLoadComplete invalid index "+b);var c=this._fileList[b],
e=this._xhr.responseText;c.loaded=!0;this.game.cache.addTilemap(c.key,c.url,e,c.format);this.nextFile(b,!0)},dataLoadError:function(b){var c=this._fileList[b];c.loaded=!0;c.error=!0;console.warn("Phaser.Loader dataLoadError: "+c.key);this.nextFile(b,!0)},xmlLoadComplete:function(b){""!==this._xhr.responseType&&"text"!==this._xhr.responseType&&(console.warn("Invalid XML Response Type",this._fileList[b]),console.warn(this._xhr));var c,e=this._xhr.responseText;try{window.DOMParser?c=(new DOMParser).parseFromString(e,
"text/xml"):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(e))}catch(g){c=void 0}if(!c||!c.documentElement||c.getElementsByTagName("parsererror").length)throw Error("Phaser.Loader. Invalid XML given");e=this._fileList[b];e.loaded=!0;"bitmapfont"===e.type?this.game.cache.addBitmapFont(e.key,e.url,e.data,c,e.xSpacing,e.ySpacing):"textureatlas"===e.type?this.game.cache.addTextureAtlas(e.key,e.url,e.data,c,e.format):"xml"===e.type&&this.game.cache.addXML(e.key,e.url,c);this.nextFile(b,
!0)},nextFile:function(b,c){this.progressFloat+=this._progressChunk;this.progress=Math.round(this.progressFloat);100<this.progress&&(this.progress=100);null!==this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite.updateCrop());this.onFileComplete.dispatch(this.progress,this._fileList[b].key,c,this.totalLoadedFiles(),
this._fileList.length);0<this.totalQueuedFiles()?(this._fileIndex++,this.loadFile()):(this.hasLoaded=!0,this.isLoading=!1,this.removeAll(),this.onLoadComplete.dispatch())},totalLoadedFiles:function(){for(var b=0,c=0;c<this._fileList.length;c++)this._fileList[c].loaded&&b++;return b},totalQueuedFiles:function(){for(var b=0,c=0;c<this._fileList.length;c++)!1===this._fileList[c].loaded&&b++;return b},totalLoadedPacks:function(){for(var b=0,c=0;c<this._packList.length;c++)this._packList[c].loaded&&b++;
return b},totalQueuedPacks:function(){for(var b=0,c=0;c<this._packList.length;c++)!1===this._packList[c].loaded&&b++;return b}};c.Loader.prototype.constructor=c.Loader;c.LoaderParser={bitmapFont:function(b,c,e,g,h){b={};var f=c.getElementsByTagName("info")[0],k=c.getElementsByTagName("common")[0];b.font=f.getAttribute("face");b.size=parseInt(f.getAttribute("size"),10);b.lineHeight=parseInt(k.getAttribute("lineHeight"),10)+h;b.chars={};f=c.getElementsByTagName("char");for(h=0;h<f.length;h++){var k=
parseInt(f[h].getAttribute("id"),10),m=new PIXI.Rectangle(parseInt(f[h].getAttribute("x"),10),parseInt(f[h].getAttribute("y"),10),parseInt(f[h].getAttribute("width"),10),parseInt(f[h].getAttribute("height"),10));b.chars[k]={xOffset:parseInt(f[h].getAttribute("xoffset"),10),yOffset:parseInt(f[h].getAttribute("yoffset"),10),xAdvance:parseInt(f[h].getAttribute("xadvance"),10)+g,kerning:{},texture:PIXI.TextureCache[e]=new PIXI.Texture(PIXI.BaseTextureCache[e],m)}}c=c.getElementsByTagName("kerning");for(h=
0;h<c.length;h++)g=parseInt(c[h].getAttribute("first"),10),f=parseInt(c[h].getAttribute("second"),10),k=parseInt(c[h].getAttribute("amount"),10),b.chars[f].kerning[g]=k;PIXI.BitmapText.fonts[e]=b}};c.AudioSprite=function(b,c){this.game=b;this.key=c;this.config=this.game.cache.getJSON(c+"-audioatlas");this.autoplayKey=null;this.autoplay=!1;this.sounds={};for(var e in this.config.spritemap){var g=this.config.spritemap[e],h=this.game.add.sound(this.key);g.loop?h.addMarker(e,g.start,g.end-g.start,null,
!0):h.addMarker(e,g.start,g.end-g.start,null,!1);this.sounds[e]=h}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])};c.AudioSprite.prototype={play:function(b,c){return"undefined"==typeof c&&(c=1),this.sounds[b].play(b,null,c)},stop:function(b){if(b)this.sounds[b].stop();else for(var c in this.sounds)this.sounds[c].stop()},get:function(b){return this.sounds[b]}};c.AudioSprite.prototype.constructor=c.AudioSprite;c.Sound=
function(b,d,e,g,h){"undefined"==typeof e&&(e=1);"undefined"==typeof g&&(g=!1);"undefined"==typeof h&&(h=b.sound.connectToMaster);this.game=b;this.key=this.name=d;this.loop=g;this.volume=e;this.markers={};this.context=null;this.autoplay=!1;this.stopTime=this.position=this.durationMS=this.duration=this.currentTime=this.startTime=this.totalDuration=0;this.paused=!1;this.pausedTime=this.pausedPosition=0;this.isPlaying=!1;this.currentMarker="";this.allowMultiple=this.override=this.pendingPlayback=!1;
this.usingWebAudio=this.game.sound.usingWebAudio;this.usingAudioTag=this.game.sound.usingAudioTag;this.gainNode=this.masterGainNode=this.externalNode=null;this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,this.gainNode="undefined"==typeof this.context.createGain?this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=e*this.game.sound.volume,h&&this.gainNode.connect(this.masterGainNode)):this.game.cache.getSound(d)&&this.game.cache.isSoundReady(d)?
(this._sound=this.game.cache.getSoundData(d),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this);this.onDecoded=new c.Signal;this.onPlay=new c.Signal;this.onPause=new c.Signal;this.onResume=new c.Signal;this.onLoop=new c.Signal;this.onStop=new c.Signal;this.onMute=new c.Signal;this.onMarkerComplete=new c.Signal;this.onFadeComplete=new c.Signal;this._volume=e;this._buffer=null;this._muted=!1;this._tempLoop=
this._muteVolume=this._tempVolume=this._tempPosition=this._tempMarker=0;this._onDecodedEventDispatched=this._paused=!1};c.Sound.prototype={soundHasUnlocked:function(b){b===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(b,c,e,g,h){"undefined"==typeof g&&(g=1);"undefined"==typeof h&&(h=!1);this.markers[b]={name:b,start:c,stop:c+e,volume:g,duration:e,durationMS:1E3*e,loop:h}},removeMarker:function(b){delete this.markers[b]},
update:function(){this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0);this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop));this.isPlaying&&(this.currentTime=this.game.time.now-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),""===this.currentMarker?(this.currentTime=
0,this.startTime=this.game.time.now):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):this.stop():this.loop?(this.onLoop.dispatch(this),this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))},play:function(b,c,e,g,h){if("undefined"==typeof b&&(b=""),"undefined"==typeof h&&(h=!0),this.isPlaying&&!this.allowMultiple&&!h&&!this.override)return this;if(this.isPlaying&&!this.allowMultiple&&(this.override||h)&&(this.usingWebAudio?"undefined"==
typeof this._sound.stop?this._sound.noteOff(0):this._sound.stop(0):this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0)),this.currentMarker=b,""!==b){if(!this.markers[b])return console.warn("Phaser.Sound.play: audio marker "+b+" doesn't exist"),this;this.position=this.markers[b].start;this.volume=this.markers[b].volume;this.loop=this.markers[b].loop;this.duration=this.markers[b].duration;this.durationMS=this.markers[b].durationMS;"undefined"!=typeof e&&(this.volume=e);"undefined"!=
typeof g&&(this.loop=g);this._tempMarker=b;this._tempPosition=this.position;this._tempVolume=this.volume;this._tempLoop=this.loop}else c=c||0,"undefined"==typeof e&&(e=this._volume),"undefined"==typeof g&&(g=this.loop),this.position=c,this.volume=e,this.loop=g,this.durationMS=this.duration=0,this._tempMarker=b,this._tempPosition=c,this._tempVolume=e,this._tempLoop=g;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(null===this._buffer&&(this._buffer=this.game.cache.getSoundData(this.key)),
this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this._sound.connect(this.externalNode?this.externalNode:this.gainNode),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1E3*this.totalDuration),this.loop&&""===b&&(this._sound.loop=!0),"undefined"==typeof this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=
this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=
this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1E3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(b,c,e,g){"undefined"==typeof g&&(g=!1);this.play(b||"",c||0,e||1,g,!0)},pause:function(){this.isPlaying&&
this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.now,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var b=this.position+this.pausedPosition/1E3;this._sound=this.context.createBufferSource();this._sound.buffer=this._buffer;this._sound.connect(this.externalNode?this.externalNode:this.gainNode);this.loop&&(this._sound.loop=!0);"undefined"==typeof this._sound.start?this._sound.noteGrainOn(0,
b,this.duration):this._sound.start(0,b,this.duration)}else this._sound.play();this.isPlaying=!0;this.paused=!1;this.startTime+=this.game.time.now-this.pausedTime;this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio)if("undefined"==typeof this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(b){}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1;var c=this.currentMarker;""!==this.currentMarker&&
this.onMarkerComplete.dispatch(this.currentMarker,this);this.currentMarker="";this.paused||this.onStop.dispatch(this,c)},fadeIn:function(b,c){"undefined"==typeof c&&(c=!1);this.paused||(this.play("",0,0,c),this.fadeTo(b,1))},fadeOut:function(b){this.fadeTo(b,0)},fadeTo:function(b,d){if(this.isPlaying&&!this.paused&&d!==this.volume){if("undefined"==typeof b&&(b=1E3),"undefined"==typeof d)return void console.warn("Phaser.Sound.fadeTo: No Volume Specified.");this.game.add.tween(this).to({volume:d},b,
c.Easing.Linear.None,!0).onComplete.add(this.fadeComplete,this)}},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume);0===this.volume&&this.stop()},destroy:function(b){"undefined"==typeof b&&(b=!0);this.stop();b?this.game.sound.remove(this):(this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}};
c.Sound.prototype.constructor=c.Sound;Object.defineProperty(c.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}});Object.defineProperty(c.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}});Object.defineProperty(c.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(b){b?(this._muted=!0,this.usingWebAudio?(this._muteVolume=this.gainNode.gain.value,this.gainNode.gain.value=
0):this.usingAudioTag&&this._sound&&(this._muteVolume=this._sound.volume,this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume));this.onMute.dispatch(this)}});Object.defineProperty(c.Sound.prototype,"volume",{get:function(){return this._volume},set:function(b){this.usingWebAudio?(this._volume=b,this.gainNode.gain.value=b):this.usingAudioTag&&this._sound&&0<=b&&1>=b&&(this._volume=b,
this._sound.volume=b)}});c.SndG=function(b){this.game=b;this.onSoundDecode=new c.Signal;this._muted=this._codeMuted=!1;this._unlockSource=null;this._volume=1;this._sounds=[];this.context=null;this.usingWebAudio=!0;this.noAudio=this.usingAudioTag=!1;this.connectToMaster=!0;this.touchLocked=!1;this.channels=32};c.SndG.prototype={boot:function(){if(this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1),!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&
window.PhaserGlobal.fakeiOSTouchLock?(this.game.input.touch.callbackContext=this,this.game.input.touch.touchStartCallback=this.unlock,this.game.input.mouse.callbackContext=this,this.game.input.mouse.mouseDownCallback=this.unlock,this.touchLocked=!0):this.touchLocked=!1,window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio)return this.usingWebAudio=!1,void(this.noAudio=!0);if(!0===window.PhaserGlobal.disableWebAudio)return this.usingWebAudio=!1,this.usingAudioTag=!0,void(this.noAudio=!1)}if(window.AudioContext)try{this.context=
new window.AudioContext}catch(b){this.context=null,this.usingWebAudio=!1,this.noAudio=!0}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(c){this.context=null,this.usingWebAudio=!1,this.noAudio=!0}window.Audio&&null===this.context&&(this.usingWebAudio=!1,this.usingAudioTag=!0,this.noAudio=!1);null!==this.context&&(this.masterGain="undefined"==typeof this.context.createGain?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination))},
unlock:function(){if(!1!==this.touchLocked)if(!1===this.game.device.webAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableWebAudio)this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null,this.game.input.mouse.callbackContext=null,this.game.input.mouse.mouseDownCallback=null;else{var b=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource();this._unlockSource.buffer=b;this._unlockSource.connect(this.context.destination);
this._unlockSource.noteOn(0)}},stopAll:function(){for(var b=0;b<this._sounds.length;b++)this._sounds[b]&&this._sounds[b].stop()},pauseAll:function(){for(var b=0;b<this._sounds.length;b++)this._sounds[b]&&this._sounds[b].pause()},resumeAll:function(){for(var b=0;b<this._sounds.length;b++)this._sounds[b]&&this._sounds[b].resume()},decode:function(b,c){c=c||null;var e=this.game.cache.getSoundData(b);if(e&&!1===this.game.cache.isSoundDecoded(b)){this.game.cache.updateSound(b,"isDecoding",!0);var g=this;
this.context.decodeAudioData(e,function(e){g.game.cache.decodedSound(b,e);c&&g.onSoundDecode.dispatch(b,c)})}},update:function(){this.touchLocked&&this.game.device.webAudio&&null!==this._unlockSource&&(this._unlockSource.playbackState===this._unlockSource.PLAYING_STATE||this._unlockSource.playbackState===this._unlockSource.FINISHED_STATE)&&(this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null);for(var b=0;b<this._sounds.length;b++)this._sounds[b].update()},
add:function(b,d,e,g){"undefined"==typeof d&&(d=1);"undefined"==typeof e&&(e=!1);"undefined"==typeof g&&(g=this.connectToMaster);b=new c.Sound(this.game,b,d,e,g);return this._sounds.push(b),b},addSprite:function(b){return new c.AudioSprite(this.game,b)},remove:function(b){for(var c=this._sounds.length;c--;)if(this._sounds[c]===b)return this._sounds[c].destroy(!1),this._sounds.splice(c,1),!0;return!1},removeByKey:function(b){for(var c=this._sounds.length,e=0;c--;)this._sounds[c].key===b&&(this._sounds[c].destroy(!1),
this._sounds.splice(c,1),e++);return e},play:function(b,c,e){b=this.add(b,c,e);return b.play(),b},setMute:function(){if(!this._muted){this._muted=!0;this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var b=0;b<this._sounds.length;b++)this._sounds[b].usingAudioTag&&(this._sounds[b].mute=!0)}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1;this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var b=0;b<this._sounds.length;b++)this._sounds[b].usingAudioTag&&
(this._sounds[b].mute=!1)}},destroy:function(){this.stopAll();for(var b=0;b<this._sounds.length;b++)this._sounds[b]&&this._sounds[b].destroy();this._sounds=[];this.onSoundDecode.dispose()}};c.SndG.prototype.constructor=c.SndG;Object.defineProperty(c.SndG.prototype,"mute",{get:function(){return this._muted},set:function(b){b?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});Object.defineProperty(c.SndG.prototype,"volume",
{get:function(){return this.usingWebAudio?this.masterGain.gain.value:this._volume},set:function(b){if(this._volume=b,this.usingWebAudio)this.masterGain.gain.value=b;else for(var c=0;c<this._sounds.length;c++)this._sounds[c].usingAudioTag&&(this._sounds[c].volume*=b)}});c.Utils.Debug=function(b){this.game=b;this.context=this.canvas=this.bmd=this.sprite=null;this.font="14px Courier";this.columnWidth=100;this.lineHeight=16;this.renderShadow=!0;this.currentY=this.currentX=0;this.currentAlpha=1;this.dirty=
!1};c.Utils.Debug.prototype={boot:function(){this.game.renderType===c.CANVAS?this.context=this.game.context:(this.bmd=this.game.make.bitmapData(this.game.width,this.game.height),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.canvas=c.Canvas.create(this.game.width,this.game.height,"",!0),this.context=this.canvas.getContext("2d"))},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,
this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height);this.sprite&&this.bmd.clear()},start:function(b,c,e,g){"number"!=typeof b&&(b=0);"number"!=typeof c&&(c=0);e=e||"rgb(255,255,255)";"undefined"==typeof g&&(g=0);this.currentX=b;this.currentY=c;this.currentColor=e;this.currentAlpha=this.context.globalAlpha;this.columnWidth=g;this.dirty=!0;this.context.save();this.context.setTransform(1,0,0,1,0,0);this.context.strokeStyle=e;this.context.fillStyle=
e;this.context.font=this.font;this.context.globalAlpha=1},stop:function(){this.context.restore();this.context.globalAlpha=this.currentAlpha},line:function(){for(var b=this.currentX,c=0;c<arguments.length;c++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[c],b+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[c],b,this.currentY),b+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(b,c,e,g){this.start(c,
e,g);this.line("Sound: "+b.key+" Locked: "+b.game.sound.touchLocked);this.line("Is Ready?: "+this.game.cache.isSoundReady(b.key)+" Pending Playback: "+b.pendingPlayback);this.line("Decoded: "+b.isDecoded+" Decoding: "+b.isDecoding);this.line("Total Duration: "+b.totalDuration+" Playing: "+b.isPlaying);this.line("Time: "+b.currentTime);this.line("Volume: "+b.volume+" Muted: "+b.mute);this.line("WebAudio: "+b.usingWebAudio+" Audio: "+b.usingAudioTag);""!==b.currentMarker&&(this.line("Marker: "+b.currentMarker+
" Duration: "+b.duration+" (ms: "+b.durationMS+")"),this.line("Start: "+b.markers[b.currentMarker].start+" Stop: "+b.markers[b.currentMarker].stop),this.line("Position: "+b.position));this.stop()},cameraInfo:function(b,c,e,g){this.start(c,e,g);this.line("Camera ("+b.width+" x "+b.height+")");this.line("X: "+b.x+" Y: "+b.y);b.bounds&&this.line("Bounds x: "+b.bounds.x+" Y: "+b.bounds.y+" w: "+b.bounds.width+" h: "+b.bounds.height);this.line("View x: "+b.view.x+" Y: "+b.view.y+" w: "+b.view.width+" h: "+
b.view.height);this.stop()},timer:function(b,c,e,g){this.start(c,e,g);this.line("Timer (running: "+b.running+" expired: "+b.expired+")");this.line("Next Tick: "+b.next+" Duration: "+b.duration);this.line("Paused: "+b.paused+" Length: "+b.length);this.stop()},pointer:function(b,c,e,g,h){null==b||("undefined"==typeof c&&(c=!1),e=e||"rgba(0,255,0,0.5)",g=g||"rgba(255,0,0,0.5)",!0===c&&!0===b.isUp||(this.start(b.x,b.y-100,h),this.context.beginPath(),this.context.arc(b.x,b.y,b.circle.radius,0,2*Math.PI),
this.context.fillStyle=b.active?e:g,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(b.positionDown.x,b.positionDown.y),this.context.lineTo(b.position.x,b.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+b.id+" Active: "+b.active),this.line("World X: "+b.worldX+" World Y: "+b.worldY),this.line("Screen X: "+b.x+" Screen Y: "+b.y),this.line("Duration: "+b.duration+" ms"),this.line("is Down: "+b.isDown+" is Up: "+
b.isUp),this.stop()))},spriteInputInfo:function(b,c,e,g){this.start(c,e,g);this.line("Sprite Input: ("+b.width+" x "+b.height+")");this.line("x: "+b.input.pointerX().toFixed(1)+" y: "+b.input.pointerY().toFixed(1));this.line("over: "+b.input.pointerOver()+" duration: "+b.input.overDuration().toFixed(0));this.line("down: "+b.input.pointerDown()+" duration: "+b.input.downDuration().toFixed(0));this.line("just over: "+b.input.justOver()+" just out: "+b.input.justOut());this.stop()},key:function(b,c,
e,g){this.start(c,e,g,150);this.line("Key:",b.keyCode,"isDown:",b.isDown);this.line("justPressed:",b.justPressed(),"justReleased:",b.justReleased());this.line("Time Down:",b.timeDown.toFixed(0),"duration:",b.duration.toFixed(0));this.stop()},inputInfo:function(b,c,e){this.start(b,c,e);this.line("Input");this.line("X: "+this.game.input.x+" Y: "+this.game.input.y);this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY);this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+
" Scale Y: "+this.game.input.scale.x.toFixed(1));this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY);this.stop()},spriteBounds:function(b,c,e){b=b.getBounds();b.x+=this.game.camera.x;b.y+=this.game.camera.y;this.rectangle(b,c,e)},ropeSegments:function(b,c,e){b.segments.forEach(function(b){this.rectangle(b,c,e)},this)},spriteInfo:function(b,c,e,g){this.start(c,e,g);this.line("Sprite:  ("+b.width+" x "+b.height+") anchor: "+b.anchor.x+" x "+
b.anchor.y);this.line("x: "+b.x.toFixed(1)+" y: "+b.y.toFixed(1));this.line("angle: "+b.angle.toFixed(1)+" rotation: "+b.rotation.toFixed(1));this.line("visible: "+b.visible+" in camera: "+b.inCamera);this.stop()},spriteCoords:function(b,c,e,g){this.start(c,e,g,100);b.name&&this.line(b.name);this.line("x:",b.x.toFixed(2),"y:",b.y.toFixed(2));this.line("pos x:",b.position.x.toFixed(2),"pos y:",b.position.y.toFixed(2));this.line("world x:",b.world.x.toFixed(2),"world y:",b.world.y.toFixed(2));this.stop()},
lineInfo:function(b,c,e,g){this.start(c,e,g,80);this.line("start.x:",b.start.x.toFixed(2),"start.y:",b.start.y.toFixed(2));this.line("end.x:",b.end.x.toFixed(2),"end.y:",b.end.y.toFixed(2));this.line("length:",b.length.toFixed(2),"angle:",b.angle);this.stop()},pixel:function(b,c,e,g){g=g||2;this.start();this.context.fillStyle=e;this.context.fillRect(b,c,g,g);this.stop()},geom:function(b,d,e,g){"undefined"==typeof e&&(e=!0);"undefined"==typeof g&&(g=0);d=d||"rgba(0,255,0,0.4)";this.start();this.context.fillStyle=
d;this.context.strokeStyle=d;b instanceof c.Rectangle||1===g?e?this.context.fillRect(b.x-this.game.camera.x,b.y-this.game.camera.y,b.width,b.height):this.context.strokeRect(b.x-this.game.camera.x,b.y-this.game.camera.y,b.width,b.height):b instanceof c.Circle||2===g?(this.context.beginPath(),this.context.arc(b.x-this.game.camera.x,b.y-this.game.camera.y,b.radius,0,2*Math.PI,!1),this.context.closePath(),e?this.context.fill():this.context.stroke()):b instanceof c.Point||3===g?this.context.fillRect(b.x-
this.game.camera.x,b.y-this.game.camera.y,4,4):(b instanceof c.Line||4===g)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(b.start.x+.5-this.game.camera.x,b.start.y+.5-this.game.camera.y),this.context.lineTo(b.end.x+.5-this.game.camera.x,b.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke());this.stop()},rectangle:function(b,c,e){"undefined"==typeof e&&(e=!0);c=c||"rgba(0, 255, 0, 0.4)";this.start();e?(this.context.fillStyle=c,this.context.fillRect(b.x-
this.game.camera.x,b.y-this.game.camera.y,b.width,b.height)):(this.context.strokeStyle=c,this.context.strokeRect(b.x-this.game.camera.x,b.y-this.game.camera.y,b.width,b.height));this.stop()},text:function(b,c,e,g,h){g=g||"rgb(255,255,255)";h=h||"16px Courier";this.start();this.context.font=h;this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(b,c+1,e+1));this.context.fillStyle=g;this.context.fillText(b,c,e);this.stop()},quadTree:function(b,c){c=c||"rgba(255,0,0,0.3)";this.start();
var e=b.bounds;if(0===b.nodes.length)for(this.context.strokeStyle=c,this.context.strokeRect(e.x,e.y,e.width,e.height),this.text("size: "+b.objects.length,e.x+4,e.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)",e=0;e<b.objects.length;e++)this.context.strokeRect(b.objects[e].x,b.objects[e].y,b.objects[e].width,b.objects[e].height);else for(e=0;e<b.nodes.length;e++)this.quadTree(b.nodes[e]);this.stop()},body:function(b,d,e){b.body&&(this.start(),b.body.type===c.Physics.ARCADE?
c.Physics.Arcade.Body.render(this.context,b.body,d,e):b.body.type===c.Physics.NINJA?c.Physics.Ninja.Body.render(this.context,b.body,d,e):b.body.type===c.Physics.BOX2D&&c.Physics.Box2D.renderBody(this.context,b.body,d),this.stop())},bodyInfo:function(b,d,e,g){b.body&&(this.start(d,e,g,210),b.body.type===c.Physics.ARCADE?c.Physics.Arcade.Body.renderBodyInfo(this,b.body):b.body.type===c.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,b.body),this.stop())},box2dWorld:function(){this.start();
this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0);this.game.physics.box2d.renderDebugDraw(this.context);this.stop()},box2dBody:function(b,d){this.start();c.Physics.Box2D.renderBody(this.context,b,d);this.stop()}};c.Utils.Debug.prototype.constructor=c.Utils.Debug;c.Color={packPixel:function(b,d,e,g){return c.Device.LITTLE_ENDIAN?(g<<24|e<<16|d<<8|b)>>>0:(b<<24|d<<16|e<<8|g)>>>0},unpackPixel:function(b,d,e,g){return("undefined"==typeof d||null===d)&&(d=c.Color.createColor()),
("undefined"==typeof e||null===e)&&(e=!1),("undefined"==typeof g||null===g)&&(g=!1),c.Device.LITTLE_ENDIAN?(d.a=(4278190080&b)>>>24,d.b=(16711680&b)>>>16,d.g=(65280&b)>>>8,d.r=255&b):(d.r=(4278190080&b)>>>24,d.g=(16711680&b)>>>16,d.b=(65280&b)>>>8,d.a=255&b),d.color=b,d.rgba="rgba("+d.r+","+d.g+","+d.b+","+d.a/255+")",e&&c.Color.RGBtoHSL(d.r,d.g,d.b,d),g&&c.Color.RGBtoHSV(d.r,d.g,d.b,d),d},fromRGBA:function(b,d){return d||(d=c.Color.createColor()),d.r=(4278190080&b)>>>24,d.g=(16711680&b)>>>16,d.b=
(65280&b)>>>8,d.a=255&b,d.rgba="rgba("+d.r+","+d.g+","+d.b+","+d.a+")",d},toRGBA:function(b,c,e,g){return b<<24|c<<16|e<<8|g},RGBtoHSL:function(b,d,e,g){g||(g=c.Color.createColor(b,d,e,1));b/=255;d/=255;e/=255;var h=Math.min(b,d,e),f=Math.max(b,d,e);if(g.h=0,g.s=0,g.l=(f+h)/2,f!==h){var k=f-h;g.s=.5<g.l?k/(2-f-h):k/(f+h);f===b?g.h=(d-e)/k+(e>d?6:0):f===d?g.h=(e-b)/k+2:f===e&&(g.h=(b-d)/k+4);g.h/=6}return g},HSLtoRGB:function(b,d,e,g){if(g?(g.r=e,g.g=e,g.b=e):g=c.Color.createColor(e,e,e),0!==d)d=.5>
e?e*(1+d):e+d-e*d,e=2*e-d,g.r=c.Color.hueToColor(e,d,b+1/3),g.g=c.Color.hueToColor(e,d,b),g.b=c.Color.hueToColor(e,d,b-1/3);return g.r=Math.floor(255*g.r|0),g.g=Math.floor(255*g.g|0),g.b=Math.floor(255*g.b|0),c.Color.updateColor(g),g},RGBtoHSV:function(b,d,e,g){g||(g=c.Color.createColor(b,d,e,255));b/=255;d/=255;e/=255;var h=Math.min(b,d,e),f=Math.max(b,d,e),k=f-h;return g.h=0,g.s=0===f?0:k/f,g.v=f,f!==h&&(f===b?g.h=(d-e)/k+(e>d?6:0):f===d?g.h=(e-b)/k+2:f===e&&(g.h=(b-d)/k+4),g.h/=6),g},HSVtoRGB:function(b,
d,e,g){"undefined"==typeof g&&(g=c.Color.createColor(0,0,0,1,b,d,0,e));var h,f,k,m=Math.floor(6*b),n=6*b-m;b=e*(1-d);var p=e*(1-n*d);d=e*(1-(1-n)*d);switch(m%6){case 0:h=e;f=d;k=b;break;case 1:h=p;f=e;k=b;break;case 2:h=b;f=e;k=d;break;case 3:h=b;f=p;k=e;break;case 4:h=d;f=b;k=e;break;case 5:h=e,f=b,k=p}return g.r=Math.floor(255*h),g.g=Math.floor(255*f),g.b=Math.floor(255*k),c.Color.updateColor(g),g},hueToColor:function(b,c,e){return 0>e&&(e+=1),1<e&&--e,1/6>e?b+6*(c-b)*e:.5>e?c:2/3>e?b+(c-b)*(2/
3-e)*6:b},createColor:function(b,d,e,g,h,f,k,m){b={r:b||0,g:d||0,b:e||0,a:g||1,h:h||0,s:f||0,l:k||0,v:m||0,color:0,color32:0,rgba:""};return b.color=c.Color.getColor(b.r,b.g,b.b),b.color32=c.Color.getColor32(b.a,b.r,b.g,b.b),c.Color.updateColor(b)},updateColor:function(b){return b.rgba="rgba("+b.r.toString()+","+b.g.toString()+","+b.b.toString()+","+b.a.toString()+")",b},getColor32:function(b,c,e,g){return b<<24|c<<16|e<<8|g},getColor:function(b,c,e){return b<<16|c<<8|e},RGBtoString:function(b,d,
e,g,h){return"undefined"==typeof g&&(g=255),"undefined"==typeof h&&(h="#"),"#"===h?"#"+(16777216+(b<<16)+(d<<8)+e).toString(16).slice(1):"0x"+c.Color.componentToHex(g)+c.Color.componentToHex(b)+c.Color.componentToHex(d)+c.Color.componentToHex(e)},hexToRGB:function(b){return(b=c.Color.hexToColor(b))?c.Color.getColor32(b.a,b.r,b.g,b.b):void 0},hexToColor:function(b,d){b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(b,c,d,e){return c+c+d+d+e+e});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);
if(e){var g=parseInt(e[1],16),h=parseInt(e[2],16),e=parseInt(e[3],16);d?(d.r=g,d.g=h,d.b=e):d=c.Color.createColor(g,h,e)}return d},webToColor:function(b,d){d||(d=c.Color.createColor());var e=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/.exec(b);return e&&(d.r=parseInt(e[1],10),d.g=parseInt(e[2],10),d.b=parseInt(e[3],10)),d},componentToHex:function(b){b=b.toString(16);return 1==b.length?"0"+b:b},HSVColorWheel:function(b,d){"undefined"==typeof b&&(b=1);"undefined"==typeof d&&(d=1);for(var e=
[],g=0;359>=g;g++)e.push(c.Color.HSVtoRGB(g/359,b,d));return e},HSLColorWheel:function(b,d){"undefined"==typeof b&&(b=.5);"undefined"==typeof d&&(d=.5);for(var e=[],g=0;359>=g;g++)e.push(c.Color.HSLtoRGB(g/359,b,d));return e},interpolateColor:function(b,d,e,g,h){"undefined"==typeof h&&(h=255);b=c.Color.getRGB(b);d=c.Color.getRGB(d);return c.Color.getColor32(h,(d.red-b.red)*g/e+b.red,(d.green-b.green)*g/e+b.green,(d.blue-b.blue)*g/e+b.blue)},interpolateColorWithRGB:function(b,d,e,g,h,f){b=c.Color.getRGB(b);
return c.Color.getColor((d-b.red)*f/h+b.red,(e-b.green)*f/h+b.green,(g-b.blue)*f/h+b.blue)},interpolateRGB:function(b,d,e,g,h,f,k,m){return c.Color.getColor((g-b)*m/k+b,(h-d)*m/k+d,(f-e)*m/k+e)},getRandomColor:function(b,d,e){if("undefined"==typeof b&&(b=0),"undefined"==typeof d&&(d=255),"undefined"==typeof e&&(e=255),255<d||b>d)return c.Color.getColor(255,255,255);var g=b+Math.round(Math.random()*(d-b)),h=b+Math.round(Math.random()*(d-b));b+=Math.round(Math.random()*(d-b));return c.Color.getColor32(e,
g,h,b)},getRGB:function(b){return 16777215<b?{alpha:b>>>24,red:b>>16&255,green:b>>8&255,blue:255&b,a:b>>>24,r:b>>16&255,g:b>>8&255,b:255&b}:{alpha:255,red:b>>16&255,green:b>>8&255,blue:255&b,a:255,r:b>>16&255,g:b>>8&255,b:255&b}},getWebRGB:function(b){if("object"==typeof b)return"rgba("+b.r.toString()+","+b.g.toString()+","+b.b.toString()+","+(b.a/255).toString()+")";b=c.Color.getRGB(b);return"rgba("+b.r.toString()+","+b.g.toString()+","+b.b.toString()+","+(b.a/255).toString()+")"},getAlpha:function(b){return b>>>
24},getAlphaFloat:function(b){return(b>>>24)/255},getRed:function(b){return b>>16&255},getGreen:function(b){return b>>8&255},getBlue:function(b){return 255&b}};c.Physics=function(b,c){c=c||{};this.game=b;this.config=c;this.chipmunk=this.box2d=this.ninja=this.p2=this.arcade=null;this.parseConfig()};c.Physics.ARCADE=0;c.Physics.P2JS=1;c.Physics.NINJA=2;c.Physics.BOX2D=3;c.Physics.CHIPMUNK=4;c.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!c.Physics.hasOwnProperty("Arcade")||
(this.arcade=new c.Physics.Arcade(this.game),this.game.time.deltaCap=.2);this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&c.Physics.hasOwnProperty("Ninja")&&(this.ninja=new c.Physics.Ninja(this.game));this.config.hasOwnProperty("p2")&&!0===this.config.p2&&c.Physics.hasOwnProperty("P2")&&(this.p2=new c.Physics.P2(this.game,this.config));this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&c.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new c.Physics.BOX2D(this.game,this.config))},
startSystem:function(b){if(b===c.Physics.ARCADE?this.arcade=new c.Physics.Arcade(this.game):b===c.Physics.P2JS&&(this.p2=new c.Physics.P2(this.game,this.config)),b===c.Physics.NINJA)this.ninja=new c.Physics.Ninja(this.game);else if(b===c.Physics.BOX2D&&null===this.box2d)this.box2d=new c.Physics.Box2D(this.game,this.config);else if(b===c.Physics.CHIPMUNK&&null===this.chipmunk)throw Error("The Chipmunk physics system has not been implemented yet.");},enable:function(b,d,e){"undefined"==typeof d&&(d=
c.Physics.ARCADE);"undefined"==typeof e&&(e=!1);d===c.Physics.ARCADE?this.arcade.enable(b):d===c.Physics.P2JS&&this.p2?this.p2.enable(b,e):d===c.Physics.NINJA&&this.ninja?this.ninja.enableAABB(b):d===c.Physics.BOX2D&&this.box2d&&this.box2d.enable(b)},preUpdate:function(){this.p2&&this.p2.preUpdate();this.box2d&&this.box2d.preUpdate()},update:function(){this.p2&&this.p2.update();this.box2d&&this.box2d.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld();this.ninja&&this.ninja.setBoundsToWorld();
this.p2&&this.p2.setBoundsToWorld();this.box2d&&this.box2d.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear();this.box2d&&this.box2d.clear()},destroy:function(){this.p2&&this.p2.destroy();this.box2d&&this.box2d.destroy();this.box2d=this.p2=this.ninja=this.arcade=null}};c.Physics.prototype.constructor=c.Physics;c.Physics.Arcade=function(b){this.game=b;this.gravity=new c.Point;this.bounds=new c.Rectangle(0,0,b.world.width,b.world.height);this.checkCollision={up:!0,down:!0,left:!0,right:!0};
this.maxObjects=10;this.OVERLAP_BIAS=this.maxLevels=4;this.TILE_BIAS=16;this.skipQuadTree=this.forceX=!1;this.quadTree=new c.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this._average=this._newVelocity2=this._newVelocity1=this._velocity2=this._velocity1=this._maxOverlap=this._overlap=0;this._mapData=[];this._result=!1;this._dy=this._dx=this._angle=this._total=0;this.setBoundsToWorld()};c.Physics.Arcade.prototype.constructor=
c.Physics.Arcade;c.Physics.Arcade.prototype={setBounds:function(b,c,e,g){this.bounds.setTo(b,c,e,g)},setBoundsToWorld:function(){this.bounds.setTo(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},enable:function(b,d){"undefined"==typeof d&&(d=!0);var e=1;if(Array.isArray(b))for(e=b.length;e--;)b[e]instanceof c.Group?this.enable(b[e].children,d):(this.enableBody(b[e]),d&&b[e].hasOwnProperty("children")&&0<b[e].children.length&&this.enable(b[e],
!0));else b instanceof c.Group?this.enable(b.children,d):(this.enableBody(b),d&&b.hasOwnProperty("children")&&0<b.children.length&&this.enable(b.children,!0))},enableBody:function(b){b.hasOwnProperty("body")&&null===b.body&&(b.body=new c.Physics.Arcade.Body(b))},updateMotion:function(b){this._velocityDelta=this.computeVelocity(0,b,b.angularVelocity,b.angularAcceleration,b.angularDrag,b.maxAngular)-b.angularVelocity;b.angularVelocity+=this._velocityDelta;b.rotation+=b.angularVelocity*this.game.time.physicsElapsed;
b.velocity.x=this.computeVelocity(1,b,b.velocity.x,b.acceleration.x,b.drag.x,b.maxVelocity.x);b.velocity.y=this.computeVelocity(2,b,b.velocity.y,b.acceleration.y,b.drag.y,b.maxVelocity.y)},computeVelocity:function(b,c,e,g,h,f){return f=f||1E4,1==b&&c.allowGravity?e+=(this.gravity.x+c.gravity.x)*this.game.time.physicsElapsed:2==b&&c.allowGravity&&(e+=(this.gravity.y+c.gravity.y)*this.game.time.physicsElapsed),g?e+=g*this.game.time.physicsElapsed:h&&(this._drag=h*this.game.time.physicsElapsed,0<e-this._drag?
e-=this._drag:0>e+this._drag?e+=this._drag:e=0),e>f?e=f:-f>e&&(e=-f),e},overlap:function(b,c,e,g,h){if(e=e||null,g=g||null,h=h||e,this._result=!1,this._total=0,!Array.isArray(b)&&Array.isArray(c))for(var f=0,k=c.length;k>f;f++)this.collideHandler(b,c[f],e,g,h,!0);else if(Array.isArray(b)&&!Array.isArray(c))for(f=0,k=b.length;k>f;f++)this.collideHandler(b[f],c,e,g,h,!0);else if(Array.isArray(b)&&Array.isArray(c))for(f=0,k=b.length;k>f;f++)for(var m=0,n=c.length;n>m;m++)this.collideHandler(b[f],c[m],
e,g,h,!0);else this.collideHandler(b,c,e,g,h,!0);return 0<this._total},collide:function(b,c,e,g,h){if(e=e||null,g=g||null,h=h||e,this._result=!1,this._total=0,!Array.isArray(b)&&Array.isArray(c))for(var f=0,k=c.length;k>f;f++)this.collideHandler(b,c[f],e,g,h,!1);else if(Array.isArray(b)&&!Array.isArray(c))for(f=0,k=b.length;k>f;f++)this.collideHandler(b[f],c,e,g,h,!1);else if(Array.isArray(b)&&Array.isArray(c))for(f=0,k=b.length;k>f;f++)for(var m=0,n=c.length;n>m;m++)this.collideHandler(b[f],c[m],
e,g,h,!1);else this.collideHandler(b,c,e,g,h,!1);return 0<this._total},collideHandler:function(b,d,e,g,h,f){return"undefined"!=typeof d||b.type!==c.GROUP&&b.type!==c.EMITTER?void(b&&d&&b.exists&&d.exists&&(b.type==c.SPRITE||b.type==c.TILESPRITE?d.type==c.SPRITE||d.type==c.TILESPRITE?this.collideSpriteVsSprite(b,d,e,g,h,f):d.type==c.GROUP||d.type==c.EMITTER?this.collideSpriteVsGroup(b,d,e,g,h,f):d.type==c.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(b,d,e,g,h):b.type==c.GROUP?d.type==c.SPRITE||d.type==
c.TILESPRITE?this.collideSpriteVsGroup(d,b,e,g,h,f):d.type==c.GROUP||d.type==c.EMITTER?this.collideGroupVsGroup(b,d,e,g,h,f):d.type==c.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(b,d,e,g,h):b.type==c.TILEMAPLAYER?d.type==c.SPRITE||d.type==c.TILESPRITE?this.collideSpriteVsTilemapLayer(d,b,e,g,h):(d.type==c.GROUP||d.type==c.EMITTER)&&this.collideGroupVsTilemapLayer(d,b,e,g,h):b.type==c.EMITTER&&(d.type==c.SPRITE||d.type==c.TILESPRITE?this.collideSpriteVsGroup(d,b,e,g,h,f):d.type==c.GROUP||d.type==
c.EMITTER?this.collideGroupVsGroup(b,d,e,g,h,f):d.type==c.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(b,d,e,g,h)))):void this.collideGroupVsSelf(b,e,g,h,f)},collideSpriteVsSprite:function(b,c,e,g,h,f){return b.body&&c.body?(this.separate(b.body,c.body,g,h,f)&&(e&&e.call(h,b,c),this._total++),!0):!1},collideSpriteVsGroup:function(b,c,e,g,h,f){if(0!==c.length&&b.body)if(b.body.skipQuadTree||this.skipQuadTree)for(var k=0,m=c.children.length;m>k;k++)c.children[k]&&c.children[k].exists&&this.collideSpriteVsSprite(b,
c.children[k],e,g,h,f);else for(this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(c),this._potentials=this.quadTree.retrieve(b),k=0,m=this._potentials.length;m>k;k++)this.separate(b.body,this._potentials[k],g,h,f)&&(e&&e.call(h,b,this._potentials[k].sprite),this._total++)},collideGroupVsSelf:function(b,c,e,g,h){if(0!==b.length)for(var f=b.children.length,
k=0;f>k;k++)for(var m=k+1;f>=m;m++)b.children[k]&&b.children[m]&&b.children[k].exists&&b.children[m].exists&&this.collideSpriteVsSprite(b.children[k],b.children[m],c,e,g,h)},collideGroupVsGroup:function(b,d,e,g,h,f){if(0!==b.length&&0!==d.length)for(var k=0,m=b.children.length;m>k;k++)b.children[k].exists&&(b.children[k].type===c.GROUP?this.collideGroupVsGroup(b.children[k],d,e,g,h,f):this.collideSpriteVsGroup(b.children[k],d,e,g,h,f))},collideSpriteVsTilemapLayer:function(b,c,e,g,h){if(b.body&&(this._mapData=
c.getTiles(b.body.position.x-b.body.tilePadding.x,b.body.position.y-b.body.tilePadding.y,b.body.width+b.body.tilePadding.x,b.body.height+b.body.tilePadding.y,!1,!1),0!==this._mapData.length))for(c=0;c<this._mapData.length;c++)g?g.call(h,b,this._mapData[c])&&this.separateTile(c,b.body,this._mapData[c])&&(this._total++,e&&e.call(h,b,this._mapData[c])):this.separateTile(c,b.body,this._mapData[c])&&(this._total++,e&&e.call(h,b,this._mapData[c]))},collideGroupVsTilemapLayer:function(b,c,e,g,h){if(0!==
b.length)for(var f=0,k=b.children.length;k>f;f++)b.children[f].exists&&this.collideSpriteVsTilemapLayer(b.children[f],c,e,g,h)},separate:function(b,c,e,g,h){return b.enable&&c.enable&&this.intersects(b,c)?e&&!1===e.call(g,b.sprite,c.sprite)?!1:(this._result=this.forceX||Math.abs(this.gravity.y+b.gravity.y)<Math.abs(this.gravity.x+b.gravity.x)?this.separateX(b,c,h)||this.separateY(b,c,h):this.separateY(b,c,h)||this.separateX(b,c,h),h?!0:this._result):!1},intersects:function(b,c){return b.right<=c.position.x?
!1:b.bottom<=c.position.y?!1:b.position.x>=c.right?!1:b.position.y>=c.bottom?!1:!0},separateX:function(b,c,e){return b.immovable&&c.immovable?!1:(this._overlap=0,this.intersects(b,c)&&(this._maxOverlap=b.deltaAbsX()+c.deltaAbsX()+this.OVERLAP_BIAS,0===b.deltaX()&&0===c.deltaX()?(b.embedded=!0,c.embedded=!0):b.deltaX()>c.deltaX()?(this._overlap=b.right-c.x,this._overlap>this._maxOverlap||!1===b.checkCollision.right||!1===c.checkCollision.left?this._overlap=0:(b.touching.none=!1,b.touching.right=!0,
c.touching.none=!1,c.touching.left=!0)):b.deltaX()<c.deltaX()&&(this._overlap=b.x-c.width-c.x,-this._overlap>this._maxOverlap||!1===b.checkCollision.left||!1===c.checkCollision.right?this._overlap=0:(b.touching.none=!1,b.touching.left=!0,c.touching.none=!1,c.touching.right=!0)),b.overlapX=this._overlap,c.overlapX=this._overlap,0!==this._overlap)?e||b.customSeparateX||c.customSeparateX?!0:(this._velocity1=b.velocity.x,this._velocity2=c.velocity.x,b.immovable||c.immovable?b.immovable?c.immovable||(c.x+=
this._overlap,c.velocity.x=this._velocity1-this._velocity2*c.bounce.x):(b.x-=this._overlap,b.velocity.x=this._velocity2-this._velocity1*b.bounce.x):(this._overlap*=.5,b.x-=this._overlap,c.x+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*c.mass/b.mass)*(0<this._velocity2?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*b.mass/c.mass)*(0<this._velocity1?1:-1),this._average=.5*(this._newVelocity1+this._newVelocity2),this._newVelocity1-=this._average,this._newVelocity2-=
this._average,b.velocity.x=this._average+this._newVelocity1*b.bounce.x,c.velocity.x=this._average+this._newVelocity2*c.bounce.x),!0):!1)},separateY:function(b,c,e){return b.immovable&&c.immovable?!1:(this._overlap=0,this.intersects(b,c)&&(this._maxOverlap=b.deltaAbsY()+c.deltaAbsY()+this.OVERLAP_BIAS,0===b.deltaY()&&0===c.deltaY()?(b.embedded=!0,c.embedded=!0):b.deltaY()>c.deltaY()?(this._overlap=b.bottom-c.y,this._overlap>this._maxOverlap||!1===b.checkCollision.down||!1===c.checkCollision.up?this._overlap=
0:(b.touching.none=!1,b.touching.down=!0,c.touching.none=!1,c.touching.up=!0)):b.deltaY()<c.deltaY()&&(this._overlap=b.y-c.bottom,-this._overlap>this._maxOverlap||!1===b.checkCollision.up||!1===c.checkCollision.down?this._overlap=0:(b.touching.none=!1,b.touching.up=!0,c.touching.none=!1,c.touching.down=!0)),b.overlapY=this._overlap,c.overlapY=this._overlap,0!==this._overlap)?e||b.customSeparateY||c.customSeparateY?!0:(this._velocity1=b.velocity.y,this._velocity2=c.velocity.y,b.immovable||c.immovable?
b.immovable?c.immovable||(c.y+=this._overlap,c.velocity.y=this._velocity1-this._velocity2*c.bounce.y,b.moves&&(c.x+=b.x-b.prev.x)):(b.y-=this._overlap,b.velocity.y=this._velocity2-this._velocity1*b.bounce.y,c.moves&&(b.x+=c.x-c.prev.x)):(this._overlap*=.5,b.y-=this._overlap,c.y+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*c.mass/b.mass)*(0<this._velocity2?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*b.mass/c.mass)*(0<this._velocity1?1:-1),this._average=
.5*(this._newVelocity1+this._newVelocity2),this._newVelocity1-=this._average,this._newVelocity2-=this._average,b.velocity.y=this._average+this._newVelocity1*b.bounce.y,c.velocity.y=this._average+this._newVelocity2*c.bounce.y),!0):!1)},separateTile:function(b,c,e){if(!c.enable||!e.intersects(c.position.x,c.position.y,c.right,c.bottom)||e.collisionCallback&&!e.collisionCallback.call(e.collisionCallbackContext,c.sprite,e)||e.layer.callbacks[e.index]&&!e.layer.callbacks[e.index].callback.call(e.layer.callbacks[e.index].callbackContext,
c.sprite,e)||!(e.faceLeft||e.faceRight||e.faceTop||e.faceBottom))return!1;var g=b=0,h=0,f=1;if(c.deltaAbsX()>c.deltaAbsY()?h=-1:c.deltaAbsX()<c.deltaAbsY()&&(f=-1),0!==c.deltaX()&&0!==c.deltaY()&&(e.faceLeft||e.faceRight)&&(e.faceTop||e.faceBottom)&&(h=Math.min(Math.abs(c.position.x-e.right),Math.abs(c.right-e.left)),f=Math.min(Math.abs(c.position.y-e.bottom),Math.abs(c.bottom-e.top))),f>h){if((e.faceLeft||e.faceRight)&&(b=this.tileCheckX(c,e),0!==b&&!e.intersects(c.position.x,c.position.y,c.right,
c.bottom)))return!0;(e.faceTop||e.faceBottom)&&(g=this.tileCheckY(c,e))}else{if((e.faceTop||e.faceBottom)&&(g=this.tileCheckY(c,e),0!==g&&!e.intersects(c.position.x,c.position.y,c.right,c.bottom)))return!0;(e.faceLeft||e.faceRight)&&(b=this.tileCheckX(c,e))}return 0!==b||0!==g},tileCheckX:function(b,c){var e=0;return 0>b.deltaX()&&!b.blocked.left&&c.collideRight&&b.checkCollision.left?c.faceRight&&b.x<c.right&&(e=b.x-c.right,e<-this.TILE_BIAS&&(e=0)):0<b.deltaX()&&!b.blocked.right&&c.collideLeft&&
b.checkCollision.right&&c.faceLeft&&b.right>c.left&&(e=b.right-c.left,e>this.TILE_BIAS&&(e=0)),0!==e&&this.processTileSeparationX(b,e),e},tileCheckY:function(b,c){var e=0;return 0>b.deltaY()&&!b.blocked.up&&c.collideDown&&b.checkCollision.up?c.faceBottom&&b.y<c.bottom&&(e=b.y-c.bottom,e<-this.TILE_BIAS&&(e=0)):0<b.deltaY()&&!b.blocked.down&&c.collideUp&&b.checkCollision.down&&c.faceTop&&b.bottom>c.top&&(e=b.bottom-c.top,e>this.TILE_BIAS&&(e=0)),0!==e&&this.processTileSeparationY(b,e),e},processTileSeparationX:function(b,
c){0>c?b.blocked.left=!0:0<c&&(b.blocked.right=!0);b.position.x-=c;b.velocity.x=0===b.bounce.x?0:-b.velocity.x*b.bounce.x},processTileSeparationY:function(b,c){0>c?b.blocked.up=!0:0<c&&(b.blocked.down=!0);b.position.y-=c;b.velocity.y=0===b.bounce.y?0:-b.velocity.y*b.bounce.y},getObjectsUnderPointer:function(b,d,e,g){if(0!==d.length&&b.exists){this.quadTree.clear();this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,
this.maxLevels);this.quadTree.populate(d);var h=new c.Rectangle(b.x,b.y,1,1);d=[];this._potentials=this.quadTree.retrieve(h);for(var h=0,f=this._potentials.length;f>h;h++)this._potentials[h].hitTest(b.x,b.y)&&(e&&e.call(g,b,this._potentials[h].sprite),d.push(this._potentials[h].sprite));return d}},moveToObject:function(b,c,e,g){return"undefined"==typeof e&&(e=60),"undefined"==typeof g&&(g=0),this._angle=Math.atan2(c.y-b.y,c.x-b.x),0<g&&(e=this.distanceBetween(b,c)/(g/1E3)),b.body.velocity.x=Math.cos(this._angle)*
e,b.body.velocity.y=Math.sin(this._angle)*e,this._angle},moveToPointer:function(b,c,e,g){return"undefined"==typeof c&&(c=60),e=e||this.game.input.activePointer,"undefined"==typeof g&&(g=0),this._angle=this.angleToPointer(b,e),0<g&&(c=this.distanceToPointer(b,e)/(g/1E3)),b.body.velocity.x=Math.cos(this._angle)*c,b.body.velocity.y=Math.sin(this._angle)*c,this._angle},moveToXY:function(b,c,e,g,h){return"undefined"==typeof g&&(g=60),"undefined"==typeof h&&(h=0),this._angle=Math.atan2(e-b.y,c-b.x),0<h&&
(g=this.distanceToXY(b,c,e)/(h/1E3)),b.body.velocity.x=Math.cos(this._angle)*g,b.body.velocity.y=Math.sin(this._angle)*g,this._angle},velocityFromAngle:function(b,d,e){return"undefined"==typeof d&&(d=60),e=e||new c.Point,e.setTo(Math.cos(this.game.math.degToRad(b))*d,Math.sin(this.game.math.degToRad(b))*d)},velocityFromRotation:function(b,d,e){return"undefined"==typeof d&&(d=60),e=e||new c.Point,e.setTo(Math.cos(b)*d,Math.sin(b)*d)},accelerationFromRotation:function(b,d,e){return"undefined"==typeof d&&
(d=60),e=e||new c.Point,e.setTo(Math.cos(b)*d,Math.sin(b)*d)},accelerateToObject:function(b,c,e,g,h){return"undefined"==typeof e&&(e=60),"undefined"==typeof g&&(g=1E3),"undefined"==typeof h&&(h=1E3),this._angle=this.angleBetween(b,c),b.body.acceleration.setTo(Math.cos(this._angle)*e,Math.sin(this._angle)*e),b.body.maxVelocity.setTo(g,h),this._angle},accelerateToPointer:function(b,c,e,g,h){return"undefined"==typeof e&&(e=60),"undefined"==typeof c&&(c=this.game.input.activePointer),"undefined"==typeof g&&
(g=1E3),"undefined"==typeof h&&(h=1E3),this._angle=this.angleToPointer(b,c),b.body.acceleration.setTo(Math.cos(this._angle)*e,Math.sin(this._angle)*e),b.body.maxVelocity.setTo(g,h),this._angle},accelerateToXY:function(b,c,e,g,h,f){return"undefined"==typeof g&&(g=60),"undefined"==typeof h&&(h=1E3),"undefined"==typeof f&&(f=1E3),this._angle=this.angleToXY(b,c,e),b.body.acceleration.setTo(Math.cos(this._angle)*g,Math.sin(this._angle)*g),b.body.maxVelocity.setTo(h,f),this._angle},distanceBetween:function(b,
c){return this._dx=b.x-c.x,this._dy=b.y-c.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToXY:function(b,c,e){return this._dx=b.x-c,this._dy=b.y-e,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToPointer:function(b,c){return c=c||this.game.input.activePointer,this._dx=b.x-c.x,this._dy=b.y-c.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},angleBetween:function(b,c){return this._dx=c.x-b.x,this._dy=c.y-b.y,Math.atan2(this._dy,this._dx)},angleToXY:function(b,c,e){return this._dx=
c-b.x,this._dy=e-b.y,Math.atan2(this._dy,this._dx)},angleToPointer:function(b,c){return c=c||this.game.input.activePointer,this._dx=c.worldX-b.x,this._dy=c.worldY-b.y,Math.atan2(this._dy,this._dx)}};c.Physics.Arcade.Body=function(b){this.sprite=b;this.game=b.game;this.type=c.Physics.ARCADE;this.enable=!0;this.offset=new c.Point;this.position=new c.Point(b.x,b.y);this.prev=new c.Point(this.position.x,this.position.y);this.allowRotation=!0;this.preRotation=this.rotation=b.rotation;this.sourceWidth=
b.texture.frame.width;this.sourceHeight=b.texture.frame.height;this.width=b.width;this.height=b.height;this.halfWidth=Math.abs(b.width/2);this.halfHeight=Math.abs(b.height/2);this.center=new c.Point(b.x+this.halfWidth,b.y+this.halfHeight);this.velocity=new c.Point;this.newVelocity=new c.Point(0,0);this.deltaMax=new c.Point(0,0);this.acceleration=new c.Point;this.drag=new c.Point;this.allowGravity=!0;this.gravity=new c.Point(0,0);this.bounce=new c.Point;this.maxVelocity=new c.Point(1E4,1E4);this.angularDrag=
this.angularAcceleration=this.angularVelocity=0;this.maxAngular=1E3;this.mass=1;this.speed=this.angle=0;this.facing=c.NONE;this.immovable=!1;this.moves=!0;this.customSeparateY=this.customSeparateX=!1;this.overlapY=this.overlapX=0;this.collideWorldBounds=this.embedded=!1;this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0};this.touching={none:!0,up:!1,down:!1,left:!1,right:!1};this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1};this.blocked={up:!1,down:!1,left:!1,right:!1};this.tilePadding=
new c.Point;this.phase=0;this.skipQuadTree=!1;this._reset=!0;this._sx=b.scale.x;this._sy=b.scale.y;this._dy=this._dx=0};c.Physics.Arcade.Body.prototype={updateBounds:function(){var b=Math.abs(this.sprite.scale.x),c=Math.abs(this.sprite.scale.y);(b!==this._sx||c!==this._sy)&&(this.width=this.sourceWidth*b,this.height=this.sourceHeight*c,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this._sx=b,this._sy=c,this.center.setTo(this.position.x+this.halfWidth,this.position.y+
this.halfHeight),this._reset=!0)},preUpdate:function(){this.enable&&(this.phase=1,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),
this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.width+this.offset.x,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.height+this.offset.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||1===this.sprite._cache[4])&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=
this.newVelocity.x,this.position.y+=this.newVelocity.y,(this.position.x!==this.prev.x||this.position.y!==this.prev.y)&&(this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.collideWorldBounds&&this.checkWorldBounds()),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1)},postUpdate:function(){this.enable&&2!==this.phase&&(this.phase=2,0>this.deltaX()?this.facing=c.LEFT:0<this.deltaX()&&(this.facing=
c.RIGHT),0>this.deltaY()?this.facing=c.UP:0<this.deltaY()&&(this.facing=c.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(0>this._dx&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:0<this._dx&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(0>this._dy&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:0<this._dy&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.x+=this._dx,this.sprite.y+=
this._dy),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},destroy:function(){this.sprite=this.sprite.body=null},checkWorldBounds:function(){this.position.x<this.game.physics.arcade.bounds.x&&this.game.physics.arcade.checkCollision.left?(this.position.x=this.game.physics.arcade.bounds.x,this.velocity.x*=-this.bounce.x,this.blocked.left=!0):this.right>this.game.physics.arcade.bounds.right&&
this.game.physics.arcade.checkCollision.right&&(this.position.x=this.game.physics.arcade.bounds.right-this.width,this.velocity.x*=-this.bounce.x,this.blocked.right=!0);this.position.y<this.game.physics.arcade.bounds.y&&this.game.physics.arcade.checkCollision.up?(this.position.y=this.game.physics.arcade.bounds.y,this.velocity.y*=-this.bounce.y,this.blocked.up=!0):this.bottom>this.game.physics.arcade.bounds.bottom&&this.game.physics.arcade.checkCollision.down&&(this.position.y=this.game.physics.arcade.bounds.bottom-
this.height,this.velocity.y*=-this.bounce.y,this.blocked.down=!0)},setSize:function(b,c,e,g){"undefined"==typeof e&&(e=this.offset.x);"undefined"==typeof g&&(g=this.offset.y);this.sourceWidth=b;this.sourceHeight=c;this.width=this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.setTo(e,g);this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(b,c){this.velocity.set(0);
this.acceleration.set(0);this.angularAcceleration=this.angularVelocity=0;this.position.x=b-this.sprite.anchor.x*this.width+this.offset.x;this.position.y=c-this.sprite.anchor.y*this.height+this.offset.y;this.prev.x=this.position.x;this.prev.y=this.position.y;this.preRotation=this.rotation=this.sprite.angle;this._sx=this.sprite.scale.x;this._sy=this.sprite.scale.y;this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},hitTest:function(b,d){return c.Rectangle.contains(this,
b,d)},onFloor:function(){return this.blocked.down},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return 0<this.deltaX()?this.deltaX():-this.deltaX()},deltaAbsY:function(){return 0<this.deltaY()?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation}};Object.defineProperty(c.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+
this.height}});Object.defineProperty(c.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}});Object.defineProperty(c.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(b){this.position.x=b}});Object.defineProperty(c.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(b){this.position.y=b}});c.Physics.Arcade.Body.render=function(b,c,e,g){"undefined"==typeof g&&(g=!0);e=e||"rgba(0,255,0,0.4)";
g?(b.fillStyle=e,b.fillRect(c.position.x-c.game.camera.x,c.position.y-c.game.camera.y,c.width,c.height)):(b.strokeStyle=e,b.strokeRect(c.position.x-c.game.camera.x,c.position.y-c.game.camera.y,c.width,c.height))};c.Physics.Arcade.Body.renderBodyInfo=function(b,c){b.line("x: "+c.x.toFixed(2),"y: "+c.y.toFixed(2),"width: "+c.width,"height: "+c.height);b.line("velocity x: "+c.velocity.x.toFixed(2),"y: "+c.velocity.y.toFixed(2),"deltaX: "+c._dx.toFixed(2),"deltaY: "+c._dy.toFixed(2));b.line("acceleration x: "+
c.acceleration.x.toFixed(2),"y: "+c.acceleration.y.toFixed(2),"speed: "+c.speed.toFixed(2),"angle: "+c.angle.toFixed(2));b.line("gravity x: "+c.gravity.x,"y: "+c.gravity.y,"bounce x: "+c.bounce.x.toFixed(2),"y: "+c.bounce.y.toFixed(2));b.line("touching left: "+c.touching.left,"right: "+c.touching.right,"up: "+c.touching.up,"down: "+c.touching.down);b.line("blocked left: "+c.blocked.left,"right: "+c.blocked.right,"up: "+c.blocked.up,"down: "+c.blocked.down)};c.Physics.Arcade.Body.prototype.constructor=
c.Physics.Arcade.Body;c.Particles=function(b){this.game=b;this.emitters={};this.ID=0};c.Particles.prototype={add:function(b){return this.emitters[b.name]=b,b},remove:function(b){delete this.emitters[b.name]},update:function(){for(var b in this.emitters)this.emitters[b].exists&&this.emitters[b].update()}};c.Particles.prototype.constructor=c.Particles;c.Particles.Arcade={};c.Particles.Arcade.Emitter=function(b,d,e,g){this.maxParticles=g||50;c.Group.call(this,b);this.name="emitter"+this.game.particles.ID++;
this.type=c.EMITTER;this.area=new c.Rectangle(d,e,1,1);this.minParticleSpeed=new c.Point(-100,-100);this.maxParticleSpeed=new c.Point(100,100);this.maxParticleScale=this.minParticleScale=1;this.scaleData=null;this.minRotation=-360;this.maxRotation=360;this.maxParticleAlpha=this.minParticleAlpha=1;this.alphaData=null;this.gravity=100;this.particleClass=c.Particle;this.particleDrag=new c.Point;this.angularDrag=0;this.frequency=100;this.lifespan=2E3;this.bounce=new c.Point;this.on=!1;this.particleAnchor=
new c.Point(.5,.5);this.blendMode=c.blendModes.NORMAL;this.emitX=d;this.emitY=e;this.particleSendToBack=this.particleBringToTop=this.autoAlpha=this.autoScale=!1;this._minParticleScale=new c.Point(1,1);this._maxParticleScale=new c.Point(1,1);this._counter=this._timer=this._quantity=0;this._explode=!0;this._frames=null};c.Particles.Arcade.Emitter.prototype=Object.create(c.Group.prototype);c.Particles.Arcade.Emitter.prototype.constructor=c.Particles.Arcade.Emitter;c.Particles.Arcade.Emitter.prototype.update=
function(){if(this.on)if(this._explode){this._counter=0;do this.emitParticle(),this._counter++;while(this._counter<this._quantity);this.on=!1}else this.game.time.now>=this._timer&&(this.emitParticle(),this._counter++,0<this._quantity&&this._counter>=this._quantity&&(this.on=!1),this._timer=this.game.time.now+this.frequency);for(var b=this.children.length;b--;)this.children[b].exists&&this.children[b].update()};c.Particles.Arcade.Emitter.prototype.makeParticles=function(b,c,e,g,h){"undefined"==typeof c&&
(c=0);"undefined"==typeof e&&(e=this.maxParticles);"undefined"==typeof g&&(g=!1);"undefined"==typeof h&&(h=!1);var f,k=0,m=b,n=c;for(this._frames=c;e>k;)Array.isArray(b)&&(m=this.game.rnd.pick(b)),Array.isArray(c)&&(n=this.game.rnd.pick(c)),f=new this.particleClass(this.game,0,0,m,n),this.game.physics.arcade.enable(f,!1),g?(f.body.checkCollision.any=!0,f.body.checkCollision.none=!1):f.body.checkCollision.none=!0,f.body.collideWorldBounds=h,f.exists=!1,f.visible=!1,f.anchor.copyFrom(this.particleAnchor),
this.add(f),k++;return this};c.Particles.Arcade.Emitter.prototype.kill=function(){this.exists=this.alive=this.on=!1};c.Particles.Arcade.Emitter.prototype.revive=function(){this.exists=this.alive=!0};c.Particles.Arcade.Emitter.prototype.explode=function(b,c){this.start(!0,b,0,c,!1)};c.Particles.Arcade.Emitter.prototype.flow=function(b,c,e){this.start(!1,b,c,e,!0)};c.Particles.Arcade.Emitter.prototype.start=function(b,c,e,g,h){"undefined"==typeof b&&(b=!0);"undefined"==typeof c&&(c=0);"undefined"!=
typeof e&&null!==e||(e=250);"undefined"==typeof g&&(g=0);"undefined"==typeof h&&(h=!1);this.revive();this.on=this.visible=!0;this._explode=b;this.lifespan=c;this.frequency=e;b||h?this._quantity=g:this._quantity+=g;this._counter=0;this._timer=this.game.time.now+e};c.Particles.Arcade.Emitter.prototype.emitParticle=function(){var b=this.getFirstExists(!1);null!==b&&(1<this.width||1<this.height?b.reset(this.game.rnd.integerInRange(this.left,this.right),this.game.rnd.integerInRange(this.top,this.bottom)):
b.reset(this.emitX,this.emitY),b.angle=0,b.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(b):this.particleSendToBack&&this.sendToBack(b),this.autoScale?b.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?b.scale.set(this.game.rnd.realInRange(this.minParticleScale,this.maxParticleScale)):(this._minParticleScale.x!==this._maxParticleScale.x||this._minParticleScale.y!==this._maxParticleScale.y)&&b.scale.set(this.game.rnd.realInRange(this._minParticleScale.x,
this._maxParticleScale.x),this.game.rnd.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),b.frame=Array.isArray("object"===this._frames)?this.game.rnd.pick(this._frames):this._frames,this.autoAlpha?b.setAlphaData(this.alphaData):b.alpha=this.game.rnd.realInRange(this.minParticleAlpha,this.maxParticleAlpha),b.blendMode=this.blendMode,b.body.updateBounds(),b.body.bounce.setTo(this.bounce.x,this.bounce.y),b.body.velocity.x=this.game.rnd.integerInRange(this.minParticleSpeed.x,this.maxParticleSpeed.x),
b.body.velocity.y=this.game.rnd.integerInRange(this.minParticleSpeed.y,this.maxParticleSpeed.y),b.body.angularVelocity=this.game.rnd.integerInRange(this.minRotation,this.maxRotation),b.body.gravity.y=this.gravity,b.body.drag.x=this.particleDrag.x,b.body.drag.y=this.particleDrag.y,b.body.angularDrag=this.angularDrag,b.onEmit())};c.Particles.Arcade.Emitter.prototype.setSize=function(b,c){this.area.width=b;this.area.height=c};c.Particles.Arcade.Emitter.prototype.setXSpeed=function(b,c){this.minParticleSpeed.x=
b||0;this.maxParticleSpeed.x=c||0};c.Particles.Arcade.Emitter.prototype.setYSpeed=function(b,c){this.minParticleSpeed.y=b||0;this.maxParticleSpeed.y=c||0};c.Particles.Arcade.Emitter.prototype.setRotation=function(b,c){this.minRotation=b||0;this.maxRotation=c||0};c.Particles.Arcade.Emitter.prototype.setAlpha=function(b,d,e,g,h){if("undefined"==typeof b&&(b=1),"undefined"==typeof d&&(d=1),"undefined"==typeof e&&(e=0),"undefined"==typeof g&&(g=c.Easing.Linear.None),"undefined"==typeof h&&(h=!1),this.minParticleAlpha=
b,this.maxParticleAlpha=d,this.autoAlpha=!1,0<e&&b!==d)b=this.game.make.tween({v:b}).to({v:d},e,g),b.yoyo(h),this.alphaData=b.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0};c.Particles.Arcade.Emitter.prototype.setScale=function(b,d,e,g,h,f,k){if("undefined"==typeof b&&(b=1),"undefined"==typeof d&&(d=1),"undefined"==typeof e&&(e=1),"undefined"==typeof g&&(g=1),"undefined"==typeof h&&(h=0),"undefined"==typeof f&&(f=c.Easing.Linear.None),"undefined"==typeof k&&(k=!1),this.minParticleScale=
1,this.maxParticleScale=1,this._minParticleScale.set(b,e),this._maxParticleScale.set(d,g),this.autoScale=!1,0<h&&b!==d||e!==g)b=this.game.make.tween({x:b,y:e}).to({x:d,y:g},h,f),b.yoyo(k),this.scaleData=b.generateData(60),this.scaleData.reverse(),this.autoScale=!0};c.Particles.Arcade.Emitter.prototype.at=function(b){b.center?(this.emitX=b.center.x,this.emitY=b.center.y):(this.emitX=b.world.x+b.anchor.x*b.width,this.emitY=b.world.y+b.anchor.y*b.height)};Object.defineProperty(c.Particles.Arcade.Emitter.prototype,
"width",{get:function(){return this.area.width},set:function(b){this.area.width=b}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"height",{get:function(){return this.area.height},set:function(b){this.area.height=b}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(b){this.emitX=b}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(b){this.emitY=b}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,
"left",{get:function(){return Math.floor(this.x-this.area.width/2)}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.area.width/2)}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.area.height/2)}});Object.defineProperty(c.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.area.height/2)}});c.Tile=function(b,c,e,g,h,f){this.layer=
b;this.index=c;this.x=e;this.y=g;this.worldX=e*h;this.worldY=g*f;this.width=h;this.height=f;this.centerX=Math.abs(h/2);this.centerY=Math.abs(f/2);this.alpha=1;this.properties={};this.collideDown=this.collideUp=this.collideRight=this.collideLeft=this.faceRight=this.faceLeft=this.faceBottom=this.faceTop=this.scanned=!1;this.collisionCallback=null;this.collisionCallbackContext=this};c.Tile.prototype={containsPoint:function(b,c){return!(b<this.worldX||c<this.worldY||b>this.right||c>this.bottom)},intersects:function(b,
c,e,g){return e<=this.worldX?!1:g<=this.worldY?!1:b>=this.worldX+this.width?!1:c>=this.worldY+this.height?!1:!0},setCollisionCallback:function(b,c){this.collisionCallback=b;this.collisionCallbackContext=c},destroy:function(){this.properties=this.collisionCallbackContext=this.collisionCallback=null},setCollision:function(b,c,e,g){this.collideLeft=b;this.collideRight=c;this.collideUp=e;this.collideDown=g;this.faceLeft=b;this.faceRight=c;this.faceTop=e;this.faceBottom=g},resetCollision:function(){this.faceRight=
this.faceLeft=this.faceBottom=this.faceTop=this.collideDown=this.collideUp=this.collideRight=this.collideLeft=!1},isInteresting:function(b,c){return b&&c?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:b?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:c?this.faceTop||this.faceBottom||this.faceLeft||this.faceRight:!1},copy:function(b){this.index=b.index;this.alpha=b.alpha;
this.properties=b.properties;this.collideUp=b.collideUp;this.collideDown=b.collideDown;this.collideLeft=b.collideLeft;this.collideRight=b.collideRight;this.collisionCallback=b.collisionCallback;this.collisionCallbackContext=b.collisionCallbackContext}};c.Tile.prototype.constructor=c.Tile;Object.defineProperty(c.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}});Object.defineProperty(c.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||
this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}});Object.defineProperty(c.Tile.prototype,"left",{get:function(){return this.worldX}});Object.defineProperty(c.Tile.prototype,"right",{get:function(){return this.worldX+this.width}});Object.defineProperty(c.Tile.prototype,"top",{get:function(){return this.worldY}});Object.defineProperty(c.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}});c.Tilemap=function(b,d,e,g,h,f){this.game=b;this.key=d;b=c.TilemapParser.parse(this.game,
d,e,g,h,f);null!==b&&(this.width=b.width,this.height=b.height,this.tileWidth=b.tileWidth,this.tileHeight=b.tileHeight,this.orientation=b.orientation,this.format=b.format,this.version=b.version,this.properties=b.properties,this.widthInPixels=b.widthInPixels,this.heightInPixels=b.heightInPixels,this.layers=b.layers,this.tilesets=b.tilesets,this.tiles=b.tiles,this.objects=b.objects,this.collideIndexes=[],this.collision=b.collision,this.images=b.images,this.currentLayer=0,this.debugMap=[],this._results=
[],this._tempA=0,this._tempB=0)};c.Tilemap.CSV=0;c.Tilemap.TILED_JSON=1;c.Tilemap.NORTH=0;c.Tilemap.EAST=1;c.Tilemap.SOUTH=2;c.Tilemap.WEST=3;c.Tilemap.prototype={create:function(b,c,e,g,h,f){return"undefined"==typeof f&&(f=this.game.world),this.width=c,this.height=e,this.setTileSize(g,h),this.layers.length=0,this.createBlankLayer(b,c,e,g,h,f)},setTileSize:function(b,c){this.tileWidth=b;this.tileHeight=c;this.widthInPixels=this.width*b;this.heightInPixels=this.height*c},addTilesetImage:function(b,
d,e,g,h,f,k){if("undefined"==typeof e&&(e=this.tileWidth),"undefined"==typeof g&&(g=this.tileHeight),"undefined"==typeof h&&(h=0),"undefined"==typeof f&&(f=0),"undefined"==typeof k&&(k=0),0===e&&(e=32),0===g&&(g=32),"undefined"==typeof d){if("string"!=typeof b)return null;if(d=b,!this.game.cache.checkImageKey(d))return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "'+d+'"'),null}if("string"==typeof b&&(b=this.getTilesetIndex(b),null===b&&this.format===c.Tilemap.TILED_JSON))return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "'+
d+'"'),null;if(this.tilesets[b])return this.tilesets[b].setImage(this.game.cache.getImage(d)),this.tilesets[b];b=new c.Tileset(d,k,e,g,h,f,{});b.setImage(this.game.cache.getImage(d));this.tilesets.push(b);d=this.tilesets.length-1;for(var m=h,n=h,p=0,q=0,r=0,t=k;t<k+b.total&&(this.tiles[t]=[m,n,d],m+=e+f,p++,p!==b.total)&&(q++,q!==b.columns||(m=h,n+=g+f,q=0,r++,r!==b.rows));t++);return b},createFromObjects:function(b,d,e,g,h,f,k,m,n){if("undefined"==typeof h&&(h=!0),"undefined"==typeof f&&(f=!1),"undefined"==
typeof k&&(k=this.game.world),"undefined"==typeof m&&(m=c.Sprite),"undefined"==typeof n&&(n=!0),!this.objects[b])return void console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: "+b);for(var p,q=0,r=this.objects[b].length;r>q;q++)if(this.objects[b][q].gid===d){p=new m(this.game,this.objects[b][q].x,this.objects[b][q].y,e,g);p.name=this.objects[b][q].name;p.visible=this.objects[b][q].visible;p.autoCull=f;p.exists=h;n&&(p.y-=p.height);k.add(p);for(var t in this.objects[b][q].properties)k.set(p,
t,this.objects[b][q].properties[t],!1,!1,0,!0)}},createLayer:function(b,d,e,g){"undefined"==typeof d&&(d=this.game.width);"undefined"==typeof e&&(e=this.game.height);"undefined"==typeof g&&(g=this.game.world);var h=b;return"string"==typeof b&&(h=this.getLayerIndex(b)),null===h||h>this.layers.length?void console.warn("Tilemap.createLayer: Invalid layer ID given: "+h):g.add(new c.TilemapLayer(this.game,this,h,d,e))},createBlankLayer:function(b,d,e,g,h,f){if("undefined"==typeof f&&(f=this.game.world),
null!==this.getLayerIndex(b))return void console.warn("Tilemap.createBlankLayer: Layer with matching name already exists");for(var k,m={name:b,x:0,y:0,width:d,height:e,widthInPixels:d*g,heightInPixels:e*h,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},n=[],p=0;e>p;p++){k=[];for(var q=0;d>q;q++)k.push(new c.Tile(m,-1,q,p,g,h));n.push(k)}m.data=n;this.layers.push(m);this.currentLayer=this.layers.length-1;d=m.widthInPixels;m=m.heightInPixels;d>this.game.width&&(d=this.game.width);
m>this.game.height&&(m=this.game.height);n=new c.TilemapLayer(this.game,this,this.layers.length-1,d,m);return n.name=b,f.add(n)},getIndex:function(b,c){for(var e=0;e<b.length;e++)if(b[e].name===c)return e;return null},getLayerIndex:function(b){return this.getIndex(this.layers,b)},getTilesetIndex:function(b){return this.getIndex(this.tilesets,b)},getImageIndex:function(b){return this.getIndex(this.images,b)},getObjectIndex:function(b){return this.getIndex(this.objects,b)},setTileIndexCallback:function(b,
c,e,g){if(g=this.getLayer(g),"number"==typeof b)this.layers[g].callbacks[b]={callback:c,callbackContext:e};else for(var h=0,f=b.length;f>h;h++)this.layers[g].callbacks[b[h]]={callback:c,callbackContext:e}},setTileLocationCallback:function(b,c,e,g,h,f,k){if(k=this.getLayer(k),this.copy(b,c,e,g,k),!(2>this._results.length))for(b=1;b<this._results.length;b++)this._results[b].setCollisionCallback(h,f)},setCollision:function(b,c,e,g){if("undefined"==typeof c&&(c=!0),"undefined"==typeof g&&(g=!0),e=this.getLayer(e),
"number"==typeof b)return this.setCollisionByIndex(b,c,e,!0);for(var h=0,f=b.length;f>h;h++)this.setCollisionByIndex(b[h],c,e,!1);g&&this.calculateFaces(e)},setCollisionBetween:function(b,c,e,g,h){if("undefined"==typeof e&&(e=!0),"undefined"==typeof h&&(h=!0),g=this.getLayer(g),!(b>c)){for(;c>=b;b++)this.setCollisionByIndex(b,e,g,!1);h&&this.calculateFaces(g)}},setCollisionByExclusion:function(b,c,e,g){"undefined"==typeof c&&(c=!0);"undefined"==typeof g&&(g=!0);e=this.getLayer(e);for(var h=0,f=this.tiles.length;f>
h;h++)-1===b.indexOf(h)&&this.setCollisionByIndex(h,c,e,!1);g&&this.calculateFaces(e)},setCollisionByIndex:function(b,c,e,g){if("undefined"==typeof c&&(c=!0),"undefined"==typeof e&&(e=this.currentLayer),"undefined"==typeof g&&(g=!0),c)this.collideIndexes.push(b);else{var h=this.collideIndexes.indexOf(b);-1<h&&this.collideIndexes.splice(h,1)}for(h=0;h<this.layers[e].height;h++)for(var f=0;f<this.layers[e].width;f++){var k=this.layers[e].data[h][f];k&&k.index===b&&(c?k.setCollision(!0,!0,!0,!0):k.resetCollision(),
k.faceTop=c,k.faceBottom=c,k.faceLeft=c,k.faceRight=c)}return g&&this.calculateFaces(e),e},getLayer:function(b){return"undefined"==typeof b?b=this.currentLayer:"string"==typeof b?b=this.getLayerIndex(b):b instanceof c.TilemapLayer&&(b=b.index),b},setPreventRecalculate:function(b){if(!0===b&&!0!==this.preventingRecalculate&&(this.preventingRecalculate=!0,this.needToRecalculate={}),!1===b&&!0===this.preventingRecalculate){this.preventingRecalculate=!1;for(var c in this.needToRecalculate)this.calculateFaces(c);
this.needToRecalculate=!1}},calculateFaces:function(b){if(this.preventingRecalculate)return void(this.needToRecalculate[b]=!0);for(var c=null,e=null,g=null,h=null,f=0,k=this.layers[b].height;k>f;f++)for(var m=0,n=this.layers[b].width;n>m;m++){var p=this.layers[b].data[f][m];p&&(c=this.getTileAbove(b,m,f),e=this.getTileBelow(b,m,f),g=this.getTileLeft(b,m,f),h=this.getTileRight(b,m,f),p.collides&&(p.faceTop=!0,p.faceBottom=!0,p.faceLeft=!0,p.faceRight=!0),c&&c.collides&&(p.faceTop=!1),e&&e.collides&&
(p.faceBottom=!1),g&&g.collides&&(p.faceLeft=!1),h&&h.collides&&(p.faceRight=!1))}},getTileAbove:function(b,c,e){return 0<e?this.layers[b].data[e-1][c]:null},getTileBelow:function(b,c,e){return e<this.layers[b].height-1?this.layers[b].data[e+1][c]:null},getTileLeft:function(b,c,e){return 0<c?this.layers[b].data[e][c-1]:null},getTileRight:function(b,c,e){return c<this.layers[b].width-1?this.layers[b].data[e][c+1]:null},setLayer:function(b){b=this.getLayer(b);this.layers[b]&&(this.currentLayer=b)},
hasTile:function(b,c,e){return e=this.getLayer(e),-1<this.layers[e].data[c][b].index},removeTile:function(b,d,e){if(e=this.getLayer(e),0<=b&&b<this.layers[e].width&&0<=d&&d<this.layers[e].height&&this.hasTile(b,d,e)){var g=this.layers[e].data[d][b];return this.layers[e].data[d][b]=new c.Tile(this.layers[e],-1,b,d,this.tileWidth,this.tileHeight),this.layers[e].dirty=!0,this.calculateFaces(e),g}},removeTileWorldXY:function(b,c,e,g,h){return h=this.getLayer(h),b=this.game.math.snapToFloor(b,e)/e,c=this.game.math.snapToFloor(c,
g)/g,this.removeTile(b,c,h)},putTile:function(b,d,e,g){if(null===b)return this.removeTile(d,e,g);if(g=this.getLayer(g),0<=d&&d<this.layers[g].width&&0<=e&&e<this.layers[g].height){var h;return b instanceof c.Tile?(h=b.index,this.hasTile(d,e,g)?this.layers[g].data[e][d].copy(b):this.layers[g].data[e][d]=new c.Tile(g,h,d,e,b.width,b.height)):(h=b,this.hasTile(d,e,g)?this.layers[g].data[e][d].index=h:this.layers[g].data[e][d]=new c.Tile(this.layers[g],h,d,e,this.tileWidth,this.tileHeight)),-1<this.collideIndexes.indexOf(h)?
this.layers[g].data[e][d].setCollision(!0,!0,!0,!0):this.layers[g].data[e][d].resetCollision(),this.layers[g].dirty=!0,this.calculateFaces(g),this.layers[g].data[e][d]}return null},putTileWorldXY:function(b,c,e,g,h,f){return f=this.getLayer(f),c=this.game.math.snapToFloor(c,g)/g,e=this.game.math.snapToFloor(e,h)/h,this.putTile(b,c,e,f)},searchTileIndex:function(b,c,e,g){"undefined"==typeof c&&(c=0);"undefined"==typeof e&&(e=!1);g=this.getLayer(g);var h=0;if(e)for(e=this.layers[g].height-1;0<=e;e--)for(var f=
this.layers[g].width-1;0<=f;f--){if(this.layers[g].data[e][f].index===b){if(h===c)return this.layers[g].data[e][f];h++}}else for(e=0;e<this.layers[g].height;e++)for(f=0;f<this.layers[g].width;f++)if(this.layers[g].data[e][f].index===b){if(h===c)return this.layers[g].data[e][f];h++}return null},getTile:function(b,c,e,g){return"undefined"==typeof g&&(g=!1),e=this.getLayer(e),0<=b&&b<this.layers[e].width&&0<=c&&c<this.layers[e].height?-1===this.layers[e].data[c][b].index?g?this.layers[e].data[c][b]:
null:this.layers[e].data[c][b]:null},getTileWorldXY:function(b,c,e,g,h){return"undefined"==typeof e&&(e=this.tileWidth),"undefined"==typeof g&&(g=this.tileHeight),h=this.getLayer(h),b=this.game.math.snapToFloor(b,e)/e,c=this.game.math.snapToFloor(c,g)/g,this.getTile(b,c,h)},copy:function(b,c,e,g,h){if(h=this.getLayer(h),!this.layers[h])return void(this._results.length=0);"undefined"==typeof b&&(b=0);"undefined"==typeof c&&(c=0);"undefined"==typeof e&&(e=this.layers[h].width);"undefined"==typeof g&&
(g=this.layers[h].height);0>b&&(b=0);0>c&&(c=0);e>this.layers[h].width&&(e=this.layers[h].width);g>this.layers[h].height&&(g=this.layers[h].height);this._results.length=0;this._results.push({x:b,y:c,width:e,height:g,layer:h});for(var f=c;c+g>f;f++)for(var k=b;b+e>k;k++)this._results.push(this.layers[h].data[f][k]);return this._results},paste:function(b,c,e,g){if("undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=0),g=this.getLayer(g),e&&!(2>e.length)){b=e[1].x-b;c=e[1].y-c;for(var h=1;h<e.length;h++)this.layers[g].data[c+
e[h].y][b+e[h].x].copy(e[h]);this.layers[g].dirty=!0;this.calculateFaces(g)}},swap:function(b,c,e,g,h,f,k){k=this.getLayer(k);this.copy(e,g,h,f,k);2>this._results.length||(this._tempA=b,this._tempB=c,this._results.forEach(this.swapHandler,this),this.paste(e,g,this._results,k))},swapHandler:function(b){b.index===this._tempA?b.index=this._tempB:b.index===this._tempB&&(b.index=this._tempA)},forEach:function(b,c,e,g,h,f,k){k=this.getLayer(k);this.copy(e,g,h,f,k);2>this._results.length||(this._results.forEach(b,
c),this.paste(e,g,this._results,k))},replace:function(b,c,e,g,h,f,k){if(k=this.getLayer(k),this.copy(e,g,h,f,k),!(2>this._results.length)){for(h=1;h<this._results.length;h++)this._results[h].index===b&&(this._results[h].index=c);this.paste(e,g,this._results,k)}},random:function(b,c,e,g,h){if(h=this.getLayer(h),this.copy(b,c,e,g,h),!(2>this._results.length)){e=[];for(g=1;g<this._results.length;g++)if(this._results[g].index){var f=this._results[g].index;-1===e.indexOf(f)&&e.push(f)}for(g=1;g<this._results.length;g++)this._results[g].index=
this.game.rnd.pick(e);this.paste(b,c,this._results,h)}},shuffle:function(b,d,e,g,h){if(h=this.getLayer(h),this.copy(b,d,e,g,h),!(2>this._results.length)){e=[];for(g=1;g<this._results.length;g++)this._results[g].index&&e.push(this._results[g].index);c.Utils.shuffle(e);for(g=1;g<this._results.length;g++)this._results[g].index=e[g-1];this.paste(b,d,this._results,h)}},fill:function(b,c,e,g,h,f){if(f=this.getLayer(f),this.copy(c,e,g,h,f),!(2>this._results.length)){for(g=1;g<this._results.length;g++)this._results[g].index=
b;this.paste(c,e,this._results,f)}},removeAllLayers:function(){this.currentLayer=this.layers.length=0},dump:function(){for(var b="",c=[""],e=0;e<this.layers[this.currentLayer].height;e++){for(var g=0;g<this.layers[this.currentLayer].width;g++)b+="%c  ",c.push(1<this.layers[this.currentLayer].data[e][g]?this.debugMap[this.layers[this.currentLayer].data[e][g]]?"background: "+this.debugMap[this.layers[this.currentLayer].data[e][g]]:"background: #ffffff":"background: rgb(0, 0, 0)");b+="\n"}c[0]=b;console.log.apply(console,
c)},destroy:function(){this.removeAllLayers();this.data=[];this.game=null}};c.Tilemap.prototype.constructor=c.Tilemap;Object.defineProperty(c.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(b){b!==this.currentLayer&&this.setLayer(b)}});c.TilemapLayer=function(b,d,e,g,h){this.game=b;this.map=d;this.index=e;this.layer=d.layers[e];this.canvas=c.Canvas.create(g,h,"",!0);this.context=this.canvas.getContext("2d");this.baseTexture=new PIXI.BaseTexture(this.canvas);
this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new c.Frame(0,0,0,g,h,"tilemapLayer",b.rnd.uuid());c.Image.call(this,this.game,0,0,this.texture,this.textureFrame);this.name="";this.type=c.TILEMAPLAYER;this.fixedToCamera=!0;this.cameraOffset=new c.Point(0,0);this.tileColor="rgb(255, 255, 255)";this.debug=!1;this.debugAlpha=.5;this.debugColor="rgba(0, 255, 0, 1)";this.debugFill=!1;this.debugFillColor="rgba(0, 255, 0, 0.2)";this.debugCallbackColor="rgba(255, 0, 0, 1)";this.scrollFactorY=
this.scrollFactorX=1;this.dirty=!0;this.rayStepRate=4;this.wrap=!1;this._mc={cw:d.tileWidth,ch:d.tileHeight,ga:1,dx:0,dy:0,dw:0,dh:0,tx:0,ty:0,tw:0,th:0,tl:0,maxX:0,maxY:0,startX:0,startY:0,x:0,y:0,prevX:0,prevY:0};this._results=[];this.updateMax()};c.TilemapLayer.prototype=Object.create(c.Image.prototype);c.TilemapLayer.prototype.constructor=c.TilemapLayer;c.TilemapLayer.prototype.postUpdate=function(){c.Image.prototype.postUpdate.call(this);this.scrollX=this.game.camera.x*this.scrollFactorX;this.scrollY=
this.game.camera.y*this.scrollFactorY;this.render();1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};c.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels,this.layer.heightInPixels)};c.TilemapLayer.prototype._fixX=function(b){return 0>b&&(b=0),1===this.scrollFactorX?b:this._mc.x+(b-this._mc.x/this.scrollFactorX)};
c.TilemapLayer.prototype._unfixX=function(b){return 1===this.scrollFactorX?b:this._mc.x/this.scrollFactorX+(b-this._mc.x)};c.TilemapLayer.prototype._fixY=function(b){return 0>b&&(b=0),1===this.scrollFactorY?b:this._mc.y+(b-this._mc.y/this.scrollFactorY)};c.TilemapLayer.prototype._unfixY=function(b){return 1===this.scrollFactorY?b:this._mc.y/this.scrollFactorY+(b-this._mc.y)};c.TilemapLayer.prototype.getTileX=function(b){return this.game.math.snapToFloor(this._fixX(b),this.map.tileWidth)/this.map.tileWidth};
c.TilemapLayer.prototype.getTileY=function(b){return this.game.math.snapToFloor(this._fixY(b),this.map.tileHeight)/this.map.tileHeight};c.TilemapLayer.prototype.getTileXY=function(b,c,e){return e.x=this.getTileX(b),e.y=this.getTileY(c),e};c.TilemapLayer.prototype.getRayCastTiles=function(b,c,e,g){"undefined"!=typeof c&&null!==c||(c=this.rayStepRate);"undefined"==typeof e&&(e=!1);"undefined"==typeof g&&(g=!1);e=this.getTiles(b.x,b.y,b.width,b.height,e,g);if(0===e.length)return[];b=b.coordinatesOnLine(c);
c=b.length;g=[];for(var h=0;h<e.length;h++)for(var f=0;c>f;f++)if(e[h].containsPoint(b[f][0],b[f][1])){g.push(e[h]);break}return g};c.TilemapLayer.prototype.getTiles=function(b,c,e,g,h,f){"undefined"==typeof h&&(h=!1);"undefined"==typeof f&&(f=!1);b=this._fixX(b);c=this._fixY(c);e>this.layer.widthInPixels&&(e=this.layer.widthInPixels);g>this.layer.heightInPixels&&(g=this.layer.heightInPixels);this._mc.tx=this.game.math.snapToFloor(b,this._mc.cw)/this._mc.cw;this._mc.ty=this.game.math.snapToFloor(c,
this._mc.ch)/this._mc.ch;this._mc.tw=(this.game.math.snapToCeil(e,this._mc.cw)+this._mc.cw)/this._mc.cw;this._mc.th=(this.game.math.snapToCeil(g,this._mc.ch)+this._mc.ch)/this._mc.ch;this._results.length=0;for(b=this._mc.ty;b<this._mc.ty+this._mc.th;b++)for(c=this._mc.tx;c<this._mc.tx+this._mc.tw;c++)this.layer.data[b]&&this.layer.data[b][c]&&(!h&&!f||this.layer.data[b][c].isInteresting(h,f))&&this._results.push(this.layer.data[b][c]);return this._results};c.TilemapLayer.prototype.updateMax=function(){this._mc.maxX=
this.game.math.ceil(this.canvas.width/this.map.tileWidth)+1;this._mc.maxY=this.game.math.ceil(this.canvas.height/this.map.tileHeight)+1;this.dirty=!0};c.TilemapLayer.prototype.render=function(){if(this.layer.dirty&&(this.dirty=!0),this.dirty&&this.visible){this._mc.prevX=this._mc.dx;this._mc.prevY=this._mc.dy;this._mc.dx=-(this._mc.x-this._mc.startX*this.map.tileWidth);this._mc.dy=-(this._mc.y-this._mc.startY*this.map.tileHeight);this._mc.tx=this._mc.dx;this._mc.ty=this._mc.dy;this.context.clearRect(0,
0,this.canvas.width,this.canvas.height);this.context.fillStyle=this.tileColor;var b,c;this.debug&&(this.context.globalAlpha=this.debugAlpha);for(var e=this._mc.startY,g=this._mc.startY+this._mc.maxY;g>e;e++){if(this._column=null,0>e&&this.wrap?this._column=this.layer.data[e+this.map.height]:e>=this.map.height&&this.wrap?this._column=this.layer.data[e-this.map.height]:this.layer.data[e]&&(this._column=this.layer.data[e]),this._column)for(var h=this._mc.startX,f=this._mc.startX+this._mc.maxX;f>h;h++)b=
null,0>h&&this.wrap?b=this._column[h+this.map.width]:h>=this.map.width&&this.wrap?b=this._column[h-this.map.width]:this._column[h]&&(b=this._column[h]),b&&-1<b.index&&(c=this.map.tilesets[this.map.tiles[b.index][2]],!1===this.debug&&b.alpha!==this.context.globalAlpha&&(this.context.globalAlpha=b.alpha),c.draw(this.context,Math.floor(this._mc.tx),Math.floor(this._mc.ty),b.index),b.debug&&(this.context.fillStyle="rgba(0, 255, 0, 0.4)",this.context.fillRect(Math.floor(this._mc.tx),Math.floor(this._mc.ty),
this.map.tileWidth,this.map.tileHeight))),this._mc.tx+=this.map.tileWidth;this._mc.tx=this._mc.dx;this._mc.ty+=this.map.tileHeight}return this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.texture._updateUvs(),this.dirty=!1,this.layer.dirty=!1,!0}};c.TilemapLayer.prototype.renderDebug=function(){this._mc.tx=this._mc.dx;this._mc.ty=this._mc.dy;this.context.strokeStyle=this.debugColor;this.context.fillStyle=this.debugFillColor;for(var b=this._mc.startY,c=this._mc.startY+this._mc.maxY;c>
b;b++){if(this._column=null,0>b&&this.wrap?this._column=this.layer.data[b+this.map.height]:b>=this.map.height&&this.wrap?this._column=this.layer.data[b-this.map.height]:this.layer.data[b]&&(this._column=this.layer.data[b]),this._column)for(var e=this._mc.startX,g=this._mc.startX+this._mc.maxX;g>e;e++){var h=null;0>e&&this.wrap?h=this._column[e+this.map.width]:e>=this.map.width&&this.wrap?h=this._column[e-this.map.width]:this._column[e]&&(h=this._column[e]);h&&(h.faceTop||h.faceBottom||h.faceLeft||
h.faceRight)&&(this._mc.tx=Math.floor(this._mc.tx),this.debugFill&&this.context.fillRect(this._mc.tx,this._mc.ty,this._mc.cw,this._mc.ch),this.context.beginPath(),h.faceTop&&(this.context.moveTo(this._mc.tx,this._mc.ty),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty)),h.faceBottom&&(this.context.moveTo(this._mc.tx,this._mc.ty+this._mc.ch),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty+this._mc.ch)),h.faceLeft&&(this.context.moveTo(this._mc.tx,this._mc.ty),this.context.lineTo(this._mc.tx,
this._mc.ty+this._mc.ch)),h.faceRight&&(this.context.moveTo(this._mc.tx+this._mc.cw,this._mc.ty),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty+this._mc.ch)),this.context.stroke());this._mc.tx+=this.map.tileWidth}this._mc.tx=this._mc.dx;this._mc.ty+=this.map.tileHeight}};Object.defineProperty(c.TilemapLayer.prototype,"scrollX",{get:function(){return this._mc.x},set:function(b){b!==this._mc.x&&(this._mc.x=b,this._mc.startX=this.game.math.floor(this._mc.x/this.map.tileWidth),this.dirty=!0)}});
Object.defineProperty(c.TilemapLayer.prototype,"scrollY",{get:function(){return this._mc.y},set:function(b){b!==this._mc.y&&(this._mc.y=b,this._mc.startY=this.game.math.floor(this._mc.y/this.map.tileHeight),this.dirty=!0)}});Object.defineProperty(c.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(b){this._mc.cw=b;this.dirty=!0}});Object.defineProperty(c.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(b){this._mc.ch=
b;this.dirty=!0}});c.TilemapParser={parse:function(b,d,e,g,h,f){if("undefined"==typeof e&&(e=32),"undefined"==typeof g&&(g=32),"undefined"==typeof h&&(h=10),"undefined"==typeof f&&(f=10),"undefined"==typeof d)return this.getEmptyData();if(null===d)return this.getEmptyData(e,g,h,f);if(b=b.cache.getTilemapData(d)){if(b.format===c.Tilemap.CSV)return this.parseCSV(d,b.data,e,g);if(!b.format||b.format===c.Tilemap.TILED_JSON)return this.parseTiledJSON(b.data)}else console.warn("Phaser.TilemapParser.parse - No map data found for key "+
d)},parseCSV:function(b,d,e,g){var h=this.getEmptyData();d=d.trim();var f=[];d=d.split("\n");for(var k=d.length,m=0,n=0;n<d.length;n++){f[n]=[];for(var p=d[n].split(","),q=0;q<p.length;q++)f[n][q]=new c.Tile(h.layers[0],parseInt(p[q],10),q,n,e,g);0===m&&(m=p.length)}return h.format=c.Tilemap.CSV,h.name=b,h.width=m,h.height=k,h.tileWidth=e,h.tileHeight=g,h.widthInPixels=m*e,h.heightInPixels=k*g,h.layers[0].width=m,h.layers[0].height=k,h.layers[0].widthInPixels=h.widthInPixels,h.layers[0].heightInPixels=
h.heightInPixels,h.layers[0].data=f,h},getEmptyData:function(b,c,e,g){var h={width:0,height:0,tileWidth:0,tileHeight:0};"undefined"!=typeof b&&null!==b&&(h.tileWidth=b);"undefined"!=typeof c&&null!==c&&(h.tileHeight=c);"undefined"!=typeof e&&null!==e&&(h.width=e);"undefined"!=typeof g&&null!==g&&(h.height=g);h.orientation="orthogonal";h.version="1";h.properties={};h.widthInPixels=0;h.heightInPixels=0;b=[];return b.push({name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,
visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]}),h.layers=b,h.images=[],h.objects={},h.collision={},h.tilesets=[],h.tiles=[],h},parseTiledJSON:function(b){function d(b,c){var d={},e;for(e in c){var g=c[e];d[g]=b[g]}return d}if("orthogonal"!==b.orientation)return console.warn("TilemapParser.parseTiledJSON: Only orthogonal map types are supported in this version of Phaser"),null;var e={};e.width=b.width;e.height=b.height;e.tileWidth=b.tilewidth;e.tileHeight=b.tileheight;e.orientation=
b.orientation;e.format=c.Tilemap.TILED_JSON;e.version=b.version;e.properties=b.properties;e.widthInPixels=e.width*e.tileWidth;e.heightInPixels=e.height*e.tileHeight;for(var g=[],h=0;h<b.layers.length;h++)if("tilelayer"===b.layers[h].type){var f={name:b.layers[h].name,x:b.layers[h].x,y:b.layers[h].y,width:b.layers[h].width,height:b.layers[h].height,widthInPixels:b.layers[h].width*b.tilewidth,heightInPixels:b.layers[h].height*b.tileheight,alpha:b.layers[h].opacity,visible:b.layers[h].visible,properties:{},
indexes:[],callbacks:[],bodies:[]};b.layers[h].properties&&(f.properties=b.layers[h].properties);for(var k=0,m=[],n=[],p=0,q=b.layers[h].data.length;q>p;p++)m.push(0<b.layers[h].data[p]?new c.Tile(f,b.layers[h].data[p],k,n.length,b.tilewidth,b.tileheight):new c.Tile(f,-1,k,n.length,b.tilewidth,b.tileheight)),k++,k===b.layers[h].width&&(n.push(m),k=0,m=[]);f.data=n;g.push(f)}e.layers=g;q=[];for(h=0;h<b.layers.length;h++)"imagelayer"===b.layers[h].type&&(k={name:b.layers[h].name,image:b.layers[h].image,
x:b.layers[h].x,y:b.layers[h].y,alpha:b.layers[h].opacity,visible:b.layers[h].visible,properties:{}},b.layers[h].properties&&(k.properties=b.layers[h].properties),q.push(k));e.images=q;q=[];for(h=0;h<b.tilesets.length;h++){var r=b.tilesets[h],k=new c.Tileset(r.name,r.firstgid,r.tilewidth,r.tileheight,r.margin,r.spacing,r.properties);r.tileproperties&&(k.tileProperties=r.tileproperties);k.rows=Math.round((r.imageheight-r.margin)/(r.tileheight+r.spacing));k.columns=Math.round((r.imagewidth-r.margin)/
(r.tilewidth+r.spacing));k.total=k.rows*k.columns;0!==k.rows%1||0!==k.columns%1?console.warn("TileSet image dimensions do not match expected dimensions. Tileset width/height must be evenly divisible by Tilemap tile width/height."):q.push(k)}e.tilesets=q;k={};p={};for(h=0;h<b.layers.length;h++)if("objectgroup"===b.layers[h].type)for(k[b.layers[h].name]=[],p[b.layers[h].name]=[],f=0,q=b.layers[h].objects.length;q>f;f++){if(b.layers[h].objects[f].gid)m={gid:b.layers[h].objects[f].gid,name:b.layers[h].objects[f].name,
x:b.layers[h].objects[f].x,y:b.layers[h].objects[f].y,visible:b.layers[h].objects[f].visible,properties:b.layers[h].objects[f].properties};else if(b.layers[h].objects[f].polyline){m={name:b.layers[h].objects[f].name,type:b.layers[h].objects[f].type,x:b.layers[h].objects[f].x,y:b.layers[h].objects[f].y,width:b.layers[h].objects[f].width,height:b.layers[h].objects[f].height,visible:b.layers[h].objects[f].visible,properties:b.layers[h].objects[f].properties,polyline:[]};for(g=0;g<b.layers[h].objects[f].polyline.length;g++)m.polyline.push([b.layers[h].objects[f].polyline[g].x,
b.layers[h].objects[f].polyline[g].y]);p[b.layers[h].name].push(m)}else if(b.layers[h].objects[f].polygon)for(m=d(b.layers[h].objects[f],"name type x y visible properties".split(" ")),m.polygon=[],g=0;g<b.layers[h].objects[f].polygon.length;g++)m.polygon.push([b.layers[h].objects[f].polygon[g].x,b.layers[h].objects[f].polygon[g].y]);else b.layers[h].objects[f].ellipse?m=d(b.layers[h].objects[f],"name type ellipse x y width height visible properties".split(" ")):(m=d(b.layers[h].objects[f],"name type x y width height visible properties".split(" ")),
m.rectangle=!0);k[b.layers[h].name].push(m)}e.objects=k;e.collision=p;e.tiles=[];for(h=0;h<e.tilesets.length;h++)for(r=e.tilesets[h],b=k=r.tileMargin,m=f=q=0,p=r.firstgid;p<r.firstgid+r.total&&(e.tiles[p]=[k,b,h],k+=r.tileWidth+r.tileSpacing,q++,q!==r.total)&&(f++,f!==r.columns||(k=r.tileMargin,b+=r.tileHeight+r.tileSpacing,f=0,m++,m!==r.rows));p++);for(var t,h=0;h<e.layers.length;h++)for(f=e.layers[h],b=0;b<f.data.length;b++)for(m=f.data[b],q=0;q<m.length;q++)k=m[q],0>k.index||(t=e.tiles[k.index][2],
r=e.tilesets[t],r.tileProperties&&r.tileProperties[k.index-r.firstgid]&&(k.properties=r.tileProperties[k.index-r.firstgid]));return e}};c.Tileset=function(b,c,e,g,h,f,k){("undefined"==typeof e||0>=e)&&(e=32);("undefined"==typeof g||0>=g)&&(g=32);"undefined"==typeof h&&(h=0);"undefined"==typeof f&&(f=0);this.name=b;this.firstgid=c;this.tileWidth=e;this.tileHeight=g;this.tileMargin=h;this.tileSpacing=f;this.properties=k;this.image=null;this.total=this.columns=this.rows=0;this.drawCoords=[]};c.Tileset.prototype=
{draw:function(b,c,e,g){this.image&&this.drawCoords[g]&&b.drawImage(this.image,this.drawCoords[g][0],this.drawCoords[g][1],this.tileWidth,this.tileHeight,c,e,this.tileWidth,this.tileHeight)},setImage:function(b){this.image=b;this.rows=Math.round((b.height-this.tileMargin)/(this.tileHeight+this.tileSpacing));this.columns=Math.round((b.width-this.tileMargin)/(this.tileWidth+this.tileSpacing));this.total=this.rows*this.columns;this.drawCoords.length=0;for(var c=b=this.tileMargin,e=this.firstgid,g=0;g<
this.rows;g++){for(var h=0;h<this.columns;h++)this.drawCoords[e]=[b,c],b+=this.tileWidth+this.tileSpacing,e++;b=this.tileMargin;c+=this.tileHeight+this.tileSpacing}},setSpacing:function(b,c){this.tileMargin=b;this.tileSpacing=c;this.setImage(this.image)}};c.Tileset.prototype.constructor=c.Tileset;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.Phaser=c):"undefined"!=typeof define&&define.amd?define("Phaser",this.Phaser=c):this.Phaser=c}).call(this);
!function(c){"object"==typeof exports?module.exports=c():"function"==typeof define&&define.amd?define("p2",function(){return this.p2=c()}()):"undefined"!=typeof window?window.p2=c():"undefined"!=typeof global?self.p2=c():"undefined"!=typeof self&&(self.p2=c())}(function(){return function f(b,d,e){function g(k,l){if(!d[k]){if(!b[k]){var n="function"==typeof require&&require;if(!l&&n)return n(k,!0);if(h)return h(k,!0);throw Error("Cannot find module '"+k+"'");}n=d[k]={exports:{}};b[k][0].call(n.exports,
function(d){var e=b[k][1][d];return g(e?e:d)},n,n.exports,f,b,d,e)}return d[k].exports}for(var h="function"==typeof require&&require,l=0;l<e.length;l++)g(e[l]);return g}({1:[function(f,b){f=function e(b,h,l){function k(n,q){if(!h[n]){if(!b[n]){var r="function"==typeof f&&f;if(!q&&r)return r(n,!0);if(m)return m(n,!0);throw Error("Cannot find module '"+n+"'");}r=h[n]={exports:{}};b[n][0].call(r.exports,function(e){var h=b[n][1][e];return k(h?h:e)},r,r.exports,e,b,h,l)}return h[n].exports}for(var m=
"function"==typeof f&&f,n=0;n<l.length;n++)k(l[n]);return k}({PcZj9L:[function(b,g,h){function f(b,e){var g=typeof b;if("base64"===e&&"string"===g){var h=b;for(b=h.trim?h.trim():h.replace(/^\s+|\s+$/g,"");0!==b.length%4;)b+="="}if("number"===g)h=da(b);else if("string"===g)h=f.byteLength(b,e);else{if("object"!==g)throw Error("First argument needs to be a number, array or string.");h=da(b.length)}var k=ra(new Ca(h));if(f.isBuffer(b))k.set(b);else{var m=b;if(Array.isArray(m)||f.isBuffer(m)||m&&"object"==
typeof m&&"number"==typeof m.length)for(g=0;h>g;g++)k[g]=f.isBuffer(b)?b.readUInt8(g):b[g];else"string"===g&&k.write(b,0,e)}return k}function k(b,e,g,h){if(isFinite(e))isFinite(g)||(h=g,g=void 0);else{var k=h;h=e;e=g;g=k}e=Number(e)||0;k=this.length-e;switch(g?(g=Number(g),g>k&&(g=k)):g=k,String(h||"utf8").toLowerCase()){case "hex":e=Number(e)||0;h=this.length-e;g?(g=Number(g),g>h&&(g=h)):g=h;h=b.length;if(0!==h%2)throw Error("Invalid hex string");g>h/2&&(g=h/2);for(h=0;g>h;h++){k=parseInt(b.substr(2*
h,2),16);if(isNaN(k))throw Error("Invalid hex string");this[e+h]=k}return f._charsWritten=2*h,h;case "utf8":case "utf-8":return f._charsWritten=X(Y(b),this,e,g);case "ascii":return f._charsWritten=X(ma(b),this,e,g);case "binary":return f._charsWritten=X(ma(b),this,e,g);case "base64":return f._charsWritten=X(sa(b),this,e,g);default:throw Error("Unknown encoding");}}function m(g,h,f){var k=this instanceof I?this._proxy:this;if(g=String(g||"utf8").toLowerCase(),h=Number(h)||0,f=void 0!==f?Number(f):
f=k.length,f===h)return"";switch(g){case "hex":g=h;h=k.length;(!g||0>g)&&(g=0);(!f||0>f||f>h)&&(f=h);for(h="";f>g;g++)h+=ea(k[g]);return h;case "utf8":case "utf-8":k=k.slice(h,f);f=g="";for(h=0;h<k.length;)127>=k[h]?(g+=ta(f)+String.fromCharCode(k[h]),f=""):f+="%"+k[h].toString(16),h++;return g+ta(f);case "ascii":return q(k,h,f);case "binary":return q(k,h,f);case "base64":return k=k.slice(h,f),b("base64-js").fromByteArray(k);default:throw Error("Unknown encoding");}}function n(){return{type:"Buffer",
data:Array.prototype.slice.call(this,0)}}function p(b,e,g,h){if(g||(g=0),h||0===h||(h=this.length),e||(e=0),h!==g&&0!==b.length&&0!==this.length){if(g>h)throw Error("sourceEnd < sourceStart");if(0>e||e>=b.length)throw Error("targetStart out of bounds");if(0>g||g>=this.length)throw Error("sourceStart out of bounds");if(0>h||h>this.length)throw Error("sourceEnd out of bounds");h>this.length&&(h=this.length);b.length-e<h-g&&(h=b.length-e+g);for(var f=0;h-g>f;f++)b[f+e]=this[f+g]}}function q(b,e,g){b=
b.slice(e,g);e="";for(g=0;g<b.length;g++)e+=String.fromCharCode(b[g]);return e}function r(b,e){var g=this.length;return b=na(b,g,0),e=na(e,g,g),ra(this.subarray(b,e))}function t(b,e){return e||(F(void 0!==b&&null!==b,"missing offset"),F(b<this.length,"Trying to read beyond buffer length")),b>=this.length?void 0:this[b]}function w(b,e,g,h){h||(F("boolean"==typeof g,"missing or invalid endian"),F(void 0!==e&&null!==e,"missing offset"),F(e+1<b.length,"Trying to read beyond buffer length"));h=b.length;
if(!(e>=h))return e+1===h?(e=new ca(new fa(2)),e.setUint8(0,b[h-1]),e.getUint16(0,g)):b._dataview.getUint16(e,g)}function v(b,e){return w(this,b,!0,e)}function u(b,e){return w(this,b,!1,e)}function y(b,e,g,h){h||(F("boolean"==typeof g,"missing or invalid endian"),F(void 0!==e&&null!==e,"missing offset"),F(e+3<b.length,"Trying to read beyond buffer length"));h=b.length;if(!(e>=h)){if(e+3>=h){for(var f=new ca(new fa(4)),k=0;h>k+e;k++)f.setUint8(k,b[k+e]);return f.getUint32(0,g)}return b._dataview.getUint32(e,
g)}}function C(b,e){return y(this,b,!0,e)}function x(b,e){return y(this,b,!1,e)}function B(b,e){return e||(F(void 0!==b&&null!==b,"missing offset"),F(b<this.length,"Trying to read beyond buffer length")),b>=this.length?void 0:this._dataview.getInt8(b)}function E(b,e,g,h){h||(F("boolean"==typeof g,"missing or invalid endian"),F(void 0!==e&&null!==e,"missing offset"),F(e+1<b.length,"Trying to read beyond buffer length"));h=b.length;if(!(e>=h))return e+1===h?(e=new ca(new fa(2)),e.setUint8(0,b[h-1]),
e.getInt16(0,g)):b._dataview.getInt16(e,g)}function z(b,e){return E(this,b,!0,e)}function G(b,e){return E(this,b,!1,e)}function J(b,e,g,h){h||(F("boolean"==typeof g,"missing or invalid endian"),F(void 0!==e&&null!==e,"missing offset"),F(e+3<b.length,"Trying to read beyond buffer length"));h=b.length;if(!(e>=h)){if(e+3>=h){for(var f=new ca(new fa(4)),k=0;h>k+e;k++)f.setUint8(k,b[k+e]);return f.getInt32(0,g)}return b._dataview.getInt32(e,g)}}function K(b,e){return J(this,b,!0,e)}function M(b,e){return J(this,
b,!1,e)}function H(b,e,g,h){return h||(F("boolean"==typeof g,"missing or invalid endian"),F(e+3<b.length,"Trying to read beyond buffer length")),b._dataview.getFloat32(e,g)}function L(b,e){return H(this,b,!0,e)}function P(b,e){return H(this,b,!1,e)}function D(b,e,g,h){return h||(F("boolean"==typeof g,"missing or invalid endian"),F(e+7<b.length,"Trying to read beyond buffer length")),b._dataview.getFloat64(e,g)}function O(b,e){return D(this,b,!0,e)}function N(b,e){return D(this,b,!1,e)}function S(b,
e,g){g||(F(void 0!==b&&null!==b,"missing value"),F(void 0!==e&&null!==e,"missing offset"),F(e<this.length,"trying to write beyond buffer length"),ga(b,255));e>=this.length||(this[e]=b)}function aa(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+1<b.length,"trying to write beyond buffer length"),ga(e,65535));f=b.length;g>=f||(g+1===f?(f=new ca(new fa(2)),f.setUint16(0,e,h),b[g]=f.getUint8(0)):b._dataview.setUint16(g,
e,h))}function T(b,e,g){aa(this,b,e,!0,g)}function Q(b,e,g){aa(this,b,e,!1,g)}function U(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+3<b.length,"trying to write beyond buffer length"),ga(e,4294967295));f=b.length;if(!(g>=f))if(g+3>=f){var k=new ca(new fa(4));k.setUint32(0,e,h);for(e=0;f>e+g;e++)b[e+g]=k.getUint8(e)}else b._dataview.setUint32(g,e,h)}function ha(b,e,g){U(this,b,e,!0,g)}function R(b,
e,g){U(this,b,e,!1,g)}function V(b,e,g){g||(F(void 0!==b&&null!==b,"missing value"),F(void 0!==e&&null!==e,"missing offset"),F(e<this.length,"Trying to write beyond buffer length"),ia(b,127,-128));e>=this.length||this._dataview.setInt8(e,b)}function ja(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+1<b.length,"Trying to write beyond buffer length"),ia(e,32767,-32768));f=b.length;g>=f||(g+1===f?
(f=new ca(new fa(2)),f.setInt16(0,e,h),b[g]=f.getUint8(0)):b._dataview.setInt16(g,e,h))}function oa(b,e,g){ja(this,b,e,!0,g)}function ya(b,e,g){ja(this,b,e,!1,g)}function za(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+3<b.length,"Trying to write beyond buffer length"),ia(e,2147483647,-2147483648));f=b.length;if(!(g>=f))if(g+3>=f){var k=new ca(new fa(4));k.setInt32(0,e,h);for(e=0;f>e+g;e++)b[e+
g]=k.getUint8(e)}else b._dataview.setInt32(g,e,h)}function A(b,e,g){za(this,b,e,!0,g)}function Aa(b,e,g){za(this,b,e,!1,g)}function qa(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+3<b.length,"Trying to write beyond buffer length"),pa(e,3.4028234663852886E38,-3.4028234663852886E38));f=b.length;if(!(g>=f))if(g+3>=f){var k=new ca(new fa(4));k.setFloat32(0,e,h);for(e=0;f>e+g;e++)b[e+g]=k.getUint8(e)}else b._dataview.setFloat32(g,
e,h)}function ka(b,e,g){qa(this,b,e,!0,g)}function la(b,e,g){qa(this,b,e,!1,g)}function ua(b,e,g,h,f){f||(F(void 0!==e&&null!==e,"missing value"),F("boolean"==typeof h,"missing or invalid endian"),F(void 0!==g&&null!==g,"missing offset"),F(g+7<b.length,"Trying to write beyond buffer length"),pa(e,1.7976931348623157E308,-1.7976931348623157E308));f=b.length;if(!(g>=f))if(g+7>=f){var k=new ca(new fa(8));k.setFloat64(0,e,h);for(e=0;f>e+g;e++)b[e+g]=k.getUint8(e)}else b._dataview.setFloat64(g,e,h)}function va(b,
e,g){ua(this,b,e,!0,g)}function wa(b,e,g){ua(this,b,e,!1,g)}function xa(b,e,g){if(b||(b=0),e||(e=0),g||(g=this.length),"string"==typeof b&&(b=b.charCodeAt(0)),"number"!=typeof b||isNaN(b))throw Error("value is not a number");if(e>g)throw Error("end < start");if(g!==e&&0!==this.length){if(0>e||e>=this.length)throw Error("start out of bounds");if(0>g||g>this.length)throw Error("end out of bounds");for(;g>e;e++)this[e]=b}}function W(){for(var b=[],e=this.length,g=0;e>g;g++)if(b[g]=ea(this[g]),g===h.INSPECT_MAX_BYTES){b[g+
1]="...";break}return"<Buffer "+b.join(" ")+">"}function Z(){return(new f(this)).buffer}function ba(){var b=new Ca(0);b.foo=function(){return 42};try{return 42===b.foo()}catch(e){return!1}}function I(b){this._arr=b;0!==b.byteLength&&(this._dataview=new ca(b.buffer,b.byteOffset,b.byteLength))}function ra(b){if(void 0===Ba&&(Ba=ba()),Ba)return b.write=k,b.toString=m,b.toLocaleString=m,b.toJSON=n,b.copy=p,b.slice=r,b.readUInt8=t,b.readUInt16LE=v,b.readUInt16BE=u,b.readUInt32LE=C,b.readUInt32BE=x,b.readInt8=
B,b.readInt16LE=z,b.readInt16BE=G,b.readInt32LE=K,b.readInt32BE=M,b.readFloatLE=L,b.readFloatBE=P,b.readDoubleLE=O,b.readDoubleBE=N,b.writeUInt8=S,b.writeUInt16LE=T,b.writeUInt16BE=Q,b.writeUInt32LE=ha,b.writeUInt32BE=R,b.writeInt8=V,b.writeInt16LE=oa,b.writeInt16BE=ya,b.writeInt32LE=A,b.writeInt32BE=Aa,b.writeFloatLE=ka,b.writeFloatBE=la,b.writeDoubleLE=va,b.writeDoubleBE=wa,b.fill=xa,b.inspect=W,b.toArrayBuffer=Z,b._isBuffer=!0,0!==b.byteLength&&(b._dataview=new ca(b.buffer,b.byteOffset,b.byteLength)),
b;b=new I(b);var e=new Proxy(b,Da);return b._proxy=e,e}function na(b,e,g){return"number"!=typeof b?g:(b=~~b,b>=e?e:0<=b?b:(b+=e,0<=b?b:0))}function da(b){return b=~~Math.ceil(+b),0>b?0:b}function ea(b){return 16>b?"0"+b.toString(16):b.toString(16)}function Y(b){for(var e=[],g=0;g<b.length;g++)if(127>=b.charCodeAt(g))e.push(b.charCodeAt(g));else for(var h=encodeURIComponent(b.charAt(g)).substr(1).split("%"),f=0;f<h.length;f++)e.push(parseInt(h[f],16));return e}function ma(b){for(var e=[],g=0;g<b.length;g++)e.push(255&
b.charCodeAt(g));return e}function sa(g){return b("base64-js").toByteArray(g)}function X(b,e,g,h){for(var f=0;h>f&&!(f+g>=e.length||f>=b.length);)e[f+g]=b[f],f++;return f}function ta(b){try{return decodeURIComponent(b)}catch(e){return String.fromCharCode(65533)}}function ga(b,e){F("number"==typeof b,"cannot write a non-number as a number");F(0<=b,"specified a negative value for writing an unsigned value");F(e>=b,"value is larger than maximum value for type");F(Math.floor(b)===b,"value has a fractional component")}
function ia(b,e,g){F("number"==typeof b,"cannot write a non-number as a number");F(e>=b,"value larger than maximum allowed value");F(b>=g,"value smaller than minimum allowed value");F(Math.floor(b)===b,"value has a fractional component")}function pa(b,e,g){F("number"==typeof b,"cannot write a non-number as a number");F(e>=b,"value larger than maximum allowed value");F(b>=g,"value smaller than minimum allowed value")}function F(b,e){if(!b)throw Error(e||"Failed assertion");}g=b("typedarray");var ca=
"undefined"==typeof DataView?g.DataView:DataView,fa="undefined"==typeof ArrayBuffer?g.ArrayBuffer:ArrayBuffer,Ca="undefined"==typeof Uint8Array?g.Uint8Array:Uint8Array;h.Buffer=f;h.SlowBuffer=f;h.INSPECT_MAX_BYTES=50;f.poolSize=8192;var Ba;f.isEncoding=function(b){switch((b+"").toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":case "raw":return!0;default:return!1}};f.isBuffer=function(b){return b&&b._isBuffer};
f.byteLength=function(b,e){switch(e||"utf8"){case "hex":return b.length/2;case "utf8":case "utf-8":return Y(b).length;case "ascii":case "binary":return b.length;case "base64":return sa(b).length;default:throw Error("Unknown encoding");}};f.concat=function(b,e){if(!Array.isArray(b))throw Error("Usage: Buffer.concat(list, [totalLength])\nlist should be an Array.");var g,h;if(0===b.length)return new f(0);if(1===b.length)return b[0];if("number"!=typeof e)for(g=e=0;g<b.length;g++)h=b[g],e+=h.length;var k=
new f(e),m=0;for(g=0;g<b.length;g++)h=b[g],h.copy(k,m),m+=h.length;return k};I.prototype.write=k;I.prototype.toString=m;I.prototype.toLocaleString=m;I.prototype.toJSON=n;I.prototype.copy=p;I.prototype.slice=r;I.prototype.readUInt8=t;I.prototype.readUInt16LE=v;I.prototype.readUInt16BE=u;I.prototype.readUInt32LE=C;I.prototype.readUInt32BE=x;I.prototype.readInt8=B;I.prototype.readInt16LE=z;I.prototype.readInt16BE=G;I.prototype.readInt32LE=K;I.prototype.readInt32BE=M;I.prototype.readFloatLE=L;I.prototype.readFloatBE=
P;I.prototype.readDoubleLE=O;I.prototype.readDoubleBE=N;I.prototype.writeUInt8=S;I.prototype.writeUInt16LE=T;I.prototype.writeUInt16BE=Q;I.prototype.writeUInt32LE=ha;I.prototype.writeUInt32BE=R;I.prototype.writeInt8=V;I.prototype.writeInt16LE=oa;I.prototype.writeInt16BE=ya;I.prototype.writeInt32LE=A;I.prototype.writeInt32BE=Aa;I.prototype.writeFloatLE=ka;I.prototype.writeFloatBE=la;I.prototype.writeDoubleLE=va;I.prototype.writeDoubleBE=wa;I.prototype.fill=xa;I.prototype.inspect=W;I.prototype.toArrayBuffer=
Z;I.prototype._isBuffer=!0;I.prototype.subarray=function(){return this._arr.subarray.apply(this._arr,arguments)};I.prototype.set=function(){return this._arr.set.apply(this._arr,arguments)};var Da={get:function(b,e){return e in b?b[e]:b._arr[e]},set:function(b,e,g){b._arr[e]=g}}},{"base64-js":3,typedarray:4}],"native-buffer-browserify":[function(b,g){g.exports=b("PcZj9L")},{}],3:[function(b,g){!function(){g.exports.toByteArray=function(b){var e,g,f,n,p;if(0<b.length%4)throw"Invalid string. Length must be a multiple of 4";
n=b.indexOf("=");n=0<n?b.length-n:0;p=[];g=0<n?b.length-4:b.length;for(e=0;g>e;e+=4)f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e])<<18|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+1])<<12|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+2])<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+3]),p.push((16711680&f)>>16),p.push((65280&f)>>8),p.push(255&f);return 2===n?(f=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e])<<2|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+1])>>4,p.push(255&f)):1===n&&(f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e])<<10|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+1])<<4|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[e+2])>>2,p.push(f>>8&255),p.push(255&f)),p};g.exports.fromByteArray=
function(b){var e,g,f,n=b.length%3,p="";e=0;for(f=b.length-n;f>e;e+=3)g=(b[e]<<16)+(b[e+1]<<8)+b[e+2],p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>18&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&g];switch(n){case 1:g=b[b.length-1];p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>
2];p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g<<4&63];p+="==";break;case 2:g=(b[b.length-2]<<8)+b[b.length-1],p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>10],p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>4&63],p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g<<2&63],p+="="}return p}}()},{}],4:[function(b,g,h){function f(b){if(R&&ha){var e,g=R(b);for(e=0;e<g.length;e+=1)ha(b,g[e],{value:b[g[e]],
writable:!1,enumerable:!1,configurable:!1})}}function k(b){function e(g){ha(b,g,{get:function(){return b._getter(g)},set:function(e){b._setter(g,e)},enumerable:!0,configurable:!1})}if(ha){if(b.length>P)throw new RangeError("Array too large for polyfill");var g;for(g=0;g<b.length;g+=1)e(g)}}function m(b,e){var g=32-e;return b<<g>>g}function n(b,e){var g=32-e;return b<<g>>>g}function p(b){return[255&b]}function q(b){return m(b[0],8)}function r(b){return[255&b]}function t(b){return n(b[0],8)}function w(b){return b=
U(Number(b)),[0>b?0:255<b?255:255&b]}function v(b){return[b>>8&255,255&b]}function u(b){return m(b[0]<<8|b[1],16)}function y(b){return[b>>8&255,255&b]}function C(b){return n(b[0]<<8|b[1],16)}function x(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]}function B(b){return m(b[0]<<24|b[1]<<16|b[2]<<8|b[3],32)}function E(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]}function z(b){return n(b[0]<<24|b[1]<<16|b[2]<<8|b[3],32)}function G(b,e,g){function h(b){var e=S(b);b-=e;return.5>b?e:.5<b?e+1:e%2?e+1:e}
var f,k,l,m=(1<<e-1)-1;b!==b?(k=(1<<e)-1,l=Q(2,g-1),f=0):1/0===b||b===-1/0?(k=(1<<e)-1,l=0,f=0>b?1:0):0===b?(k=0,l=0,f=1/b===-1/0?1:0):(f=0>b,b=N(b),b>=Q(2,1-m)?(k=T(S(aa(b)/O),1023),l=h(b/Q(2,k)*Q(2,g)),2<=l/Q(2,g)&&(k+=1,l=1),k>m?(k=(1<<e)-1,l=0):(k+=m,l-=Q(2,g))):(k=0,l=h(b/Q(2,1-m-g))));for(b=[];g;--g)b.push(l%2?1:0),l=S(l/2);for(g=e;g;--g)b.push(k%2?1:0),k=S(k/2);b.push(f?1:0);b.reverse();e=b.join("");for(f=[];e.length;)f.push(parseInt(e.substring(0,8),2)),e=e.substring(8);return f}function J(b,
e,g){var h,f,k,l,m,n,p,q,r=[];for(h=b.length;h;--h)for(k=b[h-1],f=8;f;--f)r.push(k%2?1:0),k>>=1;return r.reverse(),l=r.join(""),m=(1<<e-1)-1,n=parseInt(l.substring(0,1),2)?-1:1,p=parseInt(l.substring(1,1+e),2),q=parseInt(l.substring(1+e),2),p===(1<<e)-1?0!==q?0/0:1/0*n:0<p?n*Q(2,p-m)*(1+q/Q(2,g)):0!==q?n*Q(2,-(m-1))*(q/Q(2,g)):0>n?-0:0}function K(b){return J(b,11,52)}function M(b){return G(b,11,52)}function H(b){return J(b,8,23)}function L(b){return G(b,8,23)}var P=1E5,D=function(){var b=Object.prototype.toString,
e=Object.prototype.hasOwnProperty;return{Class:function(e){return b.call(e).replace(/^\[object *|\]$/g,"")},HasProperty:function(b,e){return e in b},HasOwnProperty:function(b,g){return e.call(b,g)},IsCallable:function(b){return"function"==typeof b},ToInt32:function(b){return b>>0},ToUint32:function(b){return b>>>0}}}(),O=Math.LN2,N=Math.abs,S=Math.floor,aa=Math.log,T=Math.min,Q=Math.pow,U=Math.round,ha=Object.defineProperty||function(b,e,g){if(!b===Object(b))throw new TypeError("Object.defineProperty called on non-object");
return D.HasProperty(g,"get")&&Object.prototype.__defineGetter__&&Object.prototype.__defineGetter__.call(b,e,g.get),D.HasProperty(g,"set")&&Object.prototype.__defineSetter__&&Object.prototype.__defineSetter__.call(b,e,g.set),D.HasProperty(g,"value")&&(b[e]=g.value),b},R=Object.getOwnPropertyNames||function(b){if(b!==Object(b))throw new TypeError("Object.getOwnPropertyNames called on non-object");var e,g=[];for(e in b)D.HasOwnProperty(b,e)&&g.push(e);return g};!function(){function b(h,m,n){var p;return p=
function(b,g,h){var m,n,q;if(arguments.length&&"number"!=typeof arguments[0])if("object"==typeof arguments[0]&&arguments[0].constructor===p)for(m=arguments[0],this.length=m.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),n=this.byteOffset=0;n<this.length;n+=1)this._setter(n,m._getter(n));else if("object"!=typeof arguments[0]||arguments[0]instanceof e||"ArrayBuffer"===D.Class(arguments[0])){if("object"!=typeof arguments[0]||!(arguments[0]instanceof e||"ArrayBuffer"===
D.Class(arguments[0])))throw new TypeError("Unexpected argument type(s)");if(this.buffer=b,this.byteOffset=D.ToUint32(g),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");if(3>arguments.length){if(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT)throw new RangeError("length of buffer minus byteOffset not a multiple of the element size");
this.length=this.byteLength/this.BYTES_PER_ELEMENT}else this.length=D.ToUint32(h),this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");}else for(m=arguments[0],this.length=D.ToUint32(m.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),n=this.byteOffset=0;n<this.length;n+=1)q=m[n],this._setter(n,Number(q));else{if(this.length=
D.ToInt32(arguments[0]),0>h)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT;this.buffer=new e(this.byteLength);this.byteOffset=0}this.constructor=p;f(this);k(this)},p.prototype=new g,p.prototype.BYTES_PER_ELEMENT=h,p.prototype._pack=m,p.prototype._unpack=n,p.BYTES_PER_ELEMENT=h,p.prototype._getter=function(b){if(1>arguments.length)throw new SyntaxError("Not enough arguments");if(!(b=D.ToUint32(b),b>=this.length)){var e,
g,h=[];e=0;for(g=this.byteOffset+b*this.BYTES_PER_ELEMENT;e<this.BYTES_PER_ELEMENT;e+=1,g+=1)h.push(this.buffer._bytes[g]);return this._unpack(h)}},p.prototype.get=p.prototype._getter,p.prototype._setter=function(b,e){if(2>arguments.length)throw new SyntaxError("Not enough arguments");if(!(b=D.ToUint32(b),b>=this.length)){var g,h,f=this._pack(e);g=0;for(h=this.byteOffset+b*this.BYTES_PER_ELEMENT;g<this.BYTES_PER_ELEMENT;g+=1,h+=1)this.buffer._bytes[h]=f[g]}},p.prototype.set=function(){if(1>arguments.length)throw new SyntaxError("Not enough arguments");
var b,e,g,h,f,k;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(b=arguments[0],g=D.ToUint32(arguments[1]),g+b.length>this.length)throw new RangeError("Offset plus length of array is out of range");if(h=this.byteOffset+g*this.BYTES_PER_ELEMENT,e=b.length*this.BYTES_PER_ELEMENT,b.buffer===this.buffer){g=[];f=0;for(k=b.byteOffset;e>f;f+=1,k+=1)g[f]=b.buffer._bytes[k];for(f=0;e>f;f+=1,h+=1)this.buffer._bytes[h]=g[f]}else for(f=0,k=b.byteOffset;e>f;f+=1,k+=1,h+=1)this.buffer._bytes[h]=
b.buffer._bytes[k]}else{if("object"!=typeof arguments[0]||"undefined"==typeof arguments[0].length)throw new TypeError("Unexpected argument type(s)");if(e=arguments[0],h=D.ToUint32(e.length),g=D.ToUint32(arguments[1]),g+h>this.length)throw new RangeError("Offset plus length of array is out of range");for(f=0;h>f;f+=1)k=e[f],this._setter(g+f,Number(k))}},p.prototype.subarray=function(b,e){b=D.ToInt32(b);e=D.ToInt32(e);1>arguments.length&&(b=0);2>arguments.length&&(e=this.length);0>b&&(b=this.length+
b);0>e&&(e=this.length+e);var g=this.length;b=0>b?0:b>g?g:b;g=this.length;g=(0>e?0:e>g?g:e)-b;return 0>g&&(g=0),new this.constructor(this.buffer,this.byteOffset+b*this.BYTES_PER_ELEMENT,g)},p}var e=function(b){if(b=D.ToInt32(b),0>b)throw new RangeError("ArrayBuffer size is not a small enough positive integer");this.byteLength=b;this._bytes=[];this._bytes.length=b;for(b=0;b<this.byteLength;b+=1)this._bytes[b]=0;f(this)};h.ArrayBuffer=h.ArrayBuffer||e;var g=function(){},m=b(1,p,q),n=b(1,r,t),O=b(1,
w,t),N=b(2,v,u),T=b(2,y,C),G=b(4,x,B),S=b(4,E,z),aa=b(4,L,H),R=b(8,M,K);h.Int8Array=h.Int8Array||m;h.Uint8Array=h.Uint8Array||n;h.Uint8ClampedArray=h.Uint8ClampedArray||O;h.Int16Array=h.Int16Array||N;h.Uint16Array=h.Uint16Array||T;h.Int32Array=h.Int32Array||G;h.Uint32Array=h.Uint32Array||S;h.Float32Array=h.Float32Array||aa;h.Float64Array=h.Float64Array||R}();(function(){function b(e,g){return D.IsCallable(e.get)?e.get(g):e[g]}function e(g){return function(e,h){if(e=D.ToUint32(e),e+g.BYTES_PER_ELEMENT>
this.byteLength)throw new RangeError("Array index out of range");e+=this.byteOffset;var f,l=new Uint8Array(this.buffer,e,g.BYTES_PER_ELEMENT),m=[];for(f=0;f<g.BYTES_PER_ELEMENT;f+=1)m.push(b(l,f));return Boolean(h)===Boolean(k)&&m.reverse(),b(new g((new Uint8Array(m)).buffer),0)}}function g(e){return function(g,h,f){if(g=D.ToUint32(g),g+e.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");h=new e([h]);var l=new Uint8Array(h.buffer),m=[];for(h=0;h<e.BYTES_PER_ELEMENT;h+=
1)m.push(b(l,h));Boolean(f)===Boolean(k)&&m.reverse();(new Uint8Array(this.buffer,g,e.BYTES_PER_ELEMENT)).set(m)}}var k=function(){var e=new h.Uint16Array([4660]),e=new h.Uint8Array(e.buffer);return 18===b(e,0)}(),m=function(b,e,g){if(0===arguments.length)b=new ArrayBuffer(0);else if(!(b instanceof ArrayBuffer||"ArrayBuffer"===D.Class(b)))throw new TypeError("TypeError");if(this.buffer=b||new ArrayBuffer(0),this.byteOffset=D.ToUint32(e),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");
if(this.byteLength=3>arguments.length?this.buffer.byteLength-this.byteOffset:D.ToUint32(g),this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");f(this)};m.prototype.getUint8=e(h.Uint8Array);m.prototype.getInt8=e(h.Int8Array);m.prototype.getUint16=e(h.Uint16Array);m.prototype.getInt16=e(h.Int16Array);m.prototype.getUint32=e(h.Uint32Array);m.prototype.getInt32=e(h.Int32Array);m.prototype.getFloat32=e(h.Float32Array);
m.prototype.getFloat64=e(h.Float64Array);m.prototype.setUint8=g(h.Uint8Array);m.prototype.setInt8=g(h.Int8Array);m.prototype.setUint16=g(h.Uint16Array);m.prototype.setInt16=g(h.Int16Array);m.prototype.setUint32=g(h.Uint32Array);m.prototype.setInt32=g(h.Int32Array);m.prototype.setFloat32=g(h.Float32Array);m.prototype.setFloat64=g(h.Float64Array);h.DataView=h.DataView||m})()},{}]},{},[]);b.exports=f("native-buffer-browserify").Buffer},{}],2:[function(f,b){var d=b.exports={};d.nextTick=function(){if("undefined"!=
typeof window&&window.setImmediate)return function(b){return window.setImmediate(b)};if("undefined"!=typeof window&&window.postMessage&&window.addEventListener){var b=[];return window.addEventListener("message",function(d){d.source===window&&"process-tick"===d.data&&(d.stopPropagation(),0<b.length)&&b.shift()()},!0),function(d){b.push(d);window.postMessage("process-tick","*")}}return function(b){setTimeout(b,0)}}();d.title="browser";d.browser=!0;d.env={};d.argv=[];d.binding=function(){throw Error("process.binding is not supported");
};d.cwd=function(){return"/"};d.chdir=function(){throw Error("process.chdir is not supported");}},{}],3:[function(f,b){function d(){}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Scalar"));b.exports=d;d.lineInt=function(b,d,f){var k,m,n,p,q,r,t,w=[0,0];return k=b[1][1]-b[0][1],m=b[0][0]-b[1][0],n=k*b[0][0]+m*b[0][1],p=d[1][1]-d[0][1],q=d[0][0]-d[1][0],r=p*d[0][0]+q*d[0][1],t=k*q-p*m,e.eq(t,0,f||0)||(w[0]=(q*n-m*r)/t,w[1]=(k*r-p*n)/t),w};d.segmentsIntersect=function(b,d,e,f){var m=
d[0]-b[0];d=d[1]-b[1];var n=f[0]-e[0],p=f[1]-e[1];if(0==n*d-p*m)return!1;f=(m*(e[1]-b[1])+d*(b[0]-e[0]))/(n*d-p*m);b=(n*(b[1]-e[1])+p*(e[0]-b[0]))/(p*m-n*d);return 0<=f&&1>=f&&0<=b&&1>=b}},{"./Scalar":6,__browserify_Buffer:1,__browserify_process:2}],4:[function(f,b){function d(){}f("__browserify_process");f("__browserify_Buffer");b.exports=d;d.area=function(b,d,e){return(d[0]-b[0])*(e[1]-b[1])-(e[0]-b[0])*(d[1]-b[1])};d.left=function(b,e,g){return 0<d.area(b,e,g)};d.leftOn=function(b,e,g){return 0<=
d.area(b,e,g)};d.right=function(b,e,g){return 0>d.area(b,e,g)};d.rightOn=function(b,e,g){return 0>=d.area(b,e,g)};var e=[],g=[];d.collinear=function(b,f,k,m){return m?(e[0]=f[0]-b[0],e[1]=f[1]-b[1],g[0]=k[0]-f[0],g[1]=k[1]-f[1],b=e[0]*g[0]+e[1]*g[1],f=Math.sqrt(e[0]*e[0]+e[1]*e[1]),k=Math.sqrt(g[0]*g[0]+g[1]*g[1]),b=Math.acos(b/(f*k)),m>b):0==d.area(b,f,k)};d.sqdist=function(b,d){var e=d[0]-b[0],g=d[1]-b[1];return e*e+g*g}},{__browserify_Buffer:1,__browserify_process:2}],5:[function(f,b){function d(){this.vertices=
[]}function e(b,d,e,g,h){var f=d[1]-b[1];d=b[0]-d[0];b=f*b[0]+d*b[1];var k=g[1]-e[1];g=e[0]-g[0];e=k*e[0]+g*e[1];var m=f*g-k*d;return l.eq(m,0,h||0)?[0,0]:[(g*b-d*e)/m,(f*e-k*b)/m]}var g=(f("__browserify_process"),f("__browserify_Buffer"),f("./Line")),h=f("./Point"),l=f("./Scalar");b.exports=d;d.prototype.at=function(b){var d=this.vertices,e=d.length;return d[0>b?b%e+e:b%e]};d.prototype.first=function(){return this.vertices[0]};d.prototype.last=function(){return this.vertices[this.vertices.length-
1]};d.prototype.clear=function(){this.vertices.length=0};d.prototype.append=function(b,d,e){if("undefined"==typeof d)throw Error("From is not given!");if("undefined"==typeof e)throw Error("To is not given!");if(d>e-1)throw Error("lol1");if(e>b.vertices.length)throw Error("lol2");if(0>d)throw Error("lol3");for(;e>d;d++)this.vertices.push(b.vertices[d])};d.prototype.makeCCW=function(){for(var b=0,d=this.vertices,e=1;e<this.vertices.length;++e)(d[e][1]<d[b][1]||d[e][1]==d[b][1]&&d[e][0]>d[b][0])&&(b=
e);h.left(this.at(b-1),this.at(b),this.at(b+1))||this.reverse()};d.prototype.reverse=function(){for(var b=[],d=0,e=this.vertices.length;d!==e;d++)b.push(this.vertices.pop());this.vertices=b};d.prototype.isReflex=function(b){return h.right(this.at(b-1),this.at(b),this.at(b+1))};var k=[],m=[];d.prototype.canSee=function(b,d){var e,f;if(h.leftOn(this.at(b+1),this.at(b),this.at(d))&&h.rightOn(this.at(b-1),this.at(b),this.at(d)))return!1;f=h.sqdist(this.at(b),this.at(d));for(var l=0;l!==this.vertices.length;++l)if((l+
1)%this.vertices.length!==b&&l!==b&&h.leftOn(this.at(b),this.at(d),this.at(l+1))&&h.rightOn(this.at(b),this.at(d),this.at(l))&&(k[0]=this.at(b),k[1]=this.at(d),m[0]=this.at(l),m[1]=this.at(l+1),e=g.lineInt(k,m),h.sqdist(this.at(b),e)<f))return!1;return!0};d.prototype.copy=function(b,e,g){g=g||new d;if(g.clear(),e>b)for(var h=b;e>=h;h++)g.vertices.push(this.vertices[h]);else{for(h=0;e>=h;h++)g.vertices.push(this.vertices[h]);for(h=b;h<this.vertices.length;h++)g.vertices.push(this.vertices[h])}return g};
d.prototype.getCutEdges=function(){for(var b=[],e=[],g=[],h=new d,f=Number.MAX_VALUE,k=0;k<this.vertices.length;++k)if(this.isReflex(k))for(var l=0;l<this.vertices.length;++l)if(this.canSee(k,l)){for(var e=this.copy(k,l,h).getCutEdges(),g=this.copy(l,k,h).getCutEdges(),m=0;m<g.length;m++)e.push(g[m]);e.length<f&&(b=e,f=e.length,b.push([this.at(k),this.at(l)]))}return b};d.prototype.decomp=function(){var b=this.getCutEdges();return 0<b.length?this.slice(b):[this]};d.prototype.slice=function(b){if(0==
b.length)return[this];if(b instanceof Array&&b.length&&b[0]instanceof Array&&2==b[0].length&&b[0][0]instanceof Array){for(var d=[this],e=0;e<b.length;e++)for(var g=b[e],h=0;h<d.length;h++){var f=d[h].slice(g);if(f){d.splice(h,1);d.push(f[0],f[1]);break}}return d}g=b;e=this.vertices.indexOf(g[0]);h=this.vertices.indexOf(g[1]);return-1!=e&&-1!=h?[this.copy(e,h),this.copy(h,e)]:!1};d.prototype.isSimple=function(){for(var b=this.vertices,d=0;d<b.length-1;d++)for(var e=0;d-1>e;e++)if(g.segmentsIntersect(b[d],
b[d+1],b[e],b[e+1]))return!1;for(d=1;d<b.length-2;d++)if(g.segmentsIntersect(b[0],b[b.length-1],b[d],b[d+1]))return!1;return!0};d.prototype.quickDecomp=function(b,g,f,k,l,m){l=l||100;m=m||0;k=k||25;b="undefined"!=typeof b?b:[];g=g||[];f=f||[];var v=[0,0],u=[0,0],y=[0,0],C=0,x=0,B=0,E=C=0,z=0,G=0,J=new d,K=new d,M=this.vertices;if(3>M.length)return b;if(m++,m>l)return console.warn("quickDecomp: max level ("+l+") reached."),b;for(var H=0;H<this.vertices.length;++H)if(this.isReflex(H)){g.push(this.vertices[H]);
for(var C=x=Number.MAX_VALUE,L=0;L<this.vertices.length;++L)h.left(this.at(H-1),this.at(H),this.at(L))&&h.rightOn(this.at(H-1),this.at(H),this.at(L-1))&&(y=e(this.at(H-1),this.at(H),this.at(L),this.at(L-1)),h.right(this.at(H+1),this.at(H),y)&&(B=h.sqdist(this.vertices[H],y),x>B&&(x=B,u=y,z=L))),h.left(this.at(H+1),this.at(H),this.at(L+1))&&h.rightOn(this.at(H+1),this.at(H),this.at(L))&&(y=e(this.at(H+1),this.at(H),this.at(L),this.at(L+1)),h.left(this.at(H-1),this.at(H),y)&&(B=h.sqdist(this.vertices[H],
y),C>B&&(C=B,v=y,E=L)));if(z==(E+1)%this.vertices.length)y[0]=(u[0]+v[0])/2,y[1]=(u[1]+v[1])/2,f.push(y),E>H?(J.append(this,H,E+1),J.vertices.push(y),K.vertices.push(y),0!=z&&K.append(this,z,this.vertices.length),K.append(this,0,H+1)):(0!=H&&J.append(this,H,this.vertices.length),J.append(this,0,E+1),J.vertices.push(y),K.vertices.push(y),K.append(this,z,H+1));else{if(z>E&&(E+=this.vertices.length),C=Number.MAX_VALUE,z>E)return b;for(L=z;E>=L;++L)h.leftOn(this.at(H-1),this.at(H),this.at(L))&&h.rightOn(this.at(H+
1),this.at(H),this.at(L))&&(B=h.sqdist(this.at(H),this.at(L)),C>B&&(C=B,G=L%this.vertices.length));G>H?(J.append(this,H,G+1),0!=G&&K.append(this,G,M.length),K.append(this,0,H+1)):(0!=H&&J.append(this,H,M.length),J.append(this,0,G+1),K.append(this,G,H+1))}return J.vertices.length<K.vertices.length?(J.quickDecomp(b,g,f,k,l,m),K.quickDecomp(b,g,f,k,l,m)):(K.quickDecomp(b,g,f,k,l,m),J.quickDecomp(b,g,f,k,l,m)),b}return b.push(this),b};d.prototype.removeCollinearPoints=function(b){for(var d=0,e=this.vertices.length-
1;3<this.vertices.length&&0<=e;--e)h.collinear(this.at(e-1),this.at(e),this.at(e+1),b)&&(this.vertices.splice(e%this.vertices.length,1),e--,d++);return d}},{"./Line":3,"./Point":4,"./Scalar":6,__browserify_Buffer:1,__browserify_process:2}],6:[function(f,b){function d(){}f("__browserify_process");f("__browserify_Buffer");b.exports=d;d.eq=function(b,d,h){return h=h||0,Math.abs(b-d)<h}},{__browserify_Buffer:1,__browserify_process:2}],7:[function(f,b){f("__browserify_process");f("__browserify_Buffer");
b.exports={Polygon:f("./Polygon"),Point:f("./Point")}},{"./Point":4,"./Polygon":5,__browserify_Buffer:1,__browserify_process:2}],8:[function(f,b){f("__browserify_process");f("__browserify_Buffer");b.exports={name:"p2",version:"0.6.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},
licenses:[{type:"MIT"}],devDependencies:{grunt:"~0.4.0","grunt-contrib-jshint":"~0.9.2","grunt-contrib-nodeunit":"~0.1.2","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{__browserify_Buffer:1,__browserify_process:2}],9:[function(f,b){function d(b){this.lowerBound=e.create();b&&b.lowerBound&&e.copy(this.lowerBound,b.lowerBound);this.upperBound=e.create();b&&b.upperBound&&e.copy(this.upperBound,
b.upperBound)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2"));f("../utils/Utils");b.exports=d;var g=e.create();d.prototype.setFromPoints=function(b,d,f,m){var n=this.lowerBound,p=this.upperBound;"number"!=typeof f&&(f=0);0!==f?e.rotate(n,b[0],f):e.copy(n,b[0]);e.copy(p,n);for(var q=Math.cos(f),r=Math.sin(f),t=1;t<b.length;t++){var w=b[t];if(0!==f){var v=w[0],w=w[1];g[0]=q*v-r*w;g[1]=r*v+q*w;w=g}for(v=0;2>v;v++)w[v]>p[v]&&(p[v]=w[v]),w[v]<n[v]&&(n[v]=w[v])}d&&(e.add(this.lowerBound,
this.lowerBound,d),e.add(this.upperBound,this.upperBound,d));m&&(this.lowerBound[0]-=m,this.lowerBound[1]-=m,this.upperBound[0]+=m,this.upperBound[1]+=m)};d.prototype.copy=function(b){e.copy(this.lowerBound,b.lowerBound);e.copy(this.upperBound,b.upperBound)};d.prototype.extend=function(b){for(var d=2;d--;){var e=b.lowerBound[d];this.lowerBound[d]>e&&(this.lowerBound[d]=e);e=b.upperBound[d];this.upperBound[d]<e&&(this.upperBound[d]=e)}};d.prototype.overlaps=function(b){var d=this.lowerBound,e=this.upperBound,
g=b.lowerBound;b=b.upperBound;return(g[0]<=e[0]&&e[0]<=b[0]||d[0]<=b[0]&&b[0]<=e[0])&&(g[1]<=e[1]&&e[1]<=b[1]||d[1]<=b[1]&&b[1]<=e[1])}},{"../math/vec2":31,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],10:[function(f,b){function d(b){this.type=b;this.result=[];this.world=null;this.boundingVolumeType=d.AABB}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("../objects/Body");b.exports=d;d.AABB=1;d.BOUNDING_CIRCLE=2;d.prototype.setWorld=function(b){this.world=
b};d.prototype.getCollisionPairs=function(){throw Error("getCollisionPairs must be implemented in a subclass!");};var h=e.create();d.boundingRadiusCheck=function(b,d){e.sub(h,b.position,d.position);var g=e.squaredLength(h),f=b.boundingRadius+d.boundingRadius;return f*f>=g};d.aabbCheck=function(b,d){return b.getAABB().overlaps(d.getAABB())};d.prototype.boundingVolumeCheck=function(b,e){var g;switch(this.boundingVolumeType){case d.BOUNDING_CIRCLE:g=d.boundingRadiusCheck(b,e);break;case d.AABB:g=d.aabbCheck(b,
e);break;default:throw Error("Bounding volume type not recognized: "+this.boundingVolumeType);}return g};d.canCollide=function(b,d){return b.type===g.STATIC&&d.type===g.STATIC?!1:b.type===g.KINEMATIC&&d.type===g.STATIC||b.type===g.STATIC&&d.type===g.KINEMATIC?!1:b.type===g.KINEMATIC&&d.type===g.KINEMATIC?!1:b.sleepState===g.SLEEPING&&d.sleepState===g.SLEEPING?!1:b.sleepState===g.SLEEPING&&d.type===g.STATIC||d.sleepState===g.SLEEPING&&b.type===g.STATIC?!1:!0};d.NAIVE=1;d.SAP=2},{"../math/vec2":31,
"../objects/Body":32,__browserify_Buffer:1,__browserify_process:2}],11:[function(f,b){function d(b){e.apply(this);b=g.defaults(b,{xmin:-100,xmax:100,ymin:-100,ymax:100,nx:10,ny:10});this.xmin=b.xmin;this.ymin=b.ymin;this.xmax=b.xmax;this.ymax=b.ymax;this.nx=b.nx;this.ny=b.ny;this.binsizeX=(this.xmax-this.xmin)/this.nx;this.binsizeY=(this.ymax-this.ymin)/this.ny}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../shapes/Circle"),f("../shapes/Plane"),f("../shapes/Particle"),f("../collision/Broadphase")),
g=(f("../math/vec2"),f("../utils/Utils"));b.exports=d;d.prototype=new e;d.prototype.getCollisionPairs=function(b){var d=[],g=b.bodies,f=g.length,n=(this.binsizeX,this.binsizeY,this.nx),p=this.ny,q=this.xmin,r=this.ymin,t=this.xmax,w=this.ymax;b=[];for(var v=n*p,u=0;v>u;u++)b.push([]);for(var y=n/(t-q),C=p/(w-r),u=0;u!==f;u++)for(var n=g[u],x=n.aabb,B=Math.max(x.lowerBound[0],q),E=Math.max(x.lowerBound[1],r),z=Math.min(x.upperBound[0],t),G=Math.min(x.upperBound[1],w),E=Math.floor(C*(E-r)),x=Math.floor(y*
(z-q)),G=Math.floor(C*(G-r)),B=Math.floor(y*(B-q));x>=B;B++)for(z=E;G>=z;z++){var J=B*(p-1)+z;0<=J&&v>J&&b[J].push(n)}for(u=0;u!==v;u++)for(g=b[u],B=0,f=g.length;B!==f;B++)for(n=g[B],z=0;z!==B;z++)p=g[z],e.canCollide(n,p)&&this.boundingVolumeCheck(n,p)&&d.push(n,p);return d}},{"../collision/Broadphase":10,"../math/vec2":31,"../shapes/Circle":38,"../shapes/Particle":42,"../shapes/Plane":43,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],12:[function(f,b){function d(){e.call(this,
e.NAIVE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../shapes/Circle"),f("../shapes/Plane"),f("../shapes/Shape"),f("../shapes/Particle"),f("../collision/Broadphase"));f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.getCollisionPairs=function(b){b=b.bodies;for(var d=this.result,f=d.length=0,k=b.length;f!==k;f++)for(var m=b[f],n=0;f>n;n++){var p=b[n];e.canCollide(m,p)&&this.boundingVolumeCheck(m,p)&&d.push(m,p)}return d}},{"../collision/Broadphase":10,"../math/vec2":31,
"../shapes/Circle":38,"../shapes/Particle":42,"../shapes/Plane":43,"../shapes/Shape":45,__browserify_Buffer:1,__browserify_process:2}],13:[function(f,b){function d(){this.contactEquations=[];this.frictionEquations=[];this.enableFriction=!0;this.slipForce=10;this.frictionCoefficient=.3;this.surfaceVelocity=0;this.reuseObjects=!0;this.reusableContactEquations=[];this.reusableFrictionEquations=[];this.restitution=0;this.stiffness=q.DEFAULT_STIFFNESS;this.relaxation=q.DEFAULT_RELAXATION;this.frictionStiffness=
q.DEFAULT_STIFFNESS;this.frictionRelaxation=q.DEFAULT_RELAXATION;this.enableFrictionReduction=!0;this.collidingBodiesLastStep=new p;this.contactSkinSize=.01}function e(b,d){h.set(b.vertices[0],.5*-d.length,-d.radius);h.set(b.vertices[1],.5*d.length,-d.radius);h.set(b.vertices[2],.5*d.length,d.radius);h.set(b.vertices[3],.5*-d.length,d.radius)}function g(b,d,e,g){var f=ya,m=za,n=A,p=Aa;d=d.vertices;for(var r=null,q=0;q!==d.length+1;q++){var w=d[(q+1)%d.length];h.rotate(f,d[q%d.length],g);h.rotate(m,
w,g);k(f,f,e);k(m,m,e);l(n,f,b);l(p,m,b);w=h.crossLength(n,p);if(null===r&&(r=w),0>=w*r)return!1;r=w}return!0}var h=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),l=h.sub,k=h.add,m=h.dot,n=f("../utils/Utils"),p=f("../utils/TupleDictionary"),q=f("../equations/Equation"),r=f("../equations/ContactEquation"),t=f("../equations/FrictionEquation"),w=f("../shapes/Circle"),v=f("../shapes/Convex"),u=f("../shapes/Shape"),y=(f("../objects/Body"),f("../shapes/Rectangle"));b.exports=d;var C=
h.fromValues(0,1),x=h.fromValues(0,0),B=h.fromValues(0,0),E=h.fromValues(0,0),z=h.fromValues(0,0),G=h.fromValues(0,0),J=h.fromValues(0,0),K=h.fromValues(0,0),M=h.fromValues(0,0),H=h.fromValues(0,0),L=h.fromValues(0,0),P=h.fromValues(0,0),D=h.fromValues(0,0),O=h.fromValues(0,0),N=h.fromValues(0,0),S=h.fromValues(0,0),aa=h.fromValues(0,0),T=h.fromValues(0,0),Q=h.fromValues(0,0),U=[];d.prototype.collidedLastStep=function(b,d){return!!this.collidingBodiesLastStep.get(0|b.id,0|d.id)};d.prototype.reset=
function(){this.collidingBodiesLastStep.reset();for(var b=this.contactEquations,d=b.length;d--;){var e=b[d];this.collidingBodiesLastStep.set(e.bodyA.id,e.bodyB.id,!0)}this.reuseObjects&&(b=this.frictionEquations,d=this.reusableFrictionEquations,n.appendArray(this.reusableContactEquations,this.contactEquations),n.appendArray(d,b));this.contactEquations.length=this.frictionEquations.length=0};d.prototype.createContactEquation=function(b,d,e,g){var f=this.reusableContactEquations.length?this.reusableContactEquations.pop():
new r(b,d);return f.bodyA=b,f.bodyB=d,f.shapeA=e,f.shapeB=g,f.restitution=this.restitution,f.firstImpact=!this.collidedLastStep(b,d),f.stiffness=this.stiffness,f.relaxation=this.relaxation,f.needsUpdate=!0,f.enabled=!0,f.offset=this.contactSkinSize,f};d.prototype.createFrictionEquation=function(b,d,e,g){var f=this.reusableFrictionEquations.length?this.reusableFrictionEquations.pop():new t(b,d);return f.bodyA=b,f.bodyB=d,f.shapeA=e,f.shapeB=g,f.setSlipForce(this.slipForce),f.frictionCoefficient=this.frictionCoefficient,
f.relativeVelocity=this.surfaceVelocity,f.enabled=!0,f.needsUpdate=!0,f.stiffness=this.frictionStiffness,f.relaxation=this.frictionRelaxation,f.contactEquations.length=0,f};d.prototype.createFrictionFromContact=function(b){var d=this.createFrictionEquation(b.bodyA,b.bodyB,b.shapeA,b.shapeB);return h.copy(d.contactPointA,b.contactPointA),h.copy(d.contactPointB,b.contactPointB),h.rotate90cw(d.t,b.normalA),d.contactEquations.push(b),d};d.prototype.createFrictionFromAverage=function(b){if(!b)throw Error("numContacts == 0!");
var d=this.contactEquations[this.contactEquations.length-1],e=this.createFrictionEquation(d.bodyA,d.bodyB,d.shapeA,d.shapeB),g=d.bodyA;d.bodyB;h.set(e.contactPointA,0,0);h.set(e.contactPointB,0,0);h.set(e.t,0,0);for(var f=0;f!==b;f++)d=this.contactEquations[this.contactEquations.length-1-f],d.bodyA===g?(h.add(e.t,e.t,d.normalA),h.add(e.contactPointA,e.contactPointA,d.contactPointA),h.add(e.contactPointB,e.contactPointB,d.contactPointB)):(h.sub(e.t,e.t,d.normalA),h.add(e.contactPointA,e.contactPointA,
d.contactPointB),h.add(e.contactPointB,e.contactPointB,d.contactPointA)),e.contactEquations.push(d);b=1/b;return h.scale(e.contactPointA,e.contactPointA,b),h.scale(e.contactPointB,e.contactPointB,b),h.normalize(e.t,e.t),h.rotate90cw(e.t,e.t),e};d.prototype[u.LINE|u.CONVEX]=d.prototype.convexLine=function(b,d,e,g,f,h,k,l,m){return m?!1:0};d.prototype[u.LINE|u.RECTANGLE]=d.prototype.lineRectangle=function(b,d,e,g,f,h,k,l,m){return m?!1:0};var ha=new y(1,1),R=h.create();d.prototype[u.CAPSULE|u.CONVEX]=
d.prototype[u.CAPSULE|u.RECTANGLE]=d.prototype.convexCapsule=function(b,d,g,f,k,l,m,n,p){h.set(R,l.length/2,0);h.rotate(R,R,n);h.add(R,R,m);var r=this.circleConvex(k,l,R,n,b,d,g,f,p,l.radius);h.set(R,-l.length/2,0);h.rotate(R,R,n);h.add(R,R,m);var q=this.circleConvex(k,l,R,n,b,d,g,f,p,l.radius);if(p&&(r||q))return!0;e(ha,l);return this.convexConvex(b,d,g,f,k,ha,m,n,p)+r+q};d.prototype[u.CAPSULE|u.LINE]=d.prototype.lineCapsule=function(b,d,e,g,f,h,k,l,m){return m?!1:0};var V=h.create(),ja=h.create(),
oa=new y(1,1);d.prototype[u.CAPSULE|u.CAPSULE]=d.prototype.capsuleCapsule=function(b,d,g,f,k,l,m,n,p){for(var r,q=0,w=0;2>w;w++){h.set(V,(0===w?-1:1)*d.length/2,0);h.rotate(V,V,f);h.add(V,V,g);for(var t=0;2>t;t++){h.set(ja,(0===t?-1:1)*l.length/2,0);h.rotate(ja,ja,n);h.add(ja,ja,m);this.enableFrictionReduction&&(r=this.enableFriction,this.enableFriction=!1);var u=this.circleCircle(b,d,V,f,k,l,ja,n,p,d.radius,l.radius);if(this.enableFrictionReduction&&(this.enableFriction=r),p&&u)return!0;q+=u}}this.enableFrictionReduction&&
(r=this.enableFriction,this.enableFriction=!1);e(oa,d);w=this.convexCapsule(b,oa,g,f,k,l,m,n,p);if(this.enableFrictionReduction&&(this.enableFriction=r),p&&w)return!0;if(q+=w,this.enableFrictionReduction)r=this.enableFriction,this.enableFriction=!1;e(oa,l);b=this.convexCapsule(k,oa,m,n,b,d,g,f,p);return this.enableFrictionReduction&&(this.enableFriction=r),p&&b?!0:(q+=b,this.enableFrictionReduction&&q&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(q)),q)};d.prototype[u.LINE|
u.LINE]=d.prototype.lineLine=function(b,d,e,g,f,h,k,l,m){return m?!1:0};d.prototype[u.PLANE|u.LINE]=d.prototype.planeLine=function(b,d,e,g,f,n,p,q,r){var w=0;h.set(x,-n.length/2,0);h.set(B,n.length/2,0);h.rotate(E,x,q);h.rotate(z,B,q);k(E,E,p);k(z,z,p);h.copy(x,E);h.copy(B,z);l(G,B,x);h.normalize(J,G);h.rotate90cw(H,J);h.rotate(M,C,g);U[0]=x;U[1]=B;for(g=0;g<U.length;g++){q=U[g];l(K,q,e);var t=m(K,M);if(0>t){if(r)return!0;var u=this.createContactEquation(b,f,d,n);w++;h.copy(u.normalA,M);h.normalize(u.normalA,
u.normalA);h.scale(K,M,t);l(u.contactPointA,q,K);l(u.contactPointA,u.contactPointA,b.position);l(u.contactPointB,q,p);k(u.contactPointB,u.contactPointB,p);l(u.contactPointB,u.contactPointB,f.position);this.contactEquations.push(u);this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(u))}}return r?!1:(this.enableFrictionReduction||w&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(w)),w)};d.prototype[u.PARTICLE|
u.CAPSULE]=d.prototype.particleCapsule=function(b,d,e,g,f,h,k,l,m){return this.circleLine(b,d,e,g,f,h,k,l,m,h.radius,0)};d.prototype[u.CIRCLE|u.LINE]=d.prototype.circleLine=function(b,d,e,g,f,n,p,q,r,w,u){w=w||0;u="undefined"!=typeof u?u:d.radius;h.set(M,-n.length/2,0);h.set(H,n.length/2,0);h.rotate(L,M,q);h.rotate(P,H,q);k(L,L,p);k(P,P,p);h.copy(M,L);h.copy(H,P);l(J,H,M);h.normalize(K,J);h.rotate90cw(G,K);l(D,e,M);q=m(D,G);l(z,M,p);l(O,e,p);g=u+w;if(Math.abs(q)<g){h.scale(x,G,q);l(E,e,x);h.scale(B,
G,m(G,O));h.normalize(B,B);h.scale(B,B,w);k(E,E,B);q=m(K,E);var t=m(K,M),v=m(K,H);if(q>t&&v>q){if(r)return!0;d=this.createContactEquation(b,f,d,n);return h.scale(d.normalA,x,-1),h.normalize(d.normalA,d.normalA),h.scale(d.contactPointA,d.normalA,u),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),l(d.contactPointB,E,p),k(d.contactPointB,d.contactPointB,p),l(d.contactPointB,d.contactPointB,f.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),
1}}U[0]=M;U[1]=H;for(t=0;t<U.length;t++)if(q=U[t],l(D,q,e),h.squaredLength(D)<Math.pow(g,2)){if(r)return!0;d=this.createContactEquation(b,f,d,n);return h.copy(d.normalA,D),h.normalize(d.normalA,d.normalA),h.scale(d.contactPointA,d.normalA,u),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),l(d.contactPointB,q,p),h.scale(N,d.normalA,-w),k(d.contactPointB,d.contactPointB,N),k(d.contactPointB,d.contactPointB,p),l(d.contactPointB,d.contactPointB,f.position),this.contactEquations.push(d),
this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1}return 0};d.prototype[u.CIRCLE|u.CAPSULE]=d.prototype.circleCapsule=function(b,d,e,g,f,h,k,l,m){return this.circleLine(b,d,e,g,f,h,k,l,m,h.radius)};d.prototype[u.CIRCLE|u.CONVEX]=d.prototype[u.CIRCLE|u.RECTANGLE]=d.prototype.circleConvex=function(b,d,e,f,m,n,p,q,r,w){w="number"==typeof w?w:d.radius;f=!1;for(var u=Number.MAX_VALUE,t=n.vertices,v=0;v!==t.length+1;v++){var D=t[(v+1)%t.length];if(h.rotate(x,t[v%t.length],
q),h.rotate(B,D,q),k(x,x,p),k(B,B,p),l(E,B,x),h.normalize(z,E),h.rotate90cw(G,z),h.scale(N,G,-d.radius),k(N,N,e),g(N,n,p,q))h.sub(S,x,N),D=Math.abs(h.dot(S,G)),u>D&&(h.copy(aa,N),u=D,h.scale(O,G,D),h.add(O,O,N),f=!0)}if(f){if(r)return!0;d=this.createContactEquation(b,m,d,n);return h.sub(d.normalA,aa,e),h.normalize(d.normalA,d.normalA),h.scale(d.contactPointA,d.normalA,w),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),l(d.contactPointB,O,p),k(d.contactPointB,d.contactPointB,
p),l(d.contactPointB,d.contactPointB,m.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1}if(0<w)for(v=0;v<t.length;v++)if(h.rotate(P,t[v],q),k(P,P,p),l(L,P,e),h.squaredLength(L)<Math.pow(w,2)){if(r)return!0;d=this.createContactEquation(b,m,d,n);return h.copy(d.normalA,L),h.normalize(d.normalA,d.normalA),h.scale(d.contactPointA,d.normalA,w),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),
l(d.contactPointB,P,p),k(d.contactPointB,d.contactPointB,p),l(d.contactPointB,d.contactPointB,m.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1}return 0};var ya=h.create(),za=h.create(),A=h.create(),Aa=h.create();d.prototype[u.PARTICLE|u.CONVEX]=d.prototype[u.PARTICLE|u.RECTANGLE]=d.prototype.particleConvex=function(b,d,e,f,n,p,q,r,w){f=Number.MAX_VALUE;var u=!1,t=p.vertices;if(!g(e,p,q,r))return 0;if(w)return!0;for(w=0;w!==
t.length+1;w++){var v=t[(w+1)%t.length];h.rotate(x,t[w%t.length],r);h.rotate(B,v,r);k(x,x,q);k(B,B,q);l(E,B,x);h.normalize(z,E);h.rotate90cw(G,z);l(L,e,x);m(L,G);l(J,x,q);l(K,e,q);h.sub(T,x,e);v=Math.abs(h.dot(T,G));f>v&&(f=v,h.scale(O,G,v),h.add(O,O,e),h.copy(Q,G),u=!0)}return u?(d=this.createContactEquation(b,n,d,p),h.scale(d.normalA,Q,-1),h.normalize(d.normalA,d.normalA),h.set(d.contactPointA,0,0),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),l(d.contactPointB,
O,q),k(d.contactPointB,d.contactPointB,q),l(d.contactPointB,d.contactPointB,n.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1):0};d.prototype[u.CIRCLE]=d.prototype.circleCircle=function(b,d,e,g,f,m,n,p,q,r,w){r=r||d.radius;w=w||m.radius;l(x,e,n);g=r+w;if(h.squaredLength(x)>Math.pow(g,2))return 0;if(q)return!0;d=this.createContactEquation(b,f,d,m);return l(d.normalA,n,e),h.normalize(d.normalA,d.normalA),h.scale(d.contactPointA,
d.normalA,r),h.scale(d.contactPointB,d.normalA,-w),k(d.contactPointA,d.contactPointA,e),l(d.contactPointA,d.contactPointA,b.position),k(d.contactPointB,d.contactPointB,n),l(d.contactPointB,d.contactPointB,f.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1};d.prototype[u.PLANE|u.CONVEX]=d.prototype[u.PLANE|u.RECTANGLE]=d.prototype.planeConvex=function(b,d,e,g,f,n,p,q,r){var w=0;h.rotate(B,C,g);for(g=0;g!==n.vertices.length;g++)if(h.rotate(x,
n.vertices[g],q),k(x,x,p),l(E,x,e),0>=m(E,B)){if(r)return!0;w++;var u=this.createContactEquation(b,f,d,n);l(E,x,e);h.copy(u.normalA,B);var t=m(E,u.normalA);h.scale(E,u.normalA,t);l(u.contactPointB,x,f.position);l(u.contactPointA,x,E);l(u.contactPointA,u.contactPointA,b.position);this.contactEquations.push(u);this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(u))}return this.enableFrictionReduction&&this.enableFriction&&w&&this.frictionEquations.push(this.createFrictionFromAverage(w)),
w};d.prototype[u.PARTICLE|u.PLANE]=d.prototype.particlePlane=function(b,d,e,g,f,k,n,p,q){p=p||0;l(x,e,n);h.rotate(B,C,p);g=m(x,B);if(0<g)return 0;if(q)return!0;d=this.createContactEquation(f,b,k,d);return h.copy(d.normalA,B),h.scale(x,d.normalA,g),l(d.contactPointA,e,x),l(d.contactPointA,d.contactPointA,f.position),l(d.contactPointB,e,b.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1};d.prototype[u.CIRCLE|u.PARTICLE]=d.prototype.circleParticle=
function(b,d,e,g,f,m,n,p,q){if(l(x,n,e),h.squaredLength(x)>Math.pow(d.radius,2))return 0;if(q)return!0;g=this.createContactEquation(b,f,d,m);return h.copy(g.normalA,x),h.normalize(g.normalA,g.normalA),h.scale(g.contactPointA,g.normalA,d.radius),k(g.contactPointA,g.contactPointA,e),l(g.contactPointA,g.contactPointA,b.position),l(g.contactPointB,n,f.position),this.contactEquations.push(g),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(g)),1};var qa=new w(1),ka=h.create(),
la=h.create();h.create();d.prototype[u.PLANE|u.CAPSULE]=d.prototype.planeCapsule=function(b,d,e,g,f,l,m,n,p){h.set(ka,-l.length/2,0);h.rotate(ka,ka,n);k(ka,ka,m);h.set(la,l.length/2,0);h.rotate(la,la,n);k(la,la,m);qa.radius=l.radius;var q;this.enableFrictionReduction&&(q=this.enableFriction,this.enableFriction=!1);l=this.circlePlane(f,qa,ka,0,b,d,e,g,p);b=this.circlePlane(f,qa,la,0,b,d,e,g,p);if(this.enableFrictionReduction&&(this.enableFriction=q),p)return l||b;p=l+b;return this.enableFrictionReduction&&
p&&this.frictionEquations.push(this.createFrictionFromAverage(p)),p};d.prototype[u.CIRCLE|u.PLANE]=d.prototype.circlePlane=function(b,d,e,g,f,n,p,q,r){g=q||0;l(x,e,p);h.rotate(B,C,g);g=m(B,x);if(g>d.radius)return 0;if(r)return!0;n=this.createContactEquation(f,b,n,d);return h.copy(n.normalA,B),h.scale(n.contactPointB,n.normalA,-d.radius),k(n.contactPointB,n.contactPointB,e),l(n.contactPointB,n.contactPointB,b.position),h.scale(E,n.normalA,g),l(n.contactPointA,x,E),k(n.contactPointA,n.contactPointA,
p),l(n.contactPointA,n.contactPointA,f.position),this.contactEquations.push(n),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(n)),1};d.prototype[u.CONVEX]=d.prototype[u.CONVEX|u.RECTANGLE]=d.prototype[u.RECTANGLE]=d.prototype.convexConvex=function(b,e,g,f,n,p,q,r,w,u){var t=0;u="number"==typeof u?u:0;if(!d.findSeparatingAxis(e,g,f,p,q,r,x))return 0;l(M,q,g);0<m(x,M)&&h.scale(x,x,-1);var v=d.getClosestEdge(e,f,x,!0),D=d.getClosestEdge(p,r,x);if(-1===v||-1===D)return 0;
for(var y=0;2>y;y++){var C=v,O=D,A=e,N=p,T=g,F=q,S=f,aa=r,R=b,L=n;if(0===y){var J;J=C;C=O;O=J;J=A;A=N;N=J;J=T;T=F;F=J;J=S;S=aa;aa=J;J=R;R=L;L=J}for(J=O;O+2>J;J++){h.rotate(B,N.vertices[(J+N.vertices.length)%N.vertices.length],aa);k(B,B,F);for(var I=0,V=C-1;C+2>V;V++){var Q=A.vertices[(V+A.vertices.length)%A.vertices.length],U=A.vertices[(V+1+A.vertices.length)%A.vertices.length];h.rotate(E,Q,S);h.rotate(z,U,S);k(E,E,T);k(z,z,T);l(G,z,E);h.rotate90cw(H,G);h.normalize(H,H);l(M,B,E);Q=m(H,M);(V===C&&
u>=Q||V!==C&&0>=Q)&&I++}if(3<=I){if(w)return!0;I=this.createContactEquation(R,L,A,N);t++;Q=A.vertices[C%A.vertices.length];U=A.vertices[(C+1)%A.vertices.length];h.rotate(E,Q,S);h.rotate(z,U,S);k(E,E,T);k(z,z,T);l(G,z,E);h.rotate90cw(I.normalA,G);h.normalize(I.normalA,I.normalA);l(M,B,E);Q=m(I.normalA,M);h.scale(K,I.normalA,Q);l(I.contactPointA,B,T);l(I.contactPointA,I.contactPointA,K);k(I.contactPointA,I.contactPointA,T);l(I.contactPointA,I.contactPointA,R.position);l(I.contactPointB,B,F);k(I.contactPointB,
I.contactPointB,F);l(I.contactPointB,I.contactPointB,L.position);this.contactEquations.push(I);this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(I))}}}return this.enableFrictionReduction&&this.enableFriction&&t&&this.frictionEquations.push(this.createFrictionFromAverage(t)),t};var ua=h.fromValues(0,0);d.projectConvexOntoAxis=function(b,d,e,g,f){var k,l=null,n=null;h.rotate(ua,g,-e);for(e=0;e<b.vertices.length;e++)k=b.vertices[e],k=m(k,ua),
(null===l||k>l)&&(l=k),(null===n||n>k)&&(n=k);n>l&&(b=n,n=l,l=b);d=m(d,g);h.set(f,n+d,l+d)};var va=h.fromValues(0,0),wa=h.fromValues(0,0),xa=h.fromValues(0,0),W=h.fromValues(0,0),Z=h.fromValues(0,0),ba=h.fromValues(0,0);d.findSeparatingAxis=function(b,e,g,f,k,m,n){var p=null,q=!1,r=!1;if(b instanceof y&&f instanceof y)for(var w=0;2!==w;w++){var u=b,t=g;1===w&&(t=m);for(var v=0;2!==v;v++){0===v?h.set(W,0,1):1===v&&h.set(W,1,0);0!==t&&h.rotate(W,W,t);d.projectConvexOntoAxis(b,e,g,W,Z);d.projectConvexOntoAxis(f,
k,m,W,ba);var q=Z,D=ba;Z[0]>ba[0]&&(D=Z,q=ba);D=D[0]-q[1];q=0>=D;(null===p||D>p)&&(h.copy(n,W),p=D,r=q)}}else for(w=0;2!==w;w++)for(u=b,t=g,1===w&&(u=f,t=m),v=0;v!==u.vertices.length;v++)h.rotate(wa,u.vertices[v],t),h.rotate(xa,u.vertices[(v+1)%u.vertices.length],t),l(va,xa,wa),h.rotate90cw(W,va),h.normalize(W,W),d.projectConvexOntoAxis(b,e,g,W,Z),d.projectConvexOntoAxis(f,k,m,W,ba),q=Z,D=ba,Z[0]>ba[0]&&(D=Z,q=ba),D=D[0]-q[1],q=0>=D,(null===p||D>p)&&(h.copy(n,W),p=D,r=q);return r};var I=h.fromValues(0,
0),ra=h.fromValues(0,0),na=h.fromValues(0,0);d.getClosestEdge=function(b,d,e,g){h.rotate(I,e,-d);g&&h.scale(I,I,-1);d=-1;e=b.vertices.length;g=-1;for(var f=0;f!==e;f++){l(ra,b.vertices[(f+1)%e],b.vertices[f%e]);h.rotate90cw(na,ra);h.normalize(na,na);var k=m(na,I);(-1===d||k>g)&&(d=f%e,g=k)}return d};var da=h.create(),ea=h.create(),Y=h.create(),ma=h.create(),sa=h.create(),X=h.create(),ta=h.create();d.prototype[u.CIRCLE|u.HEIGHTFIELD]=d.prototype.circleHeightfield=function(b,d,e,g,f,m,n,p,q,r){g=m.data;
r=r||d.radius;p=m.elementWidth;var w=Math.floor((e[0]-r-n[0])/p),u=Math.ceil((e[0]+r-n[0])/p);0>w&&(w=0);u>=g.length&&(u=g.length-1);for(var t=g[w],v=g[u],D=w;u>D;D++)g[D]<v&&(v=g[D]),g[D]>t&&(t=g[D]);if(e[1]-r>t)return q?!1:0;t=!1;for(D=w;u>D;D++)if(h.set(Y,D*p,g[D]),h.set(ma,(D+1)*p,g[D+1]),h.add(Y,Y,n),h.add(ma,ma,n),h.sub(X,ma,Y),h.rotate(X,X,Math.PI/2),h.normalize(X,X),h.scale(da,X,-r),h.add(da,da,e),h.sub(ea,da,Y),t=h.dot(ea,X),da[0]>=Y[0]&&da[0]<ma[0]&&0>=t){if(q)return!0;h.scale(ea,X,-t);
h.add(sa,da,ea);h.copy(ta,X);v=this.createContactEquation(f,b,m,d);h.copy(v.normalA,ta);h.scale(v.contactPointB,v.normalA,-r);k(v.contactPointB,v.contactPointB,e);l(v.contactPointB,v.contactPointB,b.position);h.copy(v.contactPointA,sa);h.sub(v.contactPointA,v.contactPointA,f.position);this.contactEquations.push(v);this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(v))}if(t=!1,0<r)for(D=w;u>=D;D++)if(h.set(Y,D*p,g[D]),h.add(Y,Y,n),h.sub(ea,e,Y),h.squaredLength(ea)<Math.pow(r,
2)){if(q)return!0;t=!0;v=this.createContactEquation(f,b,m,d);h.copy(v.normalA,ea);h.normalize(v.normalA,v.normalA);h.scale(v.contactPointB,v.normalA,-r);k(v.contactPointB,v.contactPointB,e);l(v.contactPointB,v.contactPointB,b.position);l(v.contactPointA,Y,n);k(v.contactPointA,v.contactPointA,n);l(v.contactPointA,v.contactPointA,f.position);this.contactEquations.push(v);this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(v))}return t?1:0};var ga=h.create(),ia=h.create(),
pa=h.create(),F=new v([h.create(),h.create(),h.create(),h.create()]);d.prototype[u.RECTANGLE|u.HEIGHTFIELD]=d.prototype[u.CONVEX|u.HEIGHTFIELD]=d.prototype.convexHeightfield=function(b,d,e,g,f,k,l,m,n){m=k.data;k=k.elementWidth;var p=Math.floor((b.aabb.lowerBound[0]-l[0])/k),q=Math.ceil((b.aabb.upperBound[0]-l[0])/k);0>p&&(p=0);q>=m.length&&(q=m.length-1);for(var r=m[p],w=m[q],v=p;q>v;v++)m[v]<w&&(w=m[v]),m[v]>r&&(r=m[v]);if(b.aabb.lowerBound[1]>r)return n?!1:0;r=0;for(v=p;q>v;v++)h.set(ga,v*k,m[v]),
h.set(ia,(v+1)*k,m[v+1]),h.add(ga,ga,l),h.add(ia,ia,l),h.set(pa,.5*(ia[0]+ga[0]),.5*(ia[1]+ga[1]-100)),h.sub(F.vertices[0],ia,pa),h.sub(F.vertices[1],ga,pa),h.copy(F.vertices[2],F.vertices[1]),h.copy(F.vertices[3],F.vertices[0]),F.vertices[2][1]-=100,F.vertices[3][1]-=100,r+=this.convexConvex(b,d,e,g,f,F,pa,0,n);return r}},{"../equations/ContactEquation":22,"../equations/Equation":23,"../equations/FrictionEquation":24,"../math/vec2":31,"../objects/Body":32,"../shapes/Circle":38,"../shapes/Convex":39,
"../shapes/Rectangle":44,"../shapes/Shape":45,"../utils/TupleDictionary":49,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],14:[function(f,b){function d(){g.call(this,g.SAP);this.axisList=[];this.axisIndex=0;var b=this;this._addBodyHandler=function(d){b.axisList.push(d.body)};this._removeBodyHandler=function(d){d=b.axisList.indexOf(d.body);-1!==d&&b.axisList.splice(d,1)}}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../utils/Utils")),g=f("../collision/Broadphase");
b.exports=d;d.prototype=new g;d.prototype.setWorld=function(b){this.axisList.length=0;e.appendArray(this.axisList,b.bodies);b.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler);b.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler);this.world=b};d.sortAxisList=function(b,d){d|=0;for(var e=1,g=b.length;g>e;e++){for(var f=b[e],p=e-1;0<=p&&!(b[p].aabb.lowerBound[d]<=f.aabb.lowerBound[d]);p--)b[p+1]=b[p];b[p+1]=f}return b};d.prototype.getCollisionPairs=
function(){var b=this.axisList,e=this.result,f=this.axisIndex;e.length=0;for(var m=b.length;m--;){var n=b[m];n.aabbNeedsUpdate&&n.updateAABB()}d.sortAxisList(b,f);m=0;for(n=0|b.length;m!==n;m++)for(var p=b[m],q=m+1;n>q;q++){var r=b[q];if(!(r.aabb.lowerBound[f]<=p.aabb.upperBound[f]))break;g.canCollide(p,r)&&this.boundingVolumeCheck(p,r)&&e.push(p,r)}return e}},{"../collision/Broadphase":10,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],15:[function(f,b){function d(b,d,f,k){this.type=
f;k=e.defaults(k,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=b;this.bodyB=d;this.collideConnected=k.collideConnected;k.wakeUpBodies&&(b&&b.wakeUp(),d&&d.wakeUp())}f("__browserify_process");f("__browserify_Buffer");b.exports=d;var e=f("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.DISTANCE=1;d.GEAR=2;d.LOCK=3;d.PRISMATIC=4;d.REVOLUTE=5;d.prototype.setStiffness=function(b){for(var d=this.equations,
e=0;e!==d.length;e++){var f=d[e];f.stiffness=b;f.needsUpdate=!0}};d.prototype.setRelaxation=function(b){for(var d=this.equations,e=0;e!==d.length;e++){var f=d[e];f.relaxation=b;f.needsUpdate=!0}}},{"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],16:[function(f,b){function d(b,d,f){f=l.defaults(f,{localAnchorA:[0,0],localAnchorB:[0,0]});e.call(this,b,d,e.DISTANCE,f);this.localAnchorA=h.fromValues(f.localAnchorA[0],f.localAnchorA[1]);this.localAnchorB=h.fromValues(f.localAnchorB[0],
f.localAnchorB[1]);var k=this.localAnchorA,m=this.localAnchorB;if(this.distance=0,"number"==typeof f.distance)this.distance=f.distance;else{var n=h.create(),u=h.create(),y=h.create();h.rotate(n,k,b.angle);h.rotate(u,m,d.angle);h.add(y,d.position,u);h.sub(y,y,n);h.sub(y,y,b.position);this.distance=h.length(y)}f="undefined"==typeof f.maxForce?Number.MAX_VALUE:f.maxForce;b=new g(b,d,-f,f);this.equations=[b];this.maxForce=f;var y=h.create(),C=h.create(),x=h.create(),B=this;b.computeGq=function(){var b=
this.bodyA,d=this.bodyB,e=b.position,g=d.position;return h.rotate(C,k,b.angle),h.rotate(x,m,d.angle),h.add(y,g,x),h.sub(y,y,C),h.sub(y,y,e),h.length(y)-B.distance};this.setMaxForce(f);this.upperLimitEnabled=!1;this.upperLimit=1;this.lowerLimitEnabled=!1;this.position=this.lowerLimit=0}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Constraint")),g=f("../equations/Equation"),h=f("../math/vec2"),l=f("../utils/Utils");b.exports=d;d.prototype=new e;var k=h.create(),m=h.create(),n=h.create();
d.prototype.update=function(){var b=this.equations[0],d=this.bodyA,e=this.bodyB,g=(this.distance,d.position),f=e.position,l=this.equations[0],b=b.G;h.rotate(m,this.localAnchorA,d.angle);h.rotate(n,this.localAnchorB,e.angle);h.add(k,f,n);h.sub(k,k,m);h.sub(k,k,g);this.position=h.length(k);d=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(l.maxForce=0,l.minForce=-this.maxForce,this.distance=this.upperLimit,d=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(l.maxForce=this.maxForce,
l.minForce=0,this.distance=this.lowerLimit,d=!0),(this.lowerLimitEnabled||this.upperLimitEnabled)&&!d)return void(l.enabled=!1);l.enabled=!0;h.normalize(k,k);l=h.crossLength(m,k);d=h.crossLength(n,k);b[0]=-k[0];b[1]=-k[1];b[2]=-l;b[3]=k[0];b[4]=k[1];b[5]=d};d.prototype.setMaxForce=function(b){var d=this.equations[0];d.minForce=-b;d.maxForce=b};d.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":23,"../math/vec2":31,"../utils/Utils":50,"./Constraint":15,
__browserify_Buffer:1,__browserify_process:2}],17:[function(f,b){function d(b,d,f){f=f||{};e.call(this,b,d,e.GEAR,f);this.ratio="number"==typeof f.ratio?f.ratio:1;this.angle="number"==typeof f.angle?f.angle:d.angle-this.ratio*b.angle;f.angle=this.angle;f.ratio=this.ratio;this.equations=[new g(b,d,f)];"number"==typeof f.maxTorque&&this.setMaxTorque(f.maxTorque)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Constraint")),g=(f("../equations/Equation"),f("../equations/AngleLockEquation"));
f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.update=function(){var b=this.equations[0];b.ratio!==this.ratio&&b.setRatio(this.ratio);b.angle=this.angle};d.prototype.setMaxTorque=function(b){this.equations[0].setMaxTorque(b)};d.prototype.getMaxTorque=function(){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":21,"../equations/Equation":23,"../math/vec2":31,"./Constraint":15,__browserify_Buffer:1,__browserify_process:2}],18:[function(f,b){function d(b,d,f){f=f||{};
e.call(this,b,d,e.LOCK,f);var k="undefined"==typeof f.maxForce?Number.MAX_VALUE:f.maxForce,l=(f.localAngleB||0,new h(b,d,-k,k)),m=new h(b,d,-k,k),n=new h(b,d,-k,k),p=g.create(),x=g.create(),B=this;l.computeGq=function(){return g.rotate(p,B.localOffsetB,b.angle),g.sub(x,d.position,b.position),g.sub(x,x,p),x[0]};m.computeGq=function(){return g.rotate(p,B.localOffsetB,b.angle),g.sub(x,d.position,b.position),g.sub(x,x,p),x[1]};var E=g.create(),z=g.create();n.computeGq=function(){return g.rotate(E,B.localOffsetB,
d.angle-B.localAngleB),g.scale(E,E,-1),g.sub(x,b.position,d.position),g.add(x,x,E),g.rotate(z,E,-Math.PI/2),g.normalize(z,z),g.dot(x,z)};this.localOffsetB=g.create();f.localOffsetB?g.copy(this.localOffsetB,f.localOffsetB):(g.sub(this.localOffsetB,d.position,b.position),g.rotate(this.localOffsetB,this.localOffsetB,-b.angle));this.localAngleB=0;this.localAngleB="number"==typeof f.localAngleB?f.localAngleB:d.angle-b.angle;this.equations.push(l,m,n);this.setMaxForce(k)}var e=(f("__browserify_process"),
f("__browserify_Buffer"),f("./Constraint")),g=f("../math/vec2"),h=f("../equations/Equation");b.exports=d;d.prototype=new e;d.prototype.setMaxForce=function(b){for(var d=this.equations,e=0;e<this.equations.length;e++)d[e].maxForce=b,d[e].minForce=-b};d.prototype.getMaxForce=function(){return this.equations[0].maxForce};var l=g.create(),k=g.create(),m=g.create(),n=g.fromValues(1,0),p=g.fromValues(0,1);d.prototype.update=function(){var b=this.equations[0],d=this.equations[1],e=this.equations[2],f=this.bodyB;
g.rotate(l,this.localOffsetB,this.bodyA.angle);g.rotate(k,this.localOffsetB,f.angle-this.localAngleB);g.scale(k,k,-1);g.rotate(m,k,Math.PI/2);g.normalize(m,m);b.G[0]=-1;b.G[1]=0;b.G[2]=-g.crossLength(l,n);b.G[3]=1;d.G[0]=0;d.G[1]=-1;d.G[2]=-g.crossLength(l,p);d.G[4]=1;e.G[0]=-m[0];e.G[1]=-m[1];e.G[3]=m[0];e.G[4]=m[1];e.G[5]=g.crossLength(k,m)}},{"../equations/Equation":23,"../math/vec2":31,"./Constraint":15,__browserify_Buffer:1,__browserify_process:2}],19:[function(f,b){function d(b,d,f){f=f||{};
e.call(this,b,d,e.PRISMATIC,f);var m=l.fromValues(0,0),n=l.fromValues(1,0),p=l.fromValues(0,0);f.localAnchorA&&l.copy(m,f.localAnchorA);f.localAxisA&&l.copy(n,f.localAxisA);f.localAnchorB&&l.copy(p,f.localAnchorB);this.localAnchorA=m;this.localAnchorB=p;this.localAxisA=n;var q=this.maxForce="undefined"!=typeof f.maxForce?f.maxForce:Number.MAX_VALUE,r=new h(b,d,-q,q),t=new l.create,G=new l.create,J=new l.create,K=new l.create;(r.computeGq=function(){return l.dot(J,K)},r.updateJacobian=function(){var e=
this.G,g=b.position,f=d.position;l.rotate(t,m,b.angle);l.rotate(G,p,d.angle);l.add(J,f,G);l.sub(J,J,g);l.sub(J,J,t);l.rotate(K,n,b.angle+Math.PI/2);e[0]=-K[0];e[1]=-K[1];e[2]=-l.crossLength(t,K)+l.crossLength(K,J);e[3]=K[0];e[4]=K[1];e[5]=l.crossLength(G,K)},this.equations.push(r),f.disableRotationalLock)||(r=new k(b,d,-q,q),this.equations.push(r));this.velocity=this.position=0;this.lowerLimitEnabled="undefined"!=typeof f.lowerLimit?!0:!1;this.upperLimitEnabled="undefined"!=typeof f.upperLimit?!0:
!1;this.lowerLimit="undefined"!=typeof f.lowerLimit?f.lowerLimit:0;this.upperLimit="undefined"!=typeof f.upperLimit?f.upperLimit:1;this.upperLimitEquation=new g(b,d);this.lowerLimitEquation=new g(b,d);this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0;this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=q;this.motorEquation=new h(b,d);this.motorEnabled=!1;this.motorSpeed=0;var M=this;f=this.motorEquation;f.computeGW;f.computeGq=function(){return 0};f.computeGW=function(){var b=
this.bodyA,d=this.bodyB;return this.gmult(this.G,b.velocity,b.angularVelocity,d.velocity,d.angularVelocity)+M.motorSpeed}}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Constraint")),g=f("../equations/ContactEquation"),h=f("../equations/Equation"),l=f("../math/vec2"),k=f("../equations/RotationalLockEquation");b.exports=d;d.prototype=new e;var m=l.create(),n=l.create(),p=l.create(),q=l.create(),r=l.create(),t=l.create();d.prototype.update=function(){var b=this.equations,d=this.upperLimit,
e=this.lowerLimit,g=this.upperLimitEquation,f=this.lowerLimitEquation,h=this.bodyA,k=this.bodyB,E=this.localAxisA,z=this.localAnchorA,G=this.localAnchorB;b[0].updateJacobian();l.rotate(m,E,h.angle);l.rotate(q,z,h.angle);l.add(n,q,h.position);l.rotate(r,G,k.angle);l.add(p,r,k.position);E=this.position=l.dot(p,m)-l.dot(n,m);this.motorEnabled&&(z=this.motorEquation.G,z[0]=m[0],z[1]=m[1],z[2]=l.crossLength(m,r),z[3]=-m[0],z[4]=-m[1],z[5]=-l.crossLength(m,q));this.upperLimitEnabled&&E>d?(l.scale(g.normalA,
m,-1),l.sub(g.contactPointA,n,h.position),l.sub(g.contactPointB,p,k.position),l.scale(t,m,d),l.add(g.contactPointA,g.contactPointA,t),-1===b.indexOf(g)&&b.push(g)):(d=b.indexOf(g),-1!==d&&b.splice(d,1));this.lowerLimitEnabled&&e>E?(l.scale(f.normalA,m,1),l.sub(f.contactPointA,n,h.position),l.sub(f.contactPointB,p,k.position),l.scale(t,m,e),l.sub(f.contactPointB,f.contactPointB,t),-1===b.indexOf(f)&&b.push(f)):(d=b.indexOf(f),-1!==d&&b.splice(d,1))};d.prototype.enableMotor=function(){this.motorEnabled||
(this.equations.push(this.motorEquation),this.motorEnabled=!0)};d.prototype.disableMotor=function(){if(this.motorEnabled){var b=this.equations.indexOf(this.motorEquation);this.equations.splice(b,1);this.motorEnabled=!1}};d.prototype.setLimits=function(b,d){"number"==typeof b?(this.lowerLimit=b,this.lowerLimitEnabled=!0):(this.lowerLimit=b,this.lowerLimitEnabled=!1);"number"==typeof d?(this.upperLimit=d,this.upperLimitEnabled=!0):(this.upperLimit=d,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":22,
"../equations/Equation":23,"../equations/RotationalLockEquation":25,"../math/vec2":31,"./Constraint":15,__browserify_Buffer:1,__browserify_process:2}],20:[function(f,b){function d(b,d,f){f=f||{};e.call(this,b,d,e.REVOLUTE,f);var u=this.maxForce="undefined"!=typeof f.maxForce?f.maxForce:Number.MAX_VALUE;this.pivotA=k.create();this.pivotB=k.create();f.worldPivot?(k.sub(this.pivotA,f.worldPivot,b.position),k.sub(this.pivotB,f.worldPivot,d.position),k.rotate(this.pivotA,this.pivotA,-b.angle),k.rotate(this.pivotB,
this.pivotB,-d.angle)):(k.copy(this.pivotA,f.localPivotA),k.copy(this.pivotB,f.localPivotB));var y=this.equations=[new g(b,d,-u,u),new g(b,d,-u,u)];f=y[0];var y=y[1],C=this;f.computeGq=function(){return k.rotate(m,C.pivotA,b.angle),k.rotate(n,C.pivotB,d.angle),k.add(r,d.position,n),k.sub(r,r,b.position),k.sub(r,r,m),k.dot(r,p)};y.computeGq=function(){return k.rotate(m,C.pivotA,b.angle),k.rotate(n,C.pivotB,d.angle),k.add(r,d.position,n),k.sub(r,r,b.position),k.sub(r,r,m),k.dot(r,q)};y.minForce=f.minForce=
-u;y.maxForce=f.maxForce=u;this.motorEquation=new h(b,d);this.motorEnabled=!1;this.angle=0;this.upperLimitEnabled=this.lowerLimitEnabled=!1;this.upperLimit=this.lowerLimit=0;this.upperLimitEquation=new l(b,d);this.lowerLimitEquation=new l(b,d);this.upperLimitEquation.minForce=0;this.lowerLimitEquation.maxForce=0}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Constraint")),g=f("../equations/Equation"),h=f("../equations/RotationalVelocityEquation"),l=f("../equations/RotationalLockEquation"),
k=f("../math/vec2");b.exports=d;var m=k.create(),n=k.create(),p=k.fromValues(1,0),q=k.fromValues(0,1),r=k.create();d.prototype=new e;d.prototype.setLimits=function(b,d){"number"==typeof b?(this.lowerLimit=b,this.lowerLimitEnabled=!0):(this.lowerLimit=b,this.lowerLimitEnabled=!1);"number"==typeof d?(this.upperLimit=d,this.upperLimitEnabled=!0):(this.upperLimit=d,this.upperLimitEnabled=!1)};d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.pivotA,g=this.pivotB,f=this.equations,h=(f[0],
f[1],f[0]),l=f[1],r=this.upperLimit,E=this.lowerLimit,z=this.upperLimitEquation,G=this.lowerLimitEquation,J=this.angle=d.angle-b.angle;this.upperLimitEnabled&&J>r?(z.angle=r,-1===f.indexOf(z)&&f.push(z)):(r=f.indexOf(z),-1!==r&&f.splice(r,1));this.lowerLimitEnabled&&E>J?(G.angle=E,-1===f.indexOf(G)&&f.push(G)):(r=f.indexOf(G),-1!==r&&f.splice(r,1));k.rotate(m,e,b.angle);k.rotate(n,g,d.angle);h.G[0]=-1;h.G[1]=0;h.G[2]=-k.crossLength(m,p);h.G[3]=1;h.G[4]=0;h.G[5]=k.crossLength(n,p);l.G[0]=0;l.G[1]=
-1;l.G[2]=-k.crossLength(m,q);l.G[3]=0;l.G[4]=1;l.G[5]=k.crossLength(n,q)};d.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)};d.prototype.disableMotor=function(){if(this.motorEnabled){var b=this.equations.indexOf(this.motorEquation);this.equations.splice(b,1);this.motorEnabled=!1}};d.prototype.motorIsEnabled=function(){return!!this.motorEnabled};d.prototype.setMotorSpeed=function(b){if(this.motorEnabled){var d=this.equations.indexOf(this.motorEquation);
this.equations[d].relativeVelocity=b}};d.prototype.getMotorSpeed=function(){return this.motorEnabled?this.motorEquation.relativeVelocity:!1}},{"../equations/Equation":23,"../equations/RotationalLockEquation":25,"../equations/RotationalVelocityEquation":26,"../math/vec2":31,"./Constraint":15,__browserify_Buffer:1,__browserify_process:2}],21:[function(f,b){function d(b,d,f){f=f||{};e.call(this,b,d,-Number.MAX_VALUE,Number.MAX_VALUE);this.angle=f.angle||0;this.ratio="number"==typeof f.ratio?f.ratio:
1;this.setRatio(this.ratio)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Equation"));f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.constructor=d;d.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle};d.prototype.setRatio=function(b){var d=this.G;d[2]=b;d[5]=-1;this.ratio=b};d.prototype.setMaxTorque=function(b){this.maxForce=b;this.minForce=-b}},{"../math/vec2":31,"./Equation":23,__browserify_Buffer:1,__browserify_process:2}],
22:[function(f,b){function d(b,d){e.call(this,b,d,0,Number.MAX_VALUE);this.contactPointA=g.create();this.penetrationVec=g.create();this.contactPointB=g.create();this.normalA=g.create();this.restitution=0;this.firstImpact=!1;this.shapeB=this.shapeA=null}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Equation")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.constructor=d;d.prototype.computeB=function(b,d,e){var f=this.contactPointA,n=this.contactPointB,p=this.bodyA.position,
q=this.bodyB.position,r=this.penetrationVec,t=this.normalA,w=this.G,v=g.crossLength(f,t),u=g.crossLength(n,t);w[0]=-t[0];w[1]=-t[1];w[2]=-v;w[3]=t[0];w[4]=t[1];w[5]=u;g.add(r,q,n);g.sub(r,r,p);g.sub(r,r,f);var y,C;this.firstImpact&&0!==this.restitution?(C=0,y=1/d*(1+this.restitution)*this.computeGW()):(C=g.dot(t,r)+this.offset,y=this.computeGW());f=this.computeGiMf();return-C*b-y*d-e*f}},{"../math/vec2":31,"./Equation":23,__browserify_Buffer:1,__browserify_process:2}],23:[function(f,b){function d(b,
e,f,h){this.minForce="undefined"==typeof f?-Number.MAX_VALUE:f;this.maxForce="undefined"==typeof h?Number.MAX_VALUE:h;this.bodyA=b;this.bodyB=e;this.stiffness=d.DEFAULT_STIFFNESS;this.relaxation=d.DEFAULT_RELAXATION;this.G=new g.ARRAY_TYPE(6);for(b=0;6>b;b++)this.G[b]=0;this.epsilon=this.b=this.a=this.offset=0;this.timeStep=1/60;this.needsUpdate=!0;this.relativeVelocity=this.multiplier=0;this.enabled=!0}f("__browserify_process");f("__browserify_Buffer");b.exports=d;var e=f("../math/vec2"),g=f("../utils/Utils");
f("../objects/Body");d.prototype.constructor=d;d.DEFAULT_STIFFNESS=1E6;d.DEFAULT_RELAXATION=4;d.prototype.update=function(){var b=this.stiffness,d=this.relaxation,e=this.timeStep;this.a=4/(e*(1+4*d));this.b=4*d/(1+4*d);this.epsilon=4/(e*e*b*(1+4*d));this.needsUpdate=!1};d.prototype.gmult=function(b,d,e,g,f){return b[0]*d[0]+b[1]*d[1]+b[2]*e+b[3]*g[0]+b[4]*g[1]+b[5]*f};d.prototype.computeB=function(b,d,e){var g=this.computeGW(),f=this.computeGq(),h=this.computeGiMf();return-f*b-g*d-h*e};var h=e.create(),
l=e.create();d.prototype.computeGq=function(){var b=this.G,d=this.bodyA,e=this.bodyB,d=(d.position,e.position,d.angle);return this.gmult(b,h,d,l,e.angle)+this.offset};d.prototype.computeGW=function(){var b=this.bodyA,d=this.bodyB;return this.gmult(this.G,b.velocity,b.angularVelocity,d.velocity,d.angularVelocity)+this.relativeVelocity};d.prototype.computeGWlambda=function(){var b=this.bodyA,d=this.bodyB;return this.gmult(this.G,b.vlambda,b.wlambda,d.vlambda,d.wlambda)};var k=e.create(),m=e.create();
d.prototype.computeGiMf=function(){var b=this.bodyA,d=this.bodyB,g=b.angularForce,f=d.force,h=d.angularForce,l=d.invMassSolve,n=b.invInertiaSolve,d=d.invInertiaSolve,p=this.G;return e.scale(k,b.force,b.invMassSolve),e.scale(m,f,l),this.gmult(p,k,g*n,m,h*d)};d.prototype.computeGiMGt=function(){var b=this.bodyA,d=this.bodyB,e=b.invMassSolve,g=d.invMassSolve,f=this.G;return f[0]*f[0]*e+f[1]*f[1]*e+f[2]*f[2]*b.invInertiaSolve+f[3]*f[3]*g+f[4]*f[4]*g+f[5]*f[5]*d.invInertiaSolve};var n=e.create(),p=e.create(),
q=e.create();e.create();e.create();e.create();d.prototype.addToWlambda=function(b){var d=this.bodyA,g=this.bodyB,f=d.invMassSolve,h=g.invMassSolve,k=d.invInertiaSolve,l=g.invInertiaSolve,m=this.G;p[0]=m[0];p[1]=m[1];q[0]=m[3];q[1]=m[4];e.scale(n,p,f*b);e.add(d.vlambda,d.vlambda,n);d.wlambda+=k*m[2]*b;e.scale(n,q,h*b);e.add(g.vlambda,g.vlambda,n);g.wlambda+=l*m[5]*b};d.prototype.computeInvC=function(b){return 1/(this.computeGiMGt()+b)}},{"../math/vec2":31,"../objects/Body":32,"../utils/Utils":50,__browserify_Buffer:1,
__browserify_process:2}],24:[function(f,b){function d(b,d,f){g.call(this,b,d,-f,f);this.contactPointA=e.create();this.contactPointB=e.create();this.t=e.create();this.contactEquations=[];this.shapeB=this.shapeA=null;this.frictionCoefficient=.3}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("./Equation");f("../utils/Utils");b.exports=d;d.prototype=new g;d.prototype.constructor=d;d.prototype.setSlipForce=function(b){this.maxForce=b;this.minForce=-b};d.prototype.getSlipForce=
function(){return this.maxForce};d.prototype.computeB=function(b,d,g){b=(this.bodyA,this.bodyB,this.contactPointA);var f=this.contactPointB,n=this.t,p=this.G;p[0]=-n[0];p[1]=-n[1];p[2]=-e.crossLength(b,n);p[3]=n[0];p[4]=n[1];p[5]=e.crossLength(f,n);b=this.computeGW();f=this.computeGiMf();return-b*d-g*f}},{"../math/vec2":31,"../utils/Utils":50,"./Equation":23,__browserify_Buffer:1,__browserify_process:2}],25:[function(f,b){function d(b,d,g){g=g||{};e.call(this,b,d,-Number.MAX_VALUE,Number.MAX_VALUE);
this.angle=g.angle||0;b=this.G;b[2]=1;b[5]=-1}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Equation")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.constructor=d;var h=g.create(),l=g.create(),k=g.fromValues(1,0),m=g.fromValues(0,1);d.prototype.computeGq=function(){return g.rotate(h,k,this.bodyA.angle+this.angle),g.rotate(l,m,this.bodyB.angle),g.dot(h,l)}},{"../math/vec2":31,"./Equation":23,__browserify_Buffer:1,__browserify_process:2}],26:[function(f,b){function d(b,
d){e.call(this,b,d,-Number.MAX_VALUE,Number.MAX_VALUE);this.ratio=this.relativeVelocity=1}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Equation"));f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.constructor=d;d.prototype.computeB=function(b,d,e){b=this.G;b[2]=-1;b[5]=this.ratio;b=this.computeGiMf();return-this.computeGW()*d-e*b}},{"../math/vec2":31,"./Equation":23,__browserify_Buffer:1,__browserify_process:2}],27:[function(f,b){var d=(f("__browserify_process"),f("__browserify_Buffer"),
function(){});b.exports=d;d.prototype={constructor:d,on:function(b,d,f){d.context=f||this;void 0===this._listeners&&(this._listeners={});f=this._listeners;return void 0===f[b]&&(f[b]=[]),-1===f[b].indexOf(d)&&f[b].push(d),this},has:function(b,d){if(void 0===this._listeners)return!1;var f=this._listeners;if(d){if(void 0!==f[b]&&-1!==f[b].indexOf(d))return!0}else if(void 0!==f[b])return!0;return!1},off:function(b,d){if(void 0===this._listeners)return this;var f=this._listeners,l=f[b].indexOf(d);return-1!==
l&&f[b].splice(l,1),this},emit:function(b){if(void 0===this._listeners)return this;var d=this._listeners[b.type];if(void 0!==d){b.target=this;for(var f=0,l=d.length;l>f;f++){var k=d[f];k.call(k.context,b)}}return this}}},{__browserify_Buffer:1,__browserify_process:2}],28:[function(f,b){function d(b,f,k){if(k=k||{},!(b instanceof e&&f instanceof e))throw Error("First two arguments must be Material instances.");this.id=d.idCounter++;this.materialA=b;this.materialB=f;this.friction="undefined"!=typeof k.friction?
Number(k.friction):.3;this.restitution="undefined"!=typeof k.restitution?Number(k.restitution):0;this.stiffness="undefined"!=typeof k.stiffness?Number(k.stiffness):g.DEFAULT_STIFFNESS;this.relaxation="undefined"!=typeof k.relaxation?Number(k.relaxation):g.DEFAULT_RELAXATION;this.frictionStiffness="undefined"!=typeof k.frictionStiffness?Number(k.frictionStiffness):g.DEFAULT_STIFFNESS;this.frictionRelaxation="undefined"!=typeof k.frictionRelaxation?Number(k.frictionRelaxation):g.DEFAULT_RELAXATION;
this.surfaceVelocity="undefined"!=typeof k.surfaceVelocity?Number(k.surfaceVelocity):0;this.contactSkinSize=.005}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Material")),g=f("../equations/Equation");b.exports=d;d.idCounter=0},{"../equations/Equation":23,"./Material":29,__browserify_Buffer:1,__browserify_process:2}],29:[function(f,b){function d(b){this.id=b||d.idCounter++}f("__browserify_process");f("__browserify_Buffer");b.exports=d;d.idCounter=0},{__browserify_Buffer:1,__browserify_process:2}],
30:[function(f,b){var d=(f("__browserify_process"),f("__browserify_Buffer"),{});d.GetArea=function(b){if(6>b.length)return 0;for(var d=b.length-2,f=0,l=0;d>l;l+=2)f+=(b[l+2]-b[l])*(b[l+1]+b[l+3]);return f+=(b[0]-b[d])*(b[d+1]+b[1]),.5*-f};d.Triangulate=function(b){var g=b.length>>1;if(3>g)return[];for(var f=[],l=[],k=0;g>k;k++)l.push(k);for(k=0;3<g;){var m=l[(k+0)%g],n=l[(k+1)%g],p=l[(k+2)%g],q=b[2*m],r=b[2*m+1],t=b[2*n],w=b[2*n+1],v=b[2*p],u=b[2*p+1],y=!1;if(d._convex(q,r,t,w,v,u))for(var y=!0,C=
0;g>C;C++){var x=l[C];if(x!=m&&x!=n&&x!=p&&d._PointInTriangle(b[2*x],b[2*x+1],q,r,t,w,v,u)){y=!1;break}}if(y)f.push(m,n,p),l.splice((k+1)%g,1),g--,k=0;else if(k++>3*g)break}return f.push(l[0],l[1],l[2]),f};d._PointInTriangle=function(b,d,f,l,k,m,n,p){n-=f;p-=l;k-=f;m-=l;b-=f;f=d-l;d=n*n+p*p;l=n*k+p*m;n=n*b+p*f;p=k*k+m*m;k=k*b+m*f;m=1/(d*p-l*l);p=(p*n-l*k)*m;n=(d*k-l*n)*m;return 0<=p&&0<=n&&1>p+n};d._convex=function(b,d,f,l,k,m){return 0<=(d-l)*(k-f)+(f-b)*(m-l)};b.exports=d},{__browserify_Buffer:1,
__browserify_process:2}],31:[function(f,b){var d=(f("__browserify_process"),f("__browserify_Buffer"),b.exports={}),e=f("../utils/Utils");d.crossLength=function(b,d){return b[0]*d[1]-b[1]*d[0]};d.crossVZ=function(b,e,f){return d.rotate(b,e,-Math.PI/2),d.scale(b,b,f),b};d.crossZV=function(b,e,f){return d.rotate(b,f,Math.PI/2),d.scale(b,b,e),b};d.rotate=function(b,d,e){if(0!==e){var f=Math.cos(e);e=Math.sin(e);var m=d[0];d=d[1];b[0]=f*m-e*d;b[1]=e*m+f*d}else b[0]=d[0],b[1]=d[1]};d.rotate90cw=function(b,
d){var e=d[0];b[0]=d[1];b[1]=-e};d.toLocalFrame=function(b,e,f,k){d.copy(b,e);d.sub(b,b,f);d.rotate(b,b,-k)};d.toGlobalFrame=function(b,e,f,k){d.copy(b,e);d.rotate(b,b,k);d.add(b,b,f)};d.centroid=function(b,e,f,k){return d.add(b,e,f),d.add(b,b,k),d.scale(b,b,1/3),b};d.create=function(){var b=new e.ARRAY_TYPE(2);return b[0]=0,b[1]=0,b};d.clone=function(b){var d=new e.ARRAY_TYPE(2);return d[0]=b[0],d[1]=b[1],d};d.fromValues=function(b,d){var f=new e.ARRAY_TYPE(2);return f[0]=b,f[1]=d,f};d.copy=function(b,
d){return b[0]=d[0],b[1]=d[1],b};d.set=function(b,d,e){return b[0]=d,b[1]=e,b};d.add=function(b,d,e){return b[0]=d[0]+e[0],b[1]=d[1]+e[1],b};d.subtract=function(b,d,e){return b[0]=d[0]-e[0],b[1]=d[1]-e[1],b};d.sub=d.subtract;d.multiply=function(b,d,e){return b[0]=d[0]*e[0],b[1]=d[1]*e[1],b};d.mul=d.multiply;d.divide=function(b,d,e){return b[0]=d[0]/e[0],b[1]=d[1]/e[1],b};d.div=d.divide;d.scale=function(b,d,e){return b[0]=d[0]*e,b[1]=d[1]*e,b};d.distance=function(b,d){var e=d[0]-b[0],f=d[1]-b[1];return Math.sqrt(e*
e+f*f)};d.dist=d.distance;d.squaredDistance=function(b,d){var e=d[0]-b[0],f=d[1]-b[1];return e*e+f*f};d.sqrDist=d.squaredDistance;d.length=function(b){var d=b[0];b=b[1];return Math.sqrt(d*d+b*b)};d.len=d.length;d.squaredLength=function(b){var d=b[0];b=b[1];return d*d+b*b};d.sqrLen=d.squaredLength;d.negate=function(b,d){return b[0]=-d[0],b[1]=-d[1],b};d.normalize=function(b,d){var e=d[0],f=d[1],e=e*e+f*f;return 0<e&&(e=1/Math.sqrt(e),b[0]=d[0]*e,b[1]=d[1]*e),b};d.dot=function(b,d){return b[0]*d[0]+
b[1]*d[1]};d.str=function(b){return"vec2("+b[0]+", "+b[1]+")"}},{"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],32:[function(f,b){function d(b){b=b||{};k.call(this);this.id=++d._idCounter;this.world=null;this.shapes=[];this.shapeOffsets=[];this.shapeAngles=[];this.mass=b.mass||0;this.invInertiaSolve=this.invMassSolve=this.invInertia=this.inertia=this.invMass=0;this.fixedRotation=!!b.fixedRotation;this.position=e.fromValues(0,0);b.position&&e.copy(this.position,b.position);this.interpolatedPosition=
e.fromValues(0,0);this.interpolatedAngle=0;this.previousPosition=e.fromValues(0,0);this.previousAngle=0;this.velocity=e.fromValues(0,0);b.velocity&&e.copy(this.velocity,b.velocity);this.vlambda=e.fromValues(0,0);this.wlambda=0;this.angle=b.angle||0;this.angularVelocity=b.angularVelocity||0;this.force=e.create();b.force&&e.copy(this.force,b.force);this.angularForce=b.angularForce||0;this.damping="number"==typeof b.damping?b.damping:.1;this.angularDamping="number"==typeof b.angularDamping?b.angularDamping:
.1;this.type=d.STATIC;this.type="undefined"!=typeof b.type?b.type:b.mass?d.DYNAMIC:d.STATIC;this.boundingRadius=0;this.aabb=new l;this.allowSleep=this.aabbNeedsUpdate=!0;this.wantsToSleep=!1;this.sleepState=d.AWAKE;this.sleepSpeedLimit=.2;this.gravityScale=this.sleepTimeLimit=1;this.timeLastSleepy=0;this.concavePath=null;this._wakeUpAfterNarrowphase=!1;this.updateMassProperties()}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("poly-decomp"),h=f("../shapes/Convex"),
l=f("../collision/AABB"),k=f("../events/EventEmitter");b.exports=d;d.prototype=new k;d._idCounter=0;d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)};d.prototype.setDensity=function(b){this.mass=this.getArea()*b;this.updateMassProperties()};d.prototype.getArea=function(){for(var b=0,d=0;d<this.shapes.length;d++)b+=this.shapes[d].area;
return b};d.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var m=new l,n=e.create();d.prototype.updateAABB=function(){for(var b=this.shapes,d=this.shapeOffsets,g=this.shapeAngles,f=b.length,h=this.angle,k=0;k!==f;k++){var l=b[k],p=g[k]+h;e.rotate(n,d[k],h);e.add(n,n,this.position);l.computeAABB(m,n,p);0===k?this.aabb.copy(m):this.aabb.extend(m)}this.aabbNeedsUpdate=!1};d.prototype.updateBoundingRadius=function(){for(var b=this.shapes,d=this.shapeOffsets,g=b.length,
f=0,h=0;h!==g;h++){var k=b[h],l=e.length(d[h]),k=k.boundingRadius;l+k>f&&(f=l+k)}this.boundingRadius=f};d.prototype.addShape=function(b,d,g){g=g||0;d=d?e.fromValues(d[0],d[1]):e.fromValues(0,0);this.shapes.push(b);this.shapeOffsets.push(d);this.shapeAngles.push(g);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0};d.prototype.removeShape=function(b){b=this.shapes.indexOf(b);return-1!==b?(this.shapes.splice(b,1),this.shapeOffsets.splice(b,1),this.shapeAngles.splice(b,
1),this.aabbNeedsUpdate=!0,!0):!1};d.prototype.updateMassProperties=function(){if(this.type===d.STATIC||this.type===d.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var b=this.shapes,g=b.length,f=this.mass/g,h=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var k=0;g>k;k++)var l=b[k],m=e.squaredLength(this.shapeOffsets[k]),l=l.computeMomentOfInertia(f),h=h+(l+f*m);this.inertia=h;this.invInertia=0<h?1/h:0}this.invMass=
1/this.mass}};var p=e.create();d.prototype.applyForce=function(b,d){e.sub(p,d,this.position);e.add(this.force,this.force,b);var g=e.crossLength(p,b);this.angularForce+=g};d.prototype.toLocalFrame=function(b,d){e.toLocalFrame(b,d,this.position,this.angle)};d.prototype.toWorldFrame=function(b,d){e.toGlobalFrame(b,d,this.position,this.angle)};d.prototype.fromPolygon=function(b,d){d=d||{};for(var f=this.shapes.length;0<=f;--f)this.removeShape(this.shapes[f]);var k=new g.Polygon;if(k.vertices=b,k.makeCCW(),
"number"==typeof d.removeCollinearPoints&&k.removeCollinearPoints(d.removeCollinearPoints),"undefined"==typeof d.skipSimpleCheck&&!k.isSimple())return!1;this.concavePath=k.vertices.slice(0);for(f=0;f<this.concavePath.length;f++){var l=[0,0];e.copy(l,this.concavePath[f]);this.concavePath[f]=l}for(var k=d.optimalDecomp?k.decomp():k.quickDecomp(),m=e.create(),f=0;f!==k.length;f++){for(var n=new h(k[f].vertices),p=0;p!==n.vertices.length;p++)l=n.vertices[p],e.sub(l,l,n.centerOfMass);e.scale(m,n.centerOfMass,
1);n.updateTriangles();n.updateCenterOfMass();n.updateBoundingRadius();this.addShape(n,m)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var q=(e.fromValues(0,0),e.fromValues(0,0)),r=e.fromValues(0,0),t=e.fromValues(0,0);d.prototype.adjustCenterOfMass=function(){var b=0;e.set(r,0,0);for(var d=0;d!==this.shapes.length;d++){var g=this.shapes[d],f=this.shapeOffsets[d];e.scale(q,f,g.area);e.add(r,r,q);b+=g.area}e.scale(t,r,1/b);for(d=0;d!==this.shapes.length;d++)(f=this.shapeOffsets[d])||
(f=this.shapeOffsets[d]=e.create()),e.sub(f,f,t);e.add(this.position,this.position,t);for(d=0;this.concavePath&&d<this.concavePath.length;d++)e.sub(this.concavePath[d],this.concavePath[d],t);this.updateMassProperties();this.updateBoundingRadius()};d.prototype.setZeroForce=function(){e.set(this.force,0,0);this.angularForce=0};d.prototype.resetConstraintVelocity=function(){e.set(this.vlambda,0,0);this.wlambda=0};d.prototype.addConstraintVelocity=function(){var b=this.velocity;e.add(b,b,this.vlambda);
this.angularVelocity+=this.wlambda};d.prototype.applyDamping=function(b){if(this.type===d.DYNAMIC){var g=this.velocity;e.scale(g,g,Math.pow(1-this.damping,b));this.angularVelocity*=Math.pow(1-this.angularDamping,b)}};d.prototype.wakeUp=function(){var b=this.sleepState;this.sleepState=d.AWAKE;this.idleTime=0;b!==d.AWAKE&&this.emit(d.wakeUpEvent)};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.angularForce=this.angularVelocity=0;e.set(this.velocity,0,0);e.set(this.force,0,0);this.emit(d.sleepEvent)};
d.prototype.sleepTick=function(b,g,f){if(this.allowSleep&&this.type!==d.SLEEPING){this.wantsToSleep=!1;b=(this.sleepState,e.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2));var h=Math.pow(this.sleepSpeedLimit,2);b>=h?(this.idleTime=0,this.sleepState=d.AWAKE):(this.idleTime+=f,this.sleepState=d.SLEEPY);this.idleTime>this.sleepTimeLimit&&(g?this.wantsToSleep=!0:this.sleep())}};d.prototype.getVelocityFromPosition=function(b,d){return b=b||e.create(),e.sub(b,this.position,this.previousPosition),
e.scale(b,b,1/d),b};d.prototype.getAngularVelocityFromPosition=function(b){return(this.angle-this.previousAngle)/b};d.prototype.overlaps=function(b){return this.world.overlapKeeper.bodiesAreOverlapping(this,b)};d.sleepyEvent={type:"sleepy"};d.sleepEvent={type:"sleep"};d.wakeUpEvent={type:"wakeup"};d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2},{"../collision/AABB":9,"../events/EventEmitter":27,"../math/vec2":31,"../shapes/Convex":39,__browserify_Buffer:1,__browserify_process:2,
"poly-decomp":7}],33:[function(f,b){function d(b,d,f){f=f||{};g.call(this,b,d,f);this.localAnchorA=e.fromValues(0,0);this.localAnchorB=e.fromValues(0,0);f.localAnchorA&&e.copy(this.localAnchorA,f.localAnchorA);f.localAnchorB&&e.copy(this.localAnchorB,f.localAnchorB);f.worldAnchorA&&this.setWorldAnchorA(f.worldAnchorA);f.worldAnchorB&&this.setWorldAnchorB(f.worldAnchorB);b=e.create();d=e.create();this.getWorldAnchorA(b);this.getWorldAnchorB(d);b=e.distance(b,d);this.restLength="number"==typeof f.restLength?
f.restLength:b}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("./Spring");f("../utils/Utils");b.exports=d;d.prototype=new g;d.prototype.setWorldAnchorA=function(b){this.bodyA.toLocalFrame(this.localAnchorA,b)};d.prototype.setWorldAnchorB=function(b){this.bodyB.toLocalFrame(this.localAnchorB,b)};d.prototype.getWorldAnchorA=function(b){this.bodyA.toWorldFrame(b,this.localAnchorA)};d.prototype.getWorldAnchorB=function(b){this.bodyB.toWorldFrame(b,this.localAnchorB)};
var h=e.create(),l=e.create(),k=e.create(),m=e.create(),n=e.create(),p=e.create(),q=e.create(),r=e.create(),t=e.create();d.prototype.applyForce=function(){var b=this.stiffness,d=this.damping,g=this.restLength,f=this.bodyA,C=this.bodyB;this.getWorldAnchorA(n);this.getWorldAnchorB(p);e.sub(q,n,f.position);e.sub(r,p,C.position);e.sub(h,p,n);var x=e.len(h);e.normalize(l,h);e.sub(k,C.velocity,f.velocity);e.crossZV(t,C.angularVelocity,r);e.add(k,k,t);e.crossZV(t,f.angularVelocity,q);e.sub(k,k,t);e.scale(m,
l,-b*(x-g)-d*e.dot(k,l));e.sub(f.force,f.force,m);e.add(C.force,C.force,m);b=e.crossLength(q,m);d=e.crossLength(r,m);f.angularForce-=b;C.angularForce+=d}},{"../math/vec2":31,"../utils/Utils":50,"./Spring":35,__browserify_Buffer:1,__browserify_process:2}],34:[function(f,b){function d(b,d,f){f=f||{};e.call(this,b,d,f);this.restAngle="number"==typeof f.restAngle?f.restAngle:d.angle-b.angle}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2"),f("./Spring"));b.exports=d;d.prototype=
new e;d.prototype.applyForce=function(){var b=this.bodyA,d=this.bodyB,e=-this.stiffness*(d.angle-b.angle-this.restAngle)-this.damping*(d.angularVelocity-b.angularVelocity)*0;b.angularForce-=e;d.angularForce+=e}},{"../math/vec2":31,"./Spring":35,__browserify_Buffer:1,__browserify_process:2}],35:[function(f,b){function d(b,d,f){f=e.defaults(f,{stiffness:100,damping:1});this.stiffness=f.stiffness;this.damping=f.damping;this.bodyA=b;this.bodyB=d}var e=(f("__browserify_process"),f("__browserify_Buffer"),
f("../math/vec2"),f("../utils/Utils"));b.exports=d;d.prototype.applyForce=function(){}},{"../math/vec2":31,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],36:[function(f,b){f("__browserify_process");f("__browserify_Buffer");b.exports={AABB:f("./collision/AABB"),AngleLockEquation:f("./equations/AngleLockEquation"),Body:f("./objects/Body"),Broadphase:f("./collision/Broadphase"),Capsule:f("./shapes/Capsule"),Circle:f("./shapes/Circle"),Constraint:f("./constraints/Constraint"),ContactEquation:f("./equations/ContactEquation"),
ContactMaterial:f("./material/ContactMaterial"),Convex:f("./shapes/Convex"),DistanceConstraint:f("./constraints/DistanceConstraint"),Equation:f("./equations/Equation"),EventEmitter:f("./events/EventEmitter"),FrictionEquation:f("./equations/FrictionEquation"),GearConstraint:f("./constraints/GearConstraint"),GridBroadphase:f("./collision/GridBroadphase"),GSSolver:f("./solver/GSSolver"),Heightfield:f("./shapes/Heightfield"),Line:f("./shapes/Line"),LockConstraint:f("./constraints/LockConstraint"),Material:f("./material/Material"),
Narrowphase:f("./collision/Narrowphase"),NaiveBroadphase:f("./collision/NaiveBroadphase"),Particle:f("./shapes/Particle"),Plane:f("./shapes/Plane"),RevoluteConstraint:f("./constraints/RevoluteConstraint"),PrismaticConstraint:f("./constraints/PrismaticConstraint"),Rectangle:f("./shapes/Rectangle"),RotationalVelocityEquation:f("./equations/RotationalVelocityEquation"),SAPBroadphase:f("./collision/SAPBroadphase"),Shape:f("./shapes/Shape"),Solver:f("./solver/Solver"),Spring:f("./objects/Spring"),LinearSpring:f("./objects/LinearSpring"),
RotationalSpring:f("./objects/RotationalSpring"),Utils:f("./utils/Utils"),World:f("./world/World"),vec2:f("./math/vec2"),version:f("../package.json").version}},{"../package.json":8,"./collision/AABB":9,"./collision/Broadphase":10,"./collision/GridBroadphase":11,"./collision/NaiveBroadphase":12,"./collision/Narrowphase":13,"./collision/SAPBroadphase":14,"./constraints/Constraint":15,"./constraints/DistanceConstraint":16,"./constraints/GearConstraint":17,"./constraints/LockConstraint":18,"./constraints/PrismaticConstraint":19,
"./constraints/RevoluteConstraint":20,"./equations/AngleLockEquation":21,"./equations/ContactEquation":22,"./equations/Equation":23,"./equations/FrictionEquation":24,"./equations/RotationalVelocityEquation":26,"./events/EventEmitter":27,"./material/ContactMaterial":28,"./material/Material":29,"./math/vec2":31,"./objects/Body":32,"./objects/LinearSpring":33,"./objects/RotationalSpring":34,"./objects/Spring":35,"./shapes/Capsule":37,"./shapes/Circle":38,"./shapes/Convex":39,"./shapes/Heightfield":40,
"./shapes/Line":41,"./shapes/Particle":42,"./shapes/Plane":43,"./shapes/Rectangle":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/Utils":50,"./world/World":54,__browserify_Buffer:1,__browserify_process:2}],37:[function(f,b){function d(b,d){this.length=b||1;this.radius=d||1;e.call(this,e.CAPSULE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(b){var d=
this.radius,e=this.length+d,d=2*d;return b*(d*d+e*e)/12};d.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2};d.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var h=g.create();d.prototype.computeAABB=function(b,d,e){var f=this.radius;g.set(h,this.length/2,0);0!==e&&g.rotate(h,h,e);g.set(b.upperBound,Math.max(h[0]+f,-h[0]+f),Math.max(h[1]+f,-h[1]+f));g.set(b.lowerBound,Math.min(h[0]-f,-h[0]-f),Math.min(h[1]-
f,-h[1]-f));g.add(b.lowerBound,b.lowerBound,d);g.add(b.upperBound,b.upperBound,d)}},{"../math/vec2":31,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],38:[function(f,b){function d(b){this.radius=b||1;e.call(this,e.CIRCLE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(b){var d=this.radius;return b*d*d/2};d.prototype.updateBoundingRadius=function(){this.boundingRadius=
this.radius};d.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius};d.prototype.computeAABB=function(b,d){var e=this.radius;g.set(b.upperBound,e,e);g.set(b.lowerBound,-e,-e);d&&(g.add(b.lowerBound,b.lowerBound,d),g.add(b.upperBound,b.upperBound,d))}},{"../math/vec2":31,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],39:[function(f,b){function d(b,d){this.vertices=[];this.axes=[];for(var f=0;f<b.length;f++){var h=g.create();g.copy(h,b[f]);this.vertices.push(h)}if(d)for(f=
0;f<d.length;f++)h=g.create(),g.copy(h,d[f]),this.axes.push(h);else for(f=0;f<b.length;f++){var h=b[f],k=b[(f+1)%b.length],l=g.create();g.sub(l,k,h);g.rotate90cw(l,l);g.normalize(l,l);this.axes.push(l)}if(this.centerOfMass=g.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,e.call(this,e.CONVEX),this.updateBoundingRadius(),this.updateArea(),0>this.area)throw Error("Convex vertices must be given in conter-clockwise winding.");
}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2"),h=f("../math/polyk");f("poly-decomp");b.exports=d;d.prototype=new e;var l=g.create(),k=g.create();d.prototype.projectOntoLocalAxis=function(b,d){var e,f=null,h=null;b=l;for(var k=0;k<this.vertices.length;k++)e=this.vertices[k],e=g.dot(e,b),(null===f||e>f)&&(f=e),(null===h||h>e)&&(h=e);h>f&&(k=h,h=f,f=k);g.set(d,h,f)};d.prototype.projectOntoWorldAxis=function(b,d,e,f){var h=k;this.projectOntoLocalAxis(b,f);
0!==e?g.rotate(h,b,e):h=b;b=g.dot(d,h);g.set(f,f[0]+b,f[1]+b)};d.prototype.updateTriangles=function(){this.triangles.length=0;for(var b=[],d=0;d<this.vertices.length;d++){var e=this.vertices[d];b.push(e[0],e[1])}b=h.Triangulate(b);for(d=0;d<b.length;d+=3)this.triangles.push([b[d],b[d+1],b[d+2]])};var m=g.create(),n=g.create(),p=g.create(),q=g.create(),r=g.create();g.create();g.create();g.create();g.create();d.prototype.updateCenterOfMass=function(){var b=this.triangles,e=this.vertices,f=this.centerOfMass,
h=p,k=q,l=r;g.set(f,0,0);for(var x=0,B=0;B!==b.length;B++)l=b[B],h=e[l[0]],k=e[l[1]],l=e[l[2]],g.centroid(m,h,k,l),h=d.triangleArea(h,k,l),x+=h,g.scale(n,m,h),g.add(f,f,n);g.scale(f,f,1/x)};d.prototype.computeMomentOfInertia=function(b){for(var d=0,e=0,f=this.vertices.length,h=f-1,k=0;f>k;h=k,k++)var l=this.vertices[h],m=this.vertices[k],h=Math.abs(g.crossLength(l,m)),l=g.dot(m,m)+g.dot(m,l)+g.dot(l,l),d=d+h*l,e=e+h;return b/6*(d/e)};d.prototype.updateBoundingRadius=function(){for(var b=this.vertices,
d=0,e=0;e!==b.length;e++){var f=g.squaredLength(b[e]);f>d&&(d=f)}this.boundingRadius=Math.sqrt(d)};d.triangleArea=function(b,d,e){return.5*((d[0]-b[0])*(e[1]-b[1])-(e[0]-b[0])*(d[1]-b[1]))};d.prototype.updateArea=function(){this.updateTriangles();this.area=0;for(var b=this.triangles,e=this.vertices,g=0;g!==b.length;g++){var f=b[g],f=d.triangleArea(e[f[0]],e[f[1]],e[f[2]]);this.area+=f}};d.prototype.computeAABB=function(b,d,e){b.setFromPoints(this.vertices,d,e,0)}},{"../math/polyk":30,"../math/vec2":31,
"./Shape":45,__browserify_Buffer:1,__browserify_process:2,"poly-decomp":7}],40:[function(f,b){function d(b,d){if(d=g.defaults(d,{maxValue:null,minValue:null,elementWidth:.1}),null===d.minValue||null===d.maxValue){d.maxValue=b[0];d.minValue=b[0];for(var f=0;f!==b.length;f++){var m=b[f];m>d.maxValue&&(d.maxValue=m);m<d.minValue&&(d.minValue=m)}}this.data=b;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementWidth=d.elementWidth;e.call(this,e.HEIGHTFIELD)}var e=(f("__browserify_process"),f("__browserify_Buffer"),
f("./Shape")),g=(f("../math/vec2"),f("../utils/Utils"));b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(){return Number.MAX_VALUE};d.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};d.prototype.updateArea=function(){for(var b=this.data,d=0,e=0;e<b.length-1;e++)d+=(b[e]+b[e+1])/2*this.elementWidth;this.area=d};d.prototype.computeAABB=function(b,d){b.upperBound[0]=this.elementWidth*this.data.length+d[0];b.upperBound[1]=this.maxValue+d[1];b.lowerBound[0]=
d[0];b.lowerBound[1]=-Number.MAX_VALUE}},{"../math/vec2":31,"../utils/Utils":50,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],41:[function(f,b){function d(b){this.length=b||1;e.call(this,e.LINE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(b){return b*Math.pow(this.length,2)/12};d.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var h=[g.create(),
g.create()];d.prototype.computeAABB=function(b,d,e){var f=this.length/2;g.set(h[0],-f,0);g.set(h[1],f,0);b.setFromPoints(h,d,e,0)}},{"../math/vec2":31,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],42:[function(f,b){function d(){e.call(this,e.PARTICLE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2");b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(){return 0};d.prototype.updateBoundingRadius=function(){this.boundingRadius=
0};d.prototype.computeAABB=function(b,d){g.copy(b.lowerBound,d);g.copy(b.upperBound,d)}},{"../math/vec2":31,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],43:[function(f,b){function d(){e.call(this,e.PLANE)}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Shape")),g=f("../math/vec2");f("../utils/Utils");b.exports=d;d.prototype=new e;d.prototype.computeMomentOfInertia=function(){return 0};d.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};d.prototype.computeAABB=
function(b,d,e){var f=0,n=g.set;"number"==typeof e&&(f=e%(2*Math.PI));0===f?(n(b.lowerBound,-Number.MAX_VALUE,-Number.MAX_VALUE),n(b.upperBound,Number.MAX_VALUE,0)):f===Math.PI/2?(n(b.lowerBound,0,-Number.MAX_VALUE),n(b.upperBound,Number.MAX_VALUE,Number.MAX_VALUE)):f===Math.PI?(n(b.lowerBound,-Number.MAX_VALUE,0),n(b.upperBound,Number.MAX_VALUE,Number.MAX_VALUE)):f===3*Math.PI/2?(n(b.lowerBound,-Number.MAX_VALUE,-Number.MAX_VALUE),n(b.upperBound,0,Number.MAX_VALUE)):(n(b.lowerBound,-Number.MAX_VALUE,
-Number.MAX_VALUE),n(b.upperBound,Number.MAX_VALUE,Number.MAX_VALUE));g.add(b.lowerBound,b.lowerBound,d);g.add(b.upperBound,b.upperBound,d)};d.prototype.updateArea=function(){this.area=Number.MAX_VALUE}},{"../math/vec2":31,"../utils/Utils":50,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],44:[function(f,b){function d(b,d){this.width=b||1;this.height=d||1;var f=[e.fromValues(-b/2,-d/2),e.fromValues(b/2,-d/2),e.fromValues(b/2,d/2),e.fromValues(-b/2,d/2)],n=[e.fromValues(1,0),e.fromValues(0,
1)];h.call(this,f,n);this.type=g.RECTANGLE}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("./Shape"),h=f("./Convex");b.exports=d;d.prototype=new h([]);d.prototype.computeMomentOfInertia=function(b){var d=this.width,e=this.height;return b*(e*e+d*d)/12};d.prototype.updateBoundingRadius=function(){var b=this.width,d=this.height;this.boundingRadius=Math.sqrt(b*b+d*d)/2};e.create();e.create();e.create();e.create();d.prototype.computeAABB=function(b,d,e){b.setFromPoints(this.vertices,
d,e,0)};d.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":31,"./Convex":39,"./Shape":45,__browserify_Buffer:1,__browserify_process:2}],45:[function(f,b){function d(b){this.type=b;this.id=d.idCounter++;this.boundingRadius=0;this.collisionMask=this.collisionGroup=1;b&&this.updateBoundingRadius();this.material=null;this.area=0;this.sensor=!1;this.updateArea()}f("__browserify_process");f("__browserify_Buffer");b.exports=d;d.idCounter=0;d.CIRCLE=1;d.PARTICLE=2;d.PLANE=
4;d.CONVEX=8;d.LINE=16;d.RECTANGLE=32;d.CAPSULE=64;d.HEIGHTFIELD=128;d.prototype.computeMomentOfInertia=function(){throw Error("Shape.computeMomentOfInertia is not implemented in this Shape...");};d.prototype.updateBoundingRadius=function(){throw Error("Shape.updateBoundingRadius is not implemented in this Shape...");};d.prototype.updateArea=function(){};d.prototype.computeAABB=function(){}},{__browserify_Buffer:1,__browserify_process:2}],46:[function(f,b){function d(b){g.call(this,b,g.GS);b=b||{};
this.iterations=b.iterations||10;this.tolerance=b.tolerance||1E-10;this.arrayStep=30;this.lambda=new h.ARRAY_TYPE(this.arrayStep);this.Bs=new h.ARRAY_TYPE(this.arrayStep);this.invCs=new h.ARRAY_TYPE(this.arrayStep);this.useZeroRHS=!1;this.usedIterations=this.frictionIterations=0}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2")),g=f("./Solver"),h=f("../utils/Utils"),l=f("../equations/FrictionEquation");b.exports=d;d.prototype=new g;d.prototype.solve=function(b,g){this.sortEquations();
var f=0,p=this.iterations,q=this.frictionIterations,r=this.equations,t=r.length,w=Math.pow(this.tolerance*t,2),v=g.bodies,u=g.bodies.length,y=(e.add,e.set,this.useZeroRHS),C=this.lambda;if(this.usedIterations=0,t)for(var x=0;x!==u;x++)f=v[x],f.updateSolveMassProperties();C.length<t&&(C=this.lambda=new h.ARRAY_TYPE(t+this.arrayStep),this.Bs=new h.ARRAY_TYPE(t+this.arrayStep),this.invCs=new h.ARRAY_TYPE(t+this.arrayStep));for(var B=C.length;B--;)C[B]=0;for(var B=this.invCs,E=this.Bs,C=this.lambda,x=
0;x!==r.length;x++){var z=r[x];(z.timeStep!==b||z.needsUpdate)&&(z.timeStep=b,z.update());E[x]=z.computeB(z.a,z.b,b);B[x]=z.computeInvC(z.epsilon)}var G;if(0!==t){for(x=0;x!==u;x++)f=v[x],f.resetConstraintVelocity();if(q){for(f=0;f!==q;f++){for(x=G=0;x!==t;x++)z=r[x],z=d.iterateEquation(x,z,z.epsilon,E,B,C,y,b,f),G+=Math.abs(z);if(this.usedIterations++,w>=G*G)break}d.updateMultipliers(r,C,1/b);for(x=0;x!==t;x++)if(q=r[x],q instanceof l){for(z=f=0;z!==q.contactEquations.length;z++)f+=q.contactEquations[z].multiplier;
f*=q.frictionCoefficient/q.contactEquations.length;q.maxForce=f;q.minForce=-f}}for(f=0;f!==p;f++){for(x=G=0;x!==t;x++)z=r[x],z=d.iterateEquation(x,z,z.epsilon,E,B,C,y,b,f),G+=Math.abs(z);if(this.usedIterations++,w>=G*G)break}for(x=0;x!==u;x++)v[x].addConstraintVelocity();d.updateMultipliers(r,C,1/b)}};d.updateMultipliers=function(b,d,e){for(var g=b.length;g--;)b[g].multiplier=d[g]*e};d.iterateEquation=function(b,d,e,g,f,h,l,w){var v=g[b],u=f[b];f=h[b];var y=d.computeGWlambda();g=d.maxForce;var C=
d.minForce;l&&(v=0);e=u*(v-y-e*f);l=f+e;return C*w>l?e=C*w-f:l>g*w&&(e=g*w-f),h[b]+=e,d.addToWlambda(e),e}},{"../equations/FrictionEquation":24,"../math/vec2":31,"../utils/Utils":50,"./Solver":47,__browserify_Buffer:1,__browserify_process:2}],47:[function(f,b){function d(b,d){b=b||{};e.call(this);this.type=d;this.equations=[];this.equationSortFunction=b.equationSortFunction||!1}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../utils/Utils"),f("../events/EventEmitter"));b.exports=d;d.prototype=
new e;d.prototype.solve=function(){throw Error("Solver.solve should be implemented by subclasses!");};var g={bodies:[]};d.prototype.solveIsland=function(b,d){this.removeAllEquations();d.equations.length&&(this.addEquations(d.equations),g.bodies.length=0,d.getBodies(g.bodies),g.bodies.length&&this.solve(b,g))};d.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)};d.prototype.addEquation=function(b){b.enabled&&this.equations.push(b)};d.prototype.addEquations=
function(b){for(var d=0,e=b.length;d!==e;d++){var g=b[d];g.enabled&&this.equations.push(g)}};d.prototype.removeEquation=function(b){b=this.equations.indexOf(b);-1!==b&&this.equations.splice(b,1)};d.prototype.removeAllEquations=function(){this.equations.length=0};d.GS=1;d.ISLAND=2},{"../events/EventEmitter":27,"../utils/Utils":50,__browserify_Buffer:1,__browserify_process:2}],48:[function(f,b){function d(){this.overlappingShapesLastState=new g;this.overlappingShapesCurrentState=new g;this.recordPool=
[];this.tmpDict=new g;this.tmpArray1=[]}function e(b,d,e,g){this.shapeA=d;this.shapeB=g;this.bodyA=b;this.bodyB=e}var g=(f("__browserify_process"),f("__browserify_Buffer"),f("./TupleDictionary"));f("./Utils");b.exports=d;d.prototype.tick=function(){for(var b=this.overlappingShapesLastState,d=this.overlappingShapesCurrentState,e=b.keys.length;e--;){var g=b.keys[e],f=b.getByKey(g),g=d.getByKey(g);f&&!g&&this.recordPool.push(f)}b.reset();b.copy(d);d.reset()};d.prototype.setOverlapping=function(b,d,g,
f){var n=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);if(!n.get(d.id,f.id)){var p;this.recordPool.length?(p=this.recordPool.pop(),p.set(b,d,g,f)):p=new e(b,d,g,f);n.set(d.id,f.id,p)}};d.prototype.getNewOverlaps=function(b){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,b)};d.prototype.getEndOverlaps=function(b){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,b)};d.prototype.bodiesAreOverlapping=
function(b,d){for(var e=this.overlappingShapesCurrentState,g=e.keys.length;g--;){var f=e.data[e.keys[g]];if(f.bodyA===b&&f.bodyB===d||f.bodyA===d&&f.bodyB===b)return!0}return!1};d.prototype.getDiff=function(b,d,e){e=e||[];e.length=0;for(var g=d.keys.length;g--;){var f=d.keys[g],p=d.data[f];if(!p)throw Error("Key "+f+" had no data!");b.data[f]||e.push(p)}return e};d.prototype.isNewOverlap=function(b,d){var e=0|b.id,g=0|d.id,f=this.overlappingShapesCurrentState;return!this.overlappingShapesLastState.get(e,
g)&&!!f.get(e,g)};d.prototype.getNewBodyOverlaps=function(b){this.tmpArray1.length=0;var d=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(d,b)};d.prototype.getEndBodyOverlaps=function(b){this.tmpArray1.length=0;var d=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(d,b)};d.prototype.getBodyDiff=function(b,d){d=d||[];for(var e=this.tmpDict,g=b.length;g--;){var f=b[g];e.set(0|f.bodyA.id,0|f.bodyB.id,f)}for(g=e.keys.length;g--;)(f=e.getByKey(e.keys[g]))&&d.push(f.bodyA,f.bodyB);
return e.reset(),d};e.prototype.set=function(b,d,g,f){e.call(this,b,d,g,f)}},{"./TupleDictionary":49,"./Utils":50,__browserify_Buffer:1,__browserify_process:2}],49:[function(f,b){function d(){this.data={};this.keys=[]}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("./Utils"));b.exports=d;d.prototype.getKey=function(b,d){return b|=0,d|=0,(0|b)===(0|d)?-1:0|((0|b)>(0|d)?b<<16|65535&d:d<<16|65535&b)};d.prototype.getByKey=function(b){return b|=0,this.data[b]};d.prototype.get=function(b,d){return this.data[this.getKey(b,
d)]};d.prototype.set=function(b,d,e){if(!e)throw Error("No data!");b=this.getKey(b,d);return this.data[b]||this.keys.push(b),this.data[b]=e,b};d.prototype.reset=function(){for(var b=this.data,d=this.keys,e=d.length;e--;)delete b[d[e]];d.length=0};d.prototype.copy=function(b){this.reset();e.appendArray(this.keys,b.keys);for(var d=b.keys.length;d--;){var f=b.keys[d];this.data[f]=b.data[f]}}},{"./Utils":50,__browserify_Buffer:1,__browserify_process:2}],50:[function(f,b){function d(){}f("__browserify_process");
f("__browserify_Buffer");b.exports=d;d.appendArray=function(b,d){if(15E4>d.length)b.push.apply(b,d);else for(var f=0,l=d.length;f!==l;++f)b.push(d[f])};d.splice=function(b,d,f){f=f||1;for(var l=b.length-f;l>d;d++)b[d]=b[d+f];b.length=l};d.ARRAY_TYPE=window.Float32Array||Array;d.extend=function(b,d){for(var f in d)b[f]=d[f]};d.defaults=function(b,d){b=b||{};for(var f in d)f in b||(b[f]=d[f]);return b}},{__browserify_Buffer:1,__browserify_process:2}],51:[function(f,b){function d(){this.equations=[];
this.bodies=[]}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../objects/Body"));b.exports=d;d.prototype.reset=function(){this.equations.length=this.bodies.length=0};var g=[];d.prototype.getBodies=function(b){b=b||[];for(var d=this.equations,e=g.length=0;e!==d.length;e++){var f=d[e];-1===g.indexOf(f.bodyA.id)&&(b.push(f.bodyA),g.push(f.bodyA.id));-1===g.indexOf(f.bodyB.id)&&(b.push(f.bodyB),g.push(f.bodyB.id))}return b};d.prototype.wantsToSleep=function(){for(var b=0;b<this.bodies.length;b++){var d=
this.bodies[b];if(d.type===e.DYNAMIC&&!d.wantsToSleep)return!1}return!0};d.prototype.sleep=function(){for(var b=0;b<this.bodies.length;b++)this.bodies[b].sleep();return!0}},{"../objects/Body":32,__browserify_Buffer:1,__browserify_process:2}],52:[function(f,b){function d(){this._nodePool=[];this._islandPool=[];this.equations=[];this.islands=[];this.nodes=[];this.queue=[]}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../math/vec2"),f("./Island")),g=f("./IslandNode"),h=f("../objects/Body");
b.exports=d;d.getUnvisitedNode=function(b){for(var d=b.length,e=0;e!==d;e++){var f=b[e];if(!f.visited&&f.body.type===h.DYNAMIC)return f}return!1};d.prototype.visit=function(b,d,e){d.push(b.body);d=b.equations.length;for(var f=0;f!==d;f++){var g=b.equations[f];-1===e.indexOf(g)&&e.push(g)}};d.prototype.bfs=function(b,e,f){var g=this.queue;g.length=0;g.push(b);b.visited=!0;for(this.visit(b,e,f);g.length;)for(var p=g.pop();b=d.getUnvisitedNode(p.neighbors);)b.visited=!0,this.visit(b,e,f),b.body.type===
h.DYNAMIC&&g.push(b)};d.prototype.split=function(b){var f=b.bodies;b=this.nodes;for(var h=this.equations;b.length;)this._nodePool.push(b.pop());for(var n=0;n!==f.length;n++)if(this._nodePool.length){var p=this._nodePool.pop();p.reset();p.body=f[n];b.push(p)}else b.push(new g(f[n]));for(p=0;p!==h.length;p++){var q=h[p],n=f.indexOf(q.bodyA),r=f.indexOf(q.bodyB),n=b[n],r=b[r];n.neighbors.push(r);r.neighbors.push(n);n.equations.push(q);r.equations.push(q)}for(f=this.islands;f.length;)h=f.pop(),h.reset(),
this._islandPool.push(h);for(;p=d.getUnvisitedNode(b);)h=this._islandPool.length?this._islandPool.pop():new e,this.bfs(p,h.bodies,h.equations),f.push(h);return f}},{"../math/vec2":31,"../objects/Body":32,"./Island":51,"./IslandNode":53,__browserify_Buffer:1,__browserify_process:2}],53:[function(f,b){function d(b){this.body=b;this.neighbors=[];this.equations=[];this.visited=!1}f("__browserify_process");f("__browserify_Buffer");b.exports=d;d.prototype.reset=function(){this.equations.length=0;this.neighbors.length=
0;this.visited=!1;this.body=null}},{__browserify_Buffer:1,__browserify_process:2}],54:[function(f,b){function d(b){p.apply(this);b=b||{};this.springs=[];this.bodies=[];this.disabledBodyCollisionPairs=[];this.solver=b.solver||new e;this.narrowphase=new v(this);this.islandManager=new C;this.gravity=g.fromValues(0,-9.78);b.gravity&&g.copy(this.gravity,b.gravity);this.frictionGravity=g.length(this.gravity)||10;this.useFrictionGravityOnZeroGravity=this.useWorldGravityAsFrictionGravity=!0;this.doProfiling=
b.doProfiling||!1;this.lastStepTime=0;this.broadphase=b.broadphase||new w;this.broadphase.setWorld(this);this.constraints=[];this.defaultMaterial=new r;this.defaultContactMaterial=new t(this.defaultMaterial,this.defaultMaterial);this.lastTimeStep=1/60;this.solveConstraints=this.applyGravity=this.applyDamping=this.applySpringForces=!0;this.contactMaterials=[];this.time=0;this.stepping=!1;this.bodiesToBeRemoved=[];this.fixedStepTime=0;this.islandSplit="undefined"!=typeof b.islandSplit?!!b.islandSplit:
!1;this.emitImpactEvent=!0;this._bodyIdCounter=this._constraintIdCounter=0;this.postStepEvent={type:"postStep"};this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null};this.addSpringEvent={type:"addSpring",spring:null};this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null};this.postBroadphaseEvent={type:"postBroadphase",pairs:null};this.sleepMode=d.NO_SLEEPING;this.beginContactEvent={type:"beginContact",shapeA:null,
shapeB:null,bodyA:null,bodyB:null,contactEquations:[]};this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null};this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null};this.overlappingShapesLastState={keys:[]};this.overlappingShapesCurrentState={keys:[]};this.overlapKeeper=new y}var e=(f("__browserify_process"),f("__browserify_Buffer"),f("../solver/GSSolver")),g=(f("../solver/Solver"),f("../collision/NaiveBroadphase"),f("../math/vec2")),h=f("../shapes/Circle"),
l=(f("../shapes/Rectangle"),f("../shapes/Convex")),k=(f("../shapes/Line"),f("../shapes/Plane")),m=f("../shapes/Capsule"),n=f("../shapes/Particle"),p=f("../events/EventEmitter"),q=f("../objects/Body"),r=(f("../shapes/Shape"),f("../objects/LinearSpring"),f("../material/Material")),t=f("../material/ContactMaterial"),w=(f("../constraints/DistanceConstraint"),f("../constraints/Constraint"),f("../constraints/LockConstraint"),f("../constraints/RevoluteConstraint"),f("../constraints/PrismaticConstraint"),
f("../constraints/GearConstraint"),f("../../package.json"),f("../collision/Broadphase"),f("../collision/SAPBroadphase")),v=f("../collision/Narrowphase"),u=f("../utils/Utils"),y=f("../utils/OverlapKeeper"),C=f("./IslandManager");f("../objects/RotationalSpring");if(b.exports=d,"undefined"==typeof performance&&(performance={}),!performance.now){var x=Date.now();performance.timing&&performance.timing.navigationStart&&(x=performance.timing.navigationStart);performance.now=function(){return Date.now()-
x}}d.prototype=Object(p.prototype);d.NO_SLEEPING=1;d.BODY_SLEEPING=2;d.ISLAND_SLEEPING=4;d.prototype.addConstraint=function(b){this.constraints.push(b)};d.prototype.addContactMaterial=function(b){this.contactMaterials.push(b)};d.prototype.removeContactMaterial=function(b){b=this.contactMaterials.indexOf(b);-1!==b&&u.splice(this.contactMaterials,b,1)};d.prototype.getContactMaterial=function(b,d){for(var e=this.contactMaterials,f=0,g=e.length;f!==g;f++){var h=e[f];if(h.materialA.id===b.id&&h.materialB.id===
d.id||h.materialA.id===d.id&&h.materialB.id===b.id)return h}return!1};d.prototype.removeConstraint=function(b){b=this.constraints.indexOf(b);-1!==b&&u.splice(this.constraints,b,1)};var B=(g.create(),g.create(),g.create(),g.create(),g.create(),g.create(),g.create()),E=g.fromValues(0,0),z=g.fromValues(0,0),G=(g.fromValues(0,0),g.fromValues(0,0));d.prototype.step=function(b,d,e){if(e=e||10,d=d||0,0===d)this.internalStep(b),this.time+=b;else{var f=Math.floor((this.time+d)/b)-Math.floor(this.time/b),f=
Math.min(f,e);e=performance.now();for(var h=0;h!==f&&(this.internalStep(b),!(performance.now()-e>1E3*b));h++);this.time+=d;b=this.time%b/b;for(d=0;d!==this.bodies.length;d++)f=this.bodies[d],f.type!==q.STATIC&&f.sleepState!==q.SLEEPING?(g.sub(G,f.position,f.previousPosition),g.scale(G,G,b),g.add(f.interpolatedPosition,f.position,G),f.interpolatedAngle=f.angle+(f.angle-f.previousAngle)*b):(g.copy(f.interpolatedPosition,f.position),f.interpolatedAngle=f.angle)}};var J=[];d.prototype.internalStep=function(b){this.stepping=
!0;var e,f,h=this.doProfiling,k=this.springs.length,l=this.springs,m=this.bodies,n=this.gravity,p=this.solver,r=this.bodies.length,t=this.broadphase,v=this.narrowphase,w=this.constraints,x=(g.scale,g.add),y=(g.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=b,h&&(e=performance.now()),this.useWorldGravityAsFrictionGravity){var A=g.length(this.gravity);0===A&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=A)}if(this.applyGravity)for(A=0;A!==r;A++){var z=m[A],C=
z.force;z.type===q.DYNAMIC&&z.sleepState!==q.SLEEPING&&(g.scale(B,n,z.mass*z.gravityScale),x(C,C,B))}if(this.applySpringForces)for(A=0;A!==k;A++)l[A].applyForce();if(this.applyDamping)for(A=0;A!==r;A++)z=m[A],z.type===q.DYNAMIC&&z.applyDamping(b);k=t.getCollisionPairs(this);n=this.disabledBodyCollisionPairs;for(A=n.length-2;0<=A;A-=2)for(l=k.length-2;0<=l;l-=2)(n[A]===k[l]&&n[A+1]===k[l+1]||n[A+1]===k[l]&&n[A]===k[l+1])&&k.splice(l,2);n=w.length;for(A=0;A!==n;A++)if(t=w[A],!t.collideConnected)for(l=
k.length-2;0<=l;l-=2)(t.bodyA===k[l]&&t.bodyB===k[l+1]||t.bodyB===k[l]&&t.bodyA===k[l+1])&&k.splice(l,2);this.postBroadphaseEvent.pairs=k;this.emit(this.postBroadphaseEvent);v.reset(this);A=0;for(n=k.length;A!==n;A+=2)for(t=k[A],x=k[A+1],z=0,C=t.shapes.length;z!==C;z++)for(var E=t.shapes[z],G=t.shapeOffsets[z],H=t.shapeAngles[z],l=0,K=x.shapes.length;l!==K;l++){var L=x.shapes[l],M=x.shapeOffsets[l],P=x.shapeAngles[l],Z=this.defaultContactMaterial;if(E.material&&L.material){var ba=this.getContactMaterial(E.material,
L.material);ba&&(Z=ba)}this.runNarrowphase(v,t,E,G,H,x,L,M,P,Z,this.frictionGravity)}for(A=0;A!==r;A++)k=m[A],k._wakeUpAfterNarrowphase&&(k.wakeUp(),k._wakeUpAfterNarrowphase=!1);if(this.has("endContact"))for(this.overlapKeeper.getEndOverlaps(J),A=this.endContactEvent,l=J.length;l--;)k=J[l],A.shapeA=k.shapeA,A.shapeB=k.shapeB,A.bodyA=k.bodyA,A.bodyB=k.bodyB,this.emit(A);A=this.preSolveEvent;A.contactEquations=v.contactEquations;A.frictionEquations=v.frictionEquations;this.emit(A);n=w.length;for(A=
0;A!==n;A++)w[A].update();if(v.contactEquations.length||v.frictionEquations.length||w.length)if(this.islandSplit){y.equations.length=0;u.appendArray(y.equations,v.contactEquations);u.appendArray(y.equations,v.frictionEquations);for(A=0;A!==n;A++)u.appendArray(y.equations,w[A].equations);y.split(this);for(A=0;A!==y.islands.length;A++)w=y.islands[A],w.equations.length&&p.solveIsland(b,w)}else{p.addEquations(v.contactEquations);p.addEquations(v.frictionEquations);for(A=0;A!==n;A++)p.addEquations(w[A].equations);
this.solveConstraints&&p.solve(b,this);p.removeAllEquations()}for(A=0;A!==r;A++)k=m[A],k.sleepState!==q.SLEEPING&&k.type!==q.STATIC&&d.integrateBody(k,b);for(A=0;A!==r;A++)m[A].setZeroForce();if(h&&(f=performance.now(),this.lastStepTime=f-e),this.emitImpactEvent&&this.has("impact"))for(e=this.impactEvent,A=0;A!==v.contactEquations.length;A++)f=v.contactEquations[A],f.firstImpact&&(e.bodyA=f.bodyA,e.bodyB=f.bodyB,e.shapeA=f.shapeA,e.shapeB=f.shapeB,e.contactEquation=f,this.emit(e));if(this.sleepMode===
d.BODY_SLEEPING)for(A=0;A!==r;A++)m[A].sleepTick(this.time,!1,b);else if(this.sleepMode===d.ISLAND_SLEEPING&&this.islandSplit){for(A=0;A!==r;A++)m[A].sleepTick(this.time,!0,b);for(A=0;A<this.islandManager.islands.length;A++)w=this.islandManager.islands[A],w.wantsToSleep()&&w.sleep()}if(this.stepping=!1,this.bodiesToBeRemoved.length){for(A=0;A!==this.bodiesToBeRemoved.length;A++)this.removeBody(this.bodiesToBeRemoved[A]);this.bodiesToBeRemoved.length=0}this.emit(this.postStepEvent)};var K=g.create(),
M=g.create();d.integrateBody=function(b,d){var e=b.invMass,f=b.force,h=b.position,k=b.velocity;g.copy(b.previousPosition,b.position);b.previousAngle=b.angle;b.fixedRotation||(b.angularVelocity+=b.angularForce*b.invInertia*d,b.angle+=b.angularVelocity*d);g.scale(K,f,d*e);g.add(k,K,k);g.scale(M,k,d);g.add(h,h,M);b.aabbNeedsUpdate=!0};d.prototype.runNarrowphase=function(b,d,e,f,h,k,l,m,n,p,r){if(0!==(e.collisionGroup&l.collisionMask)&&0!==(l.collisionGroup&e.collisionMask)&&(g.rotate(E,f,d.angle),g.rotate(z,
m,k.angle),g.add(E,E,d.position),g.add(z,z,k.position),f=h+d.angle,n+=k.angle,b.enableFriction=0<p.friction,b.frictionCoefficient=p.friction,b.slipForce=p.friction*r*(d.type===q.STATIC||d.type===q.KINEMATIC?k.mass:k.type===q.STATIC||k.type===q.KINEMATIC?d.mass:d.mass*k.mass/(d.mass+k.mass)),b.restitution=p.restitution,b.surfaceVelocity=p.surfaceVelocity,b.frictionStiffness=p.frictionStiffness,b.frictionRelaxation=p.frictionRelaxation,b.stiffness=p.stiffness,b.relaxation=p.relaxation,b.contactSkinSize=
p.contactSkinSize,r=b[e.type|l.type],p=0,r&&(p=e.sensor||l.sensor,h=b.frictionEquations.length,p=e.type<l.type?r.call(b,d,e,E,f,k,l,z,n,p):r.call(b,k,l,z,n,d,e,E,f,p),f=b.frictionEquations.length-h,p))){d.allowSleep&&d.type===q.DYNAMIC&&d.sleepState===q.SLEEPING&&k.sleepState===q.AWAKE&&k.type!==q.STATIC&&(r=g.squaredLength(k.velocity)+Math.pow(k.angularVelocity,2),n=Math.pow(k.sleepSpeedLimit,2),r>=2*n&&(d._wakeUpAfterNarrowphase=!0));k.allowSleep&&k.type===q.DYNAMIC&&k.sleepState===q.SLEEPING&&
d.sleepState===q.AWAKE&&d.type!==q.STATIC&&(r=g.squaredLength(d.velocity)+Math.pow(d.angularVelocity,2),n=Math.pow(d.sleepSpeedLimit,2),r>=2*n&&(k._wakeUpAfterNarrowphase=!0));if(this.overlapKeeper.setOverlapping(d,e,k,l),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(e,l)){r=this.beginContactEvent;if(r.shapeA=e,r.shapeB=l,r.bodyA=d,r.bodyB=k,r.contactEquations.length=0,"number"==typeof p)for(d=b.contactEquations.length-p;d<b.contactEquations.length;d++)r.contactEquations.push(b.contactEquations[d]);
this.emit(r)}if("number"==typeof p&&1<f)for(d=b.frictionEquations.length-f;d<b.frictionEquations.length;d++)e=b.frictionEquations[d],e.setSlipForce(e.getSlipForce()/f)}};d.prototype.addSpring=function(b){this.springs.push(b);this.addSpringEvent.spring=b;this.emit(this.addSpringEvent)};d.prototype.removeSpring=function(b){b=this.springs.indexOf(b);-1!==b&&u.splice(this.springs,b,1)};d.prototype.addBody=function(b){-1===this.bodies.indexOf(b)&&(this.bodies.push(b),b.world=this,this.addBodyEvent.body=
b,this.emit(this.addBodyEvent))};d.prototype.removeBody=function(b){if(this.stepping)this.bodiesToBeRemoved.push(b);else{b.world=null;var d=this.bodies.indexOf(b);-1!==d&&(u.splice(this.bodies,d,1),this.removeBodyEvent.body=b,b.resetConstraintVelocity(),this.emit(this.removeBodyEvent))}};d.prototype.getBodyById=function(b){for(var d=this.bodies,e=0;e<d.length;e++){var f=d[e];if(f.id===b)return f}return!1};d.prototype.disableBodyCollision=function(b,d){this.disabledBodyCollisionPairs.push(b,d)};d.prototype.enableBodyCollision=
function(b,d){for(var e=this.disabledBodyCollisionPairs,f=0;f<e.length;f+=2)if(e[f]===b&&e[f+1]===d||e[f+1]===b&&e[f]===d)return void e.splice(f,2)};d.prototype.clear=function(){this.fixedStepTime=this.time=0;this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var b=this.constraints,e=b.length-1;0<=e;e--)this.removeConstraint(b[e]);b=this.bodies;for(e=b.length-1;0<=e;e--)this.removeBody(b[e]);b=this.springs;for(e=b.length-1;0<=e;e--)this.removeSpring(b[e]);b=this.contactMaterials;
for(e=b.length-1;0<=e;e--)this.removeContactMaterial(b[e]);d.apply(this)};d.prototype.clone=function(){var b=new d;return b.fromJSON(this.toJSON()),b};var H=g.create(),L=g.fromValues(0,0),P=g.fromValues(0,0);d.prototype.hitTest=function(b,d,e){e=e||0;var f=new q({position:b}),p=new n;f.addShape(p);for(var r=this.narrowphase,t=[],u=0,v=d.length;u!==v;u++)for(var w=d[u],x=0,z=w.shapes.length;x!==z;x++){var y=w.shapes[x],B=w.shapeAngles[x]||0;g.rotate(H,w.shapeOffsets[x]||L,w.angle);g.add(H,H,w.position);
B+=w.angle;(y instanceof h&&r.circleParticle(w,y,H,B,f,p,b,0,!0)||y instanceof l&&r.particleConvex(f,p,b,0,w,y,H,B,!0)||y instanceof k&&r.particlePlane(f,p,b,0,w,y,H,B,!0)||y instanceof m&&r.particleCapsule(f,p,b,0,w,y,H,B,!0)||y instanceof n&&g.squaredLength(g.sub(P,H,b))<e*e)&&t.push(w)}return t};d.prototype.setGlobalEquationParameters=function(b){b=b||{};for(var d=0;d!==this.constraints.length;d++)for(var e=this.constraints[d],f=0;f!==e.equations.length;f++){var g=e.equations[f];"undefined"!=typeof b.stiffness&&
(g.stiffness=b.stiffness);"undefined"!=typeof b.relaxation&&(g.relaxation=b.relaxation);g.needsUpdate=!0}for(d=0;d!==this.contactMaterials.length;d++)e=this.contactMaterials[d],"undefined"!=typeof b.stiffness&&(e.stiffness=b.stiffness,e.frictionStiffness=b.stiffness),"undefined"!=typeof b.relaxation&&(e.relaxation=b.relaxation,e.frictionRelaxation=b.relaxation);e=this.defaultContactMaterial;"undefined"!=typeof b.stiffness&&(e.stiffness=b.stiffness,e.frictionStiffness=b.stiffness);"undefined"!=typeof b.relaxation&&
(e.relaxation=b.relaxation,e.frictionRelaxation=b.relaxation)};d.prototype.setGlobalStiffness=function(b){this.setGlobalEquationParameters({stiffness:b})};d.prototype.setGlobalRelaxation=function(b){this.setGlobalEquationParameters({relaxation:b})}},{"../../package.json":8,"../collision/Broadphase":10,"../collision/NaiveBroadphase":12,"../collision/Narrowphase":13,"../collision/SAPBroadphase":14,"../constraints/Constraint":15,"../constraints/DistanceConstraint":16,"../constraints/GearConstraint":17,
"../constraints/LockConstraint":18,"../constraints/PrismaticConstraint":19,"../constraints/RevoluteConstraint":20,"../events/EventEmitter":27,"../material/ContactMaterial":28,"../material/Material":29,"../math/vec2":31,"../objects/Body":32,"../objects/LinearSpring":33,"../objects/RotationalSpring":34,"../shapes/Capsule":37,"../shapes/Circle":38,"../shapes/Convex":39,"../shapes/Line":41,"../shapes/Particle":42,"../shapes/Plane":43,"../shapes/Rectangle":44,"../shapes/Shape":45,"../solver/GSSolver":46,
"../solver/Solver":47,"../utils/OverlapKeeper":48,"../utils/Utils":50,"./IslandManager":52,__browserify_Buffer:1,__browserify_process:2}]},{},[36])(36)});p2.Body.prototype.parent=null;p2.Spring.prototype.parent=null;
Phaser.Physics.P2=function(c,f){this.game=c;"undefined"!=typeof f&&f.hasOwnProperty("gravity")&&f.hasOwnProperty("broadphase")||(f={gravity:[0,0],broadphase:new p2.SAPBroadphase});this.config=f;this.world=new p2.World(this.config);this.frameRate=1/60;this.paused=this.useElapsedTime=!1;this.materials=[];this.gravity=new Phaser.Physics.P2.InversePointProxy(this,this.world.gravity);this.walls={left:null,right:null,top:null,bottom:null};this.onBodyAdded=new Phaser.Signal;this.onBodyRemoved=new Phaser.Signal;
this.onSpringAdded=new Phaser.Signal;this.onSpringRemoved=new Phaser.Signal;this.onConstraintAdded=new Phaser.Signal;this.onConstraintRemoved=new Phaser.Signal;this.onContactMaterialAdded=new Phaser.Signal;this.onContactMaterialRemoved=new Phaser.Signal;this.callbackContext=this.postBroadphaseCallback=null;this.onBeginContact=new Phaser.Signal;this.onEndContact=new Phaser.Signal;f.hasOwnProperty("mpx")&&f.hasOwnProperty("pxm")&&f.hasOwnProperty("mpxi")&&f.hasOwnProperty("pxmi")&&(this.mpx=f.mpx,this.mpxi=
f.mpxi,this.pxm=f.pxm,this.pxmi=f.pxmi);this.world.on("beginContact",this.beginContactHandler,this);this.world.on("endContact",this.endContactHandler,this);this.collisionGroups=[];this.nothingCollisionGroup=new Phaser.Physics.P2.CollisionGroup(1);this.boundsCollisionGroup=new Phaser.Physics.P2.CollisionGroup(2);this.everythingCollisionGroup=new Phaser.Physics.P2.CollisionGroup(2147483648);this.boundsCollidesWith=[];this._toRemove=[];this._collisionGroupID=2;this.setBoundsToWorld(!0,!0,!0,!0,!1)};
Phaser.Physics.P2.prototype={removeBodyNextStep:function(c){this._toRemove.push(c)},preUpdate:function(){for(var c=this._toRemove.length;c--;)this.removeBody(this._toRemove[c]);this._toRemove.length=0},enable:function(c,f,b){"undefined"==typeof f&&(f=!1);"undefined"==typeof b&&(b=!0);var d=1;if(Array.isArray(c))for(d=c.length;d--;)c[d]instanceof Phaser.Group?this.enable(c[d].children,f,b):(this.enableBody(c[d],f),b&&c[d].hasOwnProperty("children")&&0<c[d].children.length&&this.enable(c[d],f,!0));
else c instanceof Phaser.Group?this.enable(c.children,f,b):(this.enableBody(c,f),b&&c.hasOwnProperty("children")&&0<c.children.length&&this.enable(c.children,f,!0))},enableBody:function(c,f){c.hasOwnProperty("body")&&null===c.body&&(c.body=new Phaser.Physics.P2.Body(this.game,c,c.x,c.y,1),c.body.debug=f,c.anchor.set(.5))},setImpactEvents:function(c){c?this.world.on("impact",this.impactHandler,this):this.world.off("impact",this.impactHandler,this)},setPostBroadphaseCallback:function(c,f){this.postBroadphaseCallback=
c;this.callbackContext=f;null!==c?this.world.on("postBroadphase",this.postBroadphaseHandler,this):this.world.off("postBroadphase",this.postBroadphaseHandler,this)},postBroadphaseHandler:function(c){var f=c.pairs.length;if(this.postBroadphaseCallback&&0<f)for(;f-=2;)c.pairs[f].parent&&c.pairs[f+1].parent&&!this.postBroadphaseCallback.call(this.callbackContext,c.pairs[f].parent,c.pairs[f+1].parent)&&c.pairs.splice(f,2)},impactHandler:function(c){if(c.bodyA.parent&&c.bodyB.parent){var f=c.bodyA.parent,
b=c.bodyB.parent;f._bodyCallbacks[c.bodyB.id]&&f._bodyCallbacks[c.bodyB.id].call(f._bodyCallbackContext[c.bodyB.id],f,b,c.shapeA,c.shapeB);b._bodyCallbacks[c.bodyA.id]&&b._bodyCallbacks[c.bodyA.id].call(b._bodyCallbackContext[c.bodyA.id],b,f,c.shapeB,c.shapeA);f._groupCallbacks[c.shapeB.collisionGroup]&&f._groupCallbacks[c.shapeB.collisionGroup].call(f._groupCallbackContext[c.shapeB.collisionGroup],f,b,c.shapeA,c.shapeB);b._groupCallbacks[c.shapeA.collisionGroup]&&b._groupCallbacks[c.shapeA.collisionGroup].call(b._groupCallbackContext[c.shapeA.collisionGroup],
b,f,c.shapeB,c.shapeA)}},beginContactHandler:function(c){this.onBeginContact.dispatch(c.bodyA,c.bodyB,c.shapeA,c.shapeB,c.contactEquations);c.bodyA.parent&&c.bodyA.parent.onBeginContact.dispatch(c.bodyB.parent,c.shapeA,c.shapeB,c.contactEquations);c.bodyB.parent&&c.bodyB.parent.onBeginContact.dispatch(c.bodyA.parent,c.shapeB,c.shapeA,c.contactEquations)},endContactHandler:function(c){this.onEndContact.dispatch(c.bodyA,c.bodyB,c.shapeA,c.shapeB);c.bodyA.parent&&c.bodyA.parent.onEndContact.dispatch(c.bodyB.parent,
c.shapeA,c.shapeB);c.bodyB.parent&&c.bodyB.parent.onEndContact.dispatch(c.bodyA.parent,c.shapeB,c.shapeA)},setBoundsToWorld:function(c,f,b,d,e){this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,c,f,b,d,e)},setWorldMaterial:function(c,f,b,d,e){"undefined"==typeof f&&(f=!0);"undefined"==typeof b&&(b=!0);"undefined"==typeof d&&(d=!0);"undefined"==typeof e&&(e=!0);f&&this.walls.left&&(this.walls.left.shapes[0].material=c);b&&this.walls.right&&
(this.walls.right.shapes[0].material=c);d&&this.walls.top&&(this.walls.top.shapes[0].material=c);e&&this.walls.bottom&&(this.walls.bottom.shapes[0].material=c)},updateBoundsCollisionGroup:function(c){var f=this.everythingCollisionGroup.mask;"undefined"==typeof c&&(f=this.boundsCollisionGroup.mask);this.walls.left&&(this.walls.left.shapes[0].collisionGroup=f);this.walls.right&&(this.walls.right.shapes[0].collisionGroup=f);this.walls.top&&(this.walls.top.shapes[0].collisionGroup=f);this.walls.bottom&&
(this.walls.bottom.shapes[0].collisionGroup=f)},setBounds:function(c,f,b,d,e,g,h,l,k){"undefined"==typeof e&&(e=!0);"undefined"==typeof g&&(g=!0);"undefined"==typeof h&&(h=!0);"undefined"==typeof l&&(l=!0);"undefined"==typeof k&&(k=!0);this.walls.left&&this.world.removeBody(this.walls.left);this.walls.right&&this.world.removeBody(this.walls.right);this.walls.top&&this.world.removeBody(this.walls.top);this.walls.bottom&&this.world.removeBody(this.walls.bottom);e&&(this.walls.left=new p2.Body({mass:0,
position:[this.pxmi(c),this.pxmi(f)],angle:1.5707963267948966}),this.walls.left.addShape(new p2.Plane),k&&(this.walls.left.shapes[0].collisionGroup=this.boundsCollisionGroup.mask),this.world.addBody(this.walls.left));g&&(this.walls.right=new p2.Body({mass:0,position:[this.pxmi(c+b),this.pxmi(f)],angle:-1.5707963267948966}),this.walls.right.addShape(new p2.Plane),k&&(this.walls.right.shapes[0].collisionGroup=this.boundsCollisionGroup.mask),this.world.addBody(this.walls.right));h&&(this.walls.top=new p2.Body({mass:0,
position:[this.pxmi(c),this.pxmi(f)],angle:-3.141592653589793}),this.walls.top.addShape(new p2.Plane),k&&(this.walls.top.shapes[0].collisionGroup=this.boundsCollisionGroup.mask),this.world.addBody(this.walls.top));l&&(this.walls.bottom=new p2.Body({mass:0,position:[this.pxmi(c),this.pxmi(f+d)]}),this.walls.bottom.addShape(new p2.Plane),k&&(this.walls.bottom.shapes[0].collisionGroup=this.boundsCollisionGroup.mask),this.world.addBody(this.walls.bottom))},pause:function(){this.paused=!0},resume:function(){this.paused=
!1},update:function(){this.paused||this.world.step(this.useElapsedTime?this.game.time.physicsElapsed:this.frameRate)},clear:function(){this.world.clear();this.world.off("beginContact",this.beginContactHandler,this);this.world.off("endContact",this.endContactHandler,this);this.impactCallback=this.callbackContext=this.postBroadphaseCallback=null;this.collisionGroups=[];this._toRemove=[];this._collisionGroupID=2;this.boundsCollidesWith=[]},destroy:function(){this.clear();this.game=null},addBody:function(c){return c.data.world?
!1:(this.world.addBody(c.data),this.onBodyAdded.dispatch(c),!0)},removeBody:function(c){return c.data.world==this.world&&(this.world.removeBody(c.data),this.onBodyRemoved.dispatch(c)),c},addSpring:function(c){return this.world.addSpring(c instanceof Phaser.Physics.P2.Spring||c instanceof Phaser.Physics.P2.RotationalSpring?c.data:c),this.onSpringAdded.dispatch(c),c},removeSpring:function(c){return this.world.removeSpring(c instanceof Phaser.Physics.P2.Spring||c instanceof Phaser.Physics.P2.RotationalSpring?
c.data:c),this.onSpringRemoved.dispatch(c),c},createDistanceConstraint:function(c,f,b,d,e,g){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addConstraint(new Phaser.Physics.P2.DistanceConstraint(this,c,f,b,d,e,g)):void console.warn("Cannot create Constraint, invalid body objects given")},createGearConstraint:function(c,f,b,d){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addConstraint(new Phaser.Physics.P2.GearConstraint(this,c,f,b,d)):void console.warn("Cannot create Constraint, invalid body objects given")},
createRevoluteConstraint:function(c,f,b,d,e,g){return c=this.getBody(c),b=this.getBody(b),c&&b?this.addConstraint(new Phaser.Physics.P2.RevoluteConstraint(this,c,f,b,d,e,g)):void console.warn("Cannot create Constraint, invalid body objects given")},createLockConstraint:function(c,f,b,d,e){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addConstraint(new Phaser.Physics.P2.LockConstraint(this,c,f,b,d,e)):void console.warn("Cannot create Constraint, invalid body objects given")},createPrismaticConstraint:function(c,
f,b,d,e,g,h){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addConstraint(new Phaser.Physics.P2.PrismaticConstraint(this,c,f,b,d,e,g,h)):void console.warn("Cannot create Constraint, invalid body objects given")},addConstraint:function(c){return this.world.addConstraint(c),this.onConstraintAdded.dispatch(c),c},removeConstraint:function(c){return this.world.removeConstraint(c),this.onConstraintRemoved.dispatch(c),c},addContactMaterial:function(c){return this.world.addContactMaterial(c),this.onContactMaterialAdded.dispatch(c),
c},removeContactMaterial:function(c){return this.world.removeContactMaterial(c),this.onContactMaterialRemoved.dispatch(c),c},getContactMaterial:function(c,f){return this.world.getContactMaterial(c,f)},setMaterial:function(c,f){for(var b=f.length;b--;)f[b].setMaterial(c)},createMaterial:function(c,f){var b=new Phaser.Physics.P2.Material(c||"");return this.materials.push(b),"undefined"!=typeof f&&f.setMaterial(b),b},createContactMaterial:function(c,f,b){"undefined"==typeof c&&(c=this.createMaterial());
"undefined"==typeof f&&(f=this.createMaterial());c=new Phaser.Physics.P2.ContactMaterial(c,f,b);return this.addContactMaterial(c)},getBodies:function(){for(var c=[],f=this.world.bodies.length;f--;)c.push(this.world.bodies[f].parent);return c},getBody:function(c){return c instanceof p2.Body?c:c instanceof Phaser.Physics.P2.Body?c.data:c.body&&c.body.type===Phaser.Physics.P2JS?c.body.data:null},getSprings:function(){for(var c=[],f=this.world.springs.length;f--;)c.push(this.world.springs[f].parent);
return c},getConstraints:function(){for(var c=[],f=this.world.constraints.length;f--;)c.push(this.world.constraints[f].parent);return c},hitTest:function(c,f,b,d){"undefined"==typeof f&&(f=this.world.bodies);"undefined"==typeof b&&(b=5);"undefined"==typeof d&&(d=!1);c=[this.pxmi(c.x),this.pxmi(c.y)];for(var e=[],g=f.length;g--;)f[g]instanceof Phaser.Physics.P2.Body&&(!d||f[g].data.type!==p2.Body.STATIC)?e.push(f[g].data):f[g]instanceof p2.Body&&f[g].parent&&(!d||f[g].type!==p2.Body.STATIC)?e.push(f[g]):
f[g]instanceof Phaser.Sprite&&f[g].hasOwnProperty("body")&&(!d||f[g].body.data.type!==p2.Body.STATIC)&&e.push(f[g].body.data);return this.world.hitTest(c,e,b)},toJSON:function(){return this.world.toJSON()},createCollisionGroup:function(c){var f=Math.pow(2,this._collisionGroupID);this.walls.left&&(this.walls.left.shapes[0].collisionMask|=f);this.walls.right&&(this.walls.right.shapes[0].collisionMask|=f);this.walls.top&&(this.walls.top.shapes[0].collisionMask|=f);this.walls.bottom&&(this.walls.bottom.shapes[0].collisionMask|=
f);this._collisionGroupID++;f=new Phaser.Physics.P2.CollisionGroup(f);return this.collisionGroups.push(f),c&&this.setCollisionGroup(c,f),f},setCollisionGroup:function(c,f){if(c instanceof Phaser.Group)for(var b=0;b<c.total;b++)c.children[b].body&&c.children[b].body.type===Phaser.Physics.P2JS&&c.children[b].body.setCollisionGroup(f);else c.body.setCollisionGroup(f)},createSpring:function(c,f,b,d,e,g,h,l,k){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addSpring(new Phaser.Physics.P2.Spring(this,
c,f,b,d,e,g,h,l,k)):void console.warn("Cannot create Spring, invalid body objects given")},createRotationalSpring:function(c,f,b,d,e){return c=this.getBody(c),f=this.getBody(f),c&&f?this.addSpring(new Phaser.Physics.P2.RotationalSpring(this,c,f,b,d,e)):void console.warn("Cannot create Rotational Spring, invalid body objects given")},createBody:function(c,f,b,d,e,g){"undefined"==typeof d&&(d=!1);c=new Phaser.Physics.P2.Body(this.game,null,c,f,b);return g&&!c.addPolygon(e,g)?!1:(d&&this.world.addBody(c.data),
c)},createParticle:function(c,f,b,d,e,g){"undefined"==typeof d&&(d=!1);c=new Phaser.Physics.P2.Body(this.game,null,c,f,b);return g&&!c.addPolygon(e,g)?!1:(d&&this.world.addBody(c.data),c)},convertCollisionObjects:function(c,f,b){"undefined"==typeof b&&(b=!0);for(var d=[],e=0,g=c.collision[f].length;g>e;e++){var h=c.collision[f][e];(h=this.createBody(h.x,h.y,0,b,{},h.polyline))&&d.push(h)}return d},clearTilemapLayerBodies:function(c,f){f=c.getLayer(f);for(var b=c.layers[f].bodies.length;b--;)c.layers[f].bodies[b].destroy();
c.layers[f].bodies.length=0},convertTilemap:function(c,f,b,d){f=c.getLayer(f);"undefined"==typeof b&&(b=!0);"undefined"==typeof d&&(d=!0);this.clearTilemapLayerBodies(c,f);for(var e=0,g=0,h=0,l=0,k=c.layers[f].height;k>l;l++)for(var m=e=0,n=c.layers[f].width;n>m;m++){var p=c.layers[f].data[l][m];if(p&&-1<p.index&&p.collides)if(d){var q=c.getTileRight(f,m,l);(0===e&&(g=p.x*p.width,h=p.y*p.height,e=p.width),q&&q.collides)?e+=p.width:(q=this.createBody(g,h,0,!1),q.addRectangle(e,p.height,e/2,p.height/
2,0),b&&this.addBody(q),c.layers[f].bodies.push(q),e=0)}else q=this.createBody(p.x*p.width,p.y*p.height,0,!1),q.addRectangle(p.width,p.height,p.width/2,p.height/2,0),b&&this.addBody(q),c.layers[f].bodies.push(q)}return c.layers[f].bodies},mpx:function(c){return 20*c},pxm:function(c){return.05*c},mpxi:function(c){return-20*c},pxmi:function(c){return-.05*c}};
Object.defineProperty(Phaser.Physics.P2.prototype,"friction",{get:function(){return this.world.defaultContactMaterial.friction},set:function(c){this.world.defaultContactMaterial.friction=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"restitution",{get:function(){return this.world.defaultContactMaterial.restitution},set:function(c){this.world.defaultContactMaterial.restitution=c}});
Object.defineProperty(Phaser.Physics.P2.prototype,"contactMaterial",{get:function(){return this.world.defaultContactMaterial},set:function(c){this.world.defaultContactMaterial=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"applySpringForces",{get:function(){return this.world.applySpringForces},set:function(c){this.world.applySpringForces=c}});
Object.defineProperty(Phaser.Physics.P2.prototype,"applyDamping",{get:function(){return this.world.applyDamping},set:function(c){this.world.applyDamping=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"applyGravity",{get:function(){return this.world.applyGravity},set:function(c){this.world.applyGravity=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"solveConstraints",{get:function(){return this.world.solveConstraints},set:function(c){this.world.solveConstraints=c}});
Object.defineProperty(Phaser.Physics.P2.prototype,"time",{get:function(){return this.world.time}});Object.defineProperty(Phaser.Physics.P2.prototype,"emitImpactEvent",{get:function(){return this.world.emitImpactEvent},set:function(c){this.world.emitImpactEvent=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"sleepMode",{get:function(){return this.world.sleepMode},set:function(c){this.world.sleepMode=c}});Object.defineProperty(Phaser.Physics.P2.prototype,"total",{get:function(){return this.world.bodies.length}});
Phaser.Physics.P2.FixtureList=function(c){Array.isArray(c)||(c=[c]);this.rawList=c;this.init();this.parse(this.rawList)};
Phaser.Physics.P2.FixtureList.prototype={init:function(){this.namedFixtures={};this.groupedFixtures=[];this.allFixtures=[]},setCategory:function(c,f){this.getFixtures(f).forEach(function(b){b.collisionGroup=c})},setMask:function(c,f){this.getFixtures(f).forEach(function(b){b.collisionMask=c})},setSensor:function(c,f){this.getFixtures(f).forEach(function(b){b.sensor=c})},setMaterial:function(c,f){this.getFixtures(f).forEach(function(b){b.material=c})},getFixtures:function(c){var f=[];if(c){c instanceof
Array||(c=[c]);var b=this;return c.forEach(function(c){b.namedFixtures[c]&&f.push(b.namedFixtures[c])}),this.flatten(f)}return this.allFixtures},getFixtureByKey:function(c){return this.namedFixtures[c]},getGroup:function(c){return this.groupedFixtures[c]},parse:function(){var c,f,b,d;b=this.rawList;d=[];for(c in b)f=b[c],isNaN(c-0)?this.namedFixtures[c]=this.flatten(f):(this.groupedFixtures[c]=this.groupedFixtures[c]||[],this.groupedFixtures[c]=this.groupedFixtures[c].concat(f)),d.push(this.allFixtures=
this.flatten(this.groupedFixtures))},flatten:function(c){var f,b;return f=[],b=arguments.callee,c.forEach(function(c){return Array.prototype.push.apply(f,Array.isArray(c)?b(c):[c])}),f}};Phaser.Physics.P2.PointProxy=function(c,f){this.world=c;this.destination=f};Phaser.Physics.P2.PointProxy.prototype.constructor=Phaser.Physics.P2.PointProxy;
Object.defineProperty(Phaser.Physics.P2.PointProxy.prototype,"x",{get:function(){return this.world.mpx(this.destination[0])},set:function(c){this.destination[0]=this.world.pxm(c)}});Object.defineProperty(Phaser.Physics.P2.PointProxy.prototype,"y",{get:function(){return this.world.mpx(this.destination[1])},set:function(c){this.destination[1]=this.world.pxm(c)}});
Object.defineProperty(Phaser.Physics.P2.PointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(c){this.destination[0]=c}});Object.defineProperty(Phaser.Physics.P2.PointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(c){this.destination[1]=c}});Phaser.Physics.P2.InversePointProxy=function(c,f){this.world=c;this.destination=f};Phaser.Physics.P2.InversePointProxy.prototype.constructor=Phaser.Physics.P2.InversePointProxy;
Object.defineProperty(Phaser.Physics.P2.InversePointProxy.prototype,"x",{get:function(){return this.world.mpxi(this.destination[0])},set:function(c){this.destination[0]=this.world.pxmi(c)}});Object.defineProperty(Phaser.Physics.P2.InversePointProxy.prototype,"y",{get:function(){return this.world.mpxi(this.destination[1])},set:function(c){this.destination[1]=this.world.pxmi(c)}});
Object.defineProperty(Phaser.Physics.P2.InversePointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(c){this.destination[0]=-c}});Object.defineProperty(Phaser.Physics.P2.InversePointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(c){this.destination[1]=-c}});
Phaser.Physics.P2.Body=function(c,f,b,d,e){f=f||null;b=b||0;d=d||0;"undefined"==typeof e&&(e=1);this.game=c;this.world=c.physics.p2;this.sprite=f;this.type=Phaser.Physics.P2JS;this.offset=new Phaser.Point;this.data=new p2.Body({position:[this.world.pxmi(b),this.world.pxmi(d)],mass:e});this.data.parent=this;this.velocity=new Phaser.Physics.P2.InversePointProxy(this.world,this.data.velocity);this.force=new Phaser.Physics.P2.InversePointProxy(this.world,this.data.force);this.gravity=new Phaser.Point;
this.onBeginContact=new Phaser.Signal;this.onEndContact=new Phaser.Signal;this.collidesWith=[];this.removeNextStep=!1;this.debugBody=null;this._collideWorldBounds=!0;this._bodyCallbacks={};this._bodyCallbackContext={};this._groupCallbacks={};this._groupCallbackContext={};f&&(this.setRectangleFromSprite(f),f.exists&&this.game.physics.p2.addBody(this))};
Phaser.Physics.P2.Body.prototype={createBodyCallback:function(c,f,b){var d=-1;c.id?d=c.id:c.body&&(d=c.body.id);-1<d&&(null===f?(delete this._bodyCallbacks[d],delete this._bodyCallbackContext[d]):(this._bodyCallbacks[d]=f,this._bodyCallbackContext[d]=b))},createGroupCallback:function(c,f,b){null===f?(delete this._groupCallbacks[c.mask],delete this._groupCallbacksContext[c.mask]):(this._groupCallbacks[c.mask]=f,this._groupCallbackContext[c.mask]=b)},getCollisionMask:function(){var c=0;this._collideWorldBounds&&
(c=this.game.physics.p2.boundsCollisionGroup.mask);for(var f=0;f<this.collidesWith.length;f++)c|=this.collidesWith[f].mask;return c},updateCollisionMask:function(c){var f=this.getCollisionMask();if("undefined"==typeof c)for(c=this.data.shapes.length-1;0<=c;c--)this.data.shapes[c].collisionMask=f;else c.collisionMask=f},setCollisionGroup:function(c,f){var b=this.getCollisionMask();if("undefined"==typeof f)for(var d=this.data.shapes.length-1;0<=d;d--)this.data.shapes[d].collisionGroup=c.mask,this.data.shapes[d].collisionMask=
b;else f.collisionGroup=c.mask,f.collisionMask=b},clearCollision:function(c,f,b){if("undefined"==typeof b)for(b=this.data.shapes.length-1;0<=b;b--)c&&(this.data.shapes[b].collisionGroup=null),f&&(this.data.shapes[b].collisionMask=null);else c&&(b.collisionGroup=null),f&&(b.collisionMask=null);c&&(this.collidesWith.length=0)},collides:function(c,f,b,d){if(Array.isArray(c))for(var e=0;e<c.length;e++)-1===this.collidesWith.indexOf(c[e])&&(this.collidesWith.push(c[e]),f&&this.createGroupCallback(c[e],
f,b));else-1===this.collidesWith.indexOf(c)&&(this.collidesWith.push(c),f&&this.createGroupCallback(c,f,b));c=this.getCollisionMask();if("undefined"==typeof d)for(e=this.data.shapes.length-1;0<=e;e--)this.data.shapes[e].collisionMask=c;else d.collisionMask=c},adjustCenterOfMass:function(){this.data.adjustCenterOfMass()},applyDamping:function(c){this.data.applyDamping(c)},applyForce:function(c,f,b){this.data.applyForce(c,[this.world.pxmi(f),this.world.pxmi(b)])},setZeroForce:function(){this.data.setZeroForce()},
setZeroRotation:function(){this.data.angularVelocity=0},setZeroVelocity:function(){this.data.velocity[0]=0;this.data.velocity[1]=0},setZeroDamping:function(){this.data.damping=0;this.data.angularDamping=0},toLocalFrame:function(c,f){return this.data.toLocalFrame(c,f)},toWorldFrame:function(c,f){return this.data.toWorldFrame(c,f)},rotateLeft:function(c){this.data.angularVelocity=this.world.pxm(-c)},rotateRight:function(c){this.data.angularVelocity=this.world.pxm(c)},moveForward:function(c){c=this.world.pxmi(-c);
var f=this.data.angle+Math.PI/2;this.data.velocity[0]=c*Math.cos(f);this.data.velocity[1]=c*Math.sin(f)},moveBackward:function(c){c=this.world.pxmi(-c);var f=this.data.angle+Math.PI/2;this.data.velocity[0]=-(c*Math.cos(f));this.data.velocity[1]=-(c*Math.sin(f))},thrust:function(c){c=this.world.pxmi(-c);var f=this.data.angle+Math.PI/2;this.data.force[0]+=c*Math.cos(f);this.data.force[1]+=c*Math.sin(f)},reverse:function(c){c=this.world.pxmi(-c);var f=this.data.angle+Math.PI/2;this.data.force[0]-=c*
Math.cos(f);this.data.force[1]-=c*Math.sin(f)},moveLeft:function(c){this.data.velocity[0]=this.world.pxmi(-c)},moveRight:function(c){this.data.velocity[0]=this.world.pxmi(c)},moveUp:function(c){this.data.velocity[1]=this.world.pxmi(-c)},moveDown:function(c){this.data.velocity[1]=this.world.pxmi(c)},preUpdate:function(){this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite.x=this.world.mpxi(this.data.position[0]);this.sprite.y=this.world.mpxi(this.data.position[1]);
this.fixedRotation||(this.sprite.rotation=this.data.angle)},reset:function(c,f,b,d){"undefined"==typeof b&&(b=!1);"undefined"==typeof d&&(d=!1);this.setZeroForce();this.setZeroVelocity();this.setZeroRotation();b&&this.setZeroDamping();d&&(this.mass=1);this.x=c;this.y=f},addToWorld:function(){if(this.game.physics.p2._toRemove)for(var c=0;c<this.game.physics.p2._toRemove.length;c++)this.game.physics.p2._toRemove[c]===this&&this.game.physics.p2._toRemove.splice(c,1);this.data.world!==this.game.physics.p2.world&&
this.game.physics.p2.addBody(this)},removeFromWorld:function(){this.data.world===this.game.physics.p2.world&&this.game.physics.p2.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld();this.clearShapes();this._bodyCallbacks={};this._bodyCallbackContext={};this._groupCallbacks={};this._groupCallbackContext={};this.debugBody&&this.debugBody.destroy();this.debugBody=null;this.sprite=this.sprite.body=null},clearShapes:function(){for(var c=this.data.shapes.length;c--;)this.data.removeShape(this.data.shapes[c]);
this.shapeChanged()},addShape:function(c,f,b,d){return"undefined"==typeof f&&(f=0),"undefined"==typeof b&&(b=0),"undefined"==typeof d&&(d=0),this.data.addShape(c,[this.world.pxmi(f),this.world.pxmi(b)],d),this.shapeChanged(),c},addCircle:function(c,f,b,d){c=new p2.Circle(this.world.pxm(c));return this.addShape(c,f,b,d)},addRectangle:function(c,f,b,d,e){c=new p2.Rectangle(this.world.pxm(c),this.world.pxm(f));return this.addShape(c,b,d,e)},addPlane:function(c,f,b){var d=new p2.Plane;return this.addShape(d,
c,f,b)},addParticle:function(c,f,b){var d=new p2.Particle;return this.addShape(d,c,f,b)},addLine:function(c,f,b,d){c=new p2.Line(this.world.pxm(c));return this.addShape(c,f,b,d)},addCapsule:function(c,f,b,d,e){c=new p2.Capsule(this.world.pxm(c),this.world.pxm(f));return this.addShape(c,b,d,e)},addPolygon:function(c,f){c=c||{};Array.isArray(f)||(f=Array.prototype.slice.call(arguments,1));var b=[];if(1===f.length&&Array.isArray(f[0]))b=f[0].slice(0);else if(Array.isArray(f[0]))b=f.slice();else if("number"==
typeof f[0])for(var d=0,e=f.length;e>d;d+=2)b.push([f[d],f[d+1]]);d=b.length-1;b[d][0]===b[0][0]&&b[d][1]===b[0][1]&&b.pop();for(d=0;d<b.length;d++)b[d][0]=this.world.pxmi(b[d][0]),b[d][1]=this.world.pxmi(b[d][1]);b=this.data.fromPolygon(b,c);return this.shapeChanged(),b},removeShape:function(c){c=this.data.removeShape(c);return this.shapeChanged(),c},setCircle:function(c,f,b,d){return this.clearShapes(),this.addCircle(c,f,b,d)},setRectangle:function(c,f,b,d,e){return"undefined"==typeof c&&(c=16),
"undefined"==typeof f&&(f=16),this.clearShapes(),this.addRectangle(c,f,b,d,e)},setRectangleFromSprite:function(c){return"undefined"==typeof c&&(c=this.sprite),this.clearShapes(),this.addRectangle(c.width,c.height,0,0,c.rotation)},setMaterial:function(c,f){if("undefined"==typeof f)for(var b=this.data.shapes.length-1;0<=b;b--)this.data.shapes[b].material=c;else f.material=c},shapeChanged:function(){this.debugBody&&this.debugBody.draw()},addPhaserPolygon:function(c,f){for(var b=this.game.cache.getPhysicsData(c,
f),d=[],e=0;e<b.length;e++){var g=b[e],h=this.addFixture(g);d[g.filter.group]=d[g.filter.group]||[];d[g.filter.group]=d[g.filter.group].concat(h);g.fixtureKey&&(d[g.fixtureKey]=h)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),d},addFixture:function(c){var f=[];if(c.circle){var b=new p2.Circle(this.world.pxm(c.circle.radius));b.collisionGroup=c.filter.categoryBits;b.collisionMask=c.filter.maskBits;b.sensor=c.isSensor;var d=p2.vec2.create();d[0]=this.world.pxmi(c.circle.position[0]-this.sprite.width/
2);d[1]=this.world.pxmi(c.circle.position[1]-this.sprite.height/2);this.data.addShape(b,d);f.push(b)}else for(var d=c.polygons,e=p2.vec2.create(),g=0;g<d.length;g++){for(var b=d[g],h=[],l=0;l<b.length;l+=2)h.push([this.world.pxmi(b[l]),this.world.pxmi(b[l+1])]);b=new p2.Convex(h);for(h=0;h!==b.vertices.length;h++)l=b.vertices[h],p2.vec2.sub(l,l,b.centerOfMass);p2.vec2.scale(e,b.centerOfMass,1);e[0]-=this.world.pxmi(this.sprite.width/2);e[1]-=this.world.pxmi(this.sprite.height/2);b.updateTriangles();
b.updateCenterOfMass();b.updateBoundingRadius();b.collisionGroup=c.filter.categoryBits;b.collisionMask=c.filter.maskBits;b.sensor=c.isSensor;this.data.addShape(b,e);f.push(b)}return f},loadPolygon:function(c,f){for(var b=this.game.cache.getPhysicsData(c,f),d=p2.vec2.create(),e=0;e<b.length;e++){for(var g=[],h=0;h<b[e].shape.length;h+=2)g.push([this.world.pxmi(b[e].shape[h]),this.world.pxmi(b[e].shape[h+1])]);g=new p2.Convex(g);for(h=0;h!==g.vertices.length;h++){var l=g.vertices[h];p2.vec2.sub(l,l,
g.centerOfMass)}p2.vec2.scale(d,g.centerOfMass,1);d[0]-=this.world.pxmi(this.sprite.width/2);d[1]-=this.world.pxmi(this.sprite.height/2);g.updateTriangles();g.updateCenterOfMass();g.updateBoundingRadius();this.data.addShape(g,d)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),!0}};Phaser.Physics.P2.Body.prototype.constructor=Phaser.Physics.P2.Body;Phaser.Physics.P2.Body.DYNAMIC=1;Phaser.Physics.P2.Body.STATIC=2;Phaser.Physics.P2.Body.KINEMATIC=4;
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"static",{get:function(){return this.data.type===Phaser.Physics.P2.Body.STATIC},set:function(c){c&&this.data.type!==Phaser.Physics.P2.Body.STATIC?(this.data.type=Phaser.Physics.P2.Body.STATIC,this.mass=0):c||this.data.type!==Phaser.Physics.P2.Body.STATIC||(this.data.type=Phaser.Physics.P2.Body.DYNAMIC,0===this.mass&&(this.mass=1))}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"dynamic",{get:function(){return this.data.type===Phaser.Physics.P2.Body.DYNAMIC},set:function(c){c&&this.data.type!==Phaser.Physics.P2.Body.DYNAMIC?(this.data.type=Phaser.Physics.P2.Body.DYNAMIC,0===this.mass&&(this.mass=1)):c||this.data.type!==Phaser.Physics.P2.Body.DYNAMIC||(this.data.type=Phaser.Physics.P2.Body.STATIC,this.mass=0)}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"kinematic",{get:function(){return this.data.type===Phaser.Physics.P2.Body.KINEMATIC},set:function(c){c&&this.data.type!==Phaser.Physics.P2.Body.KINEMATIC?(this.data.type=Phaser.Physics.P2.Body.KINEMATIC,this.mass=4):c||this.data.type!==Phaser.Physics.P2.Body.KINEMATIC||(this.data.type=Phaser.Physics.P2.Body.STATIC,this.mass=0)}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"allowSleep",{get:function(){return this.data.allowSleep},set:function(c){c!==this.data.allowSleep&&(this.data.allowSleep=c)}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"angle",{get:function(){return Phaser.Math.wrapAngle(Phaser.Math.radToDeg(this.data.angle))},set:function(c){this.data.angle=Phaser.Math.degToRad(Phaser.Math.wrapAngle(c))}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"angularDamping",{get:function(){return this.data.angularDamping},set:function(c){this.data.angularDamping=c}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"angularForce",{get:function(){return this.data.angularForce},set:function(c){this.data.angularForce=c}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"angularVelocity",{get:function(){return this.data.angularVelocity},set:function(c){this.data.angularVelocity=c}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"damping",{get:function(){return this.data.damping},set:function(c){this.data.damping=c}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"fixedRotation",{get:function(){return this.data.fixedRotation},set:function(c){c!==this.data.fixedRotation&&(this.data.fixedRotation=c)}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"inertia",{get:function(){return this.data.inertia},set:function(c){this.data.inertia=c}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"mass",{get:function(){return this.data.mass},set:function(c){c!==this.data.mass&&(this.data.mass=c,this.data.updateMassProperties())}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"motionState",{get:function(){return this.data.type},set:function(c){c!==this.data.type&&(this.data.type=c)}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"rotation",{get:function(){return this.data.angle},set:function(c){this.data.angle=c}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"sleepSpeedLimit",{get:function(){return this.data.sleepSpeedLimit},set:function(c){this.data.sleepSpeedLimit=c}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"x",{get:function(){return this.world.mpxi(this.data.position[0])},set:function(c){this.data.position[0]=this.world.pxmi(c)}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"y",{get:function(){return this.world.mpxi(this.data.position[1])},set:function(c){this.data.position[1]=this.world.pxmi(c)}});Object.defineProperty(Phaser.Physics.P2.Body.prototype,"id",{get:function(){return this.data.id}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"debug",{get:function(){return null!==this.debugBody},set:function(c){c&&!this.debugBody?this.debugBody=new Phaser.Physics.P2.BodyDebug(this.game,this.data):!c&&this.debugBody&&(this.debugBody.destroy(),this.debugBody=null)}});
Object.defineProperty(Phaser.Physics.P2.Body.prototype,"collideWorldBounds",{get:function(){return this._collideWorldBounds},set:function(c){c&&!this._collideWorldBounds?(this._collideWorldBounds=!0,this.updateCollisionMask()):!c&&this._collideWorldBounds&&(this._collideWorldBounds=!1,this.updateCollisionMask())}});
Phaser.Physics.P2.BodyDebug=function(c,f,b){Phaser.Group.call(this,c);this.settings=Phaser.Utils.extend({pixelsPerLengthUnit:20,debugPolygons:!1,lineWidth:1,alpha:.5},b);this.ppu=this.settings.pixelsPerLengthUnit;this.ppu*=-1;this.body=f;this.canvas=new Phaser.Graphics(c);this.canvas.alpha=this.settings.alpha;this.add(this.canvas);this.draw()};Phaser.Physics.P2.BodyDebug.prototype=Object.create(Phaser.Group.prototype);Phaser.Physics.P2.BodyDebug.prototype.constructor=Phaser.Physics.P2.BodyDebug;
Phaser.Utils.extend(Phaser.Physics.P2.BodyDebug.prototype,{update:function(){this.updateSpriteTransform()},updateSpriteTransform:function(){return this.position.x=this.body.position[0]*this.ppu,this.position.y=this.body.position[1]*this.ppu,this.rotation=this.body.angle},draw:function(){var c,f,b,d,e,g,h,l,k,m,n,p,q;if(h=this.body,k=this.canvas,k.clear(),b=parseInt(this.randomPastelHex(),16),g=this.lineWidth,h instanceof p2.Body&&h.shapes.length){var r=h.shapes.length;for(d=0;d!==r;){if(f=h.shapes[d],
l=h.shapeOffsets[d],c=h.shapeAngles[d],l=l||0,c=c||0,f instanceof p2.Circle)this.drawCircle(k,l[0]*this.ppu,l[1]*this.ppu,c,f.radius*this.ppu,b,g);else if(f instanceof p2.Convex){m=[];n=p2.vec2.create();e=p=0;for(q=f.vertices.length;0<=q?q>p:p>q;e=0<=q?++p:--p)e=f.vertices[e],p2.vec2.rotate(n,e,c),m.push([(n[0]+l[0])*this.ppu,-(n[1]+l[1])*this.ppu]);this.drawConvex(k,m,f.triangles,16711680,b,g,this.settings.debugPolygons,[l[0]*this.ppu,-l[1]*this.ppu])}else f instanceof p2.Plane?this.drawPlane(k,
l[0]*this.ppu,-l[1]*this.ppu,b,16711680,5*g,10*g,10*g,100*this.ppu,c):f instanceof p2.Line?this.drawLine(k,f.length*this.ppu,16711680,g):f instanceof p2.Rectangle&&this.drawRectangle(k,l[0]*this.ppu,-l[1]*this.ppu,c,f.width*this.ppu,f.height*this.ppu,16711680,b,g);d++}}},drawRectangle:function(c,f,b,d,e,g,h,l,k){"undefined"==typeof k&&(k=1);"undefined"==typeof h&&(h=0);c.lineStyle(k,h,1);c.beginFill(l);c.drawRect(f-e/2,b-g/2,e,g)},drawCircle:function(c,f,b,d,e,g,h){"undefined"==typeof h&&(h=1);"undefined"==
typeof g&&(g=16777215);c.lineStyle(h,0,1);c.beginFill(g,1);c.drawCircle(f,b,-e);c.endFill();c.moveTo(f,b);c.lineTo(f+e*Math.cos(-d),b+e*Math.sin(-d))},drawLine:function(c,f,b,d){"undefined"==typeof d&&(d=1);"undefined"==typeof b&&(b=0);c.lineStyle(5*d,b,1);c.moveTo(-f/2,0);c.lineTo(f/2,0)},drawConvex:function(c,f,b,d,e,g,h,l){var k,m;if("undefined"==typeof g&&(g=1),"undefined"==typeof d&&(d=0),h){d=[16711680,65280,255];for(b=0;b!==f.length+1;)k=f[b%f.length],h=f[(b+1)%f.length],e=k[0],m=k[1],k=h[0],
h=h[1],c.lineStyle(g,d[b%d.length],1),c.moveTo(e,-m),c.lineTo(k,-h),c.drawCircle(e,-m,2*g),b++;return c.lineStyle(g,0,1),c.drawCircle(l[0],l[1],2*g)}c.lineStyle(g,d,1);c.beginFill(e);for(b=0;b!==f.length;)l=f[b],g=l[0],l=l[1],0===b?c.moveTo(g,-l):c.lineTo(g,-l),b++;return c.endFill(),2<f.length?(c.moveTo(f[f.length-1][0],-f[f.length-1][1]),c.lineTo(f[0][0],-f[0][1])):void 0},drawPath:function(c,f,b,d,e){var g,h,l,k,m,n,p,q,r,t;"undefined"==typeof e&&(e=1);"undefined"==typeof b&&(b=0);c.lineStyle(e,
b,1);"number"==typeof d&&c.beginFill(d);h=e=null;for(b=0;b<f.length;)r=f[b],t=r[0],r=r[1],(t!==e||r!==h)&&(0===b?c.moveTo(t,r):(l=e,k=h,m=t,n=r,p=f[(b+1)%f.length][0],q=f[(b+1)%f.length][1],g=(m-l)*(q-k)-(p-l)*(n-k),0!==g&&c.lineTo(t,r)),e=t,h=r),b++;"number"==typeof d&&c.endFill();2<f.length&&"number"==typeof d&&(c.moveTo(f[f.length-1][0],f[f.length-1][1]),c.lineTo(f[0][0],f[0][1]))},drawPlane:function(c,f,b,d,e,g,h,l,k,m){"undefined"==typeof g&&(g=1);"undefined"==typeof d&&(d=16777215);c.lineStyle(g,
e,11);c.beginFill(d);c.moveTo(f,-b);d=f+Math.cos(m)*this.game.width;e=b+Math.sin(m)*this.game.height;c.lineTo(d,-e);c.moveTo(f,-b);d=f+Math.cos(m)*-this.game.width;e=b+Math.sin(m)*-this.game.height;c.lineTo(d,-e)},randomPastelHex:function(){var c,f,b,d;return b=[255,255,255],d=Math.floor(256*Math.random()),f=Math.floor(256*Math.random()),c=Math.floor(256*Math.random()),d=Math.floor((d+3*b[0])/4),f=Math.floor((f+3*b[1])/4),c=Math.floor((c+3*b[2])/4),this.rgbToHex(d,f,c)},rgbToHex:function(c,f,b){return this.componentToHex(c)+
this.componentToHex(f)+this.componentToHex(b)},componentToHex:function(c){var f;return f=c.toString(16),2===f.len?f:f+"0"}});
Phaser.Physics.P2.Spring=function(c,f,b,d,e,g,h,l,k,m){this.game=c.game;this.world=c;"undefined"==typeof d&&(d=1);"undefined"==typeof e&&(e=100);"undefined"==typeof g&&(g=1);d=c.pxm(d);d={restLength:d,stiffness:e,damping:g};"undefined"!=typeof h&&null!==h&&(d.worldAnchorA=[c.pxm(h[0]),c.pxm(h[1])]);"undefined"!=typeof l&&null!==l&&(d.worldAnchorB=[c.pxm(l[0]),c.pxm(l[1])]);"undefined"!=typeof k&&null!==k&&(d.localAnchorA=[c.pxm(k[0]),c.pxm(k[1])]);"undefined"!=typeof m&&null!==m&&(d.localAnchorB=
[c.pxm(m[0]),c.pxm(m[1])]);this.data=new p2.LinearSpring(f,b,d);this.data.parent=this};Phaser.Physics.P2.Spring.prototype.constructor=Phaser.Physics.P2.Spring;Phaser.Physics.P2.RotationalSpring=function(c,f,b,d,e,g){this.game=c.game;this.world=c;"undefined"==typeof d&&(d=null);"undefined"==typeof e&&(e=100);"undefined"==typeof g&&(g=1);d&&(d=c.pxm(d));this.data=new p2.RotationalSpring(f,b,{restAngle:d,stiffness:e,damping:g});this.data.parent=this};Phaser.Physics.P2.Spring.prototype.constructor=Phaser.Physics.P2.Spring;
Phaser.Physics.P2.Material=function(c){this.name=c;p2.Material.call(this)};Phaser.Physics.P2.Material.prototype=Object.create(p2.Material.prototype);Phaser.Physics.P2.Material.prototype.constructor=Phaser.Physics.P2.Material;Phaser.Physics.P2.ContactMaterial=function(c,f,b){p2.ContactMaterial.call(this,c,f,b)};Phaser.Physics.P2.ContactMaterial.prototype=Object.create(p2.ContactMaterial.prototype);Phaser.Physics.P2.ContactMaterial.prototype.constructor=Phaser.Physics.P2.ContactMaterial;
Phaser.Physics.P2.CollisionGroup=function(c){this.mask=c};Phaser.Physics.P2.DistanceConstraint=function(c,f,b,d,e,g,h){"undefined"==typeof d&&(d=100);"undefined"==typeof e&&(e=[0,0]);"undefined"==typeof g&&(g=[0,0]);"undefined"==typeof h&&(h=Number.MAX_VALUE);this.game=c.game;this.world=c;d=c.pxm(d);e=[c.pxmi(e[0]),c.pxmi(e[1])];g=[c.pxmi(g[0]),c.pxmi(g[1])];p2.DistanceConstraint.call(this,f,b,{distance:d,localAnchorA:e,localAnchorB:g,maxForce:h})};Phaser.Physics.P2.DistanceConstraint.prototype=Object.create(p2.DistanceConstraint.prototype);
Phaser.Physics.P2.DistanceConstraint.prototype.constructor=Phaser.Physics.P2.DistanceConstraint;Phaser.Physics.P2.GearConstraint=function(c,f,b,d,e){"undefined"==typeof d&&(d=0);"undefined"==typeof e&&(e=1);this.game=c.game;this.world=c;p2.GearConstraint.call(this,f,b,{angle:d,ratio:e})};Phaser.Physics.P2.GearConstraint.prototype=Object.create(p2.GearConstraint.prototype);Phaser.Physics.P2.GearConstraint.prototype.constructor=Phaser.Physics.P2.GearConstraint;
Phaser.Physics.P2.LockConstraint=function(c,f,b,d,e,g){"undefined"==typeof d&&(d=[0,0]);"undefined"==typeof e&&(e=0);"undefined"==typeof g&&(g=Number.MAX_VALUE);this.game=c.game;this.world=c;d=[c.pxm(d[0]),c.pxm(d[1])];p2.LockConstraint.call(this,f,b,{localOffsetB:d,localAngleB:e,maxForce:g})};Phaser.Physics.P2.LockConstraint.prototype=Object.create(p2.LockConstraint.prototype);Phaser.Physics.P2.LockConstraint.prototype.constructor=Phaser.Physics.P2.LockConstraint;
Phaser.Physics.P2.PrismaticConstraint=function(c,f,b,d,e,g,h,l){"undefined"==typeof d&&(d=!0);"undefined"==typeof e&&(e=[0,0]);"undefined"==typeof g&&(g=[0,0]);"undefined"==typeof h&&(h=[0,0]);"undefined"==typeof l&&(l=Number.MAX_VALUE);this.game=c.game;this.world=c;e=[c.pxmi(e[0]),c.pxmi(e[1])];g=[c.pxmi(g[0]),c.pxmi(g[1])];p2.PrismaticConstraint.call(this,f,b,{localAnchorA:e,localAnchorB:g,localAxisA:h,maxForce:l,disableRotationalLock:!d})};Phaser.Physics.P2.PrismaticConstraint.prototype=Object.create(p2.PrismaticConstraint.prototype);
Phaser.Physics.P2.PrismaticConstraint.prototype.constructor=Phaser.Physics.P2.PrismaticConstraint;Phaser.Physics.P2.RevoluteConstraint=function(c,f,b,d,e,g,h){"undefined"==typeof g&&(g=Number.MAX_VALUE);"undefined"==typeof h&&(h=null);this.game=c.game;this.world=c;b=[c.pxmi(b[0]),c.pxmi(b[1])];e=[c.pxmi(e[0]),c.pxmi(e[1])];h&&(h=[c.pxmi(h[0]),c.pxmi(h[1])]);p2.RevoluteConstraint.call(this,f,d,{worldPivot:h,localPivotA:b,localPivotB:e,maxForce:g})};Phaser.Physics.P2.RevoluteConstraint.prototype=Object.create(p2.RevoluteConstraint.prototype);
Phaser.Physics.P2.RevoluteConstraint.prototype.constructor=Phaser.Physics.P2.RevoluteConstraint;(function(c,f,b,d,e,g,h){c.GoogleAnalyticsObject=e;c[e]=c[e]||function(){(c[e].q=c[e].q||[]).push(arguments)};c[e].l=1*new Date;g=f.createElement(b);h=f.getElementsByTagName(b)[0];g.async=1;g.src=d;h.parentNode.insertBefore(g,h)})(window,document,"script","//www.google-analytics.com/analytics.js","_gaTrack");_gaTrack("create","UA-57743254-2","auto");_gaTrack("send","pageview");var partnerName="mauj";
function anld(){_gaTrack("send","event","basic","loaded",partnerName,1)}function anst(){_gaTrack("send","event","basic","started",partnerName,1)}function anlst(){_gaTrack("send","event","basic","play",partnerName,1)}function anlsf(){_gaTrack("send","event","basic","lvlSuccessful",partnerName,1)};var DOWN=0,UP=1,RIGHT=2,LEFT=3,BEAR_EMPTY=0,BEAR_SMALL=1,BEAR_MEDIUM=2,BEAR_BIG=3,BULLET_SPEED=2,BULLET_ITERATIONS_PER_UPDATE=3,BULLET_X_MIN=0,BULLET_Y_MIN=0,BULLET_X_MAX=240,BULLET_Y_MAX=320,GRW=6,GRH=6,TLDM=1,FSM=2,ssau=0,ssbj=1,sscf=2,ssdr=3,sseg=4,ssfw=5,ssghg=6,ssih=9,ssje=10,sskw=11,sslq=12,ssma=
13,ssnh=14,ssoh=15,ACIO=Phaser.Easing.Cubic.InOut,ACI=Phaser.Easing.Cubic.In,ACO=Phaser.Easing.Cubic.Out,AEO=Phaser.Easing.Elastic.Out,AQO=Phaser.Easing.Quintic.Out,sspr=0,ssqu=1,ssrq=2,ssx9=3,sseb=4,sseo=5,MBTF=0,MBTML=1,MBTMR=2,LANGUAGE_DE=0,LANGUAGE_EN=1,LANGUAGE_ES=
2,LANGUAGE_FR=3,LANGUAGE_PT=4;lft5={0:"OH, NEIN! DER TISCH IST NICHT SAUBER! EIN WEITERER VERSUCH?",1:"OH NO! THE TABLE ISN'T CLEAR! TRY AGAIN?",2:"\u00a1OOOOH NO! \u00a1LA MESA NO EST\u00c1 LIMPIA! \u00bfPROBAR DE NUEVO?",3:"OH NON! LA TABLE N'EST PAS PROPRE! ESSAYEZ DE NOUVEAUX.",4:"N\u00c3O! A MESA N\u00c3O EST\u00c1 LIMPA! TENTAR NOVAMENTE?"};LVsI={0:"lvlCompletedText_de",1:"lvlCompletedText_en",2:"lvlCompletedText_es",3:"lvlCompletedText_fr",4:"lvlCompletedText_pt"};
lfi={0:"lvlFailedText_de",1:"lvlFailedText_en",2:"lvlFailedText_es",3:"lvlFailedText_fr",4:"lvlFailedText_pt"};
hhtx={0:"ZIEL:\nBENUTZE DEN ENTFERNER, UM ALLE TISCHE ABZUPUTZEN. DIE ST\u00dcCKE WERDEN MIT JEDEM TROPFEN GR\u00d6SSER, BIS SIE IN ALLE RICHTUNGEN EXPLODIEREN. DU MUSST EINE PERFEKTE KETTENREAKTION MIT DEM KLEINEN REST DES GELEE-ENTFERNERS VERURSACHEN.",1:"AIM:\nCLEAR ALL TABLES BY DRIPPING THE JELLY WITH JELLY REMOVER. THE BEARS WILL GROW LARGER WITH EACH DROP UNTIL THEY BURST WITH JELLY REMOVER INTO EVERY DIRECTION. YOU NEED TO ENSURE THE PERFECT CHAIN REACTION USING THE TINY AMOUNT OF JELLY REMOVER AVAILABLE.",2:"OBJETIVO:\n LIMPIA TODAS LAS MESAS PONIENDO GOTAS DE DECAPANTE ENCIMA DE LA GELATINA. LOS OSITOS DE GOMINOLA CRECEN CON CADA GOTA Y AS\u00cd LLENOS DE DECAPANTE REVENTAR\u00c1N EN TODAS LAS DIRECCIONES. Y POR ESO TIENES QUE ASEGURAR UNA PERFECTA REACCI\u00d3N EN CADENA DE LOS SALPICONES USANDO POCA CANTIDAD DE DECAPANTE DE GELATINA QUE EST\u00c1 A TU DISPOSICI\u00d3N.",
3:"BUT:\n NETTOYEZ TOUTES LES TABLES EN LAISSANT TOMBER L'\u00c9LIMINEUR DE LA GEL\u00c9E SUR L'OBJET QUE VOUS AVEZ D\u00c9CID\u00c9 D'\u00c9LIMINER. LES OBJETS VONT GRANDIR AVEC CHAQUE PI\u00c8CE JUSQU'ILS \u00c9CLATENT. VOUS DEVEZ FAIRE UNE R\u00c9ACTION EN CHA\u00ceNE PARFAITE EN UTILISANT UN PEU DE L'\u00c9LIMINEUR DE LA GEL\u00c9E DISPONIBLE.",4:"OBJETIVO:\nLIMPE TODAS AS MESAS REGANDO A GELATINA COM O REMOVEDOR DE GELATINA. OS URSOS DE GELATINA EST\u00c3O CRESCENDO COM CADA GOTA AT\u00c9 EXPLODIREM EM TODAS AS DIRE\u00c7\u00d5ES ENCHIDOS DO REMOVEDOR. ASSIM, VOC\u00ca DEVE GARANTIR UMA REA\u00c7\u00c3O EM CADEIA PERFEITA USANDO UMA PEQUENA QUANTIDADE DE REMOVEDOR DE GELATINA, QUE VOC\u00ca TEM."};
tcxr={0:"STEUERUNG: \nTIPPE AUF DAS OBJEKT, DAS DU BETR\u00c4UFELN M\u00d6CHTEST. TIPPE AUF ANDERE SYMBOLE AUF DEM BILDSCHIRM, UM DIE ENTSPRECHENDE AKTION DURCHZUF\u00dcHREN (SPIELEN, PAUSE... ).",1:"CONTROLS:\nTAP THE DESIRED OBJECT TO DROP JELLY REMOVER ON IT. TAP OTHER ONSCREEN ICONS FOR CORRESPONDING ACTION (PLAY, PAUSE...).",2:"CONTROL: \n PULSA EL OBJETO DADO PARA VERTER ENCIMA EL DECAPANTE DE GELATINA. TOCA OTROS ICONOS EN LA PANTALLA PARA EL EFECTO CORRESPONDIENTE (JUGAR, PAUSA...).",
3:"CONTR\u00d4LES:\n TOUCHEZ UN OBJET SUR LEQUEL VOUS VOULEZ LAISSER TOMBER L'\u00c9LIMINEUR. APPUYEZ SUR UNE IC\u00d4NES DE L'\u00c9CRAN POUR LES ACTIONS CORRESPONDANTES (JOUER, PAUSE...).",4:"CONTROLE: \n TOQUE NO OBJETO PARA REGAR O REMOVEDOR DE GELATINA. TOQUE EM OUTROS \u00cdCONES NA TELA PARA O EFEITO CORRESPONDENTE (JOGAR, PAUSAR...)."};
txc={0:"JELLY BOMB, V1.0.0\n\nINLOGIC SOFTWARE LTD",1:"JELLY BOMB, V1.0.0\n\nINLOGIC SOFTWARE LTD",2:"JELLY BOMB, V1.0.0\n\nINLOGIC SOFTWARE LTD",3:"JELLY BOMB, V1.0.0\n\nINLOGIC SOFTWARE LTD",4:"JELLY BOMB, V1.0.0\n\nINLOGIC SOFTWARE LTD"};
IGCFTX={0:"BIST DU DIR SICHER, DASS DAS AKTUELLE SPIEL BEENDET WERDEN SOLL?",1:"ARE YOU SURE? CURRENT PROGRESS WILL BE LOST.",2:"\u00bfEST\u00c1S SEGURO? EL JUEGO ACTUAL SER\u00c1 CANCELADO.",3:"ES-TU S\u00dbR? LE JEU EN COURS SERA ANNUL\u00c9.",4:"VOC\u00ca TEM CERTEZA? VOC\u00ca PERDER\u00c1 OS PONTOS ATINGIDOS."};
wtx={0:"GL\u00dcCKWUNSCH! DU HAST ALLE TISCHE GEPUTZT UND DIE MENSCHHEIT VOR EINER M\u00d6GLICHEN MUTANTEN- GELEE- SKLAVEREI BEWAHRT!",1:"CONGRATULATIONS! YOU HAVE CLEARED ALL TABLES AND SAVED MANKIND FROM BECOMING ENSLAVED BY A\u00a0RACE OF MUTANT JELLY BEARS!",2:"\u00a1ENHORABUENA! \u00a1HAS LIMPIADO TODAS LAS MESAS Y HAS SALVADO LA HUMANIDAD ANTE LA ESCLAVIZADA RAZA DE OSITOS MUTANTES DE GOMINOLA!",3:"F\u00c9LICITATION! VOUS AVEZ NETTOY\u00c9 TOUTES LES TABLES ET VOUS AVEZ SAUV\u00c9 LA MONDE DE LA TYRANNIE DE LA GEL\u00c9E MUTANTE!",
4:"PARAB\u00c9NS! LIMPOU TODAS AS MESAS E SALVOU A HUMANIDADE DA ESCRAVID\u00c3O POR UMA RA\u00c7A DE URSOS DE GELEIA MUTANTES!"};stx={0:"Tap to continue...",1:"Tap to continue...",2:"Tap to continue...",3:"Tap to continue...",4:"Tap to continue..."};rtx={0:"Rotate your device please",1:"Rotate your device please",2:"Rotate your device please",3:"Rotate your device please",4:"Rotate your device please"};var FCBR="#754C24",FONT_TYPE="Helvetica",roWP=!1;var IMAGE_FOLDER="img_480/";function loadSplash(c){c.load.image("inlogic_logo","assets/"+IMAGE_FOLDER+"l.png");c.load.image("splash","assets/"+IMAGE_FOLDER+"s.png");c.load.image("loading_bar_keks","assets/"+IMAGE_FOLDER+"loading_back.png");c.load.image("loading_bar_bcg","assets/"+IMAGE_FOLDER+"loading_bar0.png");c.load.image("loading_bar_full","assets/"+IMAGE_FOLDER+"loading_bar1.png");c.load.image("loading_bar_slider","assets/"+IMAGE_FOLDER+"loading_bar2.png")}
function loadImages(c){c.load.spritesheet("bear1","assets/"+IMAGE_FOLDER+"g-medved1.png",34,58);c.load.spritesheet("bear2","assets/"+IMAGE_FOLDER+"g-medved2.png",60,66);c.load.spritesheet("bear3","assets/"+IMAGE_FOLDER+"g-medved3.png",74,78);c.load.spritesheet("arrow","assets/"+IMAGE_FOLDER+"g-sipka.png",66,64);c.load.spritesheet("bomb","assets/"+IMAGE_FOLDER+"g-bomba.png",62,62);c.load.spritesheet("bombWick","assets/"+IMAGE_FOLDER+"knot.png",14,14);c.load.image("stone","assets/"+IMAGE_FOLDER+"zatarasa2.png");
c.load.spritesheet("explosion","assets/"+IMAGE_FOLDER+"vybuch-vzduch.png",90,90);c.load.image("bullet","assets/"+IMAGE_FOLDER+"g-x.png");c.load.image("gameTileBackgroundRed","assets/"+IMAGE_FOLDER+"tile-2.png");c.load.image("gameTileBackgroundBlue","assets/"+IMAGE_FOLDER+"tile-1.png");c.load.image("upperBar","assets/"+IMAGE_FOLDER+"lista-up.png");c.load.image("bottomBar","assets/"+IMAGE_FOLDER+"lista-down.png");c.load.image("mnBT","assets/"+IMAGE_FOLDER+"buttons1.png");c.load.spritesheet("mnBTi",
"assets/"+IMAGE_FOLDER+"buttons1-icons.png",60,52);c.load.spritesheet("mnBTsm","assets/"+IMAGE_FOLDER+"buttons2.png",54,54);c.load.image("mnBTArrow","assets/"+IMAGE_FOLDER+"button-sipky.png");c.load.spritesheet("lvlFlags","assets/"+IMAGE_FOLDER+"lvl-znacky-spr.png",182,202);c.load.image("ribbon","assets/"+IMAGE_FOLDER+"lvl-stuha.png");c.load.image("lvlCard","assets/"+IMAGE_FOLDER+"lvl-back.png");c.load.image("pulley","assets/"+IMAGE_FOLDER+"kladkasmall.png");c.load.image("bbiL",
"assets/"+IMAGE_FOLDER+"nobutt-left.png");c.load.image("bbiR","assets/"+IMAGE_FOLDER+"nobutt-right.png");c.load.image("upperBarLogo","assets/"+IMAGE_FOLDER+"lista-up-logo.png");c.load.image("uppperBarRoof","assets/"+IMAGE_FOLDER+"strieska.png");c.load.spritesheet("upperBarBottle","assets/"+IMAGE_FOLDER+"flasa-spr.png",64,74);c.load.image("uppperBarRound","assets/"+IMAGE_FOLDER+"lista-up-bck1.png");c.load.image("uppperBarCookCap","assets/"+IMAGE_FOLDER+"lista-up-bck2.png");c.load.spritesheet("keksNaSkladanie",
"assets/"+IMAGE_FOLDER+"window-spr.png",28,27);c.load.image("lvlCompletedLogo","assets/"+IMAGE_FOLDER+"lvlcomplete1.png");c.load.image("lvlCompletedText_de","assets/"+IMAGE_FOLDER+"lvlcomplete-de.png");c.load.image("lvlCompletedText_en","assets/"+IMAGE_FOLDER+"lvlcomplete-en.png");c.load.image("lvlCompletedText_es","assets/"+IMAGE_FOLDER+"lvlcomplete-es.png");c.load.image("lvlCompletedText_fr","assets/"+IMAGE_FOLDER+"lvlcomplete-fr.png");c.load.image("lvlCompletedText_pt","assets/"+IMAGE_FOLDER+"lvlcomplete-pt.png");
c.load.image("lvlFailedLogo","assets/"+IMAGE_FOLDER+"lvlfailed1.png");c.load.image("lvlFailedText_de","assets/"+IMAGE_FOLDER+"lvlfailed-de.png");c.load.image("lvlFailedText_en","assets/"+IMAGE_FOLDER+"lvlfailed-en.png");c.load.image("lvlFailedText_es","assets/"+IMAGE_FOLDER+"lvlfailed-es.png");c.load.image("lvlFailedText_fr","assets/"+IMAGE_FOLDER+"lvlfailed-fr.png");c.load.image("lvlFailedText_pt","assets/"+IMAGE_FOLDER+"lvlfailed-pt.png");c.load.image("mrGmzT","assets/"+IMAGE_FOLDER+"moregames.png")}
function loadSounds(c){c.load.audio("menuMusic",["assets/audio/BCB-menu113.mp3","assets/audio/BCB-menu113.ogg"]);c.load.audio("gameMusic",["assets/audio/BCB-story114.mp3","assets/audio/BCB-story114.ogg"]);c.load.audio("explodeSoundBomb",["assets/audio/bomba.mp3","assets/audio/bomba.ogg"]);c.load.audio("explodeSound1",["assets/audio/bubble1.mp3","assets/audio/bubble1.ogg"]);c.load.audio("explodeSound2",["assets/audio/bubble2.mp3","assets/audio/bubble2.ogg"]);c.load.audio("explodeSound3",["assets/audio/bubble3.mp3",
"assets/audio/bubble3.ogg"]);c.load.audio("successSound",["assets/audio/perfect1.mp3","assets/audio/perfect1.ogg"]);c.load.audio("failSound",["assets/audio/lost.mp3","assets/audio/lost.ogg"])};GameTile=function(c,f,b){this.game=c;this.xGrid=f;this.yGrid=b;this.sprxy();this.sprite=null;this.stg="";this.srRt=0;this.sres=null;this.clnwt();this.created=!1};
GameTile.prototype={constructor:GameTile,preload:function(){},create:function(){this.sprite=this.game.add.sprite(this.x,this.y,this.stg);this.sprite.anchor.set(.5);this.sprite.angle=this.srRt;this.sprite.parentObject=this;this.game.physics.arcade.enable(this.sprite);this.sprite.inputEnabled=!0;this.sprite.events.onInputDown.add(this.inputListener,this);this.sprite.animations.add("pulse",[0,1,2,1,0],13);this.sres=this.game.add.sprite(this.x,this.y,"explosion");this.sres.visible=
!1;this.sres.anchor.set(.5);this.sres.animations.add("explode",[0,1,2,3,4],13);this.sres.events.onAnimationComplete.add(this.plExdN,this);this.created=!0},update:function(){this.blnk()},sprxy:function(){this.x=(this.xGrid+.5)*TLDM+pgox;this.y=(this.yGrid+.5)*TLDM+pgoy},udsrpz:function(){null!=this.sprite&&(this.sprite.x=this.x,this.sprite.y=this.y);null!=this.sres&&(this.sres.x=
this.x,this.sres.y=this.y);null!=this.sres&&(this.sres.x=this.x,this.sres.y=this.y)},inputListener:function(){gst==ssbj&&(gmvr.upperBar.brMgz[4].animations.play("grow"),gplmvr.cltt++,gmvr.udrstt(),this.twhha())},twhha:function(){this.fire()},fire:function(){this.plExp();this.pplds();debugToConsole("fireeeee")},blnk:function(){0<this.pulseFrames?this.pulseFrames--:
(this.sprite.animations.play("pulse"),this.clnwt())},clnwt:function(){this.pulseFrames=100+100*Math.random()},enableInteract:function(){this.sprite.inputEnabled=!0},disableInteract:function(){this.sprite.inputEnabled=!1},dstrE:function(){this.sprite.kill();this.sres.kill()},plExp:function(){this.sres.animations.play("explode");this.sres.visible=!0},plExdN:function(){this.sres.visible=!1;0==this.sprite.exists&&
this.sres.kill()},pplds:function(){smvr.pls(sseo)},rwoj:function(c){this.xGrid=c%GRW;this.yGrid=parseInt(c/GRH);this.sprxy.call(this);return this},showSprite:function(){null!=this.sprite&&(this.sprite.revive(),this.enableInteract(),this.sres.revive(),this.sres.visible=!1)},udojrt:function(){null!=this.sprite&&(this.sprite.angle=this.srRt)}};Bear=function(c,f,b,d){this.level=d;GameTile.call(this,c,f,b);this.brlq=["bullet","bear1","bear2","bear3"];this.stg=this.brlq[this.level]};Bear.prototype=Object.create(GameTile.prototype);Bear.prototype.constructor=Bear;Bear.prototype.twhha=function(){3==this.level?this.fire():(this.level++,this.plExp(),this.sprite.loadTexture(this.brlq[this.level]))};
Bear.prototype.fire=function(){GameTile.prototype.fire.call(this);this.sprite.kill();debugToConsole("bear fired");gplmvr.blmgvr.frlz(this.x,this.y,this.xGrid,this.yGrid,[LEFT,RIGHT,UP,DOWN])};Bear.prototype.create=function(){GameTile.prototype.create.call(this)};Bear.prototype.rwoj=function(c){this.level=c;this.stg=this.brlq[this.level];null!=this.sprite&&this.sprite.loadTexture(this.brlq[this.level]);return this};Arrow=function(c,f,b,d){this.direction=d;GameTile.call(this,c,f,b);this.stg="arrow";d==DOWN?this.srRt=270:d==UP?this.srRt=90:d==RIGHT?this.srRt=180:d==LEFT&&(this.srRt=0)};Arrow.prototype=Object.create(GameTile.prototype);Arrow.prototype.constructor=Arrow;Arrow.prototype.fire=function(){GameTile.prototype.fire.call(this);this.sprite.kill();debugToConsole("arrow fired");gplmvr.blmgvr.frlz(this.x,this.y,this.xGrid,this.yGrid,[this.direction])};
Arrow.prototype.rwoj=function(c,f){this.xGrid=c%GRW;this.yGrid=parseInt(c/GRH);GameTile.prototype.sprxy.call(this);this.direction=f;f==DOWN?this.srRt=270:f==UP?this.srRt=90:f==RIGHT?this.srRt=180:f==LEFT&&(this.srRt=0);return this};Arrow.prototype.showSprite=function(){GameTile.prototype.showSprite.call(this);GameTile.prototype.udsrpz.call(this);GameTile.prototype.udojrt.call(this)};Bomb=function(c,f,b){GameTile.call(this,c,f,b);this.stg="bomb";this.wksr=null};Bomb.prototype=Object.create(GameTile.prototype);Bomb.prototype.constructor=Bomb;Bomb.prototype.fire=function(){GameTile.prototype.fire.call(this);this.sprite.kill();this.wksr.kill();debugToConsole("bomb exploded");gplmvr.bpld(this.xGrid,this.yGrid)};Bomb.prototype.pplds=function(){smvr.pls(sseb)};
Bomb.prototype.create=function(){GameTile.prototype.create.call(this);this.wksr=this.game.add.sprite(this.x,this.y-.55*this.sprite.height,"bombWick");this.wksr.anchor.set(.5);this.wksr.animations.add("wick",[0,1,2,3,2,1],10,!0);this.wksr.animations.play("wick")};Bomb.prototype.swkpz=function(){this.wksr.x=this.x;this.wksr.y=this.y-.55*this.sprite.height};Bomb.prototype.dstrE=function(){this.sprite.kill();this.sres.kill();this.wksr.kill()};
Bomb.prototype.showSprite=function(){GameTile.prototype.showSprite.call(this);GameTile.prototype.udsrpz.call(this);this.swkpz();this.wksr.revive()};Stone=function(c,f,b){GameTile.call(this,c,f,b);this.stg="stone"};Stone.prototype=Object.create(GameTile.prototype);Stone.prototype.constructor=Stone;Stone.prototype.fire=function(){debugToConsole("stone hit")};Stone.prototype.create=function(){GameTile.prototype.create.call(this);this.sprite.inputEnabled=!1};Stone.prototype.showSprite=function(){GameTile.prototype.showSprite.call(this);GameTile.prototype.udsrpz.call(this)};blmg=function(c){this.game=c;this.btat=[]};
blmg.prototype={constructor:blmg,frlz:function(c,f,b,d,e){for(i=0;i<e.length;i++)bull=new Bt(this.game,c,f,b,d,e[i]),bull.create(),this.btat.push(bull)},update:function(){for(bulletCount=0;bulletCount<this.btat.length;bulletCount++)this.btat[bulletCount].move()},reset:function(){for(blts=0;blts<this.btat.length;blts++)this.btat[blts].klbl();this.btat=[]}};Bt=function(c,f,b,d,e,g){this.game=c;this.x=f;this.y=b;this.direction=g;this.xGrid=d;this.yGrid=e};
Bt.prototype={constructor:Bt,create:function(){this.sprite=this.game.add.sprite(this.x,this.y,"bullet");this.sprite.parentObject=this;this.game.physics.arcade.enable(this.sprite);this.sprite.anchor.set(.5)},move:function(){speed=BULLET_SPEED;this.direction==UP?this.y-=speed:this.direction==DOWN?this.y+=speed:this.direction==LEFT?this.x-=speed:this.direction==RIGHT&&(this.x+=speed);this.sprite.x=this.x;this.sprite.y=this.y;this.xGrid=parseInt((this.x-pgox)/TLDM);this.yGrid=
parseInt((this.y-pgoy)/TLDM);(this.x<BULLET_X_MIN||this.x>BULLET_X_MAX||this.y<BULLET_Y_MIN||this.y>BULLET_Y_MAX)&&this.klbl()},klbl:function(){this.sprite.destroy()}};levels_db={0:{board:[0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0],maxLevelTurns:1},1:{board:[0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,7,0,0],maxLevelTurns:1},2:{board:[0,0,0,0,0,0,0,8,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,7],maxLevelTurns:1},3:{board:[4,0,0,0,0,4,0,0,0,0,0,0,3,0,4,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,4],maxLevelTurns:1},4:{board:[4,0,0,0,3,0,0,3,0,0,4,4,0,0,0,0,0,0,0,2,8,7,4,3,0,0,8,4,0,0,4,2,4,0,4,5],maxLevelTurns:1},
5:{board:[6,0,0,0,0,7,0,4,3,4,4,0,0,6,0,0,7,0,0,0,3,4,0,0,0,8,0,5,0,0,8,0,0,0,5,5],maxLevelTurns:1},6:{board:[3,0,4,2,7,3,0,8,0,6,0,0,6,0,0,4,2,7,0,5,4,0,0,0,5,4,0,0,8,4,2,8,0,4,4,3],maxLevelTurns:1},7:{board:[6,0,4,3,4,0,0,4,0,0,0,0,0,0,0,8,0,6,0,3,4,0,4,0,8,0,0,5,0,0,0,0,5,0,0,7],maxLevelTurns:1},8:{board:[4,6,0,7,8,4,6,6,0,0,0,0,0,0,0,0,0,0,0,8,0,4,0,0,8,0,0,0,4,3,4,0,8,7,0,3],maxLevelTurns:1},9:{board:[0,4,0,0,6,0,0,0,6,0,0,4,0,5,6,0,0,0,0,0,0,0,0,0,0,0,2,0,4,0,0,4,0,0,0,5],maxLevelTurns:2},10:{board:[2,
0,2,0,4,6,0,6,4,4,0,2,4,4,2,0,0,0,4,7,0,8,4,0,2,0,6,0,4,0,3,0,2,0,4,4],maxLevelTurns:2},11:{board:[4,0,4,0,4,0,0,0,0,0,0,0,0,2,7,0,5,3,0,6,7,0,8,6,0,0,0,0,0,0,2,3,4,3,4,3],maxLevelTurns:2},12:{board:[4,0,4,0,4,0,0,0,0,6,0,4,0,2,7,0,5,3,0,6,7,4,8,6,0,0,0,0,0,0,2,3,4,3,4,3],maxLevelTurns:2},13:{board:[6,0,0,0,4,0,2,4,0,0,0,3,4,0,7,2,0,3,0,5,4,6,0,0,0,0,8,0,4,5,2,0,2,4,2,2],maxLevelTurns:2},14:{board:[2,4,0,0,0,4,3,0,8,8,6,0,5,0,5,6,7,0,4,0,5,2,0,4,0,0,0,0,0,0,5,4,0,4,0,7],maxLevelTurns:2},15:{board:[6,
4,4,3,3,3,2,0,0,5,3,2,0,0,0,4,4,4,0,4,0,2,0,3,2,0,4,0,0,3,2,4,0,0,0,4],maxLevelTurns:2},16:{board:[4,6,3,3,6,4,0,0,6,0,0,0,0,4,0,0,4,0,0,0,0,0,0,0,5,0,3,0,0,5,4,8,3,3,7,4],maxLevelTurns:2},17:{board:[2,8,2,7,2,7,4,2,4,2,4,2,3,2,3,2,3,2,2,4,0,4,0,4,5,3,5,3,5,3,3,4,3,4,3,4],maxLevelTurns:2},18:{board:[4,0,0,0,4,3,0,6,0,0,0,0,0,0,0,8,0,6,4,0,0,4,0,2,0,5,0,0,0,0,3,8,0,0,5,4],maxLevelTurns:2},19:{board:[2,0,0,2,4,6,2,0,2,4,5,0,0,2,4,5,0,4,3,4,5,0,0,0,2,5,0,0,0,7,4,5,4,4,5,0],maxLevelTurns:3},20:{board:[8,
7,4,4,10,6,10,4,0,0,4,4,4,6,2,2,0,0,4,0,2,2,0,4,0,4,0,4,4,10,5,10,4,7,0,7],maxLevelTurns:3},21:{board:[6,7,2,2,4,6,4,4,4,0,7,4,4,2,2,2,0,3,8,0,4,0,4,6,0,2,2,2,0,0,5,4,3,4,0,7],maxLevelTurns:3},22:{board:[2,7,8,4,4,6,4,5,0,0,0,0,4,7,5,2,2,6,2,5,2,0,0,4,8,5,0,6,7,0,5,0,4,2,4,4],maxLevelTurns:3},23:{board:[2,0,0,6,0,4,4,0,0,0,0,4,2,0,0,4,6,0,2,0,0,0,4,3,4,0,0,0,0,3,2,0,0,7,0,0],maxLevelTurns:3},24:{board:[3,0,8,4,0,4,2,0,4,0,0,0,2,0,0,4,8,2,0,0,2,0,0,2,4,0,0,0,0,5,5,0,5,4,0,4],maxLevelTurns:2},25:{board:[0,
0,0,4,4,0,0,0,0,10,0,0,8,0,4,0,3,0,3,3,0,0,7,4,0,0,2,9,7,0,0,0,5,0,0,0],maxLevelTurns:3},26:{board:[0,0,0,0,0,0,0,0,0,4,4,0,4,10,0,0,0,0,3,10,0,0,3,0,4,10,0,4,3,0,2,0,0,0,5,0],maxLevelTurns:3},27:{board:[10,3,3,3,2,10,0,10,9,2,10,0,0,0,10,0,0,0,0,9,0,0,0,0,3,4,0,7,0,0,0,0,0,0,0,0],maxLevelTurns:3},28:{board:[0,0,0,4,4,0,0,4,2,6,0,0,0,4,3,3,0,0,0,2,2,3,0,0,4,2,5,2,0,0,0,2,9,0,7,0],maxLevelTurns:3},29:{board:[6,0,0,0,0,7,0,0,0,0,10,0,0,0,6,3,10,4,0,2,4,2,0,4,0,3,2,5,0,0,9,3,0,5,0,0],maxLevelTurns:3},
30:{board:[9,2,4,2,2,3,3,10,2,3,2,2,10,3,2,2,2,9,2,3,2,9,2,2,9,3,4,2,4,4,4,2,3,2,10,3],maxLevelTurns:4},31:{board:[2,2,2,2,2,4,2,3,2,3,2,2,3,2,9,2,3,2,2,4,10,2,2,4,3,2,2,2,2,4,4,3,4,4,2,10],maxLevelTurns:4},32:{board:[4,4,3,3,3,4,3,3,3,3,1,3,4,3,3,3,2,3,3,3,3,3,1,3,4,4,3,3,3,4,0,0,0,0,0,0],maxLevelTurns:3},33:{board:[4,0,4,0,4,0,3,0,4,0,3,0,3,0,4,0,3,0,3,0,4,0,3,0,3,0,4,0,3,0,3,2,4,2,3,0],maxLevelTurns:3},34:{board:[3,3,3,3,3,3,3,4,0,0,4,3,3,3,4,4,2,3,3,4,0,0,4,3,3,3,3,3,3,3,0,0,0,0,0,0],maxLevelTurns:1},
35:{board:[4,3,1,4,4,0,2,4,1,1,4,2,3,0,2,4,2,2,3,3,4,4,3,0,1,0,1,1,4,4,4,0,4,4,0,0],maxLevelTurns:1},36:{board:[4,1,2,4,3,0,4,0,2,4,1,4,4,4,2,1,1,0,3,3,4,3,4,0,3,3,4,0,2,4,0,0,4,3,4,0],maxLevelTurns:1},37:{board:[4,3,2,0,0,4,2,3,1,1,0,2,0,3,4,4,0,3,2,4,2,3,0,3,1,3,4,2,0,3,4,1,0,3,0,1],maxLevelTurns:1},38:{board:[1,2,4,3,1,0,4,4,1,3,2,0,2,0,4,4,3,4,3,4,4,0,0,0,0,3,0,1,3,4,3,0,4,2,0,0],maxLevelTurns:1},39:{board:[3,1,4,0,1,4,4,3,0,3,4,0,3,4,4,3,3,4,3,2,4,3,0,0,0,2,1,3,1,4,2,4,4,2,3,0],maxLevelTurns:1},
40:{board:[3,1,1,4,4,4,3,3,3,0,1,3,0,1,3,3,3,0,4,4,4,2,4,0,4,1,0,4,1,0,1,0,2,3,0,2],maxLevelTurns:1},41:{board:[3,2,0,4,4,0,1,3,2,3,3,1,3,0,4,3,3,2,3,3,4,3,3,3,0,0,2,3,4,3,0,0,0,0,0,0],maxLevelTurns:2},42:{board:[0,0,3,4,3,4,1,3,4,0,3,4,3,4,1,3,4,0,2,4,4,1,4,0,0,4,0,0,4,0,0,0,0,0,0,0],maxLevelTurns:1},43:{board:[0,1,0,4,2,0,2,1,4,3,1,0,2,2,3,3,4,0,3,3,4,1,4,0,3,2,4,2,2,0,3,4,4,2,2,0],maxLevelTurns:2},44:{board:[1,1,0,4,2,2,4,1,3,2,4,1,1,4,0,4,4,2,1,4,2,0,3,0,4,3,4,4,1,3,0,0,0,0,0,0],maxLevelTurns:1},
45:{board:[4,2,4,4,2,0,2,1,2,4,3,3,4,2,4,0,3,4,2,0,0,0,4,1,2,3,0,4,0,4,0,0,0,0,0,0],maxLevelTurns:2},46:{board:[0,1,3,1,4,3,0,4,4,1,4,2,0,4,4,1,3,1,0,2,3,3,4,2,0,2,3,4,0,4,0,4,4,4,1,4],maxLevelTurns:2},47:{board:[3,1,2,4,4,0,0,3,1,3,3,0,4,1,0,4,3,0,4,4,3,4,0,0,2,2,4,2,0,0,3,3,1,0,2,0],maxLevelTurns:2},48:{board:[0,2,2,3,1,3,1,4,1,2,3,3,4,4,3,1,4,1,3,3,2,0,4,3,1,4,3,4,0,3,0,0,0,0,0,0],maxLevelTurns:2},49:{board:[0,3,2,3,1,4,2,4,0,4,3,4,3,0,4,1,2,4,2,1,2,4,4,4,4,2,0,3,3,4,0,0,0,0,0,0],maxLevelTurns:3},
50:{board:[0,0,0,0,0,0,3,0,4,4,1,4,0,0,4,4,2,4,2,1,2,0,2,4,3,4,1,3,1,1,0,0,2,4,0,3],maxLevelTurns:6},51:{board:[4,0,2,4,4,3,1,4,0,3,3,2,0,3,0,3,0,3,3,2,4,2,0,3,0,2,0,4,0,3,0,0,0,0,0,0],maxLevelTurns:3},52:{board:[0,1,0,4,1,1,0,1,4,4,3,2,0,2,1,0,2,2,0,0,4,4,4,2,0,2,3,4,2,4,0,3,0,2,4,4],maxLevelTurns:3},53:{board:[4,0,1,1,4,0,0,4,2,4,4,4,0,0,1,2,3,4,2,3,4,0,4,4,3,3,1,3,3,1,0,0,0,0,0,0],maxLevelTurns:3},54:{board:[0,0,0,0,0,0,4,2,2,2,4,0,2,4,3,2,4,2,4,1,2,4,3,0,1,3,3,1,2,1,2,4,2,0,4,4],maxLevelTurns:4},
55:{board:[10,6,4,3,4,3,6,2,3,4,0,3,0,2,0,4,3,1,8,1,1,4,3,2,10,0,4,3,3,1,10,1,0,1,1,3],maxLevelTurns:3},56:{board:[6,6,9,4,3,3,3,10,10,7,4,2,3,7,8,5,2,5,0,3,3,3,3,4,4,2,5,6,9,7,8,2,5,5,4,10],maxLevelTurns:4},57:{board:[2,2,9,0,0,0,2,3,4,4,2,0,2,3,3,0,0,0,6,10,10,10,4,0,2,9,3,0,7,0,0,0,0,0,0,0],maxLevelTurns:4},58:{board:[1,2,1,2,0,1,1,1,2,3,4,0,4,3,4,4,0,3,0,2,0,4,3,0,4,1,0,3,4,1,0,0,5,0,0,5],maxLevelTurns:6},59:{board:[0,2,1,0,0,6,3,0,2,4,4,0,4,3,1,4,3,0,0,4,4,1,4,0,2,2,2,0,1,7,3,3,1,3,4,0],maxLevelTurns:4},
60:{board:[4,0,3,2,1,4,1,2,4,3,4,0,0,3,0,3,0,0,1,4,4,1,4,1,1,4,2,0,2,2,0,0,0,5,0,0],maxLevelTurns:3},61:{board:[0,1,0,2,4,1,3,4,4,4,2,3,0,4,1,4,1,2,4,3,2,4,4,3,4,2,1,1,1,4,5,0,0,0,0,5],maxLevelTurns:1},62:{board:[0,0,3,0,4,0,2,4,1,1,2,0,1,3,1,0,4,0,1,4,4,1,3,0,3,4,3,1,1,0,3,4,3,3,4,0],maxLevelTurns:5},63:{board:[2,3,4,3,0,2,0,2,0,4,2,0,0,3,0,2,2,4,3,4,2,0,2,0,2,3,0,4,9,3,3,2,0,7,0,2],maxLevelTurns:3},64:{board:[3,2,0,0,0,4,2,0,3,3,3,0,3,0,4,3,4,4,10,0,10,0,3,0,4,9,4,10,3,3,4,10,4,10,4,5],maxLevelTurns:3},
65:{board:[3,4,4,2,0,9,4,0,3,3,3,4,2,10,2,4,3,3,9,10,10,10,10,10,10,4,4,0,0,6,4,3,3,0,0,7],maxLevelTurns:3},66:{board:[3,6,0,0,7,3,0,0,0,0,0,0,4,2,9,2,0,5,0,0,6,0,4,0,3,10,8,0,0,3,0,4,0,4,5,2],maxLevelTurns:4},67:{board:[4,2,7,2,0,3,2,2,2,4,3,0,3,0,3,3,4,3,10,2,5,0,2,2,4,4,2,2,3,0,9,4,2,3,0,3],maxLevelTurns:4},68:{board:[3,2,0,0,2,0,1,0,3,2,2,0,3,3,2,3,2,0,4,2,4,3,3,0,4,0,3,3,1,0,4,2,4,1,4,0],maxLevelTurns:3},69:{board:[2,1,4,2,2,0,4,4,1,0,4,3,2,4,3,3,4,4,1,1,4,2,3,3,4,2,2,4,1,1,0,0,0,0,0,0],maxLevelTurns:2},
70:{board:[4,1,2,4,2,4,4,2,4,3,4,0,2,0,2,2,0,0,2,2,0,4,0,3,3,4,4,2,0,3,0,0,0,0,0,0],maxLevelTurns:4},71:{board:[4,1,2,4,2,4,4,2,4,3,4,0,2,0,2,2,0,0,2,2,0,4,0,3,3,4,4,2,0,3,0,0,0,0,0,0],maxLevelTurns:4},72:{board:[3,2,3,3,2,0,0,3,2,0,1,0,3,1,4,0,3,0,0,1,3,3,3,0,4,1,3,1,4,0,0,4,3,2,3,0],maxLevelTurns:5},73:{board:[1,4,1,2,4,2,0,4,0,3,0,2,0,3,2,3,1,0,4,0,2,4,2,4,0,2,4,0,2,4,0,0,0,0,0,0],maxLevelTurns:4},74:{board:[2,3,3,3,1,0,1,0,0,4,1,0,1,0,3,3,4,0,3,3,0,4,4,0,1,3,0,4,2,0,1,3,3,1,0,0],maxLevelTurns:5}};lvMG=function(c){this.game=c;this.mxlt=0;this.geig=GRH*GRW;this.unlv=Array(GRH*GRW*3);this.sfll=Array(GRH*GRW*3);for(c=0;c<this.unlv.length;c++)this.unlv[c]=!1,this.sfll[c]=!1;this.unlv[0]=!0;this.unlv[25]=!0;this.unlv[50]=!0};
lvMG.prototype={constructor:lvMG,ntE:function(){this.bears=Array(36);for(var c=0;36>c;c++)this.bears[c]=new Bear(game,c%GRW,parseInt(c/GRH),BEAR_EMPTY);this.arrows=Array(36);this.bombs=Array(36);this.stones=Array(36)},llvl:function(c){if(this.unlv[c]){this.lvl=levels_db[c].board;this.mxlt=levels_db[c].maxLevelTurns;c=Array(GRH*GRW);for(var f=0;f<c.length;f++){switch(this.lvl[this.lvl.length-1-f]){case 0:c[f]=
null;this.geig--;break;case 1:c[f]=this.bears[f].rwoj(BEAR_EMPTY);break;case 2:c[f]=this.bears[f].rwoj(BEAR_SMALL);break;case 3:c[f]=this.bears[f].rwoj(BEAR_MEDIUM);break;case 4:c[f]=this.bears[f].rwoj(BEAR_BIG);break;case 5:c[f]=this.arrows[this.gfra()].rwoj(f,DOWN);break;case 6:c[f]=this.arrows[this.gfra()].rwoj(f,UP);break;case 7:c[f]=this.arrows[this.gfra()].rwoj(f,RIGHT);break;case 8:c[f]=this.arrows[this.gfra()].rwoj(f,
LEFT);break;case 9:c[f]=this.bombs[this.gfrb()].rwoj(f);break;case 10:c[f]=this.stones[this.gfrs()].rwoj(f);this.geig--;break;default:debugToConsole("element not found"),c[f]=null,this.geig--}c[f]instanceof GameTile&&null!=c[f]&&(c[f].created?c[f].showSprite():c[f].create())}return c}return[]},gfra:function(){for(var c=0;36>c;c++)if(null==this.arrows[c]){this.arrows[c]=new Arrow(this.game,0,0,RIGHT);break}else if(null==this.arrows[c].sprite||
0==this.arrows[c].sprite.exists)break;return c},gfrs:function(){for(var c=0;36>c;c++)if(null==this.stones[c]){this.stones[c]=new Stone(this.game,0,0);break}else if(null==this.stones[c].sprite||0==this.stones[c].sprite.exists)break;return c},gfrb:function(){for(var c=0;36>c;c++)if(null==this.bombs[c]){this.bombs[c]=new Bomb(this.game,0,0);break}else if(null==this.bombs[c].sprite||0==this.bombs[c].sprite.exists)break;return c},reset:function(){this.mxlt=0;this.geig=
GRH*GRW},unllv:function(c){this.unlv[c]=!0},mrkLdN:function(c){this.sfll[c]=!0},llvls:function(c,f){null!=c&&null!=f&&(this.unlv=c,this.sfll=f)},gltss:function(){return{finished:this.sfll,unlocked:this.unlv}},aldn:function(){for(var c=0;c<this.sfll.length;c++)if(0==this.sfll[c])return!1;return!0}};Controls=function(c){this.game=c};Controls.prototype={constructor:Controls,isDown:function(){return game.input.mousePointer.isDown||game.input.pointer1.isDown}};GMgr=function(c){this.game=c;this.splash=null;this.upperBar=new UpperBar(c);this.bottomBar=new BottomBar(c);this.body=new Body(c);this.mnBtn=new MenuButtonManager(c);this.mmsrvr=new mmsr(c,this.mnBtn);this.dfsvr=new dfS(c,this.mnBtn);this.chlsrvr=new clhSr(c,this.mnBtn);this.gplsrvr=new gplSR(c,this.mnBtn);this.igmsrvr=new gmmnsr(c,this.mnBtn);this.alsrvr=new alsr(c,this.mnBtn);
this.wsrgr=new wrsr(c,this.mnBtn)};
GMgr.prototype={constructor:GMgr,preload:function(){},create:function(){this.ibg();this.mmsrvr.create(this.body.gpgsx(),this.body.gpgsy(),this.body.gpgdx,this.body.gpgdy,this.upperBar.sprite.height,this.bottomBar.gssy(),this.bottomBar.sprite.height);this.mmsrvr.sdSR();this.dfsvr.create(this.body.gpgsx(),this.body.gpgsy(),this.body.gpgdx,
this.body.gpgdy,this.bottomBar.gssy(),this.bottomBar.sprite.height);this.dfsvr.hdSR();this.chlsrvr.create(this.body.gpgsx(),this.body.gpgsy(),this.body.gpgdx,this.body.gpgdy,this.bottomBar.gssy(),this.bottomBar.sprite.height);this.chlsrvr.hdSR();this.gplsrvr.create(this.bottomBar.gssy(),this.bottomBar.sprite.height,this.body.yOffset,this.body.dimy);this.gplsrvr.hdSR();
this.igmsrvr.create(this.body.gpgsy(),this.body.gpgdy,this.bottomBar.gssy(),this.bottomBar.sprite.height,this.body.yOffset,this.body.dimy);this.igmsrvr.hdSR();this.alsrvr.create(this.body.gpgsy(),this.body.gpgdy,this.bottomBar.gssy(),this.bottomBar.sprite.height);this.alsrvr.hdSR();this.wsrgr.create();this.wsrgr.hdSR()},update:function(){},ibg:function(){var c=
this.game.cache.getImage("upperBar").height,f=this.game.cache.getImage("bottomBar").height;this.body.create(this.game.width,this.game.height-c-f+1,0,c);this.upperBar.create(0,0);this.bottomBar.create(0,this.game.height-f)},ssplsr:function(){this.splash=this.game.add.sprite(0,0,"splash")},gpgpgstx:function(){return 0},gpgpgsty:function(){return this.body.gpgsy()},udrstt:function(){this.upperBar.brMgz[3].text.text=gplmvr.mxlt-
gplmvr.cltt}};UpperBar=function(c){this.game=c;this.y=this.x=this.sprite=null;this.brMgz=[];this.msrig=!0};
UpperBar.prototype={constructor:UpperBar,create:function(c,f){this.x=c;this.y=f;if(null!=this.x||null!=this.y){this.sprite=this.game.add.sprite(this.x,this.y,"upperBar");this.upig=this.game.add.bitmapData(this.sprite.width,this.sprite.height);this.upig.draw("upperBarLogo",this.upig.width-this.game.cache.getImage("upperBarLogo").width>>1,this.upig.height-this.game.cache.getImage("upperBarLogo").height>>1);var b=this.game.width-this.game.cache.getImage("upperBarLogo").width>>
1;this.upig.draw("uppperBarRoof",(b>>1)-this.game.cache.getImage("uppperBarRoof").width,0);this.upig.draw("uppperBarRoof",b>>1,0);this.upig.draw("uppperBarRoof",this.game.width-(b>>1)-this.game.cache.getImage("uppperBarRoof").width,0);this.upig.draw("uppperBarRoof",this.game.width-(b>>1),0);var d="bold "+15*FSM+"px "+FONT_TYPE,b=this.sprite.height-this.game.cache.getImage("uppperBarRound").height>>1;this.brMgz[3]=this.game.add.sprite(b,
b,"uppperBarRound");this.brMgz[3].visible=!1;this.brMgz[3].text=this.game.add.text(this.brMgz[3].x+.77*this.brMgz[3].width,this.brMgz[3].y+(this.brMgz[3].height>>1),"",{font:d,fill:"#FFFFFF"});this.brMgz[3].text.anchor.set(.5);this.brMgz[3].text.visible=!1;this.brMgz[4]=this.game.add.sprite(this.brMgz[3].x+.27*this.brMgz[3].width,this.brMgz[3].y+.51*this.brMgz[3].height,"upperBarBottle",1);this.brMgz[4].anchor.set(.5);this.brMgz[4].visible=
!1;this.brMgz[4].animations.add("grow",[0,1],3);b=this.sprite.height-this.game.cache.getImage("uppperBarCookCap").height>>1;this.brMgz[5]=this.game.add.sprite(this.game.width-this.game.cache.getImage("uppperBarCookCap").height-b,b,"uppperBarCookCap");this.brMgz[5].visible=!1;this.brMgz[5].text=this.game.add.text(this.brMgz[5].x+(this.brMgz[5].width>>1),this.brMgz[5].y+(this.brMgz[5].height>>1),"",{font:d,fill:FCBR});this.brMgz[5].text.anchor.set(.5);
this.brMgz[5].text.visible=!1;b=this.game.width-(this.game.width-this.brMgz[5].x)-this.brMgz[3].width-this.brMgz[3].x-5*this.game.cache.getImage("uppperBarRoof").width>>1;this.gplrf=this.game.add.bitmapData(5*this.game.cache.getImage("uppperBarRoof").width,this.game.cache.getImage("uppperBarRoof").height);for(d=0;5>d;d++)this.gplrf.draw("uppperBarRoof",d*this.game.cache.getImage("uppperBarRoof").width,0);this.brMgz[6]=this.game.add.sprite(this.brMgz[3].x+this.brMgz[3].width+
b,0,this.gplrf);this.brMgz[6].visible=!1;this.upigsr=this.game.add.sprite(0,0,this.upig);this.upigsr.nrmY=this.upigsr.y;this.upigsr.invY=-this.upigsr.height;for(d=3;d<this.brMgz.length;d++)this.brMgz[d].nrmY=this.brMgz[d].y,this.brMgz[d].invY=-this.brMgz[d].nrmY-this.brMgz[d].height,null!=this.brMgz[d].text&&(this.brMgz[d].text.nrmY=this.brMgz[d].text.y,
this.brMgz[d].text.invY=-this.brMgz[d].text.nrmY-this.brMgz[d].text.height)}},setImages:function(c){c&&!this.msrig?(this.showImg(this.upigsr),this.hideImg(this.brMgz[3]),this.hideImg(this.brMgz[4]),this.hideImg(this.brMgz[5]),this.hideImg(this.brMgz[6]),this.msrig=c):!c&&this.msrig&&(this.hideImg(this.upigsr),this.showImg(this.brMgz[3]),this.showImg(this.brMgz[4]),this.showImg(this.brMgz[5]),
this.showImg(this.brMgz[6]),this.msrig=c)},showImg:function(c){c.visible=!0;c.y=c.invY;game.add.tween(c).to({y:c.nrmY},500,ACIO,!0,250,0,!1);null!=c.text&&(c.text.visible=!0,c.text.y=c.text.invY,game.add.tween(c.text).to({y:c.text.nrmY},500,ACIO,!0,250,0,!1))},hideImg:function(c){game.add.tween(c).to({y:c.invY},500,ACIO,!0,0,0,!1).onComplete.add(this.hideImgCompleted,this);null!=c.text&&game.add.tween(c.text).to({y:c.text.invY},
500,ACIO,!0,0,0,!1)},hideImgCompleted:function(c){c.visible=!1}};BottomBar=function(c,f,b){this.game=c;this.y=this.x=this.sprite=null};BottomBar.prototype={constructor:BottomBar,create:function(c,f){this.x=c;this.y=f;if(null!=this.x||null!=this.y)this.sprite=this.game.add.sprite(this.x,this.y,"bottomBar")},update:function(){},gssy:function(){return this.y}};Body=function(c){this.game=c;this.y=this.x=this.bcg=this.sprite=null;this.playGroundStartY=0};
Body.prototype={constructor:Body,create:function(c,f,b,d){this.dimx=c;this.dimy=f;this.xOffset=b;this.yOffset=d;b=this.game.cache.getImage("gameTileBackgroundBlue").height;var e=this.game.cache.getImage("gameTileBackgroundBlue").width,g=0,h=0,l=[];if(0<f/b-GRH)var k=f/b-GRH,g=parseInt(Math.ceil(k)/2),h=k-g;for(k=0;k<g;k++)l.push(!1);for(k=0;k<GRH;k++)l.push(!0);for(k=0;k<h;k++)l.push(!1);this.bcg=this.game.add.bitmapData(c,f);for(k=0;k<l.length;k++)if(l[k])if(1==
k%2)for(c=0;c<GRW/2;c++)this.bcg.draw("gameTileBackgroundBlue",e*c,k*b);else for(c=-1;c<GRW/2;c++)this.bcg.draw("gameTileBackgroundBlue",e*(c+.5),k*b);else if(1==k%2)for(c=0;c<GRW/2;c++)this.bcg.draw("gameTileBackgroundRed",e*c,k*b);else for(c=-1;c<GRW/2;c++)this.bcg.draw("gameTileBackgroundRed",e*(c+.5),k*b);this.sprite=this.game.add.sprite(0,d,this.bcg);this.playGroundStartY=d+g*b;this.gpgdx=GRW*b;this.gpgdy=GRH*b},update:function(){},
gpgsx:function(){return 0},gpgsy:function(){return this.playGroundStartY}};MenuButtonManager=function(c){this.game=c};
MenuButtonManager.prototype={constructor:MenuButtonManager,crtwmgt:function(c,f,b,d,e,g){b=this.game.add.button(c,f,b);b.events.onInputDown.add(g,this);b.anchor.set(.5);b.sprite=this.game.add.sprite(c,f,d,e);b.sprite.anchor.set(.5);b.visible=!1;b.sprite.visible=!1;b.nrmX=b.x;return b},crBtt:function(c,f,b,d,e){c=this.game.add.button(c,f);c.loadTexture(b,d);c.events.onInputDown.add(e,this);c.anchor.set(.5);c.visible=!1;c.nrmX=c.x;return c},crBttWithText:function(c,
f,b,d,e){b=this.game.add.button(c,f,b);b.events.onInputDown.add(e,this);b.anchor.set(.5);e=this.game.add.sprite(c,f,"pulley");e.anchor.set(.5);b.sprite=e;b.sprite.visible=!1;c=this.game.add.text(c,f,d.toString(),{font:"bold "+15*FSM+"px "+FONT_TYPE,fill:FCBR});c.anchor.set(.5);b.text=c;b.visible=!1;b.sprite.visible=!1;b.text.visible=!1;b.nrmX=b.x;return b},sdBT:function(c,f){f="undefined"!==typeof f?f:MBTF;c.pTWclb=
!1;c.visible=!0;f==MBTF?(c.alpha=0,tw=game.add.tween(c).to({alpha:1},500,ACIO,!0,0,0,!1)):f==MBTML?(c.x=-c.width,tw=game.add.tween(c).to({x:c.nrmX},500,ACIO,!0,0,0,!1)):f==MBTMR&&(c.x=rX+c.width,tw=game.add.tween(c).to({x:c.nrmX},500,ACIO,!0,0,0,!1));null!=c.sprite&&(c.sprite.visible=!0,c.sprite.alpha=0,game.add.tween(c.sprite).to({alpha:1},500,ACIO,
!0,0,0,!1));null!=c.text&&(c.text.visible=!0,c.text.alpha=0,game.add.tween(c.text).to({alpha:1},500,ACIO,!0,0,0,!1));tw.onComplete.add(this.sdBTComplete,this)},sdBTComplete:function(c){c.inputEnabled=!0},hdBT:function(c,f){f="undefined"!==typeof f?f:MBTF;c.inputEnabled=!1;c.pTWclb=!0;var b=null;f==MBTF?b=game.add.tween(c).to({alpha:0},200,ACIO,!0,0,0,!1):f==MBTML?
b=game.add.tween(c).to({x:0-c.x},500,ACIO,!0,0,0,!1):f==MBTMR&&(b=game.add.tween(c).to({x:rX+c.width},500,ACIO,!0,0,0,!1));b.onComplete.add(this.hdCmpl,this);null!=c.sprite&&game.add.tween(c.sprite).to({alpha:0},200,ACIO,!0,0,0,!1);null!=c.text&&game.add.tween(c.text).to({alpha:0},200,ACIO,!0,0,0,!1)},hdCmpl:function(c){if(null==c.pTWclb||null!=c.pTWclb&&
1==c.pTWclb)c.visible=!1,null!=c.sprite&&(c.sprite.visible=!1),null!=c.text&&(c.text.visible=!1)},swllcbn:function(c){c.inputEnabled=!0;c.pTWclb=!1;c.visible=!0;c.alpha=0;game.add.tween(c).to({alpha:1},200,ACIO,!0,350,0,!1);-1==c.text.text?(c.sprite.visible=!0,c.inputEnabled=!1,c.sprite.alpha=0,game.add.tween(c.sprite).to({alpha:1},200,ACIO,!0,350,0,!1)):(c.text.visible=!0,c.inputEnabled=!0,c.text.alpha=0,game.add.tween(c.text).to({alpha:1},
200,ACIO,!0,350,0,!1))},brbbtt:function(c){c.bringToTop();null!=c.sprite&&c.sprite.bringToTop();null!=c.text&&c.text.bringToTop()}};mmsr=function(c,f){this.game=c;this.mmbn=[];this.mnBtn=f;this.hipp=this.crpp=this.bbtn=null;this.brMgz=[]};
mmsr.prototype={constructor:mmsr,create:function(c,f,b,d,e,g,h){e=this.game.cache.getImage("mnBT").height;var l=this.game.cache.getImage("mnBT").width,k=this;this.mmbn[0]=this.mnBtn.crtwmgt(c+b/2,f+d/2-(e>>1)-5,"mnBT","mnBTi",5,function(){k.mmpbpr()});this.mmbn[1]=this.mnBtn.crtwmgt(c+b/2+l+10,f+d/2,"mnBT","mnBTi",9,function(){k.mmcrbpr()});this.mmbn[2]=this.mnBtn.crtwmgt(c+
b/2-l-10,f+d/2,"mnBT","mnBTi",8,function(){k.mmhbpr()});l=7;smvr.spl&&(l=6);roWP||(this.mmbn[3]=this.mnBtn.crtwmgt(c+b/2,f+d/2+(e>>1)+5,"mnBT","mnBTi",l,function(b){k.mmsbpr(b)}));this.bbtn=this.mnBtn.crBtt(this.game.world.width-this.game.cache.getImage("mnBTsm").width/8/2-4,g+h/2,"mnBTsm",2,function(){k.bbtCl()});this.bbtn.visible=!1;c="bold "+11*FSM+
"px "+FONT_TYPE;this.crpp=crTC(this.game,0,0,TLDM*(GRW-1),1.5*TLDM);this.crpp.alpha=0;this.crpp.x=this.game.world.centerX-(this.crpp.width>>1);this.crpp.y=this.game.world.centerY-(this.crpp.height>>1);this.crpp.visible=!1;f=this.crpp.addChild(this.game.make.text(0,0,txc[language],{font:c,fill:FCBR,wordWrap:!0,wordWrapWidth:.8*this.crpp.width,align:"center"}));f.x=this.crpp.width-
f.width>>1;f.y=this.crpp.height-f.height>>1;c="bold "+9*FSM+"px "+FONT_TYPE;this.hipp=crTC(this.game,0,0,TLDM*(GRW-1),TLDM*(GRH-.5));this.hipp.alpha=0;this.hipp.x=this.game.world.centerX-(this.hipp.width>>1);this.hipp.y=this.game.world.centerY-(this.hipp.height>>1);this.hipp.visible=!1;f=this.hipp.addChild(this.game.make.text(0,0,hhtx[language],{font:c,fill:FCBR,wordWrap:!0,
wordWrapWidth:.8*this.hipp.width,align:"left"}));f.x=this.hipp.width-f.width>>1;f.y=.08*this.hipp.height;text2=this.hipp.addChild(this.game.make.text(0,0,tcxr[language],{font:c,fill:FCBR,wordWrap:!0,wordWrapWidth:.8*this.hipp.width,align:"left"}));text2.x=f.x;text2.y=1.3*f.height;this.brMgz[0]=this.game.add.sprite(0,this.game.height-this.game.cache.getImage("bbiL").height,"bbiL");this.brMgz[0].invX=0-this.brMgz[0].width;
this.brMgz[0].nrmX=this.brMgz[0].x;this.brMgz[0].x=this.brMgz[0].invX;this.brMgz[1]=this.game.add.sprite(this.game.width-this.game.cache.getImage("bbiR").width,this.game.height-this.game.cache.getImage("bbiR").height,"bbiR");this.brMgz[1].invX=rX+this.brMgz[1].width;this.brMgz[1].nrmX=this.brMgz[1].x;this.brMgz[1].x=this.brMgz[1].invX},mmpbpr:function(){debugToConsole("main menu play");
this.hdSR();gst=sslq},mmhbpr:function(){debugToConsole("main menu hint");for(var c=0;c<this.mmbn.length;c++)this.mnBtn.hdBT(this.mmbn[c]);this.hbig();this.mnBtn.sdBT(this.bbtn,MBTMR);this.hipp.pTWclb=!1;this.hipp.visible=!0;game.add.tween(this.hipp).to({alpha:1},500,ACIO,!0,0,0,!1)},mmcrbpr:function(){debugToConsole("main menu creator");
for(var c=0;c<this.mmbn.length;c++)this.mnBtn.hdBT(this.mmbn[c]);this.hbig();this.mnBtn.sdBT(this.bbtn,MBTMR);this.crpp.pTWclb=!1;this.crpp.visible=!0;game.add.tween(this.crpp).to({alpha:1},500,ACIO,!0,0,0,!1)},mmsbpr:function(c){smvr.tgmz(sspr);this.udmbi(c);debugToConsole("main menu sound, enabled: ",smvr.spl)},
udmbi:function(c){smvr.spl?c.sprite.loadTexture("mnBTi",6):c.sprite.loadTexture("mnBTi",7)},bbtCl:function(){for(var c=0;c<this.mmbn.length;c++)this.mnBtn.sdBT(this.mmbn[c]);this.mnBtn.hdBT(this.bbtn,MBTMR);this.hddLz();this.swbi()},hddLz:function(){this.crpp.pTWclb=!0;this.hipp.pTWclb=!0;var c=game.add.tween(this.crpp).to({alpha:0},
500,ACIO,!0,0,0,!1);c.onComplete.add(this.hddLzDn,this);c=game.add.tween(this.hipp).to({alpha:0},500,ACIO,!0,0,0,!1);c.onComplete.add(this.hddLzDn,this)},hddLzDn:function(c){if(null==c.pTWclb||null!=c.pTWclb&&1==c.pTWclb)c.visible=!1},sdSR:function(){roWP||this.udmbi(this.mmbn[3]);for(var c=0;c<this.mmbn.length;c++)this.mnBtn.sdBT(this.mmbn[c]);
this.swbi()},swbi:function(){for(var c=0;c<this.brMgz.length;c++)this.brMgz[c].visible=!0,this.brMgz[c].pTWclb=!1,game.add.tween(this.brMgz[c]).to({x:this.brMgz[c].nrmX},500,ACIO,!0,0,0,!1)},hdSR:function(){for(var c=0;c<this.mmbn.length;c++)this.mnBtn.hdBT(this.mmbn[c]);this.hbig()},hbig:function(){for(var c=0;c<this.brMgz.length;c++)this.brMgz[c].pTWclb=
!0,game.add.tween(this.brMgz[c]).to({x:this.brMgz[c].invX},500,ACIO,!0,0,0,!1).onComplete.add(this.hdBiDN,this)},hdBiDN:function(c){if(null==c.pTWclb||null!=c.pTWclb&&1==c.pTWclb)c.visible=!1}};dfS=function(c,f){this.game=c;this.mnBtn=f;this.bbtn=null;this.dfGr=[];this.dfGrA=[];this.grMT=[];this.dstI={};this.acD=0;this.eeg=null;this.eegp=[]};
dfS.prototype={constructor:dfS,create:function(c,f,b,d,e,g){var h=this;this.bbtn=this.mnBtn.crBtt(this.game.world.width-this.game.cache.getImage("mnBTsm").width/8/2-4,e+g/2,"mnBTsm",2,function(){h.bbtCl()});this.eeg=this.game.add.group();this.dfGr[0]=this.crDFgr("EASY",0);this.eeg.add(this.dfGr[0]);c=1.4*this.dfGr[0].width;this.eegp[0]=0;this.eegp[1]=
-c;this.eegp[2]=2*-c;this.dfGr[1]=this.crDFgr("MEDIUM",c);this.eeg.add(this.dfGr[1]);this.dfGr[2]=this.crDFgr("HARD",2*c);this.eeg.add(this.dfGr[2]);this.dfGrA[0]=this.crAfg(0,0);this.eeg.add(this.dfGrA[0]);this.dfGrA[1]=this.crAfg(1,c);this.eeg.add(this.dfGrA[1]);
this.dfGrA[2]=this.crAfg(2,2*c);this.eeg.add(this.dfGrA[2]);this.grMT[0]=this.game.add.tween(this.eeg).to({x:this.eegp[0]},700,AQO);this.grMT[1]=this.game.add.tween(this.eeg).to({x:this.eegp[1]},700,AQO);this.grMT[2]=this.game.add.tween(this.eeg).to({x:this.eegp[2]},700,AQO)},
onClickDown:function(){this.lclX=this.onDclX=this.game.input.worldX;var c=this;this.game.input.touch.touchMoveCallback=function(){c.onMove()};this.game.input.mouse.mouseMoveCallback=function(){c.onMove()}},onMove:function(){this.eeg.x+=this.game.input.worldX-this.lclX;this.lclX=this.game.input.worldX},onClickUp:function(){this.game.input.mouse.mouseMoveCallback=null;this.game.input.touch.touchMoveCallback=null;xDif=this.game.input.worldX-this.onDclX;20>Math.abs(xDif)?
this.cfrbnClicked():0>xDif?this.nDbttClk():this.pDbttClk()},crDFgr:function(c,f){var b=this.game.make.group(),d=crTC(game,0,0,.7*TLDM*GRW,.85*TLDM*GRH);d.inputEnabled=!0;d.events.onInputDown.add(this.onClickDown,this);d.events.onInputUp.add(this.onClickUp,this);b.add(d);var e=3;"EASY"==c?e=0:"MEDIUM"==c?e=1:"HARD"==c&&(e=2);e=this.game.add.sprite(d.width>>1,.35*d.height,"lvlFlags",e);e.anchor.set(.5);
b.add(e);var e="bold "+15*FSM+"px "+FONT_TYPE,g=this.game.add.text(d.width>>1,.68*d.height,c,{font:e,fill:FCBR});g.anchor.set(.5);b.add(g);g=this.game.add.sprite(d.width>>1,.85*d.height,"ribbon");g.anchor.set(.5);b.add(g);d=this.game.add.text(d.width>>1,.825*d.height,"0/25",{font:e,fill:FCBR});d.anchor.set(.5);b.add(d);this.dstI[c]=b.getIndex(d);b.nrmY=(rY>>1)-(b.height>>1);b.invY=-b.height;b.x=(rX-b.width>>
1)+f;b.y=b.invY;return b},crAfg:function(c,f){var b=this,d=this.mnBtn.crBtt(0,.825*this.dfGr[c].height,"mnBTArrow",0,function(){b.pDbttClk()});d.visible=!0;d.invX=2*-d.width;d.scale.x*=-1;var e=this.mnBtn.crBtt(this.dfGr[c].width,.825*this.dfGr[c].height,"mnBTArrow",0,function(){b.nDbttClk()});e.visible=!0;e.invX=rX+e.width;var g=this.game.make.group();g.x=(rX-
this.dfGr[c].width>>1)+f;g.y=this.dfGr[c].nrmY;g.add(d);g.add(e);g.visible=!1;return g},bbtCl:function(){gst=sskw;debugToConsole("dfS - back button clicked")},cfrbnClicked:function(){gst=ssma;debugToConsole("confirm button clicked")},nDbttClk:function(){this.sNWd(!0)},pDbttClk:function(){this.sNWd(!1)},sNWd:function(c){c?
2==this.acD?this.acD=0:this.acD++:0==c&&(0==this.acD?this.acD=2:this.acD--);this.grMT[this.acD].start()},sdSR:function(){this.pTWclb=!1;this.bbtn.pTWclb=!1;this.mnBtn.sdBT(this.bbtn,MBTMR);for(var c=0;c<this.dfGr.length;c++)this.dfGr[c].visible=!0,this.dfGr[c].y=
this.dfGr[c].invY,game.add.tween(this.dfGr[c]).to({y:this.dfGr[c].nrmY},1200,AEO,!0,0,0,!1),this.dfGr[c].getAt(0).inputEnabled=!0;this.uulCn();for(c=0;c<this.dfGrA.length;c++)this.dfGrA[c].visible=!0,c==this.acD?(this.dfGrA[c].getAt(0).x=this.dfGrA[c].getAt(0).invX,game.add.tween(this.dfGrA[c].getAt(0)).to({x:this.dfGrA[c].getAt(0).nrmX},
500,ACO,!0,0,0,!1),this.dfGrA[c].getAt(1).x=this.dfGrA[c].getAt(1).invX,game.add.tween(this.dfGrA[c].getAt(1)).to({x:this.dfGrA[c].getAt(1).nrmX},500,ACO,!0,0,0,!1)):(this.dfGrA[c].getAt(0).x=this.dfGrA[c].getAt(0).nrmX,this.dfGrA[c].getAt(1).x=this.dfGrA[c].getAt(1).nrmX)},uulCn:function(){for(var c=
0,f=0;25>f;f++)gplmvr.lvmgvr.sfll[f]&&c++;this.dfGr[0].getAt(this.dstI.EASY).text=c.toString()+"/25";c=0;for(f=25;50>f;f++)gplmvr.lvmgvr.sfll[f]&&c++;this.dfGr[1].getAt(this.dstI.MEDIUM).text=c.toString()+"/25";c=0;for(f=50;75>f;f++)gplmvr.lvmgvr.sfll[f]&&c++;this.dfGr[2].getAt(this.dstI.HARD).text=
c.toString()+"/25"},hdSR:function(){this.game.input.mouse.mouseMoveCallback=null;this.game.input.touch.touchMoveCallback=null;this.grMT[this.acD].start();this.bbtn.pTWclb=!0;this.mnBtn.hdBT(this.bbtn,MBTMR);game.add.tween(this.dfGr[0]).to({y:this.dfGr[0].invY},500,ACIO,!0,0,0,!1);game.add.tween(this.dfGr[1]).to({y:this.dfGr[1].invY},
500,ACIO,!0,0,0,!1);var c=game.add.tween(this.dfGr[2]).to({y:this.dfGr[2].invY},500,ACIO,!0,0,0,!1);this.dfGr[0].getAt(0).inputEnabled=!1;this.dfGr[1].getAt(0).inputEnabled=!1;this.dfGr[2].getAt(0).inputEnabled=!1;c.onComplete.add(this.hdCmpl,this);this.pTWclb=!0;for(c=0;c<this.dfGrA.length;c++)c==this.acD&&(game.add.tween(this.dfGrA[c].getAt(0)).to({x:this.dfGrA[c].getAt(0).invX},
500,ACI,!0,0,0,!1),game.add.tween(this.dfGrA[c].getAt(1)).to({x:this.dfGrA[c].getAt(1).invX},500,ACI,!0,0,0,!1))},hdCmpl:function(){1==this.pTWclb&&(this.bbtn.visible=!1,this.dfGr[0].visible=!1,this.dfGr[1].visible=!1,this.dfGr[2].visible=!1,this.dfGrA[0].visible=!1,this.dfGrA[1].visible=!1,this.dfGrA[2].visible=
!1,this.eeg.x=this.eegp[this.acD])}};clhSr=function(c,f){this.game=c;this.mnBtn=f;this.bbtn=null;this.lvC=[]};
clhSr.prototype={constructor:clhSr,create:function(c,f,b,d,e,g){var h=this;this.bbtn=this.mnBtn.crBtt(this.game.world.width-this.game.cache.getImage("mnBTsm").width/8/2-4,e+g/2,"mnBTsm",2,function(){h.bbtCl()});this.crllCs(f)},crllCs:function(c){var f=this,b=this.game.cache.getImage("lvlCard").width,d=this.game.cache.getImage("lvlCard").height,e=.12*b,g=(rX-5*b-4*e)/2+b/2,h=.07*d;c=c+d/2+2;for(var l=0;5>l;l++)for(var k=
0;5>k;k++)this.lvC[5*l+k]=this.mnBtn.crBttWithText(k*(b+e)+g,l*(d+h)+c,"lvlCard",5*l+k+1,function(b){f.crcksr(b)})},crcksr:function(c){debugToConsole("clicked on card",c.text.text);gst=ssghg;gplmvr.hdltpcm=c.text.text-1},bbtCl:function(){gst=sslq;debugToConsole("clhSr - back button clicked")},sdSR:function(){this.mnBtn.sdBT(this.bbtn,MBTMR);this.udpCD();
for(var c=0;c<this.lvC.length;c++)this.mnBtn.swllcbn(this.lvC[c])},udpCD:function(){for(var c=0;c<this.lvC.length;c++)this.lvC[c].text.text=gplmvr.lvmgvr.unlv[c+this.lvC.length*gmvr.dfsvr.acD]?(c+this.lvC.length*gmvr.dfsvr.acD+1).toString():-1},hdSR:function(){this.mnBtn.hdBT(this.bbtn,MBTMR);for(var c=0;c<this.lvC.length;c++)this.mnBtn.hdBT(this.lvC[c])}};gplSR=function(c,f){this.game=c;this.mnBtn=f;this.pzbn=null;this.brMgz=[]};
gplSR.prototype={constructor:gplSR,create:function(c,f){var b=this;this.pzbn=this.mnBtn.crBtt(this.game.world.width-this.game.cache.getImage("mnBTsm").width/8/2-4,c+f/2,"mnBTsm",1,function(){b.pzbncK()});this.brMgz[0]=this.game.add.sprite(0,this.game.height-this.game.cache.getImage("bbiL").height,"bbiL");this.brMgz[0].nrmX=this.brMgz[0].x;this.brMgz[0].invX=0-this.brMgz[0].width;this.brMgz[0].x=
this.brMgz[0].invX},pzbncK:function(){debugToConsole("pause button clicked");gst=sseg},sdSR:function(){this.mnBtn.sdBT(this.pzbn,MBTMR);this.brMgz[0].pTWclb=!1;this.brMgz[0].visible=!0;game.add.tween(this.brMgz[0]).to({x:this.brMgz[0].nrmX},500,ACIO,!0,0,0,!1)},hdSR:function(){this.mnBtn.hdBT(this.pzbn,MBTMR);this.brMgz[0].pTWclb=
!0;game.add.tween(this.brMgz[0]).to({x:this.brMgz[0].invX},500,ACIO,!0,0,0,!1).onComplete.add(this.hdBiDN,this)},hdBiDN:function(c){if(null==c.pTWclb||null!=c.pTWclb&&1==c.pTWclb)c.visible=!1}};gmmnsr=function(c,f){this.game=c;this.mnBtn=f;this.bnlt=[];this.dialogs=[];this.fdbgst=null};
gmmnsr.prototype={constructor:gmmnsr,create:function(c,f,b,d,e,g){this.crmmBz(c,f);this.crdlz(c,f,b,d);this.hddLz();this.crbgSt(e,g)},crmmBz:function(c,f){var b=this.game.cache.getImage("mnBT").height,d=(f-4*b)/7,e=this;if(roWP)g=c+(f>>1)-d-b,h=c+(f>>1),l=c+(f>>1)+d+b;else var g=c+2*d+.5*b,h=c+3*d+1.5*b,l=c+5*d+3.5*b;this.bnlt[0]=this.mnBtn.crtwmgt(this.game.world.centerX,g,"mnBT","mnBTi",5,function(){e.igplprst()});
this.bnlt[1]=this.mnBtn.crtwmgt(this.game.world.centerX,h,"mnBT","mnBTi",0,function(){e.igrsprst()});this.bnlt[2]=this.mnBtn.crtwmgt(this.game.world.centerX,l,"mnBT","mnBTi",1,function(){e.igqtprst()});g=7;smvr.spl&&(g=6);roWP||(this.bnlt[3]=this.mnBtn.crtwmgt(this.game.world.centerX,c+4*d+2.5*b,"mnBT","mnBTi",g,function(b){e.igsdprst(b)}))},
crdlz:function(c,f,b,d){var e=this;this.dialogs[3]=crTC(this.game,0,0,.8*TLDM*GRW,1.25*TLDM);this.dialogs[3].x=this.game.world.centerX-(this.dialogs[3].width>>1);this.dialogs[3].y=this.game.world.centerY-(this.dialogs[3].height>>1);this.dialogs[3].alpha=0;c=this.dialogs[3].addChild(this.game.make.text(0,0,IGCFTX[language],{font:"bold "+10*FSM+"px "+FONT_TYPE,fill:FCBR,wordWrap:!0,wordWrapWidth:.8*this.dialogs[3].width,
align:"center"}));c.x=this.dialogs[3].width-c.width>>1;c.y=this.dialogs[3].height-c.height>>1;this.dialogs[0]=this.mnBtn.crBtt(this.dialogs[3].x+this.dialogs[3].width-this.game.cache.getImage("mnBTsm").width/8/2,this.dialogs[3].y+this.dialogs[3].height,"mnBTsm",4,function(){e.quitDialogButtonClicked()});this.dialogs[1]=this.mnBtn.crBtt(this.dialogs[3].x+this.game.cache.getImage("mnBTsm").width/8/2,this.dialogs[3].y+this.dialogs[3].height,"mnBTsm",3,function(){e.cfrsbnck()});
this.dialogs[2]=this.mnBtn.crBtt(this.dialogs[3].x+this.game.cache.getImage("mnBTsm").width/8/2,this.dialogs[3].y+this.dialogs[3].height,"mnBTsm",3,function(){e.cfrqtnck()})},crbgSt:function(c,f){var b=this.game.add.bitmapData(this.game.width,f);b.fill(0,0,0,.5);this.fdbgst=this.game.add.sprite(0,c,b);this.fdbgst.inputEnabled=!0;this.fdbgst.events.onInputDown.add(this.igplprst,this);b.alpha=0},quitDialogButtonClicked:function(){debugToConsole("quit dialog button clicked");
this.hddLz();this.sdBTs()},cfrsbnck:function(){debugToConsole("confirm reset dialog button clicked");gst=ssghg},cfrqtnck:function(){debugToConsole("confirm quit dialog button clicked");gst=sskw},igplprst:function(){debugToConsole("play button clicked");gst=ssbj},igsdprst:function(c){debugToConsole(c);smvr.tgmz(ssqu);this.udmbi(c);
debugToConsole("main menu sound, enabled: ",smvr.spl)},udmbi:function(c){smvr.spl?c.sprite.loadTexture("mnBTi",6):c.sprite.loadTexture("mnBTi",7)},igrsprst:function(){debugToConsole("reset button clicked");this.hdBTs();this.swrd()},igqtprst:function(){debugToConsole("quit button clicked");this.hdBTs();this.swqd()},sdSR:function(){this.swbg();this.sdBTs()},
sdBTs:function(){roWP||this.udmbi(this.bnlt[3]);for(var c=0;c<this.bnlt.length;c++)this.mnBtn.sdBT(this.bnlt[c]),this.bnlt[c].bringToTop(),this.bnlt[c].sprite.bringToTop()},swrd:function(){this.dialogs[0].visible=!0;this.dialogs[1].visible=!0;this.dialogs[3].visible=!0;this.game.world.bringToTop(this.dialogs[3]);this.game.world.bringToTop(this.dialogs[0]);this.game.world.bringToTop(this.dialogs[1]);for(var c=0;c<this.dialogs.length;c++)game.add.tween(this.dialogs[c]).to({alpha:1},
500,ACIO,!0,0,0,!1)},swqd:function(){this.dialogs[0].visible=!0;this.dialogs[2].visible=!0;this.dialogs[3].visible=!0;this.game.world.bringToTop(this.dialogs[3]);this.game.world.bringToTop(this.dialogs[0]);this.game.world.bringToTop(this.dialogs[2]);for(var c=0;c<this.dialogs.length;c++)game.add.tween(this.dialogs[c]).to({alpha:1},500,ACIO,!0,0,0,!1)},swbg:function(){this.game.world.bringToTop(this.fdbgst);this.fdbgst.pTWclb=
!1;this.fdbgst.visible=!0;this.fdbgst.alpha=0;game.add.tween(this.fdbgst).to({alpha:1},500,ACIO,!0,0,0,!1)},hdSR:function(){this.hdBTs();this.hddLz();this.hideBcg()},hdBTs:function(){for(var c=0;c<this.bnlt.length;c++)this.mnBtn.hdBT(this.bnlt[c])},hddLz:function(){for(var c=0;c<this.dialogs.length;c++)game.add.tween(this.dialogs[c]).to({alpha:0},500,ACIO,!0,0,0,!1).onComplete.add(this.hddLzDn,
this)},hddLzDn:function(c){c.visible=!1},hideBcg:function(){this.fdbgst.pTWclb=!0;this.fdbgst.inputEnabled=!1;game.add.tween(this.fdbgst).to({alpha:0},500,ACIO,!0,0,0,!1).onComplete.add(this.ddbg,this)},ddbg:function(){if(null==this.fdbgst.pTWclb||null!=this.fdbgst.pTWclb&&1==this.fdbgst.pTWclb)this.fdbgst.visible=!1}};alsr=function(c,f){this.game=c;this.mnBtn=f;this.dialog=[]};
alsr.prototype={constructor:alsr,create:function(c,f,b,d){var e=this;this.dialog[2]=crTC(this.game,0,0,.8*TLDM*GRW,.6*TLDM*GRH,function(){e.cfrbnClicked()});this.dialog[2].x=this.game.world.centerX-(this.dialog[2].width>>1);this.dialog[2].y=this.game.world.centerY-(this.dialog[2].height>>1);c=this.dialog[2].addChild(this.game.add.sprite(0,0,"lvlCompletedLogo"));c.x=this.dialog[2].width-c.width>>1;c.y=this.dialog[2].height-
c.height>>1;c=this.dialog[2].addChild(this.game.add.sprite(0,0,LVsI[language]));c.x=this.dialog[2].width-c.width>>1;c.y=1.67*(this.dialog[2].height-c.height>>1);this.dialog[3]=crTC(this.game,0,0,.8*TLDM*GRW,.6*TLDM*GRH,function(){e.cfrbnClicked()});this.dialog[3].x=this.game.world.centerX-(this.dialog[3].width>>1);this.dialog[3].y=this.game.world.centerY-(this.dialog[3].height>>1);c=this.dialog[3].addChild(this.game.add.sprite(0,0,
"lvlFailedLogo"));c.x=this.dialog[3].width-c.width>>1;c.y=this.dialog[3].height-c.height>>1;c=this.dialog[3].addChild(this.game.add.sprite(0,0,lfi[language]));c.x=this.dialog[3].width-c.width>>1;c.y=.2*(this.dialog[3].height-c.height>>1);c=this.dialog[3].addChild(this.game.make.text(0,0,lft5[language],{font:"bold "+10*FSM+"px "+FONT_TYPE,fill:FCBR,wordWrap:!0,wordWrapWidth:.7*this.dialog[3].width,align:"center"}));c.x=this.dialog[3].width-c.width>>
1;c.y=1.75*(this.dialog[3].height-c.height>>1);this.dialog[0]=this.mnBtn.crBtt(this.dialog[2].x+this.dialog[2].width-this.game.cache.getImage("mnBTsm").width/8/2,this.dialog[2].y+this.dialog[2].height-this.game.cache.getImage("mnBTsm").height/2,"mnBTsm",4,function(){e.cncbck()});this.dialog[1]=this.mnBtn.crBtt(this.dialog[2].x+this.game.cache.getImage("mnBTsm").width/8/2,this.dialog[2].y+this.dialog[2].height-this.game.cache.getImage("mnBTsm").height/
2,"mnBTsm",3,function(){e.cfrbnClicked()})},cfrbnClicked:function(){debugToConsole("confirm button clicked");gst=ssih},cncbck:function(){debugToConsole("cancel button clicked");gst=ssma},sdSR:function(){gst==ssdr?(this.dialog[3].visible=!0,this.dialog[3].alpha=0,tw=game.add.tween(this.dialog[3]).to({alpha:1},500,ACIO,!0,0,0,!1),tw.onComplete.add(this.sdSRComplete,this),this.game.world.bringToTop(this.dialog[3]),
this.mnBtn.sdBT(this.dialog[0]),this.mnBtn.brbbtt(this.dialog[0])):(this.dialog[2].visible=!0,this.dialog[2].alpha=0,tw=game.add.tween(this.dialog[2]).to({alpha:1},500,ACIO,!0,0,0,!1),tw.onComplete.add(this.sdSRComplete,this),this.game.world.bringToTop(this.dialog[2]));this.mnBtn.sdBT(this.dialog[1]);this.mnBtn.brbbtt(this.dialog[1])},sdSRComplete:function(c){c.inputEnabled=!0},hdSR:function(){this.mnBtn.hdBT(this.dialog[0]);this.mnBtn.hdBT(this.dialog[1]);
this.dialog[2].visible=!1;this.dialog[2].inputEnabled=!1;this.dialog[3].visible=!1;this.dialog[3].inputEnabled=!1},hdcm:function(){}};wrsr=function(c,f){this.game=c;this.mnBtn=f;this.dialog=this.cfrbn=null};
wrsr.prototype={constructor:wrsr,create:function(){var c=this,f="bold "+11*FSM+"px "+FONT_TYPE;this.dialog=crTC(this.game,0,0,TLDM*(GRW-1),2.5*TLDM,function(){c.cfrbnClicked()});this.dialog.x=this.game.world.centerX-(this.dialog.width>>1);this.dialog.y=this.game.world.centerY-(this.dialog.height>>1);this.dialog.visible=!1;f=this.dialog.addChild(this.game.make.text(0,0,wtx[language],{font:f,fill:FCBR,wordWrap:!0,
wordWrapWidth:.8*this.dialog.width,align:"center"}));f.x=this.dialog.width-f.width>>1;f.y=this.dialog.height-f.height>>1;this.cfrbn=this.mnBtn.crBtt(this.dialog.x+this.dialog.width-this.game.cache.getImage("mnBTsm").width/8/2,this.dialog.y+this.dialog.height,"mnBTsm",3,function(){c.cfrbnClicked()})},cfrbnClicked:function(){gst=sskw},sdSR:function(){this.mnBtn.sdBT(this.cfrbn);this.dialog.visible=!0},hdSR:function(){this.mnBtn.hdBT(this.cfrbn);
this.dialog.visible=!1}};function crTC(c,f,b,d,e,g){var h=c.cache.getImage("keksNaSkladanie").width/3;d=Math.ceil(d/h)-2;var l=c.cache.getImage("keksNaSkladanie").height/3;e=Math.ceil(e/l)-2;var k=c.make.image(0,0,"keksNaSkladanie",0),m=c.make.image(0,0,"keksNaSkladanie",1),n=c.make.image(0,0,"keksNaSkladanie",2),p=c.make.image(0,0,"keksNaSkladanie",3),q=c.make.image(0,0,"keksNaSkladanie",4),r=c.make.image(0,0,"keksNaSkladanie",5),t=c.make.image(0,0,"keksNaSkladanie",6),w=c.make.image(0,0,"keksNaSkladanie",7);c=
c.make.image(0,0,"keksNaSkladanie",8);tile=this.game.add.bitmapData(h*(d+2),l*(e+2));tile.draw(k,0,0);for(k=0;k<d;k++)tile.draw(m,h*(k+1),0);tile.draw(n,h*(d+1),0);for(k=0;k<e;k++)tile.draw(p,0,l*(k+1));for(k=0;k<e;k++)tile.draw(r,h*(d+1),l*(k+1));tile.draw(t,0,l*(e+1));for(k=0;k<d;k++)tile.draw(w,h*(k+1),l*(e+1));tile.draw(c,h*(d+1),l*(e+1));for(k=0;k<d;k++)for(c=0;c<e;c++)tile.draw(q,h*(k+1),l*(c+1));f=this.game.add.sprite(f,b,tile);null!=g&&(f.inputEnabled=!0,f.events.onInputDown.add(g,this));
return f};SndG=function(c){this.game=c;this.spl=!roWP;this.sounds=[];this.seb=this.acm=null;this.seo=[]};
SndG.prototype={constructor:SndG,create:function(){this.sounds[sspr]=game.add.audio("menuMusic",1,!0);this.sounds[ssqu]=game.add.audio("gameMusic",1,!0);this.sounds[ssrq]=game.add.audio("successSound",1,!1);this.sounds[ssx9]=game.add.audio("failSound",1,!1);this.seb=game.add.audio("explodeSoundBomb",1,!1);this.seo[0]=game.add.audio("explodeSound1",1,!1);this.seo[1]=game.add.audio("explodeSound2",1,!1);this.seo[2]=
game.add.audio("explodeSound3",1,!1);this.spl&&this.mzo()},mzo:function(){this.spl=!0},mzf:function(){this.spl=!1;this.acm=null},pmz:function(c,f){if((c!=this.acm||f)&&this.spl){this.acm=c;for(var b=0;b<this.sounds.length;b++)b==this.acm?this.sounds[b].play():this.sounds[b].stop()}},pls:function(c){if(this.spl)switch(c){case sseb:this.seb.play();break;case sseo:this.seo[Math.floor(3*
Math.random())].play()}},stmz:function(){for(var c=0;c<this.sounds.length;c++)this.sounds[c].stop()},tgmz:function(c){this.spl?(this.mzf(),this.stmz()):(this.mzo(),this.pmz(c));gplmvr.saveSoundSettings()},ldsst:function(c){null==c||roWP||(this.spl=c)},ggsts:function(){return this.spl}};GPLM=function(c){this.game=c;this.grid=this.lvmgvr=this.blmgvr=null;this.hdltpcm=this.geig=this.cltt=this.mxlt=0;this.psll=-1;this.crll=0;this.alvfd=!1};
GPLM.prototype={constructor:GPLM,preload:function(){this.blmgvr=new blmg(game);this.lvmgvr=new lvMG(game);this.lgpgr();this.ldsst()},create:function(){this.game.physics.startSystem(Phaser.Physics.ARCADE);this.lvmgvr.ntE()},startNewGame:function(c){this.rstF();this.grid=this.lvmgvr.llvl(c);0<this.grid.length?(this.mxlt=this.lvmgvr.mxlt,this.geig=
this.lvmgvr.geig,gst=ssbj,this.crll=c,gmvr.upperBar.brMgz[5].text.text=this.crll+1):(debugToConsole("level "+c.toString()+" nie je unlocknuty"),gst=ssfw)},rstF:function(){if(null!=this.grid)for(i=0;i<this.grid.length;i++)null!=this.grid[i]&&this.grid[i].dstrE(),this.grid[i]=null;this.blmgvr.reset();this.lvmgvr.reset();this.cltt=0;this.psll=-1},update:function(){if(gst==
ssbj)for(a=0;a<BULLET_ITERATIONS_PER_UPDATE;a++)for(this.blmgvr.update(),i=0;i<this.blmgvr.btat.length;i++)if(this.blmgvr.btat[i].sprite.exists){var c=0;if(2>this.blmgvr.btat[i].direction)for(j=0;j<GRH;j++)c=this.blmgvr.btat[i].yGrid*GRW+j,null!=this.grid[c]&&(this.grid[c].sprite.exists?this.game.physics.arcade.overlap(this.blmgvr.btat[i].sprite,this.grid[c].sprite,this.hit,null,this.blmgvr.btat[i]):
(this.grid[c]=null,this.geig--));else for(j=0;j<GRW;j++)c=j*GRW+this.blmgvr.btat[i].xGrid,null!=this.grid[c]&&(this.grid[c].sprite.exists?this.game.physics.arcade.overlap(this.blmgvr.btat[i].sprite,this.grid[c].sprite,this.hit,null,this.blmgvr.btat[i]):(this.grid[c]=null,this.geig--))}else this.blmgvr.btat.splice(i,1);if(gst==sscf)for(a=0;a<BULLET_ITERATIONS_PER_UPDATE;a++)this.blmgvr.update();
if(gst==ssbj||gst==ssdr)for(i=0;i<this.grid.length;i++)null!=this.grid[i]&&this.grid[i].update();gst==ssbj&&0==this.geig&&(gst=sscf,this.lvmgvr.mrkLdN(this.crll),74!=this.crll&&this.lvmgvr.unllv(this.crll+1),this.psll=this.hdltpcm,this.hdltpcm++,this.saveGameProgress());if(gst==ssbj&&this.cltt>=this.mxlt)for(i=
0;i<this.grid.length;i++)null!=this.grid[i]&&1==this.grid[i].sprite.inputEnabled&&this.grid[i].disableInteract();gst==ssbj&&0==this.blmgvr.btat.length&&this.cltt>=this.mxlt&&(gst=ssdr)},hit:function(c,f){c.parentObject.klbl();f.parentObject.twhha()},bpld:function(c,f){debugToConsole("bomb exploded at",c,f);for(b1=f-1;b1<f+2;b1++)for(b2=c-1;b2<c+2;b2++)0<=b1&&b1<GRH&&0<=b2&&b2<GRW&&null!=
this.grid[b2+GRW*b1]&&!(this.grid[b2+GRW*b1]instanceof Bomb)&&(debugToConsole("Bomb destroyed",this.grid[b2+GRW*b1]),this.grid[b2+GRW*b1].twhha())},lgpgr:function(){storedData=localStorage.getItem("lvls");null!=storedData&&(parsedData=JSON.parse(storedData),debugToConsole("loading game progress"),null!=parsedData&&this.lvmgvr.llvls(parsedData.unlocked,parsedData.finished));storedData=localStorage.getItem("aldn");null!=storedData&&(parsedData=
JSON.parse(storedData),null!=parsedData&&(this.alvfd=parsedData))},saveGameProgress:function(){localStorage.setItem("lvls",JSON.stringify(this.lvmgvr.gltss()));debugToConsole("saving game progress")},ldsst:function(){storedData=localStorage.getItem("sound");null!=storedData&&(parsedData=JSON.parse(storedData),debugToConsole("loading sound settings"),null!=parsedData&&smvr.ldsst(parsedData))},saveSoundSettings:function(){localStorage.setItem("sound",
JSON.stringify(smvr.ggsts()));debugToConsole("saving new sound settings")},wldls:function(){return 24==this.psll||49==this.psll||74==this.psll?!0:!1},alsDn:function(){return 0==this.alvfd&&this.lvmgvr.aldn()?(this.alvfd=!0,localStorage.setItem("aldn",!0),!0):!1}};var Splash=function(c){};
Splash.prototype={preload:function(){this.game.stage.backgroundColor="#FFFFFF";this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;game.device.desktop&&(this.scale.pageAlignHorizontally=!0);this.scale.refresh();loadSplash(this.game)},create:function(){this.logo=this.add.sprite(this.game.world.centerX,this.game.world.centerY,"inlogic_logo");this.logo.anchor.set(.5);this.logo.alpha=0;game.add.tween(this.logo).to({alpha:1},1E3,ACIO,!0,0,0,!1);if(game.device.desktop)this.lCn();else{document.getElementById("wrongRotationText").innerHTML=
rtx[language];var c=window.matchMedia("(orientation: portrait)");c.addListener(function(c){c.matches?hddV("wrongRotation"):(shdV("wrongRotation"),gst==ssbj&&(gst=sseg))});c.matches?this.lCn():(shdV("wrongRotation"),c.addListener(function(c){c.matches&&game.time.events.add(Phaser.Timer.SECOND,reloadPage,this)}))}},lCn:function(){this.logo.inputEnabled=!0;this.logo.events.onInputDown.add(this.startPreload,this);this.game.time.events.add(2*
Phaser.Timer.SECOND,this.hideLogo,this);this.game.time.events.add(3*Phaser.Timer.SECOND,this.startPreload,this)},hideLogo:function(){game.add.tween(this.logo).to({alpha:0},1E3,ACIO,!0,0,0,!1)},startPreload:function(){anst();this.game.state.start("prlS")}};var PrlD=function(c){};
PrlD.prototype={preload:function(){this.spsr=this.add.sprite(0,0,"splash");this.spsr.alpha=0;game.add.tween(this.spsr).to({alpha:1},500,ACIO,!0,0,0,!1);var c=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"loading_bar_keks");c.anchor.set(.5);game.add.tween(c).to({alpha:1},500,ACIO,!0,0,0,!1);this.ldbr=this.game.add.sprite(this.game.width>>1,this.game.height>>1,"loading_bar_bcg");this.ldbr.anchor.set(.5);this.ldbr.alpha=
0;game.add.tween(this.ldbr).to({alpha:1},500,ACIO,!0,0,0,!1);c=this.game.make.sprite(0,0,"loading_bar_full");c.x=-c.width>>1;c.y=-c.height>>1;this.ldbr.addChild(c);c=this.game.make.sprite(c.x,c.y,"loading_bar_slider");this.ldbr.addChild(c);this.game.load.setPreloadSprite(c);loadImages(this.game);(roWP=-1<navigator.userAgent.indexOf("Windows Phone"))||loadSounds(this.game)},create:function(){game.add.tween(this.ldbr).to({alpha:0},500,ACIO,
!0,0,0,!1);this.spsr.inputEnabled=!0;this.spsr.events.onInputDown.add(this.inputListener,this);this.ctxt=this.game.add.text(this.game.world.centerX,this.game.world.centerY,stx[language],{font:"bold "+10*FSM+"px "+FONT_TYPE,fill:FCBR});this.ctxt.anchor.set(.5);game.add.tween(this.ctxt).to({alpha:1},500,ACIO,!0,0,0,!1);game.add.tween(this.ctxt.scale).to({x:1.05,y:1.05},850,ACIO,!0,0,1E3,
!0)},inputListener:function(){this.startGame()},startGame:function(){this.game.state.start("gmm")}};var gmvr=null,gplmvr=null,smvr=null,pgox=0,pgoy=0,gst=ssje,gst_previous=ssje,gmm=function(c){};
gmm.prototype={preload:function(){TLDM=rX/GRW;gmvr=new GMgr(game);gplmvr=new GPLM(game);smvr=new SndG(game);gmvr.preload();gplmvr.preload()},create:function(){gmvr.create();roWP||(smvr.create(),smvr.pmz(sspr));pgox=gmvr.gpgpgstx();pgoy=gmvr.gpgpgsty();BULLET_X_MIN=gmvr.body.xOffset;BULLET_Y_MIN=gmvr.body.yOffset;
BULLET_X_MAX=gmvr.body.dimx+BULLET_X_MIN;BULLET_Y_MAX=gmvr.body.dimy+BULLET_Y_MIN;gplmvr.create();anld();this.xtd=-1},update:function(){gmvr.update();gplmvr.update();if(gst!=gst_previous)switch(gst_previous=gst,gst){case sslq:smvr.pmz(sspr);gmvr.chlsrvr.hdSR();gmvr.mmsrvr.hdSR();gmvr.dfsvr.sdSR();
gmvr.upperBar.setImages(!0);break;case sskw:smvr.pmz(sspr);gplmvr.rstF();gmvr.mmsrvr.sdSR();gmvr.dfsvr.hdSR();gmvr.igmsrvr.hdSR();gmvr.upperBar.setImages(!0);gmvr.wsrgr.hdSR();break;case ssma:smvr.pmz(sspr);gmvr.dfsvr.hdSR();gmvr.chlsrvr.sdSR();gmvr.alsrvr.hdSR();
gplmvr.rstF();gmvr.upperBar.setImages(!0);break;case ssoh:gmvr.wsrgr.sdSR();break;case ssih:gplmvr.alsDn()?(gst=ssoh,gmvr.alsrvr.hdSR(),gplmvr.rstF(),gmvr.gplsrvr.hdSR()):gplmvr.wldls()?(gst=sslq,gmvr.alsrvr.hdSR(),gplmvr.rstF(),
gmvr.gplsrvr.hdSR()):gst=ssghg;break;case ssghg:anlst();smvr.pmz(ssqu,!0);gmvr.chlsrvr.hdSR();gmvr.gplsrvr.sdSR();gmvr.igmsrvr.hdSR();gmvr.alsrvr.hdSR();gplmvr.startNewGame(gplmvr.hdltpcm);gmvr.udrstt();gmvr.upperBar.setImages(!1);break;case sseg:gmvr.gplsrvr.hdSR();
gmvr.igmsrvr.sdSR();gmvr.upperBar.setImages(!1);break;case sscf:anlsf();smvr.pmz(ssrq);gmvr.gplsrvr.hdSR();gmvr.alsrvr.sdSR();gmvr.upperBar.setImages(!1);this.clnfld();break;case ssbj:smvr.pmz(ssqu);gmvr.gplsrvr.sdSR();gmvr.igmsrvr.hdSR();gmvr.upperBar.setImages(!1);break;case ssnh:gmvr.gplsrvr.sdSR();
gmvr.igmsrvr.hdSR();gmvr.upperBar.setImages(!1);break;case ssdr:smvr.pmz(ssx9),gmvr.gplsrvr.hdSR(),gmvr.alsrvr.sdSR(),gmvr.upperBar.setImages(!1),game.time.events.add(Phaser.Timer.SECOND>>1,this.swfld,this).autoDestroy=!0}},swfld:function(){},clnfld:function(){0>this.xtd&&(this.xtd=1+Math.floor(2*Math.random()),game.time.events.add(Phaser.Timer.SECOND>>
1,this.swfld,this).autoDestroy=!0);this.xtd--}};function debugToConsole(c){};function shdV(c){game.device.desktop||(document.getElementById(c).style.display="block")}function hddV(c){game.device.desktop||(document.getElementById(c).style.display="none")}function reloadPage(){window.location.reload(!0)};var rX=480,rY=624,language=LANGUAGE_EN,pW=window.innerWidth/rX;window.innerHeight>pW*rY&&(rY=window.innerHeight/pW);var game=new Phaser.Game(rX,rY,Phaser.AUTO,"");game.state.add("splS",Splash);game.state.add("prlS",PrlD);game.state.add("gmm",gmm);game.state.start("splS");